<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan CSS Support Power BI Blog</title>
  
  <subtitle>日本マイクロソフトPower BIサポートチームのブログです。チームの担当製品である Power BI の情報を中心にお届けします。</subtitle>
  <link href="https://jpbap-sqlbi.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpbap-sqlbi.github.io/blog/"/>
  <updated>2023-10-01T06:20:18.371Z</updated>
  <id>https://jpbap-sqlbi.github.io/blog/</id>
  
  <author>
    <name>Japan Power BI Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>pbix ファイルのデータソースのファイル格納場所が変更される場合の対処策</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_changing_datasource_file_place/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_changing_datasource_file_place/</id>
    <published>2023-09-29T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.371Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Excel ファイルや CSV ファイルをデータソースにして Power BI レポートを作成したあと、「ファイルの格納場所が変更になる」という場合がございます。<br>その場合、基本的にはレポートを新規作成して新しい格納場所にあるファイルに接続をしますが、既存レポートが作りこんだ内容である場合、「そのレポートの作りを残したままデータソースの接続先だけを変更したい」というお問い合わせがよくあります。今回はその代表的な対処策をご紹介します。</p><span id="more"></span><div align="center"><img src="1.jpg"></div></br><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><p> <a href="#%E6%9C%AC%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E5%89%8D%E6%8F%90">本ブログの前提</a><br> <a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%A0%BC%E7%B4%8D%E5%A0%B4%E6%89%80%E3%81%8C%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E5%AF%BE%E5%87%A6%E7%AD%96">データソースのファイルの格納場所が変更される場合の対処策</a></p><hr><h2 id="本ブログの前提"><a href="#本ブログの前提" class="headerlink" title="本ブログの前提"></a>本ブログの前提</h2><hr><p>Excel ファイルや CSV ファイルをデータソースにしていて、そのファイルの格納場所がローカルフォルダから SharePoint フォルダに変更される場合その逆、またはローカルフォルダ内（SharePoint フォルダ内）で移動される場合を想定しています。</p></br><hr><h2 id="データソースのファイルの格納場所が変更される場合の対処策"><a href="#データソースのファイルの格納場所が変更される場合の対処策" class="headerlink" title="データソースのファイルの格納場所が変更される場合の対処策"></a>データソースのファイルの格納場所が変更される場合の対処策</h2><hr><p>Power BI Desktop で pbixファイルを開いて、Power Query エディターで、データソースの接続部分を新しい接続先に差し替えます。具体的な手順は以下です。</p><ol><li><p>念のため、対象の pbix ファイルをコピーして、そのコピーを開きます。</p></li><li><p>「データの変換」から Power Query エディターを開きます。</p><div align="center"><img src="2.jpg"></div></li></ol></br><ol start="3"><li>新しい接続先のダミーのクエリを以下の手順で生成してコピーします。<br>①「新しいソース」 &gt; 「その他」<div align="center"><img src="3.jpg"></div></li></ol></br><p>② 新しい接続先のコネクタ（以下例は SharePoint フォルダー）でデータを取得します。</p><div align="center"><img src="4.jpg"></div></br><p>③ ②で作成した新しいクエリ（テーブル）を選択 &gt; ホーム &gt; 詳細エディター　を押して、<br>クエリ（画像の赤太枠の部分）をコピーして、「キャンセル」で閉じます。</p><div align="center"><img src="5.jpg"></div></br><ol start="4"><li>既存のクエリ（テーブル）選択  &gt; ホーム &gt; 詳細エディター　を押して、３でコピーしたクエリの部分（例でいうと「ソース」から「変更された型」まで）を差し替えます。</li></ol><div align="center"><img src="6.jpg"></div></br><p>※注意点<br>・貼り付け用のクエリ以上の部分を消さないようにします（上記画像だと「追加されたカスタム」の行は残す）<br>・貼り付けたクエリのうしろにステップが存在する場合は、以下画像のように貼り付けたクエリの最後に「,（カンマ）」を忘れずに付けます（付けないと「’,’ が必要です」というエラーメッセージが出る）</p><div align="center"><img src="7.jpg"></div></br><p>・読み込んでいるクエリ（テーブル）が複数ある場合は、すべて差し替えます。</p><p>（差し替えがすべて完了したら、手順３で作成したダミーのクエリは削除して問題ありません。）</p></br><p>４．Power Query エディターを「閉じて適用」をします。</p><div align="center"><img src="8.jpg"></div></br>適用後は、レポートが変更前と変わらず表示できていることを確認しましょう。Power BI サービスにレポートを発行している場合は、再度、発行をしてデータセット更新の設定を改めて行ってください。</br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort">レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn</a></p></div></br><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Excel ファイルや CSV ファイルをデータソースにして Power BI レポートを作成したあと、「ファイルの格納場所が変更になる」という場合がございます。&lt;br&gt;その場合、基本的にはレポートを新規作成して新しい格納場所にあるファイルに接続をしますが、既存レポートが作りこんだ内容である場合、「そのレポートの作りを残したままデータソースの接続先だけを変更したい」というお問い合わせがよくあります。今回はその代表的な対処策をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
    <category term="データソース設定" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E8%A8%AD%E5%AE%9A/"/>
    
  </entry>
  
  <entry>
    <title>Power BI 利用時のパフォーマンス測定や最適化について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/performance/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/performance/</id>
    <published>2023-09-29T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:19.079Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。</p><p>Power BI Service でデータ更新を行った際に、以下のエラーが発生したことはありませんか。</p><blockquote><p>Resource Governing: This query uses more memory than the configured limit. The query — or calculations referenced by it — might be too memory-intensive to run. Either simplify the query or its calculations, or if using Power BI Premium, you may reach out to your capacity administrator to see if they can increase the per-query memory limit. More details: consumed memory 6369 MB, memory limit 6144 MB. See <a href="https://go.microsoft.com/fwlink/?linkid=2159752">https://go.microsoft.com/fwlink/?linkid=2159752</a> to learn more.</p></blockquote><p>こちらのエラーは、データセットの更新時にクエリあたりのメモリ上限を超過した際に発生するエラーとなります。本エラーが発生した場合、基本的には上位の SKU にアップグレードしてリソースを増強する必要がありますが、データモデルの最適化やビジュアルの修正によってエラーが解消する場合もございます。パフォーマンス改善に役立つ公開情報についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#Power-BI-Desktop">Power BI Desktop</a><ul><li><a href="#1-%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96">1.データモデルの最適化</a></li><li><a href="#2-%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E3%81%AE%E6%B8%AC%E5%AE%9A">2.パフォーマンスの測定</a></li><li><a href="#3-%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88%E9%96%8B%E7%99%BA%EF%BD%A5%E5%8F%82%E7%85%A7%E3%81%AE%E5%8A%B9%E7%8E%87%E5%8C%96">3.レポート開発･参照の効率化</a></li></ul></li><li><a href="#Power-BI-Service">Power BI Service</a></li><li><a href="#Power-BI-Premium-Per-Capacity-Premium-%E5%AE%B9%E9%87%8F">Power BI Premium Per Capacity (Premium 容量)</a></li><li><a href="#Microsoft-Fabric">Microsoft Fabric</a></li></ul><h2 id="Power-BI-Desktop"><a href="#Power-BI-Desktop" class="headerlink" title="Power BI Desktop"></a>Power BI Desktop</h2><p>Power BI Desktop でのパフォーマンス測定･改善については、1) データモデルの改善、 2) パフォーマンスの測定 についてご案内します。</p><h3 id="1-データモデルの最適化"><a href="#1-データモデルの最適化" class="headerlink" title="1.データモデルの最適化"></a>1.データモデルの最適化</h3><p>前提としてデータモデルは、スタースキーマで構築されることが推奨されます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/star-schema">スター スキーマと Power BI での重要性を理解する - Power BI | Microsoft Learn</a></p></div><p>処理が複雑となる場合は、 Power BI で列を追加したり、メジャーを作成したりすることや、 Power Query での加工処理を行うと、 Power BI Desktop ではクライアントのリソースを、 Power BI Service では共有リソースを使用するため、データソース側で行うことが望ましいです。 Power BI で変換を行う場合には利用しているデータモデルに応じて以下の公開情報を参照してデータモデルの最適化をご検討ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/import-modeling-data-reduction">インポート モデリングのデータ削減手法 - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/directquery-model-guidance">Power BI Desktop の DirectQuery モデルのガイダンス - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/composite-model-guidance">Power BI Desktop の複合モデルのガイダンス - Power BI | Microsoft Learn</a></p></div><p>Power Query を使用する場合には以下のベスト プラクティスをご一読ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-query/best-practices">Power Query を使用するときのベスト プラクティス - Power Query | Microsoft Learn</a></p></div><h3 id="2-パフォーマンスの測定"><a href="#2-パフォーマンスの測定" class="headerlink" title="2.パフォーマンスの測定"></a>2.パフォーマンスの測定</h3><p>パフォーマンス アナライザーを利用することで、レポートでどのビジュアルの表示に時間がかかっているか、またどの部分がボトルネックになっているかを確認することができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-performance-analyzer">Power BI Desktop でパフォーマンス アナライザーを使用してレポート要素のパフォーマンスを確認する - Power BI | Microsoft Learn</a></p></div><p>外部ツールとなりますが、 DAX Studio を利用することでもパフォーマンスを確認することができます。DAX Studio を利用する場合には、パフォーマンス アナライザーを利用してクエリ実行時のデータを .json ファイルとしてエクスポートし、エクスポートした .json ファイルを DAX Studio で読み込むことで、クエリの一覧を確認し、実行速度順にクエリを確認することや、また、クエリを再度実行することで DAX Studio 上でクエリの詳細を確認することができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://www.sqlbi.com/articles/importing-performance-analyzer-data-in-dax-studio/">Importing Performance Analyzer data into DAX Studio - SQLBI</a></p></div><h3 id="3-レポート開発･参照の効率化"><a href="#3-レポート開発･参照の効率化" class="headerlink" title="3.レポート開発･参照の効率化"></a>3.レポート開発･参照の効率化</h3><p>レポートの開発時には、 [最適化リボン] を利用することでビジュアルを追加した際のデータ更新を停止することができるため、データソースが大容量の場合であってもデータが読み込まれる時間を削減することができ、効率的な開発が可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-optimize-ribbon">Power BI Desktop の最適化リボン - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-optimize-ribbon-scenarios">Power BI Desktop の最適化リボンを使用した DirectQuery 最適化のシナリオ - Power BI | Microsoft Learn</a></p></div><p>また、レポートのスライサーやフィルターが多い場合には、一度にスライサーやフィルターを適用することで、クエリの実行回数を減らすことができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/buttons-apply-all-clear-all-slicers?tabs=powerbi-desktop">レポートにすべてのスライサーを適用およびクリアするボタンを作成する - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/power-bi-report-filter?tabs=powerbi-desktop#apply-filters-button">Power BI レポートでフィルターを書式設定する - フィルターの [適用] ボタン | Microsoft Learn</a></p></div><h2 id="Power-BI-Service"><a href="#Power-BI-Service" class="headerlink" title="Power BI Service"></a>Power BI Service</h2><p>現在、プレビュー機能で Power BI Service でもデータモデルの編集が可能ですが、 Power BI Service からデータモデルを編集する場合にも Power BI Desktop で紹介したデータモデルのデータ削減方法が利用できます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/service-edit-data-models">Power BI サービスでデータ モデルを編集する (プレビュー) - Power BI | Microsoft Learn</a></p></div><p>Power BI Service では、データフローを利用することでデータの加工が可能です。データフローをご利用いただいている場合には以下の公開情報をご一読ください。複数のトピックについてリンクがあります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/dataflows/dataflows-best-practices">データフローのベスト プラクティス - Power BI | Microsoft Learn</a></p></div><div align="center"><img src="performance01.png"></div>  <h2 id="Power-BI-Premium-Per-Capacity-Premium-容量"><a href="#Power-BI-Premium-Per-Capacity-Premium-容量" class="headerlink" title="Power BI Premium Per Capacity (Premium 容量)"></a>Power BI Premium Per Capacity (Premium 容量)</h2><p>Premium 容量では、パフォーマンスをモニタリングするためのアプリがあります。アプリから時系列で容量の利用率や上限を超過しているかどうかの推移や、各アイテムのリソースの利用状況をご確認いただけます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-install-app?tabs=1st">Premium メトリック アプリをインストールする - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-metrics-app">Premium メトリック アプリを使用して Power BI Premium 容量を監視します。 - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-concepts">Power BI Premium の最大能力負荷、過負荷、自動スケーリング - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-smoothing">Power BI Premium の CPU スムージング。 - Power BI | Microsoft Learn</a></p></div><p>また、データセットの使用できるメモリの使用量上限の設定など、データセット、データフローの更新やクエリ、ページ分割されたレポートの実行、AI 機能を処理する各ワークロードの動作を制御することも可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-premium-workloads">Power BI Premium でワークロードを構成する方法 - Power BI | Microsoft Learn</a></p></div><div align="center"><img src="performance02.png"></div>  <p>Premium 容量の P1･P2 をご利用いただいている場合で、冒頭に記載したクエリあたりの最大メモリエラーが発生している場合、Premium Per User (PPU) 試用版を利用することで、上位の SKU にアップグレードした場合にエラーが解消するかを確認することが可能です。PPU は、 Premium 容量の SKU の P3 に相当するため、試用版を利用して一度更新を実行いただき、エラーが解消する場合には SKU のアップグレードをご検討ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-what-is#capacities-and-skus">Power BI Premium とは - 容量と SKU | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/service-self-service-signup-for-power-bi#use-self-service-sign-up-to-start-an-individual-trial-of-the-power-bi-paid-version">個人として Power BI サービスにサインアップまたは購入する - セルフサービス サインアップを使用して Power BI 有料バージョンの個人向け試用版を開始する | Microsoft Learn</a></p></div><div align="center"><img src="performance03.png"></div>  <h2 id="Microsoft-Fabric"><a href="#Microsoft-Fabric" class="headerlink" title="Microsoft Fabric"></a>Microsoft Fabric</h2><p>Microsoft Fabric についても、Premium 容量と同様にパフォーマンス測定のためのアプリがあります。Premium 容量と同様に、アプリから時系列で容量の利用率や上限を超過しているかどうかの推移や、各アイテムのリソースの利用状況をご確認いただけます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app">Microsoft Fabric Capacity Metrics アプリとは? - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app-install?tabs=1st">Microsoft Fabric Capacity Metrics (Microsoft Fabric 容量メトリック) アプリをインストールする - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app-overview-page">メトリック アプリの概要ページを理解する - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app-timepoint-page">メトリック アプリのタイムポイント ページについて - Microsoft Fabric | Microsoft Learn</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;/p&gt;
&lt;p&gt;Power BI Service でデータ更新を行った際に、以下のエラーが発生したことはありませんか。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Resource Governing: This query uses more memory than the configured limit. The query — or calculations referenced by it — might be too memory-intensive to run. Either simplify the query or its calculations, or if using Power BI Premium, you may reach out to your capacity administrator to see if they can increase the per-query memory limit. More details: consumed memory 6369 MB, memory limit 6144 MB. See &lt;a href=&quot;https://go.microsoft.com/fwlink/?linkid=2159752&quot;&gt;https://go.microsoft.com/fwlink/?linkid=2159752&lt;/a&gt; to learn more.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;こちらのエラーは、データセットの更新時にクエリあたりのメモリ上限を超過した際に発生するエラーとなります。本エラーが発生した場合、基本的には上位の SKU にアップグレードしてリソースを増強する必要がありますが、データモデルの最適化やビジュアルの修正によってエラーが解消する場合もございます。パフォーマンス改善に役立つ公開情報についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="データセット" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88/"/>
    
    <category term="パフォーマンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Desktop のインストール・更新方法について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/powerbidesktop_install/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/powerbidesktop_install/</id>
    <published>2023-09-28T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:19.083Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI Desktop にはインストール方法が 2 種類あることをご存じですか？<br>最小要件や提供される機能は基本的には同じですが、いくつかの制限事項や違いがあります。<br>本記事では、両者の違いをわかりやすくご案内しておりますので、どちらのインストール方法を採用するか迷った際にはご参考にしていただけますと幸いです。   </p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="Power-BI-Desktop-のインストール方法は２種類"><a href="#Power-BI-Desktop-のインストール方法は２種類" class="headerlink" title="Power BI Desktop のインストール方法は２種類"></a><font color="DodgerBlue">Power BI Desktop のインストール方法は２種類</font></h2><p>Power BI Desktop は、以下２つの方法で Windows 8.1 以上の PC にインストールして使用できる無償のアプリケーションです。   </p><p>・<a href="https://www.microsoft.com/ja-jp/download/details.aspx?id=58494">ダウンロードセンター</a>から Power BI Desktop のインストーラをダウンロードしてインストールする<br>・Microsoft Store からインストールする  </p><p>ご参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-get-the-desktop">Power BI Desktop の取得</a> </p><h3 id="Power-BI-Desktop-のインストーラをダウンロードしてインストールする"><a href="#Power-BI-Desktop-のインストーラをダウンロードしてインストールする" class="headerlink" title="Power BI Desktop のインストーラをダウンロードしてインストールする"></a><font color="HotPink">Power BI Desktop のインストーラをダウンロードしてインストールする</font></h3><p>ダウンロードセンターから、ご使用の OS と同じ bit 数のインストーラをダウンロードしインストールします。<br>この方法でインストールした場合、次回以降の更新は毎回同じように、ダウンロードセンターからインストーラを取得して上書きインストールする必要があります。<br>また、インストール時には管理者権限が必要です。<br>組織やユーザーのタイミングで更新を行いたい場合や、Microsoft Store を利用できない場合はこちらの方法をご検討いただければと思います。     </p><h3 id="Microsoft-Store-からインストールする"><a href="#Microsoft-Store-からインストールする" class="headerlink" title="Microsoft Store からインストールする"></a><font color="HotPink">Microsoft Store からインストールする</font></h3><p>Microsoft Store からストアアプリとしてインストールします。<br>インストール後の Power BI Desktop アプリとしての機能は基本的にはダウンロードセンターから入手したものと差はありません。<br>ストアアプリとは Microsoft Store から入手・自動更新できるアプリであり、管理者権限を必要とせず標準ユーザーでもインストールできるように設計されています。<br>サンドボックスという、他のアプリケーションやシステムとは隔離された仮想的な空間で動作するため、セキュリティが高い特徴があります。<br>その他ストアプリのメリットとして、各更新のダウンロード量が少なくなること、言語サポートなどがあります。<br>Microsoft Store を利用できる場合や、その後自動更新をしたい場合、ユーザー権限でインストールさせたい場合はこちらの方法をご検討いただければと思います。 </p><h3 id="比較表"><a href="#比較表" class="headerlink" title="比較表 "></a><font color="HotPink">比較表 </font></h3><table><thead><tr><th align="center"></th><th>Microsoft Store からストアアプリとしてインストール</th><th>ダウンロードセンターからインストーラをダウンロードしてインストール</th></tr></thead><tbody><tr><td align="center">最小要件</td><td>・Windows 8.1 または Windows Server 2012 R2 以降 <br>・.NET 4.6.2 以降 <br>・メモリ (RAM): 2 GB 以上使用可能、4 GB 以上を推奨) <br>・WebView2 <br>その他以下公開情報を参照 <br><a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-get-the-desktop#minimum-requirements">最小要件</a></td><td>・Windows 8.1 または Windows Server 2012 R2 以降 <br>・.NET 4.6.2 以降 <br>・メモリ (RAM): 2 GB 以上使用可能、4 GB 以上を推奨) <br>・WebView2 <br>その他以下公開情報を参照 <br><a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-get-the-desktop#minimum-requirements">最小要件</a></td></tr><tr><td align="center">金額</td><td>無償</td><td>無償</td></tr><tr><td align="center">インストールに必要な権限</td><td>標準ユーザーの権限にてインストール可能</td><td>管理者特権が必要</td></tr><tr><td align="center">インストールパス（既定）</td><td>C:\Program Files\Microsoft Power BI Desktop(既定)</td><td>C:\Program Files\WindowsApps</td></tr><tr><td align="center">更新方法</td><td>ダウンロードセンターから都度インストーラを入手</td><td>自動更新が可能</td></tr><tr><td align="center">更新頻度</td><td>月1回程度（マイナーアップデートが発生することもあり） <br>ご参考：<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_feature_roadmap/">Power BIのアップデート情報について</a></td><td>月1回程度（マイナーアップデートが発生することもあり） <br>ご参考：<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_feature_roadmap/">Power BIのアップデート情報について</a></td></tr><tr><td align="center">その他制限事項</td><td>ー</td><td>・SAP コネクタを使用する場合、SAP ドライバー ファイルを Windows\System32 フォルダーに移動することが必要な場合がある <br>・Microsoft Store から Power BI Desktop をインストールしても、.exe バージョンのユーザー設定はコピーされないため、最近使ったデータ ソースに再接続し、資格情報を再入力することが必要な場合がある <br>・Oracle データベース コネクタを使用する場合場合、ドライバーの問題によりOracleデータベースに接続できない可能性がある <br>対処策は以下公開情報を参照 <br>  <a href="https://learn.microsoft.com/ja-jp/power-query/connectors/oracle-database#troubleshooting">Oracle データソース - トラブルシューティング</a></td></tr></tbody></table> </br><h2 id="使用しているPower-BI-Desktopがどちらのインストール方法でインストールされたか確認する方法"><a href="#使用しているPower-BI-Desktopがどちらのインストール方法でインストールされたか確認する方法" class="headerlink" title="使用しているPower BI Desktopがどちらのインストール方法でインストールされたか確認する方法"></a><font color="DodgerBlue">使用しているPower BI Desktopがどちらのインストール方法でインストールされたか確認する方法</h2> </font>   <p>Power BI Desktop を起動した状態で、タスク マネージャーを起動し、プロセス タブの一覧から Power BI Desktop アプリを展開し、“Microsoft Power BI Desktop” で右クリック ＞ プロパティを開きます。<br>“場所” に表示されるパスで確認できます。<br>以下例では、パスが “C:\Program Files\Microsoft Power BI Desktop\” 配下なので、ダウンロードセンターから入手した Power BI Desktop であることが確認できます。 </p><div align="left"><img src="1.png"></div></p> </br><h2 id="組織での一括インストールや更新方法について"><a href="#組織での一括インストールや更新方法について" class="headerlink" title="組織での一括インストールや更新方法について"></a><font color="DodgerBlue">組織での一括インストールや更新方法について</h2> </font>  <p>上記ダウンロードセンターから入手する従来のデスクトップアプリとストアアプリのどちらを採用するかにより、検討可能な方法は異なってまいります。<br>Power BI Desktop に特化した運用方法のベストプラクティスはご用意がありませんので、ユーザー様の組織において、既存のデスクトップアプリやストアアプリをどのように運用されているかをご確認の上ご検討いただければと存じます。   </p> </br>   <p>以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI Desktop にはインストール方法が 2 種類あることをご存じですか？&lt;br&gt;最小要件や提供される機能は基本的には同じですが、いくつかの制限事項や違いがあります。&lt;br&gt;本記事では、両者の違いをわかりやすくご案内しておりますので、どちらのインストール方法を採用するか迷った際にはご参考にしていただけますと幸いです。   &lt;/p&gt;</summary>
    
    
    
    
    <category term="アップデート" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%83%88/"/>
    
    <category term="更新" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
    <category term="PowerBIDesktop　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBIDesktop/"/>
    
    <category term="インストール" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/"/>
    
    <category term="ストアアプリ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B9%E3%83%88%E3%82%A2%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
    <category term="MicrosoftStore" scheme="https://jpbap-sqlbi.github.io/blog/tags/MicrosoftStore/"/>
    
  </entry>
  
  <entry>
    <title>Power BIワークスペースのガバナンス</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_workspace_governance/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_workspace_governance/</id>
    <published>2023-08-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.947Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。<br>Power BI管理者は、 [管理ポータル]からテナントに存在するワークスペースの容量やアクセス設定を変更できること、皆さんご存知かと思います。一方で、データセットの更新エラーの修正、機密データへのアクセスの制御、ユーザーが組織を離れるときのコンテンツ引き継ぎ、データ使用量の制御や、会社のポリシーとの従業員のコンプライアンスの確保などのために、[マイワークスペース]へのアクセスが必要になる場合があります。<br>この場合、Power BI管理者がユーザーのマイワークスペースにアクセスする機能を使用することで、マイワークスペースのガバナンスを実現可能です。この記事では、その手順ついて詳しく説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></br></p><p></br></p></div><hr><h2 id="Power-BI管理者がマイワークスペースにアクセスする手順"><a href="#Power-BI管理者がマイワークスペースにアクセスする手順" class="headerlink" title="Power BI管理者がマイワークスペースにアクセスする手順"></a>Power BI管理者がマイワークスペースにアクセスする手順</h2><hr><p>マイワークスペースのアクセス権限を取得する方法は、基本的には共有ワークスペースの方法と同じです。<br>１．Power BIサービスで[設定]＞[管理ポータル]＞[ワークスペース]を選択します。</p><div align="left"><img src="1.png"></div><p>２．必要に応じて、ワークスペース名を絞り込みます。<br>※マイワークスペースの[名前]は、「PersonalWorkspace ユーザー名」で、[型]は「個人用グループ」です</p><div align="left"><img src="2.png"></div><p>３．[︙]（アクション）＞[アクセスの許可]を選択します。</p><div align="left"><img src="3.png"></div><p>※選択後、「アクセス権が正常に取得されました」との通知が表示されます</p><div align="left"><img src="4.png"></div><p>４．アクセス権限の取得後、マイワークスペースは[ユーザー名]の名前で、ワークスペース一覧で表示されるようになります。<br>アクセス権限を取得したマイワークスペースにアクセスいただき、必要に応じて中身のコンテンツの削除や修正、別のワークスペースへの移動などの操作をすることが可能となります</p><div align="left"><img src="5.png"></div></br><hr><h2 id="注意事項"><a href="#注意事項" class="headerlink" title="注意事項"></a>注意事項</h2><hr><p>・マイワークスペースへのアクセス権限は 24 時間後に自動的に取り消されます。<br>・退職し削除されたユーザーのマイワークスペースは [削除済み] として表示され、コンテンツは 90 日間保持されます。<br>・コンテンツの保持期間中、管理者はマイ ワークスペースを[復元]オプションを利用できます。</p><div align="left"><img src="6.png"></div></br><hr><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><hr><ul><li> <a href="https://powerbi.microsoft.com/en-us/blog/announcing-my-workspace-governance-improvement-public-preview/">Microsoft Power BI Blog：Announcing My workspace governance improvement</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-portal-workspaces">公開情報：ワークスペースを管理する</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-platform-release-plan/2022wave2/power-bi/improve-my-workspace-governance">公開情報：自分のワークスペースのガバナンスを改善する</a></li></ul><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;br&gt;Power BI管理者は、 [管理ポータル]からテナントに存在するワークスペースの容量やアクセス設定を変更できること、皆さんご存知かと思います。一方で、データセットの更新エラーの修正、機密データへのアクセスの制御、ユーザーが組織を離れるときのコンテンツ引き継ぎ、データ使用量の制御や、会社のポリシーとの従業員のコンプライアンスの確保などのために、[マイワークスペース]へのアクセスが必要になる場合があります。&lt;br&gt;この場合、Power BI管理者がユーザーのマイワークスペースにアクセスする機能を使用することで、マイワークスペースのガバナンスを実現可能です。この記事では、その手順ついて詳しく説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="ワークスペース" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B9/"/>
    
    <category term="ガバナンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%AC%E3%83%90%E3%83%8A%E3%83%B3%E3%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>トラブル発生時の事象調査における情報採集</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace_NewVer/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace_NewVer/</id>
    <published>2023-08-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.287Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのファムです。<br>Power BI を利用される際に、エラーが発生するなど想定したとおりに動作しない場合、事象が起こる原因を特定するための調査が必要になる場合があります。<br>以前<a href="https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace/">「トラブル発生時の事象調査に必要な情報の採取手順について(通信編)」</a>について記載しましたが、現象によって必要な情報は異なりますので、以下は複数のパターンを想定して問題が発生する場合の情報採取手順についてご紹介いたします。</p><span id="more"></span></br><div class="alert is-important"><p class="alert-title">重要</p><p>弊社サポートをご利用いただいている場合、状況に合わせた調査方針を策定するため、記載の内容とご案内が異なる場合がございます。</p><p>ご不明な点がございましたら弊社サポート担当までお気軽にご質問ください。</p><p>また掲載している画像・手順は投稿時点のものとなります。最新の情報とは異なる可能性がございますので予めご了承ください。</p></div></br><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#1%EF%BC%8EFiddler%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">Fiddlerトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#2%EF%BC%8EPower-BI-Desktop%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">Power BI Desktopトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#3%EF%BC%8E%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">ブラウザトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#4%EF%BC%8EFiddler%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8Power-BI-Desktop%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">FiddlerトレースとPower BI Desktopトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#5%EF%BC%8E%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9-%E3%83%A2%E3%83%8B%E3%82%BF%E3%83%BC%E3%81%A8Power-BI-Desktop%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8Xbox-Game-Bar%E3%81%AB%E3%82%88%E3%82%8B%E9%8C%B2%E7%94%BB%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順</a></br></li></ol><hr><h2 id="1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順"><a href="#1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順"></a>1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順</h2><p>・HTTP/S トレース（Fiddler トレース）： クライアントに導入するソフトウェア。使用するアプリケーションなどを通じて端末と接続先のHTTP/S 通信を記録し通信状況の差異を確認するツール<br>・PSR（ステップ記録ツール）：　操作ごとに画面キャプチャを記録するツール</p><p><strong>1．Fiddlerのインストール</strong></p><ol><li>Telerik 社の Web サイトより、適宜必要項目を入力し「Download for Windows」を選択し、インストーラをダウンロードします。その後、採取対象の環境へインストールします。<br><a href="https://www.telerik.com/download/fiddler">https://www.telerik.com/download/fiddler</a></li></ol></br><div align="center"><img src="pic1.png"></div><ol start="2"><li>採取対象の環境で、Fiddler を起動します。<br>※Fiddler の採取時は可能な限り不要なアプリケーションを閉じ、事象再現のみのトレースが取れるように設定ください。</li><li>自動的にトレースが開始されるため、メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。または[F12]キーでもトレースの停止/再開が可能です。</li></ol></br><div align="center"><img src="pic2.png"></div><ol start="4"><li>メニュー バーから [Tools] - [Options] を選択します。</li></ol></br><div align="center"><img src="pic3.png"></div><ol start="5"><li>HTTPS タブをクリックし、”Capture HTTPS CONNECTS” および “Decrypt HTTPS traffic” のチェック ボックスをオンにし、OK ボタンをクリックし、Fiddler Options を閉じます。</li></ol></br><div align="center"><img src="pic4.png"></div><p>“Decrypt HTTPS traffic” のチェック ボックスをオンにすることで、以下の警告が表示されることがございます。Yes ボタンをクリックします。<br>“Fiddler generates a unique root CA certificate to intercept HTTPS traffic. You may choose to have Windows trust this root certificate to avoid security warnings about the untrusted root certificate. You should ONLY click ‘Yes’ on a computer used exclusively for TEST purposes.”<br>上記警告で Yes を選択すると、セキュリティ警告が表示されますので、”はい” を選択します。<br>これにより、ログインユーザーの個人ストアならびに、ローカルコンピューターの信頼されたルート証明機関ストアに発行者が “DO_NOT_TRUST_FiddlerRoot” である証明書が追加されます。</p><ol start="6"><li>画面右側にある Filters - User Filter がオフになっていることを確認します。</li></ol></br><div align="center"><img src="pic5.png"></div><p><strong>2．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div><p><strong>3．Fiddler トレースの開始</strong><br>Fiddler のメニューバーの[File] - [Capture Traffic] を選択し、トレースを再開します。<br>この時左側のウィンドウでトレースが取れていることをご確認ください。</p><p><strong>4．事象の再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>5．Fiddler トレースの停止</strong></p><ol><li>事象再現後、Fiddler メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。</li><li>Fiddler のメニュー バーから [File] - [Save] - [All Sessions] を選択し、.saz 形式でログを保存します。</li></ol></br><div align="center"><img src="pic7.png"></div><ol start="3"><li>一度 Fiddler を終了し、閉じます。</li></ol><p><strong>6．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>Fiddlerトレースとステップ記録ツール (PSR)の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p><p>Fiddler 自体が Proxy の役目となるため、ご利用環境からインターネットへの通信において Proxy サーバーがございましたら、利用する貴社の Proxy を通るようにご設定ください。<br>※外部サイトではございますが、手順についてまとめられたサイトがありますので、ご参考ください。<br>参考情報：<a href="http://did2.blog64.fc2.com/blog-entry-8.html">プロキシ環境でのfiddler</a></p><p><strong>ネットワーク環境においてプロキシをご利用いただいている場合</strong></p><p>Fiddler 自体が Proxy の役目となるため、ご利用環境からインターネットへの通信において Proxy サーバーがございましたら、利用する貴社の Proxy を通るようにご設定ください。</p><p>※外部サイトではございますが、手順についてまとめられたサイトがありますので、ご参考ください。<br>参考情報：<a href="http://did2.blog64.fc2.com/blog-entry-8.html">プロキシ環境でのfiddler</a></p><h2 id="2．Power-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順"><a href="#2．Power-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="2．Power BI Desktopトレースとステップ記録ツール（PSR）の採取手順"></a>2．Power BI Desktopトレースとステップ記録ツール（PSR）の採取手順</h2><p>・Desktop トレース  ：Power BI Desktopの処理を記録するためのトレース<br>・PSR（ステップ記録ツール） ：操作ごとに画面キャプチャを記録するツール</p><p><strong>1．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div></br><p><strong>2．Power BI Desktopトレースの採取手順</strong><br>開いている Power BI Desktop をすべて閉じます。<br>以下の Traces フォルダーおよびその配下のフォルダーにあるログファイルをすべて削除します。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>1)「環境変数」の「ユーザー変数」に 変数名：PBI_forceTracing、変数値： 1 を設定します。</p></br><div align="center"><img src="pic9.png"></div><p>2)左上にあるキャプチャウィンドウから、マイクをオフにし、●ボタンをクリックすると、録画が開始されます。</p></br><div align="center"><img src="pic10.png"></div><p><strong>3．事象再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>4．Power BI Desktop トレース停止</strong><br>Power BI Desktop を閉じます。<br>現象再現後、トーレスに関しましては、以下の Power BI Desktop フォルダーに生成されます。<br>該当の Traces フォルダーを以下の弊社アップロードサイトへご送付ください。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>&lt;トレース無効化手順&gt;<br>「環境変数」の「ユーザー変数」に 設定した PBI_forceTracing  1 を削除します。</p><p><strong>5．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>Power BI Desktopトレースとステップ記録ツール (PSR) の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p><h2 id="3．ブラウザトレースとステップ記録ツール（PSR）の採取手順"><a href="#3．ブラウザトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="3．ブラウザトレースとステップ記録ツール（PSR）の採取手順"></a>3．ブラウザトレースとステップ記録ツール（PSR）の採取手順</h2><p>・ブラウザ トレース  ：ブラウザの処理を記録するためのトレース<br>・PSR（ステップ記録ツール）　：操作ごとに画面キャプチャを記録するツール</p><p><strong>1．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div></br><p><strong>2．ブラウザトレースの開始</strong></p><ol><li>ブラウザを起動し、Chrome のシークレットモードまたはEdge のIn-Private モードで新しいウィンドウを開きます。</li><li>F12 を押下し、ネットワーク を選択し、セッションをクリアした後、開始ボタンを押下します。</li></ol><p>Microsoft Edge の場合：<br></br></p><div align="center"><img src="pic11.png"></div></br><p>Chrome の場合：<br></br></p><div align="center"><img src="pic12.png"></div></br><p><strong>3．事象再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>4．ブラウザトレースの停止</strong><br>停止 ボタンを押下し、HARファイルとしてエクスポート ボタンよりファイルをエクスポートします。<br>※取得したトレース上で右クリックしていただき、「HAR としてすべて保存する」からでもエクスポート可能です。</p><p>Microsoft Edgeの場合：<br></br></p><div align="center"><img src="pic13.png"></div><p>Chrome の場合：<br></br></p><div align="center"><img src="pic14.png"></div><p><strong>5．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>ブラウザトレースとステップ記録ツール (PSR) の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p></br><h2 id="4．FiddlerトレースとPower-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順"><a href="#4．FiddlerトレースとPower-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="4．FiddlerトレースとPower BI Desktopトレースとステップ記録ツール（PSR）の採取手順"></a>4．FiddlerトレースとPower BI Desktopトレースとステップ記録ツール（PSR）の採取手順</h2><p>・HTTP/S トレース（Fiddler トレース） ：クライアントに導入するソフトウェア。使用するアプリケーションなどを通じて端末と接続先のHTTP/S 通信を記録し通信状況の差異を確認するツール<br>・Desktop トレース    ：Power BI Desktopの処理を記録するためのトレース<br>・PSR（ステップ記録ツール）　：操作ごとに画面キャプチャを記録するツール</p><p><strong>1．Fiddlerのインストール</strong></p><ol><li>Telerik 社の Web サイトより、適宜必要項目を入力し「Download for Windows」を選択し、インストーラをダウンロードします。その後、採取対象の環境へインストールします。<br><a href="https://www.telerik.com/download/fiddler">https://www.telerik.com/download/fiddler</a></li></ol></br><div align="center"><img src="pic1.png"></div><ol start="2"><li>採取対象の環境で、Fiddler を起動します。<br>※Fiddler の採取時は可能な限り不要なアプリケーションを閉じ、事象再現のみのトレースが取れるように設定ください。</li><li>自動的にトレースが開始されるため、メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。または[F12]キーでもトレースの停止/再開が可能です。</li></ol></br><div align="center"><img src="pic2.png"></div><ol start="4"><li>メニュー バーから [Tools] - [Options] を選択します。</li></ol></br><div align="center"><img src="pic3.png"></div><ol start="5"><li>HTTPS タブをクリックし、”Capture HTTPS CONNECTS” および “Decrypt HTTPS traffic” のチェック ボックスをオンにし、OK ボタンをクリックし、Fiddler Options を閉じます。</li></ol></br><div align="center"><img src="pic4.png"></div><p>“Decrypt HTTPS traffic” のチェック ボックスをオンにすることで、以下の警告が表示されることがございます。Yes ボタンをクリックします。<br>“Fiddler generates a unique root CA certificate to intercept HTTPS traffic. You may choose to have Windows trust this root certificate to avoid security warnings about the untrusted root certificate. You should ONLY click ‘Yes’ on a computer used exclusively for TEST purposes.”<br>上記警告で Yes を選択すると、セキュリティ警告が表示されますので、”はい” を選択します。<br>これにより、ログインユーザーの個人ストアならびに、ローカルコンピューターの信頼されたルート証明機関ストアに発行者が “DO_NOT_TRUST_FiddlerRoot” である証明書が追加されます。</p><ol start="6"><li>画面右側にある Filters - User Filter がオフになっていることを確認します。</li></ol></br><div align="center"><img src="pic5.png"></div><p><strong>2．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div><p><strong>3．Fiddler トレースの開始</strong><br>Fiddler のメニューバーの[File] - [Capture Traffic] を選択し、トレースを再開します。<br>この時左側のウィンドウでトレースが取れていることをご確認ください。</p><p><strong>4．Power BI Desktopトレースの採取手順</strong><br>開いている Power BI Desktop をすべて閉じます。<br>以下の Traces フォルダーおよびその配下のフォルダーにあるログファイルをすべて削除します。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>1)「環境変数」の「ユーザー変数」に 変数名：PBI_forceTracing、変数値： 1 を設定します。</p></br><div align="center"><img src="pic9.png"></div><p>2)左上にあるキャプチャウィンドウから、マイクをオフにし、●ボタンをクリックすると、録画が開始されます。</p></br><div align="center"><img src="pic10.png"></div><p><strong>5．事象の再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>6．Fiddler トレースの停止</strong></p><ol><li>事象再現後、Fiddler メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。</li><li>Fiddler のメニュー バーから [File] - [Save] - [All Sessions] を選択し、.saz 形式でログを保存します。</li></ol></br><div align="center"><img src="pic7.png"></div><ol start="3"><li>一度 Fiddler を終了し、閉じます。</li></ol><p><strong>7．Power BI Desktop トレース停止</strong><br>Power BI Desktop を閉じます。<br>現象再現後、トーレスに関しましては、以下の Power BI Desktop フォルダーに生成されます。<br>該当の Traces フォルダーを以下の弊社アップロードサイトへご送付ください。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>&lt;トレース無効化手順&gt;<br>「環境変数」の「ユーザー変数」に 設定した PBI_forceTracing  1 を削除します。</p><p><strong>8．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>FiddlerトレースとPower BI Desktopトレースとステップ記録ツール (PSR)の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p><p><strong>ネットワーク環境においてプロキシをご利用いただいている場合</strong><br>Fiddler 自体が Proxy の役目となるため、ご利用環境からインターネットへの通信において Proxy サーバーがございましたら、利用する貴社の Proxy を通るようにご設定ください。</p><p>※外部サイトではございますが、手順についてまとめられたサイトがありますので、ご参考ください。<br>参考情報：<a href="http://did2.blog64.fc2.com/blog-entry-8.html">プロキシ環境でのfiddler</a></p><h2 id="5．プロセス-モニターとPower-BI-DesktopトレースとXbox-Game-Barによる録画の採取手順"><a href="#5．プロセス-モニターとPower-BI-DesktopトレースとXbox-Game-Barによる録画の採取手順" class="headerlink" title="5．プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順"></a>5．プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順</h2><p>・プロセス モニター ：リアルタイムのファイル システム、レジストリ、プロセス/スレッド アクティビティを示す Windows 用の高度な監視ツール<br>・Desktop トレース    ：Power BI Desktopの処理を記録するためのトレース<br>・Xbox Game Barによる録画    ：操作ごとに録画するツール</p><p><strong>1．プロセス モニターのインストール</strong></p><ol><li>以下のWebサイトより、インストーラーをダウンロードします。<br><a href="https://learn.microsoft.com/ja-jp/sysinternals/downloads/procmon">プロセス モニター - Sysinternals | Microsoft Learn</a></li></ol></br><div align="center"><img src="pic15.png"></div><ol start="2"><li>採取対象の環境で、Procmon.exe を 管理者権限で起動します。<br>※プロセス モニターを実施時に、可能な限り不要なアプリケーションを閉じ、事象再現のみのトレースが取れるように設定ください。</li></ol><p>“Process Monitor License Agreement” が表示された場合は、内容をご確認の上 [Agree] を選択します。<br></br></p><div align="center"><img src="pic16.png"></div><ol start="3"><li><p>フィルタ指定メニューが自動表示された場合は [Cancel] を選択します。<br>※ [Cancel] を選択後、情報採取が開始されます。</p></li><li><p>開始された情報採取を一旦停止するため、[File] - [Capture Events] を選択し、チェックを外します。<br>　[Edit] – [Clear Display]を選択します。<br>※ ツールバーに存在する “虫眼鏡” のアイコンをクリックすることにより、同様に情報採取を停止することが可能となります。</p></br></li></ol><div align="center"><img src="pic17.png"></div><p><strong>2．Power BI Desktopトレースの採取手順</strong><br>開いている Power BI Desktop をすべて閉じます。<br>以下の Traces フォルダーおよびその配下のフォルダーにあるログファイルをすべて削除します。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>「環境変数」の「ユーザー変数」に 変数名：PBI_forceTracing、変数値： 1 を設定します。</p></br><div align="center"><img src="pic9.png"></div><p><strong>3．Xbox Game Barによる録画開始</strong></p><ol><li>XBOX Game Barが起動します。<br>Windowsのスタートボタンから、[Xbox]と入力するとアプリが表示されますので、こちらを選択して起動できます。</li></ol></br><div align="center"><img src="pic18.png"></div><ol start="2"><li>左上にあるキャプチャウィンドウから、マイクをオフにし、●ボタンをクリックすると、録画が開始されます。</li></ol></br><div align="center"><img src="pic19.png"></div><p><strong>4．プロセス モニターの開始</strong><br>情報採取準備が完了した後、以下の手順でプロセス モニターによるトレース採取を開始します。<br>[File] - [Capture Events] を選択し、チェックを付けます。</p><p><strong>5．事象再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>6．Power BI Desktop トレース停止</strong><br>Power BI Desktop を閉じます。<br>現象再現後、トーレスに関しましては、以下の Power BI Desktop フォルダーに生成されます。<br>該当の Traces フォルダーを以下の弊社アップロードサイトへご送付ください。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces<br>&lt;トレース無効化手順&gt;<br>「環境変数」の「ユーザー変数」に 設定した PBI_forceTracing  1 を削除します。</p><p><strong>7．プロセス モニターの停止</strong></p><ol><li><p>[File] - [Capture Events] を選択し、チェックを外します。</p></li><li><p>メニューの [File] から [Save] メニューを選択し、プロセス モニタートレース情報を任意のパスに保存します。<br>※ オプションは既定のままで問題ございません。</p></li></ol></br><div align="center"><img src="pic20.png"></div><p><strong>8．録画停止</strong></p><ol><li>画面右上に表示されているウィンドウの■ボタンをクリックし、停止します。</br></li></ol><div align="center"><img src="pic21.png"></div><ol start="2"><li>キャプチャのギャラリーにてファイルの場所を開きます。</br></li></ol><div align="center"><img src="pic22.png"></div><p>こちらの画面が出ない場合は、Xbox Game Barの[キャプチャを表示する]をクリックすると、ギャラリーが表示されます。<br></br></p><div align="center"><img src="pic23.png"></div><ol start="3"><li>保存先の動画を確認します。<br>デフォルト設定での保存先は、C:\Users[アカウント名]\Videos\Captures<br>や、エクスプローラ画面における[ビデオ]フォルダ内の[キャプチャ]フォルダとなっております。</li></ol></br><div align="center"><img src="pic24.png"></div><p>プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。<br></br><br>以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのファムです。&lt;br&gt;Power BI を利用される際に、エラーが発生するなど想定したとおりに動作しない場合、事象が起こる原因を特定するための調査が必要になる場合があります。&lt;br&gt;以前&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace/&quot;&gt;「トラブル発生時の事象調査に必要な情報の採取手順について(通信編)」&lt;/a&gt;について記載しましたが、現象によって必要な情報は異なりますので、以下は複数のパターンを想定して問題が発生する場合の情報採取手順についてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Troubleshooting" scheme="https://jpbap-sqlbi.github.io/blog/tags/Troubleshooting/"/>
    
    <category term="Fiddler" scheme="https://jpbap-sqlbi.github.io/blog/tags/Fiddler/"/>
    
    <category term="PSR" scheme="https://jpbap-sqlbi.github.io/blog/tags/PSR/"/>
    
    <category term="Power BI Desktop trace" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop-trace/"/>
    
    <category term="browser trace" scheme="https://jpbap-sqlbi.github.io/blog/tags/browser-trace/"/>
    
    <category term="Process Monitor" scheme="https://jpbap-sqlbi.github.io/blog/tags/Process-Monitor/"/>
    
    <category term="Xbox Game Bar" scheme="https://jpbap-sqlbi.github.io/blog/tags/Xbox-Game-Bar/"/>
    
  </entry>
  
  <entry>
    <title>Power BIにおけるデータソースのパラメーター化</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_datasoource_parameter/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_datasoource_parameter/</id>
    <published>2023-07-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.439Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。<br>Power BI では、Power Queryのパラメーターを活用して、データセットのデータソースを動的に変更する方法があることをご存知ですか。パラメーターを使ってデータソースに接続し、パラメーターを編集することで、データソースを必要に応じて簡単に変更できます。これにより、異なる要件に対応する柔軟性を持ったレポートを作成し、レポートの再利用性と拡張性を向上させられます。<br>今回の記事では、SQL Serverを例に、データソースのパラメーター化の設定方法をご紹介いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%8C%96%E3%81%AE%E5%BF%9C%E7%94%A8%E4%BE%8B">データソースのパラメーター化の応用例</a></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%8C%96%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86">データソースのパラメーター化設定手順</a></li><li><a href="#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AE%E5%A4%89%E6%9B%B4%E6%96%B9%E6%B3%95">パラメーターの変更方法</a></li><li><a href="#Excel%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88">Excelデータソースの場合</a></li><li><a href="#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%82%92%E9%81%A9%E7%94%A8%E3%81%97%E3%81%9F%E5%A0%B4%E5%90%88%E3%81%AE%E5%8B%95%E4%BD%9C">パラメーターを適用した場合の動作</a></br></li></ol><hr><h2 id="データソースのパラメーター化の応用例"><a href="#データソースのパラメーター化の応用例" class="headerlink" title="データソースのパラメーター化の応用例"></a>データソースのパラメーター化の応用例</h2><hr><p>・開発／テスト／本番など異なるデータソース環境の間で簡単に切り替えたい場合<br>・部門や地域ごとに異なるデータソースを使用している場合<br>・Power BI Serviceに発行されたデータセットのデータソースを切り替えたい場合<br><br></p><hr><h2 id="データソースのパラメーター化設定手順"><a href="#データソースのパラメーター化設定手順" class="headerlink" title="データソースのパラメーター化設定手順"></a>データソースのパラメーター化設定手順</h2><hr><p>※今回検証を行った環境では、１つのサーバーに「Northwind」と「test」という２つのデータベースを用意しています。</p><div align="left"><img src="1.png"></div><p>１．データソースのパラメーターを設定する前に、まずはPower Queryエディターの[表示]タブで、パラメーターの[常に許可]にチェックを入れます。</p><div align="left"><img src="2.png"></div><p>設定後は以下のように、データソースに接続する際に、固定の接続先だけでなく、サーバー名やデータベース名のパラメーターで作成し、設定可能になります。</p><div align="left"><img src="3.png"></div><p>２．SQL Serverの接続画面から[新しいパラメーター]を選択し、サーバー名やデータベース名のパラメーターを設定します。</p><div align="left"><img src="4.png"></div>※パラメーターの[種類]が[すべて]に設定されている場合、Power BI サービスでパラメーターを編集できない可能性がございますため、[テキスト]もしくは[10進数]に設定していただく必要がございます。<div class="alert is-success"><p class="alert-title">ヒント</p><p>参考事例：<a href="https://community.fabric.microsoft.com/t5/Service/Parameter-is-disabled-for-editing-in-power-bi-service/m-p/398733">Parameter is disabled for editing in power bi service - Microsoft Fabric Community</a></p></div><p>３．設定されたパラメーターを使って、SQL Serverデータベースに接続します。</p><div align="left"><img src="5.png"></div><p>以上で、データソースのパラメーター化設定が完了です！</p><br><hr><h2 id="パラメーターの変更方法"><a href="#パラメーターの変更方法" class="headerlink" title="パラメーターの変更方法"></a>パラメーターの変更方法</h2><hr><h3 id="Power-BI-Desktopの場合"><a href="#Power-BI-Desktopの場合" class="headerlink" title="Power BI Desktopの場合"></a>Power BI Desktopの場合</h3><p>１．[ホーム]タブの[データの変換]より、[パラメーターの編集]を選択します。</p><div align="left"><img src="6.png"></div><p>２．ポップアップ画面から、データソースのパラメーターを変更できます。<br>※以下例では、データベース名のパラメーターを「Northwind」を「test」に変更しました。</p><div align="left"><img src="7.png"></div><br><h3 id="Power-BI-サービスの場合"><a href="#Power-BI-サービスの場合" class="headerlink" title="Power BI サービスの場合"></a>Power BI サービスの場合</h3><p>１．ワークスペースから、データセットの[・・・]＞[設定]を選択します。</p><div align="left"><img src="8.png"></div><p>２．設定画面の[パラメーター]から、データソースのパラメーターを変更できます。</p><div align="left"><img src="9.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-parameters">Power BI サービスのパラメーター設定を編集する - Power BI | Microsoft Learn</a></p><p></p><p></p><p></p><p></p></div><hr><h2 id="Excelデータソースの場合"><a href="#Excelデータソースの場合" class="headerlink" title="Excelデータソースの場合"></a>Excelデータソースの場合</h2><hr><p>本記事の前半では、接続時にデータソースのパラメーター化する方法をご紹介しましたが、実は、データソースのパラメーターは必ずしも接続時に設定する必要がなく、接続後にも[詳細エディター]より設定可能です。<br>例えば、Excelファイルの場合、接続時に特定の Excel ファイルをデータソースとして指定する必要がありますため、SQL Serverのように、接続画面からデータソースのパラメーターを設定できません。<br>その場合、Excelファイルへ接続後にパラメーターを設定することができますので、以下の例にて説明します。</p><p>１．[UFO_US.xlsx]というExcelファイルに接続しますと、[詳細エディター]では以下のように表示されます。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let</span><br><span class="line">    ソース <span class="built_in">=</span> Excel.Workbook(File.Contents(<span class="string">&quot;C:\Users\lyuyue\Documents\UFO_US.xlsx&quot;</span>), null, <span class="built_in">true</span>),</span><br><span class="line">    UFO_US_Sheet <span class="built_in">=</span> ソース&#123;[Item<span class="built_in">=</span><span class="string">&quot;UFO&quot;</span>,Kind<span class="built_in">=</span><span class="string">&quot;Sheet&quot;</span>]&#125;[Data],</span><br><span class="line">    昇格されたヘッダー数 <span class="built_in">=</span> Table.PromoteHeaders(UFO_US_Sheet, [PromoteAllScalars<span class="built_in">=</span><span class="built_in">true</span>]),</span><br><span class="line">    変更された型 <span class="built_in">=</span> Table.TransformColumnTypes(昇格されたヘッダー数,&#123;&#123;<span class="string">&quot;datetime&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;city&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;state&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;country&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;shape&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;duration (seconds)&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;duration (hours/min)&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;comments&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;date posted&quot;</span>, <span class="keyword">type</span> date&#125;, &#123;<span class="string">&quot;latitude&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;longitude &quot;</span>, <span class="keyword">type</span> number&#125;&#125;)</span><br><span class="line">in</span><br><span class="line">    変更された型</span><br></pre></td></tr></table></figure><p>２．Power Query エディターの[ホーム]＞[パラメーターの管理]＞[新しいパラメーター]を選択します。</p><div align="left"><img src="10.png"></div><p>３．Excelファイルのファイルパス変更用のパラメーターを作成します。</p><div align="left"><img src="11.png"></div><p>４．[詳細エディター]を開き、２行目のありましたファイルパスの部分をパラメーター名に差し替えます。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let</span><br><span class="line">    ソース <span class="built_in">=</span> Excel.Workbook(File.Contents(ファイルパス), null, <span class="built_in">true</span>),</span><br><span class="line">    UFO_US_Sheet <span class="built_in">=</span> ソース&#123;[Item<span class="built_in">=</span><span class="string">&quot;UFO&quot;</span>,Kind<span class="built_in">=</span><span class="string">&quot;Sheet&quot;</span>]&#125;[Data],</span><br><span class="line">    昇格されたヘッダー数 <span class="built_in">=</span> Table.PromoteHeaders(UFO_US_Sheet, [PromoteAllScalars<span class="built_in">=</span><span class="built_in">true</span>]),</span><br><span class="line">    変更された型 <span class="built_in">=</span> Table.TransformColumnTypes(昇格されたヘッダー数,&#123;&#123;<span class="string">&quot;datetime&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;city&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;state&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;country&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;shape&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;duration (seconds)&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;duration (hours/min)&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;comments&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;date posted&quot;</span>, <span class="keyword">type</span> date&#125;, &#123;<span class="string">&quot;latitude&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;longitude &quot;</span>, <span class="keyword">type</span> number&#125;&#125;)</span><br><span class="line">in</span><br><span class="line">    変更された型</span><br></pre></td></tr></table></figure><p>５．パラメーターの設定後は以下のように、接続先のファイルパスを変更することが可能になります。</p><div align="left"><img src="12.png"></div><br><br><hr><h2 id="パラメーターを適用した場合の動作"><a href="#パラメーターを適用した場合の動作" class="headerlink" title="パラメーターを適用した場合の動作"></a>パラメーターを適用した場合の動作</h2><hr><p>最後にExcelのサンプルファイルでのパラメーターを変更し、適用した動作についてご紹介します。<br>以下の通り、[ファイルパス]のパラメーターを編集することで、データソースを「US」と「US以外」のファイル間で、必要に応じて切り替え可能です。<br>同様のスキーマのデータソースが複数存在し、切り替えが必要である場合はぜひこの方法をご活用ください。</p><div align="left"><img src="13.png"></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。<br><br></p><hr><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><hr><ul><li> <a href="https://support.microsoft.com/ja-jp/office/%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC-%E3%82%AF%E3%82%A8%E3%83%AA%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B-power-query-5eb365bc-3982-4ab2-8830-b205a69e0f33">公開情報：パラメーター クエリを作成する (Power Query)</a></li><li> <a href="https://www.phdata.io/blog/how-to-parameterize-data-sources-power-bi/">外部情報：How to Parameterize Data Sources in Power BI | phData</a></li><li> <a href="https://data-marc.com/2018/11/15/parameterize-your-data-source/">外部情報：Parameterize your data source! – Data – Marc</a></li><li> <a href="https://www.youtube.com/watch?v=OnaDJkGOmIE">ビデオ：Making data source parameters easy in Power BI Desktop - Guy in a Cube</a></li></ul><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;br&gt;Power BI では、Power Queryのパラメーターを活用して、データセットのデータソースを動的に変更する方法があることをご存知ですか。パラメーターを使ってデータソースに接続し、パラメーターを編集することで、データソースを必要に応じて簡単に変更できます。これにより、異なる要件に対応する柔軟性を持ったレポートを作成し、レポートの再利用性と拡張性を向上させられます。&lt;br&gt;今回の記事では、SQL Serverを例に、データソースのパラメーター化の設定方法をご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="パラメーター" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC/"/>
    
    <category term="Power Query" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-Query/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Report Server のサポートについて</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbirs_support_boundary/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbirs_support_boundary/</id>
    <published>2023-07-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:19.079Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>日頃から、マイクロソフトのサポート サービスをご利用いただき誠にありがとうございます。<br>以前、<a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて</a> の記事で、私たち Power BI サポート チームで提供しているサービスの詳細についてご紹介いたしました。<br>今回は、Power BI Report Server に関するサポートについてご紹介いたします。</p><br /><h5 id="※-Power-BI-Report-Server-とは"><a href="#※-Power-BI-Report-Server-とは" class="headerlink" title="※ Power BI Report Server とは"></a><strong>※ Power BI Report Server とは</strong></h5><p>お客様が管理されているオンプレミスのサーバー上に Power BI のレポートを配信・共有できる Web サービスの仕組みを構築できる製品です。<br>詳細は<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_pbirs/">Power BI Report Server とは</a> の記事におまとめしておりますので、ご参考にしていただければと思います。</p><span id="more"></span><br /><h4 id="Power-BI-Report-Serverのサポート-プラン"><a href="#Power-BI-Report-Serverのサポート-プラン" class="headerlink" title="Power BI Report Serverのサポート プラン"></a><font color="RoyalBlue">Power BI Report Serverのサポート プラン</font></h4><p>サポート チームに Power BI Report Server および Power BI Report Server 用 Power BI Desktop のお問合せをいただく場合、プロフェッショナル サポートやユニファイド サポート (旧プレミアサポート) といった有償サポート契約が必要となります。<br>プロフェッショナル契約の場合は対処策のご案内まで、ユニファイド サポートの場合は対処策のご案内に加え、原因追及の調査が可能となります。</p><p>基本的なサポート範囲については、<a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて</a> の記事<br>と同様になりますので、ご一読くださいますようお願いいたします。</p><br /><h4 id="Power-BI-Report-Serverのサポート-タイムライン"><a href="#Power-BI-Report-Serverのサポート-タイムライン" class="headerlink" title="Power BI Report Serverのサポート タイムライン"></a><font color="RoyalBlue">Power BI Report Serverのサポート タイムライン</font></h4><p>Power BI Report Server は、基本的には毎年 1 月、 5 月、 9 月の年 3 回リリースされており、リリース後のサポート期間は 1 年となります。<br>詳細は、以下公開情報におまとめしておりますので、お問合せ前にご使用中の Power BI Report Server がサポート対象のバージョンであることをご確認くださいますようお願いいたします。</p><p>ご参考：<a href="https://learn.microsoft.com/ja-jp/power-bi/report-server/support-timeline">Power BI レポート サーバーのサポート タイムライン</a></p><br /><h4 id="その他ご参考：アップデート情報"><a href="#その他ご参考：アップデート情報" class="headerlink" title="その他ご参考：アップデート情報"></a><font color="RoyalBlue">その他ご参考：アップデート情報</font></h4><p><a href="https://learn.microsoft.com/ja-jp/power-bi/report-server/changelog">Power BI Report Server の変更ログ</a></p><p>リリースされた各ビルドの新しい項目とバグの修正をご案内しております。</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/report-server/whats-new">Power BI レポート サーバーの新機能</a></p><p>変更ログの公開情報と一部情報が重複する部分もありますが、Power BI Report Server と Power BI Report Server 向け Power BI Desktop の最新バージョンの新機能について説明しております。</p><p><a href="https://powerbi.microsoft.com/ja-jp/blog/power-bi-report-server-may-2023-feature-summary/">Power BI Report Server May 2023 Feature Summary</a></p><p>Power BI Report Server 用 Power BI Desktop の新機能詳細についてはこちらの公式ブログもご参考にしていただければと思います。<br>[Power BI Report Server Month yyyy Feature Summary] という命名規則のタイトルにて、その月の更新について機能ごとに詳細を案内しています。</p><p>※上記リンクは本ブログが公開された 2023 年 7 月時点での最新情報のリンク (Power BI Report Server May 2023 Feature Summary) となります。</p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;日頃から、マイクロソフトのサポート サービスをご利用いただき誠にありがとうございます。&lt;br&gt;以前、&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/&quot;&gt;Power BI のお問い合わせについて&lt;/a&gt; の記事で、私たち Power BI サポート チームで提供しているサービスの詳細についてご紹介いたしました。&lt;br&gt;今回は、Power BI Report Server に関するサポートについてご紹介いたします。&lt;/p&gt;
&lt;br /&gt;

&lt;h5 id=&quot;※-Power-BI-Report-Server-とは&quot;&gt;&lt;a href=&quot;#※-Power-BI-Report-Server-とは&quot; class=&quot;headerlink&quot; title=&quot;※ Power BI Report Server とは&quot;&gt;&lt;/a&gt;&lt;strong&gt;※ Power BI Report Server とは&lt;/strong&gt;&lt;/h5&gt;&lt;p&gt;お客様が管理されているオンプレミスのサーバー上に Power BI のレポートを配信・共有できる Web サービスの仕組みを構築できる製品です。&lt;br&gt;詳細は&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_pbirs/&quot;&gt;Power BI Report Server とは&lt;/a&gt; の記事におまとめしておりますので、ご参考にしていただければと思います。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI Report Server" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Report-Server/"/>
    
    <category term="お問い合わせ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B/"/>
    
    <category term="サポート範囲" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E7%AF%84%E5%9B%B2/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Service でサービス プリンシパルを利用する</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/ServicePrincipal/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/ServicePrincipal/</id>
    <published>2023-07-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.087Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。</p><p>Azure Active Directoryでは、皆さまが普段利用されているユーザー アカウント (例: <a href="mailto:&#x65;&#120;&#x61;&#109;&#112;&#x6c;&#x65;&#x40;&#99;&#111;&#110;&#x74;&#x6f;&#x73;&#x6f;&#x2e;&#99;&#111;&#x6d;">&#x65;&#120;&#x61;&#109;&#112;&#x6c;&#x65;&#x40;&#99;&#111;&#110;&#x74;&#x6f;&#x73;&#x6f;&#x2e;&#99;&#111;&#x6d;</a>) のほかに、サービス プリンシパルを利用することでもリソースにアクセスすることが可能です。Power BI では、レポートを他サービス/アプリケーションに埋め込む (Power BI Embedded) 場合や、REST API を実行する場合に利用されます。</p><p>本記事では、サービス プリンシパルについて説明し、例として PowerShell から REST API <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events">Get Activity Events</a> を実行する方法や、Power Automate からこの REST API を実行する方法についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E3%81%A8%E3%81%AF">サービス プリンシパルとは</a></li><li><a href="#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90">サービス プリンシパルの作成</a><ul><li><a href="#%E6%89%8B%E9%A0%861-%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%99%BB%E9%8C%B2">手順1 アプリの登録</a></li><li><a href="#%E6%89%8B%E9%A0%862-%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%BE%E3%81%9F%E3%81%AF%E3%82%B7%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90">手順2 証明書またはシークレットの作成</a><ul><li><a href="#%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E7%99%BB%E9%8C%B2%E3%82%92%E8%A1%8C%E3%81%86%E5%A0%B4%E5%90%88">証明書の登録を行う場合</a></li><li><a href="#%E3%82%B7%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88">シークレットを作成する場合</a></li></ul></li><li><a href="#%E6%89%8B%E9%A0%863-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E8%A8%B1%E5%8F%AF%E3%80%81%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E3%81%AE%E8%A8%AD%E5%AE%9A">手順3 アクセス許可、スコープの設定</a><ul><li><a href="#%E5%BF%85%E8%A6%81%E3%81%AA%E6%A8%A9%E9%99%90%E3%81%AE%E7%A2%BA%E8%AA%8D">必要な権限の確認</a></li><li><a href="#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E8%A8%B1%E5%8F%AF%E3%81%AE%E8%A8%AD%E5%AE%9A">アクセス許可の設定</a>    </li><li><a href="#%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E3%81%AE%E8%A8%AD%E5%AE%9A">スコープの設定</a></li></ul></li></ul></li><li><a href="#Power-BI-%E3%81%AE%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A">Power BI のテナント設定</a></li><li><a href="#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B">実際に動かしてみる</a><ul><li><a href="#%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">事前準備</a></li><li><a href="#PowerShell-%E3%81%8B%E3%82%89-API-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B">PowerShell から API を実行する</a></li><li><a href="#Power-Automate-%E3%81%8B%E3%82%89-API-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B">Power Automate から API を実行する</a></li></ul></li></ul><h2 id="サービス-プリンシパルとは"><a href="#サービス-プリンシパルとは" class="headerlink" title="サービス プリンシパルとは"></a>サービス プリンシパルとは</h2><p>サービス プリンシパルは、テナントまたはディレクトリ内のアプリケーション インスタンスで、アプリがアクセスできるAzure AD テナント内のリソースやアプリにアクセスできるユーザー、アプリが実際に行えることの定義を持ちます。</p><blockquote><p>サービス プリンシパルは、アプリケーションが使用される各テナントで作成され、グローバルに一意なアプリ オブジェクトが参照されます。 サービス プリンシパル オブジェクトには、特定のテナント内でアプリが実際に実行できること、アプリにアクセスできるユーザー、アプリからアクセスできるリソースを定義します。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/app-objects-and-service-principals?tabs=browser#service-principal-object">サービス プリンシパル オブジェクト</a></p></blockquote><p>普段皆さまが利用しているユーザー アカウント (例: <a href="mailto:&#101;&#120;&#97;&#109;&#112;&#x6c;&#101;&#x40;&#99;&#111;&#110;&#x74;&#x6f;&#115;&#x6f;&#46;&#99;&#111;&#x6d;">&#101;&#120;&#97;&#109;&#112;&#x6c;&#101;&#x40;&#99;&#111;&#110;&#x74;&#x6f;&#115;&#x6f;&#46;&#99;&#111;&#x6d;</a>) は、人間が利用することを想定したアカウントとなります。そのため、スケジュールで実行することが想定されるようなスクリプトの場合には、ユーザー アカウントを利用することは推奨されず、サービス プリンシパルを利用することが推奨されます。</p><p>例えば、以下のような要件では、ユーザー アカウントではなくサービス プリンシパルを利用することで業務負荷を低減することが可能な場合があります。サービス プリンシパルでは、証明書またはシークレットを利用した認証を行いますが、例えば、シークレット キーの有効期限は最長2年となっているため、パスワードの有効期限ポリシーよりも有効期限が長い場合には、更新作業の頻度を抑えることが可能です。</p><ul><li>業務での利用のため、スクリプトによってREST APIを実行し、アクティビティ ログを取得している。</li><li>資格情報にユーザー アカウントを利用している。</li><li>ポリシー上、定期的なパスワードの更新が必須となっており、パスワード更新後には資格情報の更新作業が発生する。</li></ul><h2 id="サービス-プリンシパルの作成"><a href="#サービス-プリンシパルの作成" class="headerlink" title="サービス プリンシパルの作成"></a>サービス プリンシパルの作成</h2><p>サービス プリンシパルはAzure Portal、PowerShell、Azure CLI、Microsoft Graph APIでの作成が可能です。また、Power BI Embdded用にサービス プリンシパルを作成する場合には、 <a href="https://app.powerbi.com/embedsetup">Power BI 埋め込み分析セットアップ ツール</a> での作成も可能です。本記事では、Azure Portalでの作成方法についてご案内いたします。その他の方法につきましては、以下の公開情報をご確認ください。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/howto-create-service-principal-portal">ポータルで Azure AD アプリとサービス プリンシパルを作成する - Microsoft Entra | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/howto-authenticate-service-principal-powershell">Azure アプリ ID を作成する (PowerShell) - Microsoft Entra | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/cli/azure/create-an-azure-service-principal-azure-cli">サービス プリンシパルの操作 - Azure CLI | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/graph/api/serviceprincipal-post-serviceprincipals?view=graph-rest-1.0&tabs=http">serviceprincipal を作成する - Microsoft Graph v1.0 | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/developer/embedded/register-app?tabs=customers#set-up-your-environment">Power BI Embedded を設定する - 環境の設定方法 | Microsoft Learn</a></p><h3 id="手順1-アプリの登録"><a href="#手順1-アプリの登録" class="headerlink" title="手順1 アプリの登録"></a>手順1 アプリの登録</h3><ol><li><p><a href="https://ms.portal.azure.com/#home">Azure Portal</a> にアクセスします。</p></li><li><p><strong>[Azure Active Directory]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal01.png"></div>  </li><li><p><strong>[アプリの登録]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal02.png"></div>  </li><li><p><strong>[新規登録]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal03.png"></div>  </li><li><p>名前を入力し、 <strong>[登録]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal04.png"></div>  </li></ol><p>アプリの作成は以上で完了です。</p><h3 id="手順2-証明書またはシークレットの作成"><a href="#手順2-証明書またはシークレットの作成" class="headerlink" title="手順2 証明書またはシークレットの作成"></a>手順2 証明書またはシークレットの作成</h3><p>次に、認証に利用する証明書の登録またはシークレットの作成を行います。</p><h4 id="証明書の登録を行う場合"><a href="#証明書の登録を行う場合" class="headerlink" title="証明書の登録を行う場合"></a>証明書の登録を行う場合</h4><ol><li><p><strong>[証明書とシークレット]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal05.png"></div>  </li><li><p><strong>[証明書]</strong> タブを開き、 <strong>[証明書のアップロード]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal06.png"></div>  </li><li><p>証明書をアップロードし、 <strong>[追加]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal07.png"></div>  </li><li><p>証明書がアップロードされたことを確認します。</p><div align="center"><img src="ServicePrincipal08.png"></div>  </li></ol><h4 id="シークレットを作成する場合"><a href="#シークレットを作成する場合" class="headerlink" title="シークレットを作成する場合"></a>シークレットを作成する場合</h4><ol><li><p><strong>[証明書とシークレット]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal05.png"></div>  </li><li><p><strong>[クライアント シークレット]</strong> タブを開き、 <strong>[新しいクライアント シークレット]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal09.png"></div>  </li><li><p>説明、有効期限を設定し、 <strong>[追加]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal10.png"></div>  </li><li><p>シークレットが作成されたことを確認します。このとき、 <strong>必ず “値” を控えておきます</strong>。一度ウインドウを閉じてしまうと、一部が非表示となり再度表示することやコピーすることができなくなります。</p><div align="center"><img src="ServicePrincipal11.png"></div>  </li></ol><h3 id="手順3-アクセス許可、スコープの設定"><a href="#手順3-アクセス許可、スコープの設定" class="headerlink" title="手順3 アクセス許可、スコープの設定"></a>手順3 アクセス許可、スコープの設定</h3><p>このあとは、実行したい内容に応じてアプリのアクセス許可やスコープを設定します。本手順では、後の REST API 実行のための権限設定を行います。</p><h4 id="必要な権限の確認"><a href="#必要な権限の確認" class="headerlink" title="必要な権限の確認"></a>必要な権限の確認</h4><p>実行したいAPIの公開情報を確認します。今回は <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events">Admin - Get Activity Events - REST API (Power BI Power BI REST APIs) | Microsoft Learn</a> を実行します。</p><blockquote><h2 id="アクセス許可"><a href="#アクセス許可" class="headerlink" title="アクセス許可"></a>アクセス許可</h2><ul><li>ユーザーは管理者権限 (Office 365グローバル管理者や Power BI サービス管理者など) を持っているか、サービス プリンシパルを使用して認証する必要があります。</li><li>委任されたアクセス許可がサポートされています。</li></ul><p><u>サービス の prinicipal 認証で実行する場合、アプリには、Azure portalで Power BI に対して管理者の同意が必要な使用許可が設定<strong>されていないことが必要</strong>です。</u></p><h2 id="必要なスコープ"><a href="#必要なスコープ" class="headerlink" title="必要なスコープ"></a>必要なスコープ</h2><p>Tenant.Read.All または Tenant.ReadWrite.All</p><p>標準の委任された管理者アクセス トークンを使用して認証する場合にのみ関連します。 <u>サービス プリンシパルによる認証を使用する場合は、存在しない必要があります。</u></p></blockquote><div align="center"><img src="ServicePrincipal12.png"></div>  <h4 id="アクセス許可の設定"><a href="#アクセス許可の設定" class="headerlink" title="アクセス許可の設定"></a>アクセス許可の設定</h4><ol><li><p><strong>[API のアクセス許可]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal13.png"></div>  </li><li><p>今回利用するAPIではアクセス許可は不要なので、 <strong>[･･･]</strong> &gt; <strong>[すべてのアクセス許可を削除]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal14.png"></div>  </li><li><p>確認が求められますが、 <strong>[はい、削除します]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal15.png"></div>  </li><li><p>アクセス許可が削除されたことを確認します。</p><div align="center"><img src="ServicePrincipal16.png"></div>  </li></ol><h4 id="スコープの設定"><a href="#スコープの設定" class="headerlink" title="スコープの設定"></a>スコープの設定</h4><ol><li><p><strong>[API の公開]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal17.png"></div>  </li><li><p>今回利用するAPIでは、スコープは存在しない必要があるため、未定義であることを確認します。</p><div align="center"><img src="ServicePrincipal18.png"></div>  </li></ol><h2 id="Power-BI-のテナント設定"><a href="#Power-BI-のテナント設定" class="headerlink" title="Power BI のテナント設定"></a>Power BI のテナント設定</h2><p>Power BI でサービス プリンシパルを利用して REST API を実行するためには、テナント設定 <strong>[Power BI APIの使用をサービス プリンシパルに許可]</strong> 、 <strong>[読み取り専用管理APIの使用をサービス プリンシパルに許可する]</strong> を有効化する必要がございます。</p><ul><li><p>Power BI APIの使用をサービス プリンシパルに許可</p> <div align="center"> <img src="ServicePrincipal19.png"> </div>  </li><li><p>読み取り専用管理APIの使用をサービス プリンシパルに許可する<br>こちらの設定は、セキュリティ グループ単位での有効化となります。そのため、Azure ADからセキュリティ グループを作成し、作成したサービス プリンシパルをグループに追加した上で、セキュリティ グループに対して設定を有効化します。</p><p>詳細な手順については以下の公開情報をご確認ください。<br>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/read-only-apis-service-principal-authentication">読み取り専用の管理 API に対してサービス プリンシパル認証を有効にする - Power BI | Microsoft Learn</a></p> <div align="center"> <img src="ServicePrincipal20.png"> </div>  </li></ul><h2 id="実際に動かしてみる"><a href="#実際に動かしてみる" class="headerlink" title="実際に動かしてみる"></a>実際に動かしてみる</h2><p>PowerShell および Power Automate から <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events">Get Activity Events</a> を実行してみましょう。今回は例としてシークレットを利用した認証を行います。</p><h3 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h3><p>APIの実行にはアプリケーション (クライアント) ID、ディレクトリ (テナントID)、シークレット キー (値) が必要になるので、事前に確認しておきます。</p><div align="center"><img src="ServicePrincipal21.png"></div>  <div align="center"><img src="ServicePrincipal22.png"></div>  <h3 id="PowerShell-から-API-を実行する"><a href="#PowerShell-から-API-を実行する" class="headerlink" title="PowerShell から API を実行する"></a>PowerShell から API を実行する</h3><p>PowerShell から API を実行してみましょう。サンプルコードは以下になります。アプリケーションID、シークレット キー、テナントIDはお手元の環境に合わせて入力します。</p><p>アクティビティ ログの取得は1日単位となるので、StartDateTime、EndDateTimeは同一日付とする必要があります。<br>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_activity_log_usage_metrics/">Power BI のユーザーアクティビティ追跡方法の比較 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><p>Visual Studio Code やメモ帳などお好みのエディタから以下のコードを入力し、.ps1 ファイルとして保存します。検証のためユーザー名とパスワードを平文で含めていますが、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> MicrosoftPowerBIMgmt </span><br><span class="line"></span><br><span class="line"><span class="variable">$clientId</span> = <span class="string">&quot;&lt;アプリケーションID&gt;&quot;</span></span><br><span class="line"><span class="variable">$secret</span> = <span class="string">&quot;&lt;シークレット キー&gt;&quot;</span></span><br><span class="line"><span class="variable">$clientSecret</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="literal">-String</span> <span class="variable">$secret</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$tenantId</span> = <span class="string">&quot;&lt;テナントID&gt;&quot;</span></span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$clientId</span>, <span class="variable">$clientSecret</span></span><br><span class="line"><span class="built_in">Connect-PowerBIServiceAccount</span> <span class="literal">-ServicePrincipal</span> <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-TenantId</span> <span class="variable">$tenantId</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$activities</span> = <span class="built_in">Get-PowerBIActivityEvent</span> <span class="literal">-StartDateTime</span> <span class="string">&#x27;2023-07-20T00:00:00&#x27;</span> <span class="literal">-EndDateTime</span> <span class="string">&#x27;2023-07-20T23:59:59&#x27;</span> | <span class="built_in">ConvertFrom-Json</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$outputFile</span> = <span class="string">&quot;C:\Temp\activities.csv&quot;</span></span><br><span class="line"><span class="variable">$activities</span> | <span class="built_in">Export-Csv</span> <span class="variable">$outputFile</span> <span class="literal">-NoTypeInformation</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Disconnect-PowerBIServiceAccount</span></span><br></pre></td></tr></table></figure><p>上記サンプルコードを実行すると、C:\Temp 以下に activities.csv が生成されます。</p><div align="center"><img src="ServicePrincipal23.png"></div>  <h3 id="Power-Automate-から-API-を実行する"><a href="#Power-Automate-から-API-を実行する" class="headerlink" title="Power Automate から API を実行する"></a>Power Automate から API を実行する</h3><p>Power Automate から REST API を実行することも可能です。実行にあたっては組み込みの HTTP コネクタ (プレミアム コネクタ) が必要となります。</p><p>以下の手順でフローを作成します。</p><ol><li><p><strong>[作成]</strong> &gt; <strong>[インスタント クラウド フロー]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal24.png"></div>  </li><li><p><strong>[フローを手動でトリガーする]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal25.png"></div>  </li><li><p>操作で組み込みの HTTP コネクタを選択します。</p><div align="center"><img src="ServicePrincipal26.png"></div>  </li><li><p>以下のとおり設定します。</p><ul><li><p>方法: GET</p></li><li><p>URI: <a href="https://api.powerbi.com/v1.0/myorg/admin/activityevents">https://api.powerbi.com/v1.0/myorg/admin/activityevents</a></p></li><li><p>クエリ: </p><ul><li>startDateTime: ‘2023-07-03T00:00:00.000Z’</li><li>endDateTime: ‘2023-07-03T23:59:00.000Z’</li></ul></li><li><p>認証: Active Directory OAuth</p></li><li><p>テナント: &lt;テナントID&gt;</p></li><li><p>対象ユーザー: <a href="https://analysis.windows.net/powerbi/api">https://analysis.windows.net/powerbi/api</a></p></li><li><p>クライアント ID: &lt;クライアントID&gt;</p></li><li><p>資格情報の種類: シークレット</p></li><li><p>シークレット: &lt;シークレット キー&gt;</p></li></ul><div align="center"><img src="ServicePrincipal27.png"></div>  </li><li><p>設定できたら、 <strong>[保存]</strong> を選択して保存し、テストを実行します。アクティビティ ログが取得できていることを確認します。</p><div align="center"><img src="ServicePrincipal28.png"></div>  <div align="center"><img src="ServicePrincipal29.png"></div>  </li></ol><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;/p&gt;
&lt;p&gt;Azure Active Directoryでは、皆さまが普段利用されているユーザー アカウント (例: &lt;a href=&quot;mailto:&amp;#x65;&amp;#120;&amp;#x61;&amp;#109;&amp;#112;&amp;#x6c;&amp;#x65;&amp;#x40;&amp;#99;&amp;#111;&amp;#110;&amp;#x74;&amp;#x6f;&amp;#x73;&amp;#x6f;&amp;#x2e;&amp;#99;&amp;#111;&amp;#x6d;&quot;&gt;&amp;#x65;&amp;#120;&amp;#x61;&amp;#109;&amp;#112;&amp;#x6c;&amp;#x65;&amp;#x40;&amp;#99;&amp;#111;&amp;#110;&amp;#x74;&amp;#x6f;&amp;#x73;&amp;#x6f;&amp;#x2e;&amp;#99;&amp;#111;&amp;#x6d;&lt;/a&gt;) のほかに、サービス プリンシパルを利用することでもリソースにアクセスすることが可能です。Power BI では、レポートを他サービス/アプリケーションに埋め込む (Power BI Embedded) 場合や、REST API を実行する場合に利用されます。&lt;/p&gt;
&lt;p&gt;本記事では、サービス プリンシパルについて説明し、例として PowerShell から REST API &lt;a href=&quot;https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events&quot;&gt;Get Activity Events&lt;/a&gt; を実行する方法や、Power Automate からこの REST API を実行する方法についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="サービス プリンシパル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB/"/>
    
    <category term="REST API" scheme="https://jpbap-sqlbi.github.io/blog/tags/REST-API/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Fabric パブリック プレビュー</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/microsoft_fabric/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/microsoft_fabric/</id>
    <published>2023-06-17T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.295Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>この度、Microsoft Fabric (以下 Fabric) がパブリック プレビューとして公開されました。<br>Fabric はデータサイエンスやリアルタイム分析、可視化などデータに関する操作が行えるオールインワンの分析ソリューションです。<br>本記事では、Fabricとはどのような製品なのかご説明します。また、Fabricは 2023 年 7 月 1 日より既定で有効化されますので、設定についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p>また、冒頭でもお伝えしました通り、Fabric は現在パブリックプレビュー中でございますので、ご案内した内容が今後変更される可能性が十分にございますことをご了承いただきますようお願いいたします。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#Microsoft-Fabric%E3%81%A8%E3%81%AF">Microsoft Fabricとは</a></li><li><a href="#Fabric-%E3%81%AE%E5%88%A9%E7%94%A8">Fabric の利用</a><ul><li><a href="#Fabric-%E8%A9%A6%E7%94%A8%E7%89%88%E3%81%AE%E9%96%8B%E5%A7%8B">Fabric 試用版の開始</a></li><li><a href="#Fabric-%E5%AE%B9%E9%87%8F%E3%81%AE%E4%BD%9C%E6%88%90">Fabric 容量の作成</a></li></ul></li><li><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9">ライセンス</a></li><li><a href="#Fabric-%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A">Fabric に関するテナント設定</a></li><li><a href="#Fabric-%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">Fabric に関するお問い合わせについて</a></li></ul><h2 id="Microsoft-Fabricとは"><a href="#Microsoft-Fabricとは" class="headerlink" title="Microsoft Fabricとは"></a>Microsoft Fabricとは</h2><p>Fabric は 端的に表現するとPower BI、Azure Synapse Analytics、Azure Data Factory を1つのSaaS環境で利用できるオールインワンの分析ソリューションです。この統合によって、データを一元管理でき、コラボレーションをより容易に行うことが可能となります。Fabric で利用できる機能は以下になります。</p><div align="center"><img src="Fabric01.png"></div>  <ul><li><p><strong>Data Engineering</strong><br>ユーザーが構造化データ/非構造化データを一元管理できるレイクハウスを作成することや、Python や R、Scala を利用した対話型のノートブックを作成したデータ分析、データを収集･処理･変換するデータ パイプラインを実行することが可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-engineering/data-engineering-overview">Microsoft Fabric のデータ エンジニアリングとは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-engineering/tutorial-lakehouse-introduction">Lakehouse のエンド ツー エンドのシナリオ: 概要とアーキテクチャ - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric02.png"></div>  </li><li><p><strong>Data Factory</strong><br>さまざまなデータ ソースからデータを取り込み、変換できるデータフローを作成できるほか、データ パイプラインを使用して、複数のタスクを実行できるワークフローを構築することができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-factory/data-factory-overview">Data Factory とは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-factory/tutorial-end-to-end-introduction">Data Factory のエンド ツー エンドのシナリオ - 概要とアーキテクチャ - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric03.png"></div></li><li><p><strong>Data Science</strong><br>データの取得、クレンジングから、モデルのトレーニングといった機械学習モデルの構築から、デプロイ、運用までを実行できます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-science/data-science-overview">Microsoft Fabric のデータ サイエンス - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-science/tutorial-data-science-introduction">データ サイエンスのチュートリアル - 作業の開始 - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric04.png"></div>  </li><li><p><strong>Data Warehouse</strong><br>さまざまなデータ ソースに接続し、ウェアハウスを構築することができます。ウェアハウスでは、接続されたデータを簡単に結合することができるため、より少ないリソースで分析が可能となります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-warehouse/data-warehousing">Microsoft Fabric のデータ ウェアハウスとは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-warehouse/tutorial-introduction">データ ウェアハウスのチュートリアル - 概要 - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric05.png"></div>  </li><li><p><strong>Real-Time Analytics</strong><br>Fabric の Real-Time Analytics は、ストリーミングと時系列データに最適化されており、構造化データだけでなく、半構造化データ、非構造化データに対して優れたパフォーマンスを備えています。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/real-time-analytics/overview">Microsoft Fabric のReal-Time Analytics の概要 - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric06.png"></div>  </li><li><p><strong>Power BI</strong><br>Power BI は、データに迅速かつ直感的にアクセスして、データを使用してより適切な意思決定を行うことができます。 </p></li></ul><p>これらのように、Fabric ではデータの取得から可視化まで、エンドツーエンドで扱うことができる SaaS プラットフォームとなります。<br>より詳細に Fabric について知りたい方は、以下の公開情報やトレーニングをご参照ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/get-started/microsoft-fabric-overview">Microsoft Fabric とは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/">Microsoft Fabric のドキュメント - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/get-started/end-to-end-tutorials">Microsoft Fabric のエンド ツー エンドのチュートリアル - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/training/paths/get-started-fabric/">Microsoft Fabric の概要 - Training | Microsoft Learn</a></p></div><h2 id="Fabric-の利用"><a href="#Fabric-の利用" class="headerlink" title="Fabric の利用"></a>Fabric の利用</h2><h3 id="Fabric-試用版の開始"><a href="#Fabric-試用版の開始" class="headerlink" title="Fabric 試用版の開始"></a>Fabric 試用版の開始</h3><p>Fabric は、現在 60 日間の試用が可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/get-started/fabric-trial">Fabric (プレビュー) 試用版 - Microsoft Fabric | Microsoft Learn</a></p></div><p>試用版の利用を開始するには、アカウント マネージャーを開き、 <strong>[無料体験する]</strong> を選択するか、</p><div align="center"><img src="Fabric07.png"></div> <div align="center"><img src="Fabric08.png"></div>  <p>ワークスペースを開き、 <strong>[+ 新規]</strong> &gt; <strong>[すべて表示]</strong> を選択し、</p><div align="center"><img src="Fabric09.png"></div>  <p>Fabric アイテムを選択すると、ワークスペースのアップグレードが求められるため、</p><div align="center"><img src="Fabric10.png"></div>  <p><strong>[アップグレード]</strong> を選択してワークスペースを試用版容量ワークスペースにアップグレードし、Fabric の試用を開始します。</p><div align="center"><img src="Fabric11.png"></div>  <p>Fabric 試用版をキャンセルするか、60 日の試用版の利用期限が終了したのち Fabric 容量へ移行しない場合には、試用版容量が削除されますのでご注意ください。</p><h3 id="Fabric-容量の作成"><a href="#Fabric-容量の作成" class="headerlink" title="Fabric 容量の作成"></a>Fabric 容量の作成</h3><p>Fabric を利用するには、Azure Portal 上から Fabric 容量を購入する必要があります。</p><p>Azure Portal にアクセスし、 <strong>[Microsoft Fabric (プレビュー)]</strong> を選択します。</p><div align="center"><img src="Fabric12.png"></div>  <p><strong>[ファブリック容量 の作成]</strong> を選択します。</p><div align="center"><img src="Fabric13.png"></div>  <p>サブスクリプション、リソースグループ、容量の名前、リージョン、サイズ、Fabric 容量管理者を設定し、 <strong>[確認と作成]</strong> を選択します。</p><div align="center"><img src="Fabric14.png"></div>  <h2 id="ライセンス"><a href="#ライセンス" class="headerlink" title="ライセンス"></a>ライセンス</h2><p>これまで、Power BI では Power BI Free、Power BI Pro、Power BI Premium Per User (PPU)、Power BI Premium Per Capacity (Premium容量)の4つのライセンスがあり、ワークスペースについては Pro、Premium Per User、Premium 容量、Embedded の4つのライセンス モードがありました。<br>Fabric によって、ワークスペースのライセンスモードには、Fabric 容量と、Fabric 試用版が追加されました。</p><div align="center"><img src="Fabric15.png"></div>  <p>Fabric のワークロードを利用する場合には、Fabric 容量を作成し、Fabric 容量を割り当てたワークスペースに Fabric アイテムを作成するほか、従来のPremium 容量にも Fabric アイテムを作成することが可能です。以下はライセンスとワークスペースのライセンスについて整理した表になります。</p><table><thead><tr><th></th><th>Pro</th><th>Premium Per User (PPU)</th><th>Premium容量</th><th>Embedded</th><th>Fabric</th></tr></thead><tbody><tr><td>SKU</td><td>なし</td><td>P3</td><td>P1 ~ P5</td><td>EM ~ EM3 / A1~ A8</td><td>F2 ~ F2048</td></tr><tr><td>ワークスペースにあるコンテンツを参照できるユーザー ライセンス</td><td>Pro、PPU</td><td>PPU</td><td>Free、Pro、PPU</td><td>埋め込みの方法によって (*1)</td><td>F64 未満の SKU の場合は Pro、F64 以上の場合は Free、Pro、PPU</td></tr><tr><td>Fabric アイテムの作成</td><td>不可</td><td>不可</td><td>可</td><td>不可</td><td>可</td></tr><tr><td>Embedded での利用</td><td>不可</td><td>不可</td><td>可</td><td>可</td><td>可</td></tr><tr><td>ライセンスの管理</td><td>Microsoft 365 管理センター</td><td>Microsoft 365 管理センター</td><td>Microsoft 365 管理センター</td><td>Azure Portal</td><td>Azure Portal</td></tr></tbody></table><p>*1 埋め込みの方法によって異なります。詳しくは以下の記事をご参照ください。<br>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_embedded_license/">Power BI Embedded とは？ライセンスと埋め込み方法 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><p>ライセンスについては以下の公開情報もご参照ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/licenses">Microsoft Fabric ライセンス - Microsoft Fabric | Microsoft Learn</a></p></div><p>また、従来のライセンスについては以下のブログをご確認ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded） | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><h2 id="Fabric-に関するテナント設定"><a href="#Fabric-に関するテナント設定" class="headerlink" title="Fabric に関するテナント設定"></a>Fabric に関するテナント設定</h2><p><strong>[管理ポータル]</strong> &gt; <strong>[テナント設定]</strong> &gt; <strong>[ユーザーは Fabric アイテムを作成できます (パブリック プレビュー)]</strong> を有効化することで、ユーザーが Fabric アイテムを作成することができるようになります。</p><div align="center"><img src="Fabric16.png"></div>  <p>テナント全体で有効にしたくない場合には、Premium 容量単位で有効にすることも可能です。 <strong>[管理ポータル]</strong> &gt; <strong>[容量の設定]</strong> から Premium 容量を選択し、 <strong>[委任されたテナントの設定]</strong> &gt; <strong>[ユーザーは Fabric アイテムを作成できます (パブリック プレビュー)]</strong> を有効化します。このとき、 <strong>[テナント設定]</strong> でこの設定を無効にしている場合には、 <strong>[テナント管理者の選択をオーバーライドする]</strong> にチェックが入っていることを確認します。</p><div align="center"><img src="Fabric17.png"></div>  <div class="alert is-important"><p class="alert-title">重要</p><p>なお、上記設定を無効にしない場合には、【2023 年 7 月 1 日】 にすべての Power BI ユーザーに対して Microsoft Fabric が有効になりますのでご注意ください。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/admin/fabric-switch">organizationに対して Microsoft Fabric を有効にする - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"> <img src="Fabric18.png"> </div>  <h2 id="Fabric-に関するお問い合わせについて"><a href="#Fabric-に関するお問い合わせについて" class="headerlink" title="Fabric に関するお問い合わせについて"></a>Fabric に関するお問い合わせについて</h2><p>Power BI サポートでは、Fabric に関するお問い合わせもご支援が可能でございますが、プレビュー機能でございますため、ご案内ができない内容を含むためご回答が難しい場合や、その後機能が変更される場合などがございます。予めご了承いただくとともに、スムーズな回答のため、お問い合わせの際には事前に以下の公開情報やブログ記事をご一読いただけますと幸いでございます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/support/service-support-options">Power BI Pro、Power BI Premium、Fabric のサポート オプション - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary2/">Power BI の開発支援・コンサルティングを含む内容に関するお問い合わせについて | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;この度、Microsoft Fabric (以下 Fabric) がパブリック プレビューとして公開されました。&lt;br&gt;Fabric はデータサイエンスやリアルタイム分析、可視化などデータに関する操作が行えるオールインワンの分析ソリューションです。&lt;br&gt;本記事では、Fabricとはどのような製品なのかご説明します。また、Fabricは 2023 年 7 月 1 日より既定で有効化されますので、設定についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Fabric" scheme="https://jpbap-sqlbi.github.io/blog/tags/Fabric/"/>
    
  </entry>
  
  <entry>
    <title>セルフサービス サインアップの無効化</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_self-service-signup/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_self-service-signup/</id>
    <published>2023-06-08T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.807Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。</p><p>Power BI にはいくつかのライセンスがあることを、こちらのブログ「 <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）</a> 」でご紹介させていただきました。</p><p>無償版の Power BI Free ライセンスについては、組織において無制限でライセンスを取得しご利用いただけますが、ライセンス管理者様が割り当てを行わずとも、ユーザー自身でライセンスの利用を開始すること (セルフサービス サインアップ) が可能です。</p><p>今回は、管理者が組織内のユーザーに対して、”ユーザー自身で Power BI Free ライセンスの利用を開始できるようにするかどうかを制御する方法” についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ul><li><a href="#%E7%9B%AE%E6%AC%A1">目次</a></li><li><a href="#%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4">更新履歴</a></li><li><a href="#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E8%87%AA%E8%BA%AB%E3%81%8C-power-bi-free-%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%AE%E5%88%A9%E7%94%A8%E9%96%8B%E5%A7%8B%E3%81%99%E3%82%8B%E3%81%93%E3%81%A8%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%97%E3%81%9F%E3%81%84%E3%81%AE%E3%81%AF%E3%81%A9%E3%82%93%E3%81%AA%E6%99%82">ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？</a></li><li><a href="#%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%A8%E3%81%AF">セルフサービス サインアップとは？</a></li><li><a href="#%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96%E6%89%8B%E9%A0%86">セルフサービス サインアップの無効化手順</a><ul><li><a href="#1-%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">1. 事前準備</a></li><li><a href="#2-microsoftgraph-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%AE%E5%AE%9F%E8%A1%8C">2. Microsoft.Graph モジュールの実行</a></li><li><a href="#3-%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%82%92%E6%9C%89%E5%8A%B9%E3%81%AB%E6%88%BB%E3%81%97%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D">3. セルフサービス サインアップを有効に戻したいとき</a></li></ul></li></ul><hr><h2 id="更新履歴"><a href="#更新履歴" class="headerlink" title="更新履歴"></a>更新履歴</h2><hr><p>2023/6/09 (記: 山本)<br>MSOnline モジュールが2023年6月30日に廃止予定であることに伴い、<a href="#%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96%E6%89%8B%E9%A0%86">セルフサービス サインアップの無効化手順</a> に使用するモジュールの変更およびスクリプトの修正を行ないました。MSOnline モジュールの廃止に関する詳細については Azure Identity サポートチームのブログをご参照ください。</p><blockquote><p><strong>参考情報</strong><br><a href="https://jpazureid.github.io/blog/azure-active-directory/how-to-determine-depreacated-azuread-msol/">Azure AD Graph / MSOnline PowerShell モジュール利用状況の調べ方</a></p></blockquote></br><hr><h2 id="ユーザー自身が-Power-BI-Free-ライセンスの利用開始することを制御したいのはどんな時？"><a href="#ユーザー自身が-Power-BI-Free-ライセンスの利用開始することを制御したいのはどんな時？" class="headerlink" title="ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？"></a>ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？</h2><hr><p>Power BI 管理者様や IT 管理者様、これから Power BI 導入のプロジェクトを進められるご担当者様などから、「ユーザーが勝手に Power BI Freeライセンスの利用を開始することを制御したい」とご要望をいただくことがたくさんあります。<br>組織によって背景は様々ですが、多くのお問合せは以下のような場合の時にいただきます。<br>このようなシナリオに該当する場合は、”セルフサービス サインアップ” 機能を無効にすることをご検討ください。</p><ul><li>ライセンス割り当ては管理者側で完全に制御したい</li><li>Power BI を組織内で徐々に展開していることを検討しているため、知らないうちにユーザーが勝手に利用することを防ぎたい</li><li>有償ライセンスのみを利用することを検討しているため、Power BI Free を利用させたくない</li></ul></br><hr><h2 id="セルフサービス-サインアップとは？"><a href="#セルフサービス-サインアップとは？" class="headerlink" title="セルフサービス サインアップとは？"></a>セルフサービス サインアップとは？</h2><hr><p>セルフサービス サインアップとは、管理者側が各ユーザーへのライセンス割り当てをしなくてもユーザー側のサインアップ作業によってライセンスの取得およびサービスの利用開始が可能となる機能です。</p><p>本機能を無効化することで、ユーザーが勝手に Power BI Free ライセンスを利用開始することを制御できます。</p></br><div class="alert is-warning"><p class="alert-title">警告</p><p>無効化の設定は他のセルフサービス プログラムと一括で管理されているため、例えば Power Apps のセルフサービス サインアップなども無効化されます。</p><p>サービスごとに制御する方法はご用意がないことを、ご注意くださいますようお願いいたします。</p></div></br><blockquote><p><strong>参考情報</strong><br>セルフ サービスサインアップが有効なプログラムの一覧はこちらでご案内しております。<br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/admin/misc/self-service-sign-up?view=o365-worldwide">セルフサービスでのサインアップと購入を有効または無効にする - Power BI | Microsoft Learn</a>   </p></blockquote><hr><h2 id="セルフサービス-サインアップの無効化手順"><a href="#セルフサービス-サインアップの無効化手順" class="headerlink" title="セルフサービス サインアップの無効化手順"></a>セルフサービス サインアップの無効化手順</h2><hr><p>セルフサービス サインアップ無効化の一連の設定手順を詳細におまとめいたしました。</p><div class="alert is-info"><p class="alert-title">Note</p><p>本操作はすべて PowerShell 上で実行することを想定しています。</p><p>また本操作は、テナント管理者を想定した操作手順となります。</p></div></br><h4 id="1-事前準備"><a href="#1-事前準備" class="headerlink" title="1. 事前準備"></a>1. 事前準備</h4><p>セルフサービス サインアップの無効化には、PowerShell の Microsoft.Graph モジュール (Microsoft Graph PowerShell SDK) を使用します。<br>次の4つの前提条件を満たしておく必要がありますので、各種準備をします。</p><ul><li>PowerShell 5.1 以降</li><li>.NET Framework 4.7.2以降</li><li>PowerShellGet 最新バージョン</li><li>PowerShellスクリプトの実行ポリシーは、リモート署名またはそれ以下に制限されていること</li></ul></br><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/installation?view=graph-powershell-1.0#prerequisites">Install the Microsoft Graph PowerShell SDK</a></p></blockquote></br><p><strong>1) PowerShell のバージョンを確認する</strong></p><p>管理者として Windows PowerShell を起動し、以下のコマンドを実行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$PSVersionTable</span></span><br></pre></td></tr></table></figure><p>次のように <code>PSVersion</code> の値が 5.1 以上であればサポートされます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Name                           Value</span><br><span class="line">----                           -----</span><br><span class="line">PSVersion                      <span class="number">5.1</span>.<span class="number">20348.1366</span></span><br><span class="line">PSEdition                      Desktop</span><br><span class="line">PSCompatibleVersions           &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>...&#125;</span><br><span class="line">BuildVersion                   <span class="number">10.0</span>.<span class="number">20348.1366</span></span><br><span class="line">CLRVersion                     <span class="number">4.0</span>.<span class="number">30319.42000</span></span><br><span class="line">WSManStackVersion              <span class="number">3.0</span></span><br><span class="line">PSRemotingProtocolVersion      <span class="number">2.3</span></span><br><span class="line">SerializationVersion           <span class="number">1.1</span>.<span class="number">0.1</span></span><br></pre></td></tr></table></figure><p>バージョンが満たない場合、ご利用の環境に合わせて、PowerShell のインストールやアップデートをお試しください。</p></br><p><strong>2) .NET Framework 4.7.2 以降のインストール状況を確認する</strong></p><p>.NET Framework のインストール状況の確認には、いくつかの方法がございますが、ここでは PowerShell を使用して .NET 4.7.2 以上のバージョンがインストールされているかどうか確認します。</p><p>次のコマンドを実行し、<code>True</code> が返ってきたら .NET Framework 4.7.2 に対応していることが確認できます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">Get-ItemPropertyValue</span> <span class="literal">-LiteralPath</span> <span class="string">&#x27;HKLM:SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full&#x27;</span> <span class="literal">-Name</span> Release) <span class="operator">-ge</span> <span class="number">461808</span></span><br></pre></td></tr></table></figure><p><code>False</code> の場合には <a href="https://learn.microsoft.com/ja-jp/dotnet/framework/install/">インストール ガイド</a> を参考に、アップデートをお試しください。</p><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/dotnet/framework/migration-guide/how-to-determine-which-versions-are-installed">方法: インストールされている .NET Framework バージョンを確認する</a></p></blockquote></br><p><strong>3) PowerShellGet を最新バージョンにする</strong></p><p>次のコマンドを実行し、<code>PowerShellGet</code> を最新バージョンにしておきます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> PowerShellGet <span class="literal">-Force</span></span><br></pre></td></tr></table></figure><p>次のプロンプトが表示される場合は <code>Y</code> を入力し、<code>Enter</code> キーで続行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">続行するには NuGet プロバイダーが必要です</span><br><span class="line">PowerShellGet で NuGet ベースのリポジトリを操作するには、<span class="string">&#x27;2.8.5.201&#x27;</span> 以降のバージョンの NuGetプロバイダーが必要です。</span><br><span class="line">NuGet プロバイダーは <span class="string">&#x27;C:\Program Files\PackageManagement\ProviderAssemblies&#x27;</span> または<span class="string">&#x27;C:\Users\XX\AppData\Local\PackageManagement\ProviderAssemblies&#x27;</span></span><br><span class="line">に配置する必要があります。<span class="string">&#x27;Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force&#x27;</span> を実行して NuGet プロバイダーをインストールすることもできます。今すぐ PowerShellGet で NuGet プロバイダーをインストールしてインポートしますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">N</span>] いいえ(N)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;Y&quot;</span>):</span><br></pre></td></tr></table></figure></br><p>次の警告が表示されアップデートが中断される場合、PowerShell の SecurityProtocol が TLS1.2 に設定されていない可能性があります。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">警告: Unable to resolve package source <span class="string">&#x27;https://www.powershellgallery.com/api/v2&#x27;</span>.</span><br><span class="line">PackageManagement\<span class="built_in">Install-Package</span> : 指定された検索条件とパッケージ名 <span class="string">&#x27;PowerShellGet&#x27;</span> と一致するものが見つかりませんでした。登録されている使用可能なすべてのパッケージ ソースを確認するには、<span class="built_in">Get-PSRepository</span> を使用します。</span><br><span class="line">発生場所 C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\<span class="number">1.0</span>.<span class="number">0.1</span>\PSModule.psm1:<span class="number">1772</span> 文字:<span class="number">21</span></span><br><span class="line">+ ...          <span class="variable">$null</span> = PackageManagement\<span class="built_in">Install-Package</span> @PSBoundParameters</span><br><span class="line">+                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [<span class="built_in">Install-Package</span>], Exception</span><br><span class="line">    + FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage</span><br></pre></td></tr></table></figure><p>次のコマンドを実行し、<code>Tls12</code> が含まれていない場合、</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">Net.ServicePointManager</span>]::SecurityProtocol</span><br></pre></td></tr></table></figure><p>次のコマンドで <code>Tls12</code> を強制し、再度 <code>Install-Module PowerShellGet -Force</code> をお試しください。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">Net.SecurityProtocolType</span>]::Tls12</span><br></pre></td></tr></table></figure></br><p>また場合によっては、次の警告が表示され、<code>PowerShellGet</code> のインストールが中断されることがあります。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">信頼されていないリポジトリ</span><br><span class="line">信頼されていないリポジトリからモジュールをインストールしようとしています。このリポジトリを信頼する場合は、<span class="built_in">Set-PSRepository</span></span><br><span class="line">コマンドレットを実行して、リポジトリの InstallationPolicy の値を変更してください。<span class="string">&#x27;PSGallery&#x27;</span> からモジュールをインストールしますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">A</span>] すべて続行(A)  [<span class="type">N</span>] いいえ(N)  [<span class="type">L</span>] すべて無視(L)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;N&quot;</span>):</span><br></pre></td></tr></table></figure><p>この場合には、<code>Set-ExecutionPolicy</code> を <code>Unrestricted</code> に変更するコマンドを実行し、再度お試しください。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> <span class="literal">-ExecutionPolicy</span> Unrestricted <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure></br><p><strong>4) PowerShell スクリプトの実行ポリシーを変更する</strong></p><p>続けて次のコマンドを実行し、PowerShell スクリプトの実行ポリシーを変更します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> <span class="literal">-ExecutionPolicy</span> RemoteSigned <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure><p>コマンドを実行後、次のようなプロンプトが表示される場合、<code>A</code> を入力し、<code>Enter</code> キーで続行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">実行ポリシーの変更</span><br><span class="line">実行ポリシーは、信頼されていないスクリプトからの保護に役立ちます。実行ポリシーを変更すると、about_Execution_Policies</span><br><span class="line">のヘルプ トピック (http://go.microsoft.com/fwlink/?LinkID=<span class="number">135170</span>)</span><br><span class="line">で説明されているセキュリティ上の危険にさらされる可能性があります。実行ポリシーを変更しますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">A</span>] すべて続行(A)  [<span class="type">N</span>] いいえ(N)  [<span class="type">L</span>] すべて無視(L)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;N&quot;</span>):</span><br></pre></td></tr></table></figure><p>次のコマンドを実行し、実行ポリシーが <code>RemoteSigned</code> となっていることを確認します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ExecutionPolicy</span> <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure></br><p><strong>5) Microsoft.Graph をインストールする</strong></p><p>次のコマンドを実行し、Microsoft.Graph モジュールをインストールします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> Microsoft.Graph <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure><p><code>信頼されていないレポジトリ</code> と表示される場合がありますが、<code>A</code> を入力し、<code>Enter</code> キーで続行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">信頼されていないリポジトリ</span><br><span class="line">信頼されていないリポジトリからモジュールをインストールしようとしています。このリポジトリを信頼する場合は、<span class="built_in">Set-PSRepository</span></span><br><span class="line">コマンドレットを実行して、リポジトリの InstallationPolicy の値を変更してください。<span class="string">&#x27;PSGallery&#x27;</span> からモジュールをインストールしますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">A</span>] すべて続行(A)  [<span class="type">N</span>] いいえ(N)  [<span class="type">L</span>] すべて無視(L)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;N&quot;</span>):</span><br></pre></td></tr></table></figure><p>Microsoft.Graph のインストール後、次のコマンドでモジュールが確認できれば、インストールは成功です。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-InstalledModule</span> Microsoft.Graph</span><br></pre></td></tr></table></figure><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Version    Name                                Repository           Description</span><br><span class="line">-------    ----                                ----------           -----------</span><br><span class="line"><span class="number">1.27</span>.<span class="number">0</span>     Microsoft.Graph                     PSGallery            Microsoft Graph PowerShell module</span><br></pre></td></tr></table></figure></br><h4 id="2-Microsoft-Graph-モジュールの実行"><a href="#2-Microsoft-Graph-モジュールの実行" class="headerlink" title="2. Microsoft.Graph モジュールの実行"></a>2. Microsoft.Graph モジュールの実行</h4><p><strong>1) Microsoft Graph にサインインする</strong></p><p>次のコマンドを実行し、Microsoft.Graph にサインインします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-Scopes</span> <span class="string">&quot;Policy.ReadWrite.Authorization&quot;</span></span><br></pre></td></tr></table></figure><p>ブラウザに遷移し、Microsoft 365 へのサインイン画面が表示されますので、<br>テナント管理者のアカウントでサインインします。</p><p>初めて上記コマンドを実行する場合、スコープに従ってアクセス許可が要求されます。<br>[組織の代理として同意する] にチェックをつけ [承諾] をクリックします。</p><div align="center"><img src="3.png" width=50%></div></br><p>その後 <code>Welcome To Microsoft Graph!</code> と表示されると、認証成功となります。</p></br><p><strong>2) Azure Active Directory 内のドメイン取得</strong></p><p>アクセス先ドメインを確認します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-MgDomain</span></span><br></pre></td></tr></table></figure><p><strong>3) セルフサービス サインアップに関するテナント設定を確認する</strong></p><p>次のコマンドを実行し、セルフサービス サインアップに関するテナント設定の状態を確認します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-MgPolicyAuthorizationPolicy</span> | <span class="built_in">Format-List</span> *Email*</span><br></pre></td></tr></table></figure><p>AllowEmailVerifiedUsersToJoinOrganization が新規ユーザーに対するテナントの自動参加の可否を決める機能であり、AllowedToSignUpEmailBasedSubscriptions　既存ユーザーに対するライセンスの自動配布の可否を決める機能です。<br>この時点で両方の値が False の場合、次の項番4を実施する必要はありません。<br>既にセルフサービス サインアップの機能は無効になっています。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AllowEmailVerifiedUsersToJoinOrganization : True</span><br><span class="line">AllowedToSignUpEmailBasedSubscriptions    : True</span><br></pre></td></tr></table></figure></br><p><strong>4) セルフサービス サインアップを無効化する</strong></p><p>セルフサービス サインアップを無効化したい場合、次のコマンドを実行し、両機能を <code>false</code> にします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-MgPolicyAuthorizationPolicy</span> <span class="literal">-AllowEmailVerifiedUsersToJoinOrganization</span>:<span class="variable">$false</span> <span class="literal">-AllowedToSignUpEmailBasedSubscriptions</span>:<span class="variable">$false</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.graph.identity.signins/update-mgpolicyauthorizationpolicy?view=graph-powershell-1.0">Update-MgPolicyAuthorizationPolicy (Microsoft.Graph.Identity.SignIns) | Microsoft Learn</a></p></blockquote></br><p>上記設定後、Power BI のライセンスをもたないユーザーが Power BI にサインインしようとしても、以下画面の通りセルフサービス サインアップができなくなります。</p><div align="center"><img src="2.png"></div></br><p><strong>5) Microsoft Graph のサインイン セッションを切断</strong></p><p>最後に次のコマンドを実行し、Microsoft Graph へのセッションを切断します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Disconnect-MgGraph</span></span><br></pre></td></tr></table></figure></br><h4 id="3-セルフサービス-サインアップを有効に戻したいとき"><a href="#3-セルフサービス-サインアップを有効に戻したいとき" class="headerlink" title="3. セルフサービス サインアップを有効に戻したいとき"></a>3. セルフサービス サインアップを有効に戻したいとき</h4><p>セルフサービス サインアップを有効化したい場合、次のコマンドを実行し、両機能を <code>true</code> にします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-MgPolicyAuthorizationPolicy</span> <span class="literal">-AllowEmailVerifiedUsersToJoinOrganization</span>:<span class="variable">$true</span> <span class="literal">-AllowedToSignUpEmailBasedSubscriptions</span>:<span class="variable">$true</span></span><br></pre></td></tr></table></figure></br><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-disable-self-service#use-powershell-azure-ad-and-microsoft-365-to-enable-and-disable-self-service">組織でのセルフサービス サインアップの使用 - Microsoft 365 admin | Microsoft Learn</a></p></blockquote></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;/p&gt;
&lt;p&gt;Power BI にはいくつかのライセンスがあることを、こちらのブログ「 &lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/&quot;&gt;Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）&lt;/a&gt; 」でご紹介させていただきました。&lt;/p&gt;
&lt;p&gt;無償版の Power BI Free ライセンスについては、組織において無制限でライセンスを取得しご利用いただけますが、ライセンス管理者様が割り当てを行わずとも、ユーザー自身でライセンスの利用を開始すること (セルフサービス サインアップ) が可能です。&lt;/p&gt;
&lt;p&gt;今回は、管理者が組織内のユーザーに対して、”ユーザー自身で Power BI Free ライセンスの利用を開始できるようにするかどうかを制御する方法” についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="ライセンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9/"/>
    
    <category term="Power BI Free" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Free/"/>
    
    <category term="セルフサービス サインアップ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97/"/>
    
  </entry>
  
  <entry>
    <title>Power BI サービスでデータモデルを編集する</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_modify_model_in_service/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_modify_model_in_service/</id>
    <published>2023-05-31T06:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.551Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのチャンです。 </p><p>2023 年 4 月 下旬より、新機能リリースによって、Power BI サービスでもデータセット（データモデル）の編集が可能となりました！</p><p>これまでは、 Power BI サービス上で複数ユーザーで実施可能な共同作業はレポートの編集のみでしたが、本機能により、新しいメジャーや計算列の作成、リレーションシップの管理、行レベルセキュリティのロール作成などといったデータセットの編集作業が、毎回.PBIX ファイルをダウンロードせずとも、Power BI サービス上で、直接実施することができます。早速本機能について詳細をご紹介していきます。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></p><p></p><p></p><p>また、本機能は開発段階 (プレビュー) でございますため、今後予告なしに機能が削除されたり、</p><p>動作変更が発生する可能性がありますことをあらかじめご了承くださいますようお願い申し上げます。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E6%9C%AC%E6%A9%9F%E8%83%BD%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B%E8%A8%AD%E5%AE%9A">本機能を有効化する設定</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E3%83%BB%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88">使用方法・メリット</a></li><li><a href="#%E8%80%83%E6%85%AE%E4%BA%8B%E9%A0%85%E3%81%A8%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85">考慮事項と制限事項</a></li></ol><hr><h2 id="本機能を有効化する設定"><a href="#本機能を有効化する設定" class="headerlink" title="本機能を有効化する設定"></a>本機能を有効化する設定</h2><hr><h4 id="テナント設定"><a href="#テナント設定" class="headerlink" title="テナント設定"></a>テナント設定</h4><p> 既定値では有効となっていますが、 Power BI 管理者権限を持つアカウントにて、[管理ポータル] &gt; [テナント設定] にて以下の設定「ユーザーはPower BI サービスでデータ モデルを編集できます (プレビュー)」を有効化します。</p><div align="center"><img src="tenant_settings.png"></div><h4 id="ワークスペースの設定"><a href="#ワークスペースの設定" class="headerlink" title="ワークスペースの設定"></a>ワークスペースの設定</h4><p>本機能を使用したいワークスペースに対して、ワークスペースの管理者にて、[設定]を開き、[Power BI] [全般] &gt; データモデルの設定の中に、「ユーザーは Power BI サービスでデータ モデルを編集できます (プレビュー)」にチェックを入れてください。</p><div align="center"><img src="workspace_settings.png"></div><p>チェックを入れて、有効化されたら、発行済みのデータセットに対して、[…]でオプションを展開すると、「オープンデータモデル」という選択肢が有効になっていることがわかります。</p><div align="center"><img src="dataset_options.png"></div><p>[オープンデータモデル]をクリックすると、モデルの編集画面へアクセスできます。</p><div align="center"><img src="open_data_model.png"></div><hr><h2 id="使用方法・メリット"><a href="#使用方法・メリット" class="headerlink" title="使用方法・メリット"></a>使用方法・メリット</h2><hr><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>以下の画像の選択肢の通り、Power BI サービス上で、新しいメジャー、計算列と計算テーブル、行レベルセキュリティ用の新しいロールを作成できます。</p><div align="center"><img src="open_data_model2.png"></div><blockquote><p><strong>参考情報</strong><br>メジャーの作成</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-tutorial-create-measures">チュートリアル: Power BI Desktop で独自のメジャーを作成する</a></li></ul><p>計算列の作成</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-tutorial-create-calculated-columns">チュートリアル: Power BI Desktop で計算列を作成する</a></li></ul><p>計算テーブルの作成</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-calculated-tables">Power BI Desktop で計算テーブルを作成する</a></li></ul><p>行レベルセキュリティについて</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-rls">Power BI での行レベルのセキュリティ (RLS)</a></li></ul></blockquote><p>リレーションシップにつきましても作成できますが、現状アイコンがないため、例えば以下の例で示すように Calendar テーブルと financials テーブルの間でリレーションシップを作成する場合、まずリレーションシップとして設定したい両方の「 Date 」列に対して、片方のテーブルの列をドラッグして、もう片方の列にドロップします。</p><div align="center"><img src="tables.png"></div><p>そうすると、リレーションシップを設定するウィザードが表示されますので、そこから詳細なリレーションシップを設定できます。</p><div align="center"><img src="relationship.png"></div></br><div align="center"><img src="relationship2.png"></div><blockquote><p><strong>参考情報</strong><br>モデルのリレーションシップについて</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-relationships-understand">Power BI Desktop でのモデル リレーションシップ</a></li></ul></blockquote><h4 id="メリット"><a href="#メリット" class="headerlink" title="メリット"></a>メリット</h4><p>メジャー・計算列・計算テーブルの作成機能においては、数式のオートコンプリート（入力すると、自動的に利用可能な関数や完全な数式を提示してくれる機能）が実装されているため、 Power BI Desktop でのモデル編集と比較しても全く劣りません。</p><p>また、物理的にレポートファイルの受け渡しをせずとも、簡単に複数のユーザーによる編集が可能な点、会社のルールや端末のスペックにより Power BI Desktop アプリケーションのインストールができないユーザーでも実施できることなども、大きなメリットでございます。</p><p>行レベルセキュリティの作成に関して、特に Power BI Desktop より便利な点としては、ロールを定義したら、すぐに、作成したロールに適用したいユーザーまで設定できることです。</p><div align="center"><img src="rls_role.png"></div><p>これまでは、まずは Power BI Desktop でロールを作成し、 Power BI サービスへ発行してから、データセットの[セキュリティ]から行レベルセキュリティの適用ユーザーを設定する必要がありましたが、本機能を利用することで、一連の流れとして同じ画面内で設定できるため、よりスムーズなオペレーションを実施できます。</p><hr><h2 id="考慮事項と制限事項"><a href="#考慮事項と制限事項" class="headerlink" title="考慮事項と制限事項"></a>考慮事項と制限事項</h2><hr><p>本記事を執筆した時点では、プレビュー機能なため、Power BI Desktop との機能差異や制限事項がまだ多く存在しています。<br>その中から、一部ご紹介いたします。</p><ul><li><p>データ モデルを変更すると、変更は自動的に保存されます。 変更は永続的であり、元に戻すオプションはございませんので十分にご注意ください。</p></li><li><p>本機能はモデルの編集のみなため、新しいデータソースへの接続や、 Power Query によるデータ加工は実施できません。代わりにデータフローやデータマートのご利用をご検討ください。</p></li></ul><div class="alert is-info"><p class="alert-title">Note</p><p><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_dataflow_dataset/">Power BI データフローとデータセット及びデータマートの紹介と比較</a></p></div><ul><li><p>増分更新が設定されているデータセット、デプロイパイプラインによるデプロイされたデータセット、 XMLA エンドポイントによって変更されたデータセット、ライブ接続を持つデータセットなどはサポートされていません。</p></li><li><p>現在はマイワークスペースを含め、すべてのライセンスのワークスペースでご利用可能ですが、 今後一部の Pro ライセンスのワークスペースでは利用できなくなります。</p></li><li><p>データソース側のテーブルや列に対して、名前を変更することはできません。</p></li><li><p>テーブルのストレージモードの変更ができません。</p></li></ul><p>上述した考慮事項の他にもございますので、詳細につきまして、以下の公開情報にて最新状況をご確認ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/service-edit-data-models?source=recommendations#considerations-and-limitations">考慮事項と制限事項 | Power BI サービスでデータ モデルを編集する (プレビュー)</a></p></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。 </p><blockquote><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/service-edit-data-models">Power BI サービスでデータ モデルを編集する (プレビュー)</a> </li></ul></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのチャンです。 &lt;/p&gt;
&lt;p&gt;2023 年 4 月 下旬より、新機能リリースによって、Power BI サービスでもデータセット（データモデル）の編集が可能となりました！&lt;/p&gt;
&lt;p&gt;これまでは、 Power BI サービス上で複数ユーザーで実施可能な共同作業はレポートの編集のみでしたが、本機能により、新しいメジャーや計算列の作成、リレーションシップの管理、行レベルセキュリティのロール作成などといったデータセットの編集作業が、毎回.PBIX ファイルをダウンロードせずとも、Power BI サービス上で、直接実施することができます。早速本機能について詳細をご紹介していきます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="データモデル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB/"/>
    
    <category term="Power BIサービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="モデル編集" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A2%E3%83%87%E3%83%AB%E7%B7%A8%E9%9B%86/"/>
    
    <category term="リレーションシップ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%B7%E3%83%83%E3%83%97/"/>
    
    <category term="メジャー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A1%E3%82%B8%E3%83%A3%E3%83%BC/"/>
    
    <category term="計算列" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%A8%88%E7%AE%97%E5%88%97/"/>
    
    <category term="行レベルのセキュリティー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%A1%8C%E3%83%AC%E3%83%99%E3%83%AB%E3%81%AE%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%BC/"/>
    
  </entry>
  
  <entry>
    <title>オンプレミス データ ゲートウェイのトラブルシューティング：構成時に発生するエラー</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/gateway_troubleshooting/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/gateway_troubleshooting/</id>
    <published>2023-05-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.295Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>オンプレミス上のデータを取得するなどの目的で、対象のサーバーと Power BI サービスをブリッジする機能としてオンプレミス データ ゲートウェイ (※1) がありますが、このゲートウェイの構成時にエラーが発生するというお問合せをいただくことがよくあります。<br>今回は、ゲートウェイ構成時にエラーが発生した際にまずお試しいただきたいトラブルシューティングをご案内いたします。  </p><p>※1 <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-onprem">オンプレミス データ ゲートウェイとは</a></p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><br /><br /><hr><h2 id="構成時に発生するエラー"><a href="#構成時に発生するエラー" class="headerlink" title="構成時に発生するエラー"></a><font color="RoyalBlue">構成時に発生するエラー</font></h2><hr><p>ゲートウェイ アプリをインストールした後に、ゲートウェイの管理者となるユーザーアカウントにてサインインし、新しいゲートウェイの登録を行い構成を完了させます。<br>この構成作業中に、ゲートウェイ アプリ上に以下のようなエラーメッセージが表示され、後続の処理に進めないことがあります。  </p><br /> <p>「ゲートウェイの詳細を更新できませんでした。ゲートウェイを実行するアカウントの変更が必要な場合があります。」<br>「ゲートウェイ サービスの正常性チェックがタイムアウトになり失敗しました。」<br>「ゲートウェイを作成できませんでした、もう一度お試しください。」<br>「ネットワーク要求で予期しないエラーが返されました。」<br>「ネットワーク接続が制限されています。」<br>「ゲートウェイは正しく構成されているがローカルネットワーク接続の問題によりアクセスできません。」   </p><br /><hr><h2 id="トラブルシューティング"><a href="#トラブルシューティング" class="headerlink" title="トラブルシューティング"></a><font color="RoyalBlue">トラブルシューティング</font></h2><hr><p>上記いずれかのエラーが発生している場合は、ゲートウェイを構成するための前提条件を満たせていない可能性があります。<br>このため、まずは以下の点をご確認くださいますようお願いいたします。  </p><br /><h3 id="1-最新版のゲートウェイをインストールする"><a href="#1-最新版のゲートウェイをインストールする" class="headerlink" title="1. 最新版のゲートウェイをインストールする"></a><font color="LightCoral">1. 最新版のゲートウェイをインストールする</font></h3><p>ゲートウェイの更新プログラムは毎月リリースしており、古いバージョンで発生する問題が解消している可能性があります。<br>古いバージョンをインストールしている場合は、最新版で事象が解消するかご確認いただきますようお願いいたします。  </p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-update?source=recommendations">オンプレミスのデータ ゲートウェイの更新</a>  </p><br />  <h3 id="2-ゲートウェイに必要な通信を許可する"><a href="#2-ゲートウェイに必要な通信を許可する" class="headerlink" title="2. ゲートウェイに必要な通信を許可する"></a><font color="LightCoral">2. ゲートウェイに必要な通信を許可する</font></h3><p>ゲートウェイは、以下公式ドキュメント “オンプレミス データ ゲートウェイの通信設定を調整する” でご案内しているFQDN、送信ポートの許可設定が必要となります。<br>ファイアウォールにて通信の接続を制限しているご環境の場合は、ドキュメントに記載されている通信許可の設定がお済みであるかご確認いただきますようお願いいたします。　  </p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-communication">オンプレミス データ ゲートウェイの通信設定を調整する</a>  </p><br />  <h3 id="3-ゲートウェイ-構成ファイルの設定"><a href="#3-ゲートウェイ-構成ファイルの設定" class="headerlink" title="3. ゲートウェイ 構成ファイルの設定"></a><font color="LightCoral">3. ゲートウェイ 構成ファイルの設定</font></h3><p>対象のご環境にプロキシサーバーが存在している場合、以下公式ドキュメント “オンプレミス データ ゲートウェイのプロキシ設定を構成する” の通り、事前にゲートウェイの構成ファイルの設定が必要となります。</p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-proxy">オンプレミス データ ゲートウェイのプロキシ設定を構成する</a> </p><h4 id="lt-詳細手順-gt"><a href="#lt-詳細手順-gt" class="headerlink" title="&lt;詳細手順&gt;"></a><strong>&lt;詳細手順&gt;</strong></h4><ol><li>次の２つのファイルを確認し、テキストエディタなどで開きます。  </li></ol><blockquote><p>C:\Program Files\On-premises data gateway\enterprisegatewayconfigurator.exe.config<br>C:\Program Files\On-premises data gateway\Microsoft.PowerBI.EnterpriseGateway.exe.config  </p></blockquote><ol start="2"><li>以下表記の部分を変更します。<br>※　“http://192.168.1.10:3128” の部分には、実際のプロキシサーバーのアドレスを入力いただきます。  </li></ol><p><strong>変更前 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;system.net&gt;  </span><br><span class="line">    &lt;defaultProxy useDefaultCredentials=&quot;true&quot; /&gt;  </span><br><span class="line">&lt;/system.net&gt;  </span><br></pre></td></tr></table></figure></p><p><strong>変更後 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;system.net&gt;</span><br><span class="line">    &lt;defaultProxy useDefaultCredentials=&quot;true&quot;&gt;</span><br><span class="line">        &lt;proxy </span><br><span class="line">            autoDetect=&quot;false&quot; </span><br><span class="line">            proxyaddress=&quot; http://192.168.1.10:3128&quot; </span><br><span class="line">            bypassonlocal=&quot;false&quot; </span><br><span class="line">            usesystemdefault=&quot;true&quot;</span><br><span class="line">        /&gt; </span><br><span class="line">    &lt;/defaultProxy&gt;</span><br><span class="line">&lt;/system.net&gt;  </span><br></pre></td></tr></table></figure></p><p>変更後、各ファイルを保存します。</p><p>※　ゲートウェイがプロキシを介してクラウド データ ソースに接続する場合や、対象のご環境によっては、以下構成ファイルを編集する必要があります。  </p><blockquote><p>C:\Program Files\On-premises data gateway\m\Microsoft.Mashup.Container.NetFX45.exe.config  </p></blockquote><p><strong>変更前 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;startup&gt;</span><br><span class="line">    &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.5.2&quot;/&gt;</span><br><span class="line">  &lt;/startup&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><p><strong>変更後 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;system.net&gt;</span><br><span class="line">        &lt;defaultProxy useDefaultCredentials=&quot;true&quot; enabled=&quot;true&quot;&gt;</span><br><span class="line">        &lt;proxy proxyaddress=&quot;http://192.168.1.10:3128&quot; bypassonlocal=&quot;true&quot; /&gt;</span><br><span class="line">        &lt;/defaultProxy&gt;</span><br><span class="line">    &lt;/system.net&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><h4 id="lt-プロキシサーバー有無のご確認方法-gt"><a href="#lt-プロキシサーバー有無のご確認方法-gt" class="headerlink" title="&lt;プロキシサーバー有無のご確認方法&gt;"></a><strong>&lt;プロキシサーバー有無のご確認方法&gt;</strong></h4><p>コマンドプロンプトから、以下のコマンドを実行します。<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh winhttp show proxy</span><br></pre></td></tr></table></figure></p><p>実行結果が以下結果の場合は、プロキシ設定がされていませんが、以下結果 <font color="red"><strong>以外</strong></font>の場合、プロキシ設定がされております。</p><p>――――――――――――――――<br>現在の WinHTTP プロキシ設定:<br>直接アクセス (プロキシ サーバーなし)。<br>――――――――――――――――   </p><br />  <h3 id="4．サービスアカウントの変更"><a href="#4．サービスアカウントの変更" class="headerlink" title="4．サービスアカウントの変更"></a><font color="LightCoral">4．サービスアカウントの変更</font></h3><p>以下公式ドキュメント “オンプレミスのデータ ゲートウェイ サービス アカウントを変更する” に記載される通り、ゲートウェイのサービスは、ゲートウェイ専用のサービスアカウント “NT SERVICE\PBIEgwService” によって実行されますが、対象のご環境によっては、そのままだとエラーが発生する場合があります。<br>上記 １～3 の設定確認をクリアしている場合、サービス アカウントをドメインユーザーまたは PC にサインインしているローカルユーザーに変更することで事象に変化があるかご確認いただきますようお願いいたします。  </p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-service-account">オンプレミスのデータ ゲートウェイ サービス アカウントを変更する</a></p><br /> <hr><h2 id="その他ご参考情報"><a href="#その他ご参考情報" class="headerlink" title="その他ご参考情報"></a><font color="RoyalBlue">その他ご参考情報</font></h2><hr><p>以下公式ドキュメントでもゲートウェイのトラブルシューティングに関する情報をご案内していますので、合わせてご参考にしていただきますようお願いいたします。　　</p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-tshoot">オンプレミス データ ゲートウェイのトラブルシューティング</a></p><br /> <br /> 以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。<hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;オンプレミス上のデータを取得するなどの目的で、対象のサーバーと Power BI サービスをブリッジする機能としてオンプレミス データ ゲートウェイ (※1) がありますが、このゲートウェイの構成時にエラーが発生するというお問合せをいただくことがよくあります。&lt;br&gt;今回は、ゲートウェイ構成時にエラーが発生した際にまずお試しいただきたいトラブルシューティングをご案内いたします。  &lt;/p&gt;
&lt;p&gt;※1 &lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-onprem&quot;&gt;オンプレミス データ ゲートウェイとは&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerBI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBI/"/>
    
    <category term="Onpreisesdatagateway" scheme="https://jpbap-sqlbi.github.io/blog/tags/Onpreisesdatagateway/"/>
    
    <category term="gateway" scheme="https://jpbap-sqlbi.github.io/blog/tags/gateway/"/>
    
    <category term="troubleshooting" scheme="https://jpbap-sqlbi.github.io/blog/tags/troubleshooting/"/>
    
  </entry>
  
  <entry>
    <title>コンテンツの承認（昇格・認定）と検出について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_endorsement/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_endorsement/</id>
    <published>2023-05-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.451Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>組織で Power BI サービスの利用が進むと、画面上の一覧に表示されるコンテンツが膨大になってくることがあります。<br>その際、特定のコンテンツを「承認（昇格・認定）」することで、そのコンテンツにラベルが付いて他ユーザーに対して目立たせて表示をすることができます。また、データセットの場合は、その際「検出可能」とすれば、そもそもアクセス権がないユーザーに対してもデータハブに表示をさせることができます。</p><p>今回はそれらの機能をご紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><p> <a href="#%EF%BC%91%EF%BC%8E%E6%89%BF%E8%AA%8D%EF%BC%88%E6%98%87%E6%A0%BC%E3%83%BB%E8%AA%8D%E5%AE%9A%EF%BC%89">１．承認（昇格・認定）</a><br> <a href="#%EF%BC%92%EF%BC%8E%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E3%80%8C%E6%A4%9C%E5%87%BA%E5%8F%AF%E8%83%BD%E3%81%AB%E3%81%99%E3%82%8B%E3%80%8D">２．データセットの「検出可能にする」</a><br> <a href="#%EF%BC%93%EF%BC%8E%E3%81%A9%E3%82%93%E3%81%AA%E3%81%A8%E3%81%8D%E3%81%AB%E4%BD%BF%E3%81%86%EF%BC%9F">３．どんなときに使う？</a></p><hr><h2 id="１．承認（昇格・認定）"><a href="#１．承認（昇格・認定）" class="headerlink" title="１．承認（昇格・認定）"></a>１．承認（昇格・認定）</h2><hr><p>コンテンツの「承認」を行うと、Power BI サービスの一覧や検索でコンテンツが表示される際にラベルが付きます。これによって、質の高いと評価されたコンテンツを他コンテンツから差別化してユーザーに目立たせて表示することができます。一部の検索で優先されるほか、一部のリストを並べ替えるためにも使用できます。</p><p>「承認」には昇格と認定の2種類があります。</p><table><thead><tr><th>承認の種類</th><th>ラベル</th><th>用途</th><th>設定に必要な権限</th></tr></thead><tbody><tr><td>昇格</td><td>昇格しました</td><td>コンテンツが共有に十分適していると考えた場合、他のユーザーに対して有用で価値があるアピールをする。これにより、組織内で共同作業するためのコンテンツの拡散を促進する。</td><td>コンテンツの所有者、またはワークスペースの書き込みアクセスのあるユーザー（管理者・メンバー・共同作成者）</td></tr><tr><td>認定</td><td>認定</td><td>（昇格よりもさらに）コンテンツが組織の品質基準を満たしていて、有用で信頼できる優先コンテンツとして拡散を促進する。</td><td>テナント設定「認定資格」で指定されたセキュリティグループ</td></tr></tbody></table><p>承認ができるコンテンツは以下です。<br>　・データセット<br>　・データフロー<br>　・レポート<br>　・アプリ</p><p>表示イメージは以下のとおりで、「昇格しました」「認定済み」のラベルが付きます。</p><div align="center"><img src="1.png"></div></br><p>// 承認の手順（例：データセット）<br>Power BI サービス &gt; ワークスペース &gt; 該当のデータセットのメニュー「…」 &gt; 設定 &gt; 承認と検出 &gt; 昇格 or 認定 を選択する</p><div align="center"><img src="2.png"></div> </br><div class="alert is-info"><p class="alert-title">Note</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-endorsement-overview">承認 - Power BI コンテンツの昇格と認定 - Power BI | Microsoft Learn</a></p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-setup-certification">コンテンツの認定を有効にする - Power BI | Microsoft Learn</a></p></div></br><hr><h2 id="２．データセットの「検出可能にする」"><a href="#２．データセットの「検出可能にする」" class="headerlink" title="２．データセットの「検出可能にする」"></a>２．データセットの「検出可能にする」</h2><hr><p>データセットに関しては、「検出可能にする」ことができます。<br>「検出」とは「承認（昇格・認定）」がされているデータセットについて、そのデータセットへのアクセス権を持たないユーザーにもデータセットハブの一覧に表示をさせることを表します。</p><p>「承認（昇格・認定）」はラベル付けしてユーザーに目立たせて表示をする方法ですが、他のすべてのデータセットと同様、データセットに対するアクセス権を持つユーザーにのみ表示されて、アクセス権を持たないユーザーには表示されないため、アクセス権を要求することすら困難です。この問題を解決するため、「承認」されたデータセットは「検出可能」としてマークすることで、アクセス権を持たないユーザーにも表示され、その後は、提供されている任意のアクセス要求メカニズムを使用してデータセットに対するビルドアクセス許可を要求できます。</p><p>// データセットハブの表示</p><div align="center"><img src="3.png"></div></br><p>「検出可能にする」ための手順は以下です。<br>１の承認をする設定画面で下部「検出可能にする」にチェックを入れて適用します。</p><div align="center"><img src="4.png"></div></br><p>検出可能にするには以下のテナント設定が有効化されている必要があります。</p><p>　・昇格したコンテンツを検出可能にする<br>　・認定コンテンツを検出可能にする</p><div align="center"><img src="5.png"></div></br><p>これらのテナント設定を有効化すると、コンテンツの承認（昇格・認定）が可能な指定ユーザーは、そのコンテンツを検出可能としてマークすることができます。ユーザーやグループを指定して、許可される指定グループから除外することもできます。</p><p>検出可能の設定が可能なメンバーは、承認されたコンテンツが存在するワークスペースの管理者、またはメンバーロールを持つ承認されたユーザーです。つまり、これらのロールがあれば、承認「認定」の処理が不可のユーザーだとしても、すでに「認定済みのデータセット」に対して検出の設定が可能です。</p><p>また、検出可能として承認されたコンテンツについてアクセス権がないユーザーに対してもそれを検索や表示をさせるには、テナント設定「コンテンツの検出」を有効化しておく必要があります。</p><div align="center"><img src="6.png"></div></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-JP/power-bi/connect-data/service-data-hub?tabs=datasets">データ ハブを使用したデータ検出 - Power BI | Microsoft Learn</a></p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-JP/power-bi/collaborate-share/service-discovery">データセットの検出可能性 - Power BI | Microsoft Learn</a></p></div><hr><h2 id="３．どんなときに使う？"><a href="#３．どんなときに使う？" class="headerlink" title="３．どんなときに使う？"></a>３．どんなときに使う？</h2><hr><p>使い分けとしては以下のパターンが考えられます。</p><p>１．アクセス権のあるユーザー内の一覧表示で、特定のコンテンツ表示を目立たせる（差別化する）<br>　　⇒承認の昇格と認定の2段階でラベル付けをする</p><p>２．１で表示を差別化したいのはまとまったレポート群である<br>　　⇒レポート単体でも承認（昇格・認定）できるが、アプリごとで承認することもできる</p><p>３．アクセス権のないユーザーにも存在を知ってもらう（アクセス権の要求を出す機会をつくる）<br>　　⇒承認（昇格と認定）を設定する際に「検出可能」にする</p></br><hr><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><hr><ul><li> 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-endorsement-overview">承認 - Power BI コンテンツの昇格と認定 - Power BI | Microsoft Learn</a></li><li> 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-setup-certification">コンテンツの認定を有効にする - Power BI | Microsoft Learn</a></li><li> 公開情報：<a href="https://learn.microsoft.com/ja-JP/power-bi/connect-data/service-data-hub?tabs=datasets">データ ハブを使用したデータ検出 - Power BI | Microsoft Learn</a></li><li> 公開情報：<a href="https://learn.microsoft.com/ja-JP/power-bi/collaborate-share/service-discovery">データセットの検出可能性 - Power BI | Microsoft Learn</a></li></ul><hr></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p></br><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;組織で Power BI サービスの利用が進むと、画面上の一覧に表示されるコンテンツが膨大になってくることがあります。&lt;br&gt;その際、特定のコンテンツを「承認（昇格・認定）」することで、そのコンテンツにラベルが付いて他ユーザーに対して目立たせて表示をすることができます。また、データセットの場合は、その際「検出可能」とすれば、そもそもアクセス権がないユーザーに対してもデータハブに表示をさせることができます。&lt;/p&gt;
&lt;p&gt;今回はそれらの機能をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="共有" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E5%85%B1%E6%9C%89/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="Power BI アプリ" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
  </entry>
  
  <entry>
    <title>TLS1.0/1.1のサポート終了</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/tls/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/tls/</id>
    <published>2023-05-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:19.087Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>この度、Power BIにおいてTLS1.0/1.1を使用した通信のサポートが終了しますので、その詳細やユーザーさまにて必要な設定等についてご案内いたします。Power BIを管理されているユーザーさまは、いま一度ご確認いただきますようお願いいたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><h2 id="TLSとは"><a href="#TLSとは" class="headerlink" title="TLSとは"></a>TLSとは</h2><p>TLSとは、正称をTransport Layer Security (トランスポート層セキュリティ プロトコル) といい、インターネットを介して行われる通信のプライバシーを保護するために設計された、業界標準のプロトコルです。TLSプロトコルを利用することで、メッセージの改ざんや傍受、偽造を検知することができます。1999年に初めてTLS1.0が定義され、現在はTLS1.3がリリースされています。  </p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/windows/win32/secauthn/transport-layer-security-protocol">トランスポート層セキュリティ プロトコル - Win32 apps | Microsoft Learn</a></p></div><div align="center"><img src="TLS01.png"></div>  <p>TLS1.0/1.1は古いプロトコルのため、新たに脆弱性が発見され、悪意のある第三者からの攻撃を受ける可能性があります。そのため、Microsoftでは様々なアプリケーションでTLS1.0/1.1のサポートを終了し、TLS1.2を利用するように移行しています。  </p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/lifecycle/announcements/transport-layer-security-1x-disablement">更新: トランスポート層セキュリティ 1.0 および 1.1 の無効化 - Microsoft Lifecycle | Microsoft Learn</a></p></div><div align="center"><img src="TLS02.png"></div>  <h2 id="TLS1-0-1-1のサポート終了"><a href="#TLS1-0-1-1のサポート終了" class="headerlink" title="TLS1.0/1.1のサポート終了"></a>TLS1.0/1.1のサポート終了</h2><p>2023年4月26日に、Microsoft365管理センターのメッセージ センターに、以下の案内が送付されています。</p><blockquote><p>件名: Power BI notification for discontinuation of support for TLS 1.0 and 1.1 (MC546936)</p><p>We will be retiring the support of TLS 1.0 and TLS 1.1 for outgoing requests from Power BI. Instead, we recommend the utilization of TLS 1.2 or above for outgoing requests, which is where we will continue to invest our development resources. TLS 1.0 and TLS 1.1 have already been disabled for incoming requests long ago. For security documentation, please refer: <a href="https://learn.microsoft.com/power-bi/enterprise/service-admin-power-bi-security">Power BI Security - Power BI</a>.</p><p>(自動翻訳)</p><p>Power BI からの送信リクエストにおける TLS 1.0 および TLS 1.1 のサポートは終了となります。その代わりに、発信リクエストにはTLS 1.2以上の利用を推奨しており、今後も開発リソースを投入していく予定です。TLS 1.0とTLS 1.1は、すでにかなり前に受信リクエストに対して無効化されています。セキュリティに関するドキュメントは、こちらをご参照ください： Power BI セキュリティ - Power BI.</p></blockquote><div align="center"><img src="TLS03.png"></div>  <p>こちらは、Power BIからクライアントへの通信について、TLS1.0/1.1のサポートが終了するために送られた案内でございます。すでに、クライアントからPower BIへの通信についてはサポートが終了しており、送信/受信ともにPower BIではTLS1.0/1.1のサポートが終了となります。<br>今回の発信リクエストのサポート終了にともない影響が考えられるシナリオとしましては、レガシーなデータソースを利用している場合がございます。データソースがTLS1.0/1.1へフォールバックされる場合には、Power BIではデータの取り込みに利用できなくなります。<br>今後は、TLS1.0/1.1を利用したPower BI Serviceとの通信は行うことができません。TLS1.0/1.1を利用したクライアントでの通信は失敗しますのでご注意ください。例えば、以下のクライアントではTLS1.2を利用することができません。以下のクライアントを利用している場合にはご注意ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://powerbi.microsoft.com/ja-jp/blog/deprecating-tls-1-0-and-1-1-support-in-power-bi/">Deprecating TLS 1.0 and 1.1 support in Power BI | Microsoft Power BI ブログ | Microsoft Power BI</a></p></div><ul><li>Android 4.3 以前のバージョン</li><li>Firefox バージョン 5.0 以前のバージョン</li><li>Windows 7 以前のバージョンの Internet Explorer 8-10</li><li>Windows Phone 8 の Internet Explorer 10</li><li>Safari 6.0.4/OS X10.8.4以前のバージョン</li></ul><div align="center"><img src="TLS04.png"></div>  <h2 id="ユーザーさまが実施する必要のある操作-Power-BI-Service"><a href="#ユーザーさまが実施する必要のある操作-Power-BI-Service" class="headerlink" title="ユーザーさまが実施する必要のある操作(Power BI Service)"></a>ユーザーさまが実施する必要のある操作(Power BI Service)</h2><p>TLS1.0/1.1のサポート終了によって、テナント設定の変更等、ユーザーさまがPower BI Service上で行う必要のある操作は<strong>ございません</strong>。</p><h2 id="ユーザーさまが実施する必要のある操作-クライアント"><a href="#ユーザーさまが実施する必要のある操作-クライアント" class="headerlink" title="ユーザーさまが実施する必要のある操作(クライアント)"></a>ユーザーさまが実施する必要のある操作(クライアント)</h2><p>TLS1.0/1.1を利用するクライアントを利用している場合には、TLS1.2を利用するように構成する必要があります。例えば、.NETアプリケーションを使用している場合には、.NET Framework4.6以上で実行されている場合には、規制の構成を変更していない限りTLS1.2を利用しますが、.NET Framework4.6より前で実行されている場合には、以下のコードを使用することで、アプリケーションの起動時にTLS1.2を有効にすることができます。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.Net.ServicePointManager .SecurityProtocol |= SecurityProtocolType.Tls11 | SecurityProtocolType.Tls12; </span><br></pre></td></tr></table></figure><p>また、PowerShellを使用している場合には、以下のコードでTLSのバージョンをアップグレードすることができます。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls12  </span><br></pre></td></tr></table></figure><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://azure.microsoft.com/ja-jp/updates/power-bi-support-for-transportlayer-security/">Power BI アプリケーションの TLS バージョンを TLS 1.2 にアップグレードする | Azure の更新情報 | Microsoft Azure</a></p></div><div align="center"><img src="TLS05.png"></div>  <h2 id="おわりに"><a href="#おわりに" class="headerlink" title="おわりに"></a>おわりに</h2><p>Power BIは、皆さまが安心してご利用いただけるように改善に取り組んでおり、今後も改善を続けていきます。セキュリティについては以下の公開情報に記載をしておりますのでよろしければご一読ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/whitepaper-powerbi-security">Power BI のセキュリティに関するホワイト ペーパー - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-power-bi-security">Power BI のセキュリティ - Power BI | Microsoft Learn</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;この度、Power BIにおいてTLS1.0/1.1を使用した通信のサポートが終了しますので、その詳細やユーザーさまにて必要な設定等についてご案内いたします。Power BIを管理されているユーザーさまは、いま一度ご確認いただきますようお願いいたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
  </entry>
  
  <entry>
    <title>Power BI の開発支援・コンサルティングを含む内容に関するお問い合わせについて</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary2/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary2/</id>
    <published>2023-05-10T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:19.087Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。  </p><p>日頃から、マイクロソフトのサポート サービスをご利用いただき誠にありがとうございます。<br>以前、<a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて</a> の記事で、私たち Power BI サポート チームで提供しているサービスの詳細についてご紹介いたしました。<br>しかしながら、以下 “開発支援、コンサルティングを含む内容” については、問い合わせしようとしている内容が範囲外に該当するかどうかの判断が難しいとお声をいただくことがありました。<br>このため、今回の記事では、開発支援やコンサルティングに該当するお問合せはどういったものかを、より詳細にご紹介いたします。  </p><br /><blockquote><h3 id="4-開発支援、コンサルティングを含む内容"><a href="#4-開発支援、コンサルティングを含む内容" class="headerlink" title="4. 開発支援、コンサルティングを含む内容"></a><font color="LightCoral">4. 開発支援、コンサルティングを含む内容</font></h3><p>レポート開発、DAX 式や M クエリの作成、Embedded 環境の開発、REST API や PowerShell でのスクリプト作成等開発にかかわる内容やコンサルティングを含む内容は当リアクティブ サポート範囲外となります。<br>もちろん、お客様にて開発を進めていただく中で発生した問題のトラブルシューティングについては、問題箇所に限定して 1 問 1 答でのご支援は可能です。（原因追及の可否については、上記サポート プランに基づきます。）<br>開発支援が必要な場合は、別途営業担当などにご相談ください。  </p></blockquote><span id="more"></span><br /><br /><hr><h2 id="開発支援、コンサルティングを含む内容の詳細分類"><a href="#開発支援、コンサルティングを含む内容の詳細分類" class="headerlink" title="開発支援、コンサルティングを含む内容の詳細分類"></a><font color="RoyalBlue">開発支援、コンサルティングを含む内容の詳細分類</font></h2><hr><p>基本的には、サポート開始にあたりユーザー様固有の要件やデータソース・テーブル構成、環境全体の構成図等の把握が必要になる場合は、開発者サポート案件に該当し、Premier/ユニファイド といった有償のご契約の中で追加サービスをご購入いただき、当リアクティブ サポート チームとは別の部門にて対応している範囲となります。<br>以下では、Power BI サポート チームによくお寄せいただく　”開発支援やコンサルティングを含むお問合せ“ について例を挙げながら分類分けをし、サポート範囲外かどうかの判断基準をご説明いたします。  </p><br /><p> <font color="LightCoral"><strong>分類</strong></font><br> １．ゼロからのレポート開発<br> ２．開発中レポートにおける新規課題の解決<br> ３．レポート開発中に発生した問題の解決<br> ４．データモデル構成、ネットワークや環境の構成<br> ５．スクリプト作成依頼  </p><br /><h3 id="１．ゼロからのレポート開発"><a href="#１．ゼロからのレポート開発" class="headerlink" title="１．ゼロからのレポート開発"></a><font color="LightCoral">１．ゼロからのレポート開発</font></h3><p>ユーザー様にてレポート未作成の状態であり、 Excel や他社 BI ツール、イメージ図などを基にゼロからのレポート開発支援をご要望されるケースは、ご要件とデータソースの構成の把握が必須となり開発案件に該当しますので、サポート対象外となります。    </p><p><strong>サポート対象外となるお問合せの例：</strong><br>・添付画像通りの BI レポートを実現するための手順を教えてほしい。<br>・既存のデータを使用して、各地区で販売された品目の小売り売上データを分析するレポートを作りたいが、どうしたらよいかわからない。<br>・他社 BI ツールでは ○○ といった分析ができていた。同じデータを使用してPower BIで再現する方法を知りたい。　　  </p><br />  <h3 id="２．開発中レポートにおける新規課題の解決"><a href="#２．開発中レポートにおける新規課題の解決" class="headerlink" title="２．開発中レポートにおける新規課題の解決"></a><font color="LightCoral">２．開発中レポートにおける新規課題の解決</font></h3><p>ユーザー様にて開発中のレポートにおいて行いたい分析があり、それを実現する方法をご要望されるケースは、ご要件と既存レポートの構成を正しく把握し、そのレポートに沿った DAX 式の検証、テーブル構成の見直し等を行った上で実現可否を調査する必要があり、開発案件に該当しますのでサポート対象外になります。  </p><p><strong>サポート対象外となるお問合せの例：</strong><br>・添付の .pbix にて、営業日に限定し稼働時間の前年比を計算したいが、どのような式をたてればよいか教えてほしい。<br>・自社独自のカレンダーにあわせて分析を行いたいが、どのようにカレンダー テーブルを作成し紐づければよいか教えてほしい。  </p><br />  <h3 id="３．レポート開発中に発生した問題の解決"><a href="#３．レポート開発中に発生した問題の解決" class="headerlink" title="３．レポート開発中に発生した問題の解決"></a><font color="LightCoral">３．レポート開発中に発生した問題の解決</font></h3><p>レポート開発中に何かしらのエラーが発生しているケース、該当のエラーや行っていた操作の詳細情報をもとにしたトラブルシューティングはサポート範囲内となります。<br>しかしながら、トラブルシューティングの中でユーザー様のテーブル構成や DAX 式に問題があることがわかった場合、問題個所の特定まではご支援させていただきますが、テーブル構成や DAX 式の修正作業自体はユーザー様にて実施いただく必要があり、サポート対象外となります。<br>また、エラーは発生していないが、想定している値が表示されないので修正すべき点について指摘してほしいといったケースは、ご要件と既存レポートの構成を正しく把握し、そのレポートに沿った DAX 式の検証、テーブル構成の見直し等が必要となるため、開発案件に該当しますのでサポート対象外となります。  </p><p><strong>サポート対象となるお問合せの例：</strong><br>・DAX 式を作成したところ ○○ というエラーメッセージが表示されたため解消方法を教えてほしい。  </p><p><strong>サポート対象外となるお問合せの例：</strong><br>・作成中の式において ○○ という DAX 関数は使用できないことがわかった。使用する関数にこだわりはないので、代替となる関数と式をおしえてほしい。<br>・出勤と退勤時間を記録したデータを取り込んだレポートにおいて、平日勤務時間内とそれ以外の時間帯の稼働時間を計算したいが、うまく計算ができないため DAX 式作成について支援してほしい。  </p><br />  <h3 id="４-データモデル構成、ネットワークや環境の構成"><a href="#４-データモデル構成、ネットワークや環境の構成" class="headerlink" title="４. データモデル構成、ネットワークや環境の構成"></a><font color="LightCoral">４. データモデル構成、ネットワークや環境の構成</font></h3><p>Power BI 導入におけるシステム・ネットワーク環境の設計、提案や検討中のシステム運用に問題がないかといった確認依頼は、ユーザー様のご要件を正確に把握した上でのご案内が必要となり、コンサルティングに該当するためサポート対象外となります。  </p><p><strong>サポート対象外のお問合せ例：</strong><br>・セキュアな環境で Power BI を利用させたいと思っており、添付の構成図で実現が可能かレビューしてほしい。<br>・○○ 人規模で Power BI を安定して使用するために必要なネットワーク帯域の目安を教えてほしい。<br>・Power BI を運用するためのおすすめのテナント設定値やベストプラクティスを教えてほしい。  </p><br />  <h3 id="５．スクリプト作成依頼"><a href="#５．スクリプト作成依頼" class="headerlink" title="５．スクリプト作成依頼"></a><font color="LightCoral">５．スクリプト作成依頼</font></h3><p>Power BI の REST API や PowerShell を使用したスクリプト作成はサポート対象外となります。<br>ご支援範囲は、該当するコマンドのご紹介やコマンド単体で実行した際に発生しているエラーのトラブルシューティングまでとなります。  </p><p><strong>サポート対象外のお問合せ例：</strong><br>組織のワークスペースとそのワークスペース内に存在するレポートの一覧を取得するためのスクリプトがほしい。  </p><br /><br /><hr><h2 id="ベストエフォートでのご支援範囲"><a href="#ベストエフォートでのご支援範囲" class="headerlink" title="ベストエフォートでのご支援範囲"></a><font color="RoyalBlue">ベストエフォートでのご支援範囲</font></h2><hr><p>上述でご説明したサポート範囲外のお問合せをいただいた際には、恐れ入りますが、適切なご支援提供のために営業担当へのご相談等をご案内し、当リアクティブ サポート チームとしてのお問合せ対応は終了となります。<br>しかしながら、内容によっては詳細ヒアリングを実施させていただき、事前にご支援範囲やゴールの認識合わせを行いご了承いただいた上で、ベストエフォートでのご支援を提供させていただく場合があります。<br>ベストエフォートでのご支援範囲は以下となりますので、事前にご確認いただけますと幸いです。  </p><br />  <h3 id="ベストエフォートでのご支援範囲-1"><a href="#ベストエフォートでのご支援範囲-1" class="headerlink" title="ベストエフォートでのご支援範囲"></a><font color="DarkSalmon">ベストエフォートでのご支援範囲</font></h3><p><strong>1. 関連する公開情報と Power BI コミュニティー事例のご案内</strong><br>ご要望を実現するために参考になりそうな機能や関数、類似事例に関する情報をご紹介いたします。  </p><p><strong>2. Power BIの既存機能による実施可否の確認</strong><br>Power BI の既存機能によるご要望実現可否について確認し、関連する情報をご紹介いたします。  </p><p><strong>3. ご要望と事象をシンプル化したレポートをご提供いただき調査を行う</strong><br>対象のレポートやテーブル構成に特化した支援の必要がなく、課題をシンプル化したレポートをご用意いただいた場合は、他のベストエフォートでのご支援範囲に沿って、実現方法について検討した結果をご紹介いたします。  </p><p><strong>4. Power BI仕様の確認</strong><br>“3. レポート開発中に発生した問題の解決” 、 “4. データモデル構成、ネットワークや環境の構成” に該当するお問合せについては、 Power BI の仕様としてどのような動作となるかといった情報をご紹介いたします。  </p><h3 id="ご参考情報"><a href="#ご参考情報" class="headerlink" title="ご参考情報"></a><font color="DarkSalmon">ご参考情報</font></h3><p>なお、上記ベストエフォート調査については、主に以下サイトをもとに調査を行いますので、ご参考にしていただければと思います。 </p><p><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_useful_learning_link/">Power BI を学習するために役に立つコンテンツのご紹介</a><br>・Power BI を学習するための資料に関する情報をまとめております。  </p><p><a href="https://community.powerbi.com/">Forums - Microsoft Power BI Community</a><br>・世界中にいるさまざまな Power BI のエンジニアや有識者にて運営されており、お互いに Power BI の課題を解決し合う場となっております。  </p><p><a href="https://learn.microsoft.com/ja-jp/dax/">Data Analysis Expressions (DAX) リファレンス</a><br>・DAX 関数に関する情報をまとめた公開情報となります。</p><br /><br /><hr><h2 id="おわりに：Power-BI-サポート-チーム-からのご挨拶"><a href="#おわりに：Power-BI-サポート-チーム-からのご挨拶" class="headerlink" title="おわりに：Power BI サポート チーム からのご挨拶"></a><font color="RoyalBlue">おわりに：Power BI サポート チーム からのご挨拶</font></h2><hr><p>本記事を最後までお読みいただきありがとうございます。<br>Power BI ユーザー数は年々増加しており、それに比例して Power BI サポート チームには毎日たくさんのお問合せをいただき、大変ありがたく感じております。<br>しかしながら、中には上述でご紹介したような、サポート チームではご支援が難しい内容のお問合せも多く寄せられており、「せっかく問い合わせしたのに期待するサポートが得られなかった」といった残念なお声をいただいてしまうこともありました。<br>このため、すべてのユーザー様に、それぞれお持ちのライセンスやご契約に基づき適切なサポートを提供できるよう、あらためて Power BI サポート チームでご提供しておりますリアクティブ サポート範囲やベストエフォートでのご支援範囲を明確にする必要があると考え、今回の記事作成に至りました。<br>私たち Power BI サポート チームは、お問合せいただいたすべての方のお力になれるよう全力でサポートに取り組んでまいりますが、リアクティブ サポート範囲外の課題については適切なサポート サービス をご案内させていただきますことをご理解いただけると幸いです。<br>今後も、精一杯ご支援を提供していきますので、引き続き Power BI サポートをご利用くださいますようお願いいたします。  </p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。  &lt;/p&gt;
&lt;p&gt;日頃から、マイクロソフトのサポート サービスをご利用いただき誠にありがとうございます。&lt;br&gt;以前、&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/&quot;&gt;Power BI のお問い合わせについて&lt;/a&gt; の記事で、私たち Power BI サポート チームで提供しているサービスの詳細についてご紹介いたしました。&lt;br&gt;しかしながら、以下 “開発支援、コンサルティングを含む内容” については、問い合わせしようとしている内容が範囲外に該当するかどうかの判断が難しいとお声をいただくことがありました。&lt;br&gt;このため、今回の記事では、開発支援やコンサルティングに該当するお問合せはどういったものかを、より詳細にご紹介いたします。  &lt;/p&gt;
&lt;br /&gt;

&lt;blockquote&gt;
&lt;h3 id=&quot;4-開発支援、コンサルティングを含む内容&quot;&gt;&lt;a href=&quot;#4-開発支援、コンサルティングを含む内容&quot; class=&quot;headerlink&quot; title=&quot;4. 開発支援、コンサルティングを含む内容&quot;&gt;&lt;/a&gt;&lt;font color=&quot;LightCoral&quot;&gt;4. 開発支援、コンサルティングを含む内容&lt;/font&gt;&lt;/h3&gt;&lt;p&gt;レポート開発、DAX 式や M クエリの作成、Embedded 環境の開発、REST API や PowerShell でのスクリプト作成等開発にかかわる内容やコンサルティングを含む内容は当リアクティブ サポート範囲外となります。&lt;br&gt;もちろん、お客様にて開発を進めていただく中で発生した問題のトラブルシューティングについては、問題箇所に限定して 1 問 1 答でのご支援は可能です。（原因追及の可否については、上記サポート プランに基づきます。）&lt;br&gt;開発支援が必要な場合は、別途営業担当などにご相談ください。  &lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    
    <category term="PowerBI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBI/"/>
    
    <category term="お問い合わせ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B/"/>
    
    <category term="サポート範囲" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E7%AF%84%E5%9B%B2/"/>
    
  </entry>
  
  <entry>
    <title>Azure AD の外部コラボレーションの設定が与える影響について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_guest_user_access_restrict/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_guest_user_access_restrict/</id>
    <published>2023-04-29T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.507Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山本です。<br>ゲスト ユーザーに関する Power BI の動作については、以前私たちのブログ記事 <a href="https://jpbap-sqlbi.github.io/blog/powerbi/aad_guestuser/">組織外のユーザーに対する Power BI コンテンツの共有</a> でご紹介させていただきました。</p><p>ゲスト ユーザーを招待する側のテナントの管理者様によっては「Power BI のコンテンツはアクセスさせてもよいが、テナント内のユーザー情報が見えてしまうのは避けたい」というようなご意見をいただくことがあります。<br>上記動作は Azure Active Directory (以下 Azure AD) に存在する外部コラボレーションの設定 (ゲストユーザーのアクセス許可に関する設定) で変更することが可能です。<br>今回は、外部コラボレーションの設定とは何か、また設定がどのように影響するか、各設定値による動作を検証ベースで確認した内容をご紹介いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に検証を踏まえた結果として構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ul><li><a href="#%E7%9B%AE%E6%AC%A1">目次</a></li><li><a href="#%E5%A4%96%E9%83%A8%E3%82%B3%E3%83%A9%E3%83%9C%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%81%A8%E3%81%AF">外部コラボレーションの設定とは</a></li><li><a href="#%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E5%BD%B1%E9%9F%BF%E3%81%99%E3%82%8B%E3%81%8B">どのように影響するか</a><ul><li><a href="#%E5%89%8D%E6%8F%90">前提</a></li><li><a href="#%E5%88%B6%E9%99%90%E3%81%8C%E6%9C%80%E3%82%82%E5%B0%91%E3%81%AA%E3%81%84">制限が最も少ない</a></li><li><a href="#%E5%88%B6%E9%99%90%E4%BB%98%E3%81%8D%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9-%E6%97%A2%E5%AE%9A--%E6%9C%80%E3%82%82%E5%88%B6%E9%99%90%E3%81%8C%E5%A4%9A%E3%81%84">制限付きアクセス (既定) / 最も制限が多い</a></li></ul></li><li><a href="#%E3%81%A9%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E8%A8%AD%E5%AE%9A%E3%81%97%E3%81%A6%E3%81%8A%E3%81%8F%E3%81%B9%E3%81%8D%E3%81%8B">どのように設定しておくべきか</a></li></ul><hr><h2 id="外部コラボレーションの設定とは"><a href="#外部コラボレーションの設定とは" class="headerlink" title="外部コラボレーションの設定とは"></a>外部コラボレーションの設定とは</h2><hr><p>Azure AD には、テナントに招待したゲスト ユーザーに対して、組織内のユーザーとグループ メンバーシップの表示を制限する設定があります。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>遷移方法：</p><p>Azure Active Directory の管理メニュー [ユーザーのプロパティ] をクリックし、[外部コラボレーションの設定を管理します] の文字をクリックすると、設定画面が表示されます。</p></div><p>この設定には、以下３つのアクセス レベルがあります。</p><table><thead><tr><th>アクセス許可レベル</th><th>アクセス レベル</th></tr></thead><tbody><tr><td>制限が最も少ない</td><td>ゲスト ユーザーは、メンバーと同じアクセス権を持ちます</td></tr><tr><td>制限付きアクセス (既定)</td><td>ゲスト ユーザーは、ディレクトリ オブジェクトのプロパティとメンバーシップへのアクセスが制限されます</td></tr><tr><td>最も制限が多い</td><td>ゲスト ユーザーのアクセスは、各自のディレクトリ オブジェクトのプロパティとメンバーシップに制限されます</td></tr></tbody></table><div align="center"><img src="1.png"></div><p>既定値は「制限付きアクセス」レベルとなっており、特定のオブジェクト ID を元に照会することはできるものの、ユーザー一覧が確認できなかったり、グループが確認できない状態です。<br>さらに制限の強い「最も制限が多い」レベルでは、ゲスト ユーザー自身のプロパティ情報のみが確認できる状態となります。<br>一方「制限が最も少ない」レベルでは、管理者ではないメンバー ユーザーと同じアクセス権で組織内のユーザーとグループ メンバーシップの表示を行なうことができるようになります。</p><p>より詳細な動作については、弊社 Azure ID サポートチームのブログ記事「<a href="https://jpazureid.github.io/blog/azure-active-directory/external-collaboration-setting-b2b-access/">外部コラボレーションの設定 (ゲスト ユーザーのアクセス制限) について</a>」にて紹介されておりますので、こちらも合わせてご確認ください。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>ゲスト ユーザー アクセスを構成するには、全体管理者ロールである必要があります。</p><p>またゲスト アクセスを制限するための追加のライセンス要件はありません。</p><p><a href="https://learn.microsoft.com/ja-jp/azure/active-directory/enterprise-users/users-restrict-guest-permissions#update-in-the-azure-portal">Azure Active Directory でゲストのアクセス許可を制限する</a></p></div></br><hr><h2 id="どのように影響するか"><a href="#どのように影響するか" class="headerlink" title="どのように影響するか"></a>どのように影響するか</h2><hr><p>各アクセス レベルは、Power BI サービスでテナント ディレクトリのユーザーやグループを参照する機能で影響を受けることになります。<br>ユーザーやグループを参照する具体的な機能は以下です。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-comment">コメント機能</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-share-dashboards#share-a-report-via-link">共有リンク機能</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-share-dashboards#manage-permissions-to-a-report">直接アクセス許可の追加</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-give-access-new-workspaces">ワークスペース アクセスの追加</a></li></ul><p>上記機能においてアクセス レベルを変更した場合、結論として以下のような動作となります。</p><table><thead><tr><th>アクセス許可レベル</th><th>Power BI でのゲストユーザーの動作</th></tr></thead><tbody><tr><td>制限が最も少ない</td><td>ゲストユーザーはテナント内のユーザーやグループの候補検索やメールアドレスの指定が可能</td></tr><tr><td>制限付きアクセス (既定) ／ </br>最も制限が多い</td><td>ゲストユーザーはテナント内のユーザーやグループの候補検索やメールアドレスの指定が不可</td></tr></tbody></table><div class="alert is-success"><p class="alert-title">ヒント</p><p>ゲストユーザーに Power BI 管理者の役割が割り当てられている場合、全てのリソースの基本プロパティを読み取るアクセス許可が付与されるため、本機能の制限は受けません。</p><p>参考: <a href="https://learn.microsoft.com/ja-JP/azure/active-directory/roles/permissions-reference?WT.mc_id=365AdminCSH#power-bi-administrator">Azure AD の組み込みロール - Power BI 管理者</a></p></div></br><h3 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h3><p>今回、テストシナリオとして、テナント B のユーザー「Adele」が、テナント A のゲスト ユーザーとして、Power BI ワークスペース「Guest Share」のビューアーロールとしてアクセス権を持っているものとします。</p><div align="center"><img src="6.png"></div><p>またワークスペース「Guest Share」には「Guest Share Report」があり、Adele には再共有のアクセスが付与されています。</p><div align="center"><img src="7.png"></div><p>さらにゲスト ユーザーに関するテナント設定「Azure Active Directory のゲスト ユーザーによる Power BI へのアクセスを許可する」「組織への外部ユーザーの招待」「Azure Active Directory のゲスト ユーザーによる組織内のコンテンツの編集および管理を許可する」は有効化されている状態とします。<br>候補リストにゲスト ユーザーが表示される「また候補者のリストに Azure Active Directory のゲストを表示する」も有効化されています。</p><div align="center"><img src="8.png"></div></br><h3 id="制限が最も少ない"><a href="#制限が最も少ない" class="headerlink" title="制限が最も少ない"></a>制限が最も少ない</h3><p>制限が最も少ないアクセス レベルでは、テナントのユーザーやグループの候補検索が制限なく可能になります。<br>またテナント設定「また候補者のリストに Azure Active Directory のゲストを表示する」が有効化されている場合、テナント A に属する自身以外のゲスト ユーザーも候補検索が可能です。<br>（レポートやダッシュボードのコメント機能についてはゲスト ユーザーへのメンション機能はありません）</p><p>//リンク共有</p><div align="center"><img src="9.png" width=40%></div></br><p>//コメント機能でのメンション</p><div align="center"><img src="11.png" width=40%></div></br><h3 id="制限付きアクセス-既定-最も制限が多い"><a href="#制限付きアクセス-既定-最も制限が多い" class="headerlink" title="制限付きアクセス (既定) / 最も制限が多い"></a>制限付きアクセス (既定) / 最も制限が多い</h3><p>制限付きアクセス (既定) や最も制限が多いアクセス レベルでは、候補検索もできず、メールアドレスでの一致指定もできません。<br>Power BI に影響する部分としては両設定に違いはありません。</p><p>//リンク共有</p><div align="center"><img src="10.png" width=40%></div></br><p>//コメント機能でのメンション</p><div align="center"><img src="2.png" width=40%></div></br><p>またテナント設定「組織への外部ユーザーの招待」を有効化している場合でも、ゲスト ユーザーからの <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-azure-ad-b2b#ad-hoc-invites">アドホック招待</a> はできなくなります。</p><div align="center"><img src="14.png"></div></br><hr><h2 id="どのように設定しておくべきか"><a href="#どのように設定しておくべきか" class="headerlink" title="どのように設定しておくべきか"></a>どのように設定しておくべきか</h2><hr><p>ゲスト ユーザーに対して Power BI の機能は使わせたいが、組織内のユーザー情報は検索候補に表示させたくない、という場合にはアクセス レベルを「制限付きアクセス (既定)」または「最も制限が多い」に変更しておくことをお勧めいたします。</p></br></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山本です。&lt;br&gt;ゲスト ユーザーに関する Power BI の動作については、以前私たちのブログ記事 &lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/aad_guestuser/&quot;&gt;組織外のユーザーに対する Power BI コンテンツの共有&lt;/a&gt; でご紹介させていただきました。&lt;/p&gt;
&lt;p&gt;ゲスト ユーザーを招待する側のテナントの管理者様によっては「Power BI のコンテンツはアクセスさせてもよいが、テナント内のユーザー情報が見えてしまうのは避けたい」というようなご意見をいただくことがあります。&lt;br&gt;上記動作は Azure Active Directory (以下 Azure AD) に存在する外部コラボレーションの設定 (ゲストユーザーのアクセス許可に関する設定) で変更することが可能です。&lt;br&gt;今回は、外部コラボレーションの設定とは何か、また設定がどのように影響するか、各設定値による動作を検証ベースで確認した内容をご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="ゲストユーザー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B2%E3%82%B9%E3%83%88%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC/"/>
    
    <category term="アクセス許可" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E8%A8%B1%E5%8F%AF/"/>
    
    <category term="管理者向け" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E7%AE%A1%E7%90%86%E8%80%85%E5%90%91%E3%81%91/"/>
    
  </entry>
  
  <entry>
    <title>Power BI の既知の問題や障害に関する公開情報について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_knownissue/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_knownissue/</id>
    <published>2023-04-27T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.523Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI Desktop や Power BI サービスを使用していて、「この動作は不具合なのでは？」「もしかして障害が発生しているのかな？」と思ったことはありますか？<br>そのようなときは、まずは落ち着いて以下でご案内する公開情報をもとに既知の問題や障害に該当している可能性がないかご確認いただきますようお願いいたします。  </p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="公開情報のご案内"><a href="#公開情報のご案内" class="headerlink" title="公開情報のご案内 "></a><font color="DodgerBlue">公開情報のご案内 </font></h2><h3 id="Power-BI-の既知の問題"><a href="#Power-BI-の既知の問題" class="headerlink" title="Power BI の既知の問題"></a><font color="HotPink">Power BI の既知の問題</font></h3><p><font color="SlateGray">対象：ユーザー様、管理者様向け</font>  </p><p>影響度がおおきいものについては以下公開情報に既知の問題として一覧でまとめられています。<br>不具合が疑われる動作を確認した際は、まずは以下一覧にある問題に該当していないかご確認ください。  </p><p>参考情報：<br><a href="https://learn.microsoft.com/ja-jp/power-bi/troubleshoot/known-issues/power-bi-known-issues">Power BI の既知の問題</a> </p><h3 id="サービスレベルの停止"><a href="#サービスレベルの停止" class="headerlink" title="サービスレベルの停止"></a><font color="HotPink">サービスレベルの停止</font></h3><p><font color="SlateGray">対象：ユーザー様、管理者様向け</font>  </p><p>クラウドサービスである Power BI サービスにアクセスできない、レポートを表示できないなど、サービスの停止や低下が疑われる場合は、こちらサポートページの [ リージョンごとのサービス状態 ] [ サービスの停止/低下 ] をご確認ください。<br>また、こちらのページの [ 認識 ] には、修正が近い将来に行われるような緊急度の高い問題について、その問題の詳細や今後予定されている修正スケジュールが報告されることもあり、解決されるとお知らせから削除されます。  </p><div align="center"><img src="1.png"></div></p><p>参考情報：<br><a href="https://powerbi.microsoft.com/ja-jp/support/">Power BI のサポート</a> </p><h3 id="Microsoft-365-サービス-正常性"><a href="#Microsoft-365-サービス-正常性" class="headerlink" title="Microsoft 365 サービス 正常性"></a><font color="HotPink">Microsoft 365 サービス 正常性</font></h3><p><font color="SlateGray">対象：管理者様向け</font>  </p><p>クラウドサービスで問題が発生している場合に、対象テナントやリージョンの Microsoft 365 管理センターの “サービス正常性” ページで報告されることもあります。<br>“未解決の問題”の[影響を受けたサービス]や、”Microsoft サービスの正常性” の[サービス]の覧に Power BI に関する報告がないかご確認ください。</p><p>参考情報：<br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/enterprise/view-service-health?view=o365-worldwide">How to check Microsoft 365 service health</a></p><div align="center"><img src="2.png"></div></p><h3 id="Azure-正常性（Embedded）"><a href="#Azure-正常性（Embedded）" class="headerlink" title="Azure 正常性（Embedded）"></a><font color="HotPink">Azure 正常性（Embedded）</font></h3><p><font color="SlateGray">対象：管理者様向け</font><br>Embedded をご運用されている場合は、Azure ポータルの Power BI Embedded リソースの “リソースの正常性” にてリソースの状況をご確認ください。</p><div align="center"><img src="3.png"></div></p><h3 id="サービス中断の通知"><a href="#サービス中断の通知" class="headerlink" title="サービス中断の通知"></a><font color="HotPink">サービス中断の通知</font></h3><p><font color="SlateGray">対象：管理者様向け</font><br>Premium 容量のみとなりますが、サービスの中断や停止がある場合に、Power BI からのインシデント通知をメールで受け取ることができます。<br>以下公開情報にて設定方法やメール送信されるシナリオ等をご案内しています。</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/support/service-interruption-notifications">サービス中断の通知</a></p><h2 id="サポートからのご案内"><a href="#サポートからのご案内" class="headerlink" title="サポートからのご案内"></a><font color="DodgerBlue">サポートからのご案内</font></h2><p>・公開情報で報告されている問題についてお問合せいただいても、基本的には公開情報以上の内部情報はご案内できませんので、定期的に公開情報の更新をご確認いただきますようお願いいたします。  </p></p><p>・公開情報で報告されているもの以外に、弊社サポートサービスへいただいたお問合せの調査の中で見つかる問題があります。<br>  影響範囲がおおきいものについては、公開情報にてお知らせされる場合がありますが、基本的にその他の問題については、セキュリティや機密情報保持等の関係上公開しておりません。<br>  なお、問題が確認されたあと、開発部門にて今後の修正スケジュールの調整・対応が行われますが、数か月以上かかるものがほとんどで、なかには半年以上かかるものや影響度や暫定対処策の有無によって今後のスケジュールが未定のままとなることもあります。<br>  このような公開されていない問題については、お問合せベースで進捗状況や今後のスケジュールをご案内することはできませんので、あらかじめご了承ください。<br>  Power BI Desktop および Power BI サービスは定期的に更新が行われていますので、ユーザー様・管理者様にて動作をご確認いただきますようお願いいたします。  </p></p></p>   以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。<p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI Desktop や Power BI サービスを使用していて、「この動作は不具合なのでは？」「もしかして障害が発生しているのかな？」と思ったことはありますか？&lt;br&gt;そのようなときは、まずは落ち着いて以下でご案内する公開情報をもとに既知の問題や障害に該当している可能性がないかご確認いただきますようお願いいたします。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerBI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBI/"/>
    
    <category term="knownissue" scheme="https://jpbap-sqlbi.github.io/blog/tags/knownissue/"/>
    
    <category term="既知の問題" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%97%A2%E7%9F%A5%E3%81%AE%E5%95%8F%E9%A1%8C/"/>
    
    <category term="不具合" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E4%B8%8D%E5%85%B7%E5%90%88/"/>
    
    <category term="bug" scheme="https://jpbap-sqlbi.github.io/blog/tags/bug/"/>
    
    <category term="障害" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E9%9A%9C%E5%AE%B3/"/>
    
    <category term="Outage" scheme="https://jpbap-sqlbi.github.io/blog/tags/Outage/"/>
    
    <category term="Degradation" scheme="https://jpbap-sqlbi.github.io/blog/tags/Degradation/"/>
    
  </entry>
  
  <entry>
    <title>Power BI で ExpressRoute の使用について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_expressroute/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_expressroute/</id>
    <published>2023-03-31T07:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.479Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのチャンです。<br>オンプレミス環境と Microsoft クラウドサービスの間に、プライベートな通信ルートで接続できる Microsoft Azure ExpressRoute という機能がございます。<br>Power BI の公式情報では詳細な記載がない場合が多いため、お客様よりよくご質問いただく内容につきまして、本ブログにてまとめてご紹介いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="Microsoft-Azure-ExpressRoute-とは"><a href="#Microsoft-Azure-ExpressRoute-とは" class="headerlink" title="Microsoft Azure ExpressRoute とは"></a>Microsoft Azure ExpressRoute とは</h2><hr><p>Microsoft Azure ExpressRoute では、専用のプライベート接続を使用してオンプレミスのネットワークを Microsoft Cloud Services に接続できます。<br>サービスの名前は Azure ExpressRoute ですが、Microsoft 365、Microsoft Power Platform、Dynamics 365 などの Azure 上に構築されたサービスへのプライベート接続もサポートしています。</p><div align="center"><img src="https://learn.microsoft.com/ja-jp/power-platform/guidance/expressroute/media/expressroute-overview.png"></div><hr><h2 id="Power-BI-で-ExpressRoute-を使用するには"><a href="#Power-BI-で-ExpressRoute-を使用するには" class="headerlink" title="Power BI で ExpressRoute を使用するには"></a>Power BI で ExpressRoute を使用するには</h2><hr><h4 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h4><p>お客様のオンプレミスのご環境から、 Power BI への接続において ExpressRoute をご利用いただくには、ExpressRoute のプロバイダーをご契約いただいた上で、お客様側の企業ネットワークにて ExpressRoute を経由するよう、ネットワークのルーティングを設定いただく必要がございます。</p><p>Power BI への接続においては、 Microsoft ピアリングを利用することとなりますが、ExpressRoute 回線が Azure Microsoft ピアリングに対して有効になっている場合は、Azure 内で使用されている <a href="https://learn.microsoft.com/ja-jp/azure/virtual-network/ip-services/public-ip-addresses#public-ip-addresses">パブリック IP アドレスの範囲</a> に回線経由でアクセスできます。</p><p>Power BI は Azure 上に構築されており、 Azure リージョン コミュニティを介して ExpressRoute を使用できます。Power BI テナントのリージョンを確認する方法については、<a href="https://learn.microsoft.com/ja-jp/power-bi/service-admin-where-is-my-tenant-located">こちら</a> をご確認ください。</p><blockquote><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-locations-providers">ExpressRoute のピアリングの場所と接続パートナー - Power BI | Microsoft Learn</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-faqs#microsoft-peering">Microsoft ピアリング | ExpressRoute の FAQ - Power BI | Microsoft Learn</a></li></ul></blockquote></br><h4 id="設定方法"><a href="#設定方法" class="headerlink" title="設定方法"></a>設定方法</h4><p>ExpressRoute の利用において、Power BI 側にて管理者による特別の設定は必要ございません。</p><p>お客様のネットワークから、Power BI への接続に関して、ExpressRoute を経由するよう、「 <a href="https://learn.microsoft.com/ja-jp/power-bi/admin/power-bi-allow-list-urls">Power BI URL を許可リストに追加する</a>」という公開情報に記載されているエンドポイント に対してお客様の企業ネットワークのルーティング対象として設定いただくことが必要な作業として考えられます。</p><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/admin/power-bi-allow-list-urls">Power BI URL を許可リストに追加する - Power BI | Microsoft Learn</a></br></li></ul></blockquote><p>しかしながら、上記の許可リストに記載されている一部の通信においては、ExpressRoute を経由することがサポートされていません。</p><p>一例としては、<a href="https://learn.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide#microsoft-365-common-and-office-online">Microsoft 365 Common と Office Online の URL</a> に記載されているエンドポイントで、「認証」セッションに含まれる Power BI サービスへサインイン時に使用される Azure AD 認証など、 ExpressRoute 非対応のものが一部含まれています。</p><p>そのため、Power BI へのアクセスにおいて、すべてのエンドポイントを ExpressRoute へ経由することができませんので、企業ネットワークにてインターネット接続をブロックしてしまうと、Power BI をご利用いただくのに支障が出る可能性があることをご理解ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>なお、ExpressRoute をお客様の企業内のネットワークにて、どのようにルーティングされるかは、各企業様によって実際の方法が異なりますので、弊サポートから詳細な手順をご案内することができません。予めご了承ください。</p><p></br></p></div><hr><h2 id="よくある質問"><a href="#よくある質問" class="headerlink" title="よくある質問"></a>よくある質問</h2><hr><h4 id="Q1：ExpressRoute-を利用して-Power-BI-へ接続したいが、Power-BI-で何か設定する必要がありますか。"><a href="#Q1：ExpressRoute-を利用して-Power-BI-へ接続したいが、Power-BI-で何か設定する必要がありますか。" class="headerlink" title="Q1：ExpressRoute を利用して Power BI へ接続したいが、Power BI で何か設定する必要がありますか。"></a>Q1：ExpressRoute を利用して Power BI へ接続したいが、Power BI で何か設定する必要がありますか。</h4><p><strong>A1：</strong> Power BI 側にて管理者による特別の設定は必要ございません。お客様のネットワークで ExpressRoute を経由するよう設定いただく必要があります。</p></br><h4 id="Q2：ExpressRoute-を設定したらインターネット経由の接続ができなくなりますか。"><a href="#Q2：ExpressRoute-を設定したらインターネット経由の接続ができなくなりますか。" class="headerlink" title="Q2：ExpressRoute を設定したらインターネット経由の接続ができなくなりますか。"></a>Q2：ExpressRoute を設定したらインターネット経由の接続ができなくなりますか。</h4><p><strong>A2：</strong> Power BI サービス側では、インターネットから直接受信するトラフィックはブロックしません。また、ExpressRoute は、インターネットから直接受信したトラフィックからの応答をブロックしません。</p><p>ExpressRoute をご利用いただくにあたり、以下の2点を認識いただくことが重要です。</p><ul><li><p>お客様の企業ネットワーク内からのトラフィックが ExpressRoute を使用することを保証しないこと。 企業ネットワーク内のプロキシルールとルーティング ルールがこれを決定するため、企業ネットワーク内からの要求が ExpressRoute を使用するように設定する必要があること。</p></li><li><p>他の接続 (たとえば、インターネット上のユーザー) が Power BI へのダイレクト アクセスすることをブロックしないこと</p></li></ul><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/guidance/expressroute/setup#client-traffic">クライアント トラフィック | ExpressRoute を Microsoft Power Platform 用に設定する - Power BI | Microsoft Learn</a></li></ul></blockquote><p>もし Power BI サービス側で、インターネットからのアクセスを禁止したい場合は、代わりに、Azure Private Link のご利用をご検討ください。</p><p>詳細につきましては、以下のブログ記事と公開情報をご参照いただけますと幸いです。</p><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="../pbi_privatelink">Power BI Service へのアクセス制御② Azure Private Link</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-private-links">Power BI へのセキュリティで保護されたアクセスのためのプライベート エンドポイント - Power BI | Microsoft Learn</a></li></ul></blockquote></br><h4 id="Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute-を利用できますか。"><a href="#Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute-を利用できますか。" class="headerlink" title="Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute を利用できますか。"></a>Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute を利用できますか。</h4><p><strong>A3：</strong> はい、ご利用いただけます。Power BI サービスと同様に、オンプレミスデータゲートウェイ側にて特別の設定は必要ございません。お客様の企業ネットワークにて対象の通信設定を実施する場合、以下の公開情報にて必要な通信エンドポイントをご確認ください。</p><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-communication">Port | オンプレミス データ ゲートウェイの通信設定を調整する - Power BI | Microsoft Learn</a></li></ul></blockquote><p>しかしながら、オンプレミスデータゲートウェイがインストールされている環境でインターネットアクセスを完全にブロックしてしまった場合、一部正しく通信できないエンドポイントがございますので、ご留意ください。</p><p>具体的には、Azure Active Directory (Azure AD) と OAuth2 認証部分において、ExpressRoute 非対応のエンドポイントが含まれています。</p></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><blockquote><p><strong>本ブログの関連記事</strong></p><ul><li><a href="../pbi_pbiservice_network/">Power BI の通信設定</a></li><li><a href="../pbi_privatelink">Power BI Service へのアクセス制御② Azure Private Link</a></li></ul></blockquote></br><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのチャンです。&lt;br&gt;オンプレミス環境と Microsoft クラウドサービスの間に、プライベートな通信ルートで接続できる Microsoft Azure ExpressRoute という機能がございます。&lt;br&gt;Power BI の公式情報では詳細な記載がない場合が多いため、お客様よりよくご質問いただく内容につきまして、本ブログにてまとめてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Express Route" scheme="https://jpbap-sqlbi.github.io/blog/tags/Express-Route/"/>
    
    <category term="通信" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E9%80%9A%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>よくある「並べ替え」のお問い合わせ</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_sorting/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_sorting/</id>
    <published>2023-03-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.915Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Power BI でレポートを作成しているとき、ビジュアル内のデータの「並べ替え」を行いたいことがあると思います。<br>今回は「並べ替え」についてよくあるお問い合わせと、その代表的な解決策をご紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><p> <a href="#%E5%89%8D%E6%8F%90%EF%BC%9A%E3%83%93%E3%82%B8%E3%83%A5%E3%82%A2%E3%83%AB%E3%81%AE%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%80%8C%E8%BB%B8%E3%81%AE%E4%B8%A6%E3%81%B3%E6%9B%BF%E3%81%88%E3%80%8D">前提：ビジュアルのメニュー「軸の並び替え」</a><br> <a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%91%EF%BC%9A%E5%88%97%E3%81%8C%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E5%9E%8B%E3%81%A7%E3%81%82%E3%82%8B%E3%81%9F%E3%82%81%E6%84%8F%E5%9B%B3%E3%81%97%E3%81%9F%E9%A0%86%E3%81%AB%E3%81%AA%E3%82%89%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88">ケース１：列がテキスト型であるため意図した順にならない場合</a><br> <a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%92%EF%BC%9A%EF%BC%92%E3%81%A4%E3%81%AE%E5%88%97%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%80%8C%E4%B8%A6%E3%81%B3%E6%9B%BF%E3%81%88%E3%80%8D%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88">ケース２：２つの列を使って「並び替え」したい場合</a></p><hr><h2 id="前提：ビジュアルのメニュー「軸の並び替え」"><a href="#前提：ビジュアルのメニュー「軸の並び替え」" class="headerlink" title="前提：ビジュアルのメニュー「軸の並び替え」"></a>前提：ビジュアルのメニュー「軸の並び替え」</h2><hr><p>ビジュアル内のフィールドで並べ替え（昇順/降順）をしたい場合は、以下図の手順で可能です。</p><p>ビジュアル右上 (…) &gt; 軸の並べ替え &gt; フィールド名と昇順/降順を選択</p><div align="center"><img src="1.png"></div></br><p>凡例についても、凡例に使用している列で「並べ替え」を行うことが可能です。</p></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort">レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn</a></p></div></br><hr><h2 id="ケース１：列がテキスト型であるため意図した順にならない場合"><a href="#ケース１：列がテキスト型であるため意図した順にならない場合" class="headerlink" title="ケース１：列がテキスト型であるため意図した順にならない場合"></a>ケース１：列がテキスト型であるため意図した順にならない場合</h2><hr><p>特定の列で並べ替えをしようと思っても、列がテキスト型である場合は意図した順にならず、<br>テキストによる並び順になってしまいます（見た目が数値でも）</p><p>例） X軸の「月（テキスト型）」で昇順にした場合。1から始まる名称が先頭に並んでいる</p><div align="center"><img src="2.png"></div> </br><p>この問題を解決するには、根本的にはデータアーキテクトの観点でデータソース側のデータの持ち方を変更するということが<br>重要な場合もありますが、Power BI 上でどうにかしたいという場合は、別の列をもとに並べ替えるという解決策があります。<br>具体的な手順は以下です。</p></br><p>ステップ１：並べ替えのもととなる数値型の列を作成する（すでにある場合はステップ２へ）</p><p>① Power Query エディタを開く<br>Power BI Desktop &gt; ホーム &gt; データの変換</p><div align="center"><img src="3.png"></div></br><p>② 列を作成する（以下は一例です。シナリオによっては別の方法で列を作成します）<br>列の追加 &gt; 例からの列 &gt; 選択範囲から &gt; 例をいくつか入力すると法則から値が自動入力される</p><div align="center"><img src="4.png"></div></br><p>③ Power Query エディタを閉じて適用する</p><div align="center"><img src="5.png"></div></br><p>ステップ２ ： 「列で並べ替え」を設定する</p><p>テキスト型のフィールドを選択 &gt; 列で並べ替え &gt; 作成した数値型の列を選択する</p><div align="center"><img src="6.png"></div></br><p>ステップ３：[軸の並べ替え] をすると、裏側では数値型をもとにして並び替えが完了する</p><div align="center"><img src="7.png"></div></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-sort-by-column?tabs=powerbi-desktop">Power BI で 1 つの列をほかの列で並べ替える - Power BI | Microsoft Learn</a></p></div></br><hr><h2 id="ケース２：２つの列を使って「並び替え」したい場合"><a href="#ケース２：２つの列を使って「並び替え」したい場合" class="headerlink" title="ケース２：２つの列を使って「並び替え」したい場合"></a>ケース２：２つの列を使って「並び替え」したい場合</h2><hr><p>列１の値の中で重複するものが存在していて、列２の値も含めて並べ替えをしたい場合、<br>列１の並べ替えを実施した後に、Shift キーを押しながら列２のヘッダーをクリックすると、<br>列１の並べ替えを保持したまま、列２の並べ替えを設定することが可能です。</p><p>以下テーブルビジュアルを例にご説明いたします。<br>「列１」をクリックして並べ替えをした後、Shift キーを押しながら「列2」をクリックします。すると、列１内で重複した値 “3” や “2” に対する列２の値が、それぞれ降順で並べ替えられているのがわかります。</p><p>※昇順と降順の切り替えは、Shift キーを押したままもう一度ヘッダーをクリックする</p><div align="center"><img src="8.png"></div></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort">レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn</a></p></div></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Power BI でレポートを作成しているとき、ビジュアル内のデータの「並べ替え」を行いたいことがあると思います。&lt;br&gt;今回は「並べ替え」についてよくあるお問い合わせと、その代表的な解決策をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>XMLAエンドポイント</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_xmlaendpoint/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_xmlaendpoint/</id>
    <published>2023-03-30T15:00:00.000Z</published>
    <updated>2023-10-01T06:20:18.955Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>Power BI Premium Per Capacity または Premium Per Userでは、XMLAエンドポイントを使用してデータセットに接続したり、更新したりすることができます。今回は  ｢XMLAエンドポイント｣ について説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88-%E3%81%A8%E3%81%AF">XMLAエンドポイント とは</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A">XMLAエンドポイントの設定</a><ul><li><a href="#%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%8B%E3%82%89XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">テナント設定からXMLAエンドポイントの設定を有効化する</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-Capacity">XMLAエンドポイントの設定 (Power BI Premium Per Capacity)</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-User">XMLAエンドポイントの設定 (Power BI Premium Per User)</a></li></ul></li><li><a href="#SQL-Server-Management-Studio-SSMS-%E3%81%8B%E3%82%89%E3%81%AE%E6%8E%A5%E7%B6%9A">SQL Server Management Studio (SSMS) からの接続</a></li><li><a href="#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3">セキュリティ</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E5%88%A9%E7%94%A8">XMLAエンドポイントの利用</a><ul><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88">XMLAエンドポイントを利用したエクスポート</a>    </li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E6%9B%B4%E6%96%B0">XMLAエンドポイントを利用したデータセットの更新</a><ul><li><a href="#SSMS%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">SSMSを利用したデータセット更新</a></li><li><a href="#PowerShell%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">PowerShellを利用したデータセット更新</a></li></ul></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97%EF%BD%A5%E5%BE%A9%E5%85%83">データセットのバックアップ･復元</a><ul><li><a href="#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97">バックアップ</a></li><li><a href="#%E5%BE%A9%E5%85%83">復元</a></li></ul></li></ul></li></ul><h2 id="XMLAエンドポイント-とは"><a href="#XMLAエンドポイント-とは" class="headerlink" title="XMLAエンドポイント とは"></a>XMLAエンドポイント とは</h2><p>XMLAとは、 <strong>XML for Analysis</strong> の略称で、Microsoft Analysis Services エンジンによって使用される通信プロトコルを指します。Excel や SSMS といったクライアント アプリケーションとPower BI のワークスペース･データセットを管理するエンジンとの間の通信には、この XMLA プロトコルが使用されます。これらの接続は、一般的に XMLA エンドポイントと呼ばれるものを経由します。<br>Power BI の設定では、規定で設定されている “読み取り専用” の接続により、クエリを実行してデータを取得できるほか、”読み取り/書き込み” の接続によりデータセットを更新することも可能となります。また、XMLAエンドポイントでの更新は、Power BIの更新上限 (Premiumでは48回/日) にはカウントされないといったメリットがあります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考＃ <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-connect-tools">Power BI での XMLA エンドポイントを使用したデータセットの接続と管理 - Power BI | Microsoft Learn</a></p></div><h2 id="XMLAエンドポイントの設定"><a href="#XMLAエンドポイントの設定" class="headerlink" title="XMLAエンドポイントの設定"></a>XMLAエンドポイントの設定</h2><p>Power BI でXMLAエンドポイントを利用するためには、以下の設定を行います。それぞれの設定を変更するには、Power BI 管理者や、Premium容量の管理者である必要がありますのでご留意ください。</p><ul><li><a href="#%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%8B%E3%82%89XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">テナント設定からXMLAエンドポイントの設定を有効化する</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-Capacity">XMLAエンドポイントの設定 (Power BI Premium Per Capacity)</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-User">XMLAエンドポイントの設定 (Power BI Premium Per User)</a></li></ul><h3 id="テナント設定からXMLAエンドポイントの設定を有効化する"><a href="#テナント設定からXMLAエンドポイントの設定を有効化する" class="headerlink" title="テナント設定からXMLAエンドポイントの設定を有効化する"></a>テナント設定からXMLAエンドポイントの設定を有効化する</h3><p>テナントでXMLAエンドポイントを有効化するには、管理ポータルにアクセスし、 <strong>[テナント設定]</strong> &gt; <strong>[統合の設定]</strong> &gt; <strong>[XMLAエンドポイントとオンプレミスのデータセットによる “Excelで分析” の許可]</strong> を有効化します。</p><div align="center"><img src="xmla01.png"></div>  <h3 id="XMLAエンドポイントの設定-Power-BI-Premium-Per-Capacity"><a href="#XMLAエンドポイントの設定-Power-BI-Premium-Per-Capacity" class="headerlink" title="XMLAエンドポイントの設定 (Power BI Premium Per Capacity)"></a>XMLAエンドポイントの設定 (Power BI Premium Per Capacity)</h3><p>XMLAエンドポイントは規定では “読み取り専用” に設定されていますが、無効化したい場合や、”読み取り/書き込み” に設定を変更したい場合は、以下の手順で設定を変更します。</p><p>管理ポータルを開き、 <strong>[容量の設定]</strong>  から容量を選択します。</p><div align="center"><img src="xmla02.png"></div>  <p><strong>[ワークロード]</strong> &gt; <strong>[XMLA エンドポイント]</strong> の設定を変更します。</p><div align="center"><img src="xmla03.png"></div>  <h3 id="XMLAエンドポイントの設定-Power-BI-Premium-Per-User"><a href="#XMLAエンドポイントの設定-Power-BI-Premium-Per-User" class="headerlink" title="XMLAエンドポイントの設定 (Power BI Premium Per User)"></a>XMLAエンドポイントの設定 (Power BI Premium Per User)</h3><p>Power BI Premium Per UserでXMLAエンドポイントの設定を変更したい場合は、以下の手順になります。</p><p>管理ポータルを開き、 <strong>[Premium Per User]</strong> &gt; <strong>[データセットのワークロード設定]</strong> &gt; <strong>[XMLA エンドポイント]</strong> の設定を変更します。</p><div align="center"><img src="xmla04.png"></div>  <h2 id="SQL-Server-Management-Studio-SSMS-からの接続"><a href="#SQL-Server-Management-Studio-SSMS-からの接続" class="headerlink" title="SQL Server Management Studio (SSMS) からの接続"></a>SQL Server Management Studio (SSMS) からの接続</h2><p>以下の手順により、SQL Server Management Studio (SSMS) からワークスペースへ接続します。SSMSは、以下のリンクより無償でダウンロードいただくことが可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16">SQL Server Management Studio (SSMS) のダウンロード - SQL Server Management Studio (SSMS) | Microsoft Learn</a></p></div><h3 id="1-ワークスペースの接続-URL-の取得"><a href="#1-ワークスペースの接続-URL-の取得" class="headerlink" title="1.ワークスペースの接続 URL の取得"></a>1.ワークスペースの接続 URL の取得</h3><p>ワークスペースの <strong>[設定]</strong> &gt; <strong>[プレミアム]</strong> &gt; <strong>[ワークスペース接続]</strong> で <strong>[コピー]</strong> を選択します。</p><div align="center"><img src="xmla05.png"></div>  <h3 id="2-SSMSからの接続"><a href="#2-SSMSからの接続" class="headerlink" title="2.SSMSからの接続"></a>2.SSMSからの接続</h3><p>SQL Server Management Studio を開き、 <strong>[接続]</strong> &gt; <strong>[サーバーに接続]</strong> を選択します。</p><p>以下のように設定したら、 <strong>[接続]</strong> を選択します。</p><table><thead><tr><th>項目</th><th>設定</th></tr></thead><tbody><tr><td>サーバーの種類</td><td>Analysis Services</td></tr><tr><td>サーバー名</td><td>手順1で取得したワークスペースの URL</td></tr><tr><td>認証</td><td>Active Directory - MFA で汎用</td></tr><tr><td>ユーザー名</td><td>Power BI にサインインするユーザー ID</td></tr></tbody></table><div align="center"><img src="xmla06.png"></div>  <p>必要な権限のあるユーザーが接続に成功すると、ワークスペースに存在するデータセットが表示されます。</p><div align="center"><img src="xmla07.png"></div>  <h2 id="セキュリティ"><a href="#セキュリティ" class="headerlink" title="セキュリティ"></a>セキュリティ</h2><p>サインインするユーザーに割り当てられているロールが Analysis Services の権限と対応しており、それによってXMLAエンドポイントを使用して行える操作が異なります。以下がそれを整理した表になります。</p><table><thead><tr><th><strong>Power BI アクセス許可</strong></th><th><strong>Analysis Services権限</strong></th><th><strong>実際の動作</strong></th></tr></thead><tbody><tr><td>Power  BIビューアー</td><td>Analysis  Services権限ないユーザー</td><td>データベース（データセット）を参照できない</td></tr><tr><td>Power  BI共同作成者・メンバー・管理者</td><td>Analysis  Servicesデータベース管理者</td><td>新しいデータセットを配置し、SSMS で TMSL スクリプトを実行することができます。</td></tr><tr><td>データセットのビルドアクセス</td><td>Analysis  Services データベース閲覧者</td><td>データの使用と視覚化のためにデータセットに接続し、データセットを参照できます。  行レベル セキュリティ (RLS) 規則が適用され、内部データセットのメタデータを参照することはできません。</td></tr></tbody></table><p>実際の動作は以下のようになります。</p><p><strong>＜XMLAエンドポイントに接続できるが、データセットに接続できない＞</strong></p><p>（ビューアー権限）エンドポイントまたは接続できていますが、データベースの配下に何も表示されません。</p><div align="center"><img src="xmla08.png"></div>  <p><strong>＜XMLAエンドポイントに接続できて、データセットに接続できている状態（ReadまたはRead/Write）＞</strong></p><p>（共同作成者・メンバー・管理者の権限）エンドポイントまたは接続できていて、データベース配下にテーブル（データセット）が表示されています。</p><div align="center"><img src="xmla09.png"></div>  <h2 id="XMLAエンドポイントの利用"><a href="#XMLAエンドポイントの利用" class="headerlink" title="XMLAエンドポイントの利用"></a>XMLAエンドポイントの利用</h2><p>これまでXMLAエンドポイントの設定について説明してきましたが、実際の活用方法についていくつかご紹介します。</p><ul><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88">XMLAエンドポイントを利用したエクスポート</a>    </li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E6%9B%B4%E6%96%B0">XMLAエンドポイントを利用したデータセットの更新</a><ul><li><a href="#SSMS%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">SSMSを利用したデータセット更新</a></li><li><a href="#PowerShell%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">PowerShellを利用したデータセット更新</a></li></ul></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97%EF%BD%A5%E5%BE%A9%E5%85%83">データセットのバックアップ･復元</a><ul><li><a href="#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97">バックアップ</a></li><li><a href="#%E5%BE%A9%E5%85%83">復元</a></li></ul></li></ul><h3 id="XMLAエンドポイントを利用したエクスポート"><a href="#XMLAエンドポイントを利用したエクスポート" class="headerlink" title="XMLAエンドポイントを利用したエクスポート"></a>XMLAエンドポイントを利用したエクスポート</h3><p>XMLAエンドポイントへ接続し、PowerShellのコマンドを利用してデータをエクスポートすることが可能です。<br>Power BI内部で利用しているクエリを実行して取得することができますので、データセットに存在する列のみでなく、メジャーを利用した計算結果を取得することも可能です。</p><p>以下に取得方法を説明します。</p><h4 id="クエリの取得"><a href="#クエリの取得" class="headerlink" title="クエリの取得"></a>クエリの取得</h4><p>Power BI Desktopのパフォーマンス アナライザーを利用して、利用しているクエリを取得します。</p><ol><li>Power BI Desktopを開き、 <strong>[パフォーマンス アナライザー]</strong> を実行し、**[記録の開始]** を選択します。</li></ol>  <div align="center">  <img src="xmla10.png">  </div>  <ol start="2"><li><p><strong>[ビジュアルを更新します]</strong> を選択します。レポート内のビジュアルが更新されます。</p><div align="center"><img src="xmla11.png"></div>  </li><li><p>各ビジュアルの更新時間が表示されます。 <strong>[クエリのコピー]</strong> を選択します。</p><div align="center"><img src="xmla12.png"></div>  </li><li><p>メモ帳などに <strong>[貼り付け]</strong> して保存しておきます。</p><div align="center"><img src="xmla13.png"></div>  </li></ol><h4 id="コマンドの作成"><a href="#コマンドの作成" class="headerlink" title="コマンドの作成"></a>コマンドの作成</h4><p>PowerShellで実行するコマンドを作成します。動作確認のために使用しているPowerShellの環境は以下になります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="variable">$PSVersionTable</span></span><br><span class="line"></span><br><span class="line">Name                           Value</span><br><span class="line">----                           -----</span><br><span class="line">PSVersion                      <span class="number">7.3</span>.<span class="number">3</span></span><br><span class="line">PSEdition                      Core</span><br><span class="line">GitCommitId                    <span class="number">7.3</span>.<span class="number">3</span></span><br><span class="line">OS                             Microsoft Windows <span class="number">10.0</span>.<span class="number">22621</span></span><br><span class="line">Platform                       Win32NT</span><br><span class="line">PSCompatibleVersions           &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>…&#125;</span><br><span class="line">PSRemotingProtocolVersion      <span class="number">2.3</span></span><br><span class="line">SerializationVersion           <span class="number">1.1</span>.<span class="number">0.1</span></span><br><span class="line">WSManStackVersion              <span class="number">3.0</span></span><br></pre></td></tr></table></figure><p>Visual Studio Codeやメモ帳などお好みのエディタから以下のコードを入力し、.ps1ファイルとして保存します。検証のためユーザー名とパスワードを平文で含めていますが、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="string">&quot;Microsoft.AnalysisServices.AdomdClient&quot;</span>) </span><br><span class="line"><span class="variable">$PowerBIEndpoint</span> = <span class="string">&quot;powerbi://api.powerbi.com/v1.0/myorg/&lt;ワークスペース名&gt;;initial catalog=&lt;データセット名&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBILogin</span> = <span class="string">&quot;&lt;アカウント名&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBIPassword</span> = <span class="string">&quot;&lt;パスワード&gt;&quot;</span> </span><br><span class="line"><span class="variable">$Query</span> = <span class="string">&quot;&lt;取得したクエリ&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$ExportPath</span> = <span class="string">&quot;&lt;保存したいパス&gt;&quot;</span></span><br><span class="line">  </span><br><span class="line"><span class="variable">$Connection</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Data.OleDb.OleDbConnection</span><br><span class="line"><span class="variable">$Results</span> = <span class="built_in">New-Object</span> System.Data.DataTable</span><br><span class="line"><span class="variable">$Connection</span>.ConnectionString = <span class="string">&quot;Provider=MSOLAP.8;Data Source=&quot;</span>+ <span class="variable">$PowerBIEndpoint</span> +<span class="string">&quot;;UID=&quot;</span>+ <span class="variable">$PowerBILogin</span> +<span class="string">&quot;;PWD=&quot;</span>+ <span class="variable">$PowerBIPassword</span>  </span><br><span class="line"><span class="variable">$Connection</span>.Open() </span><br><span class="line"><span class="variable">$Adapter</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Data.OleDb.OleDbDataAdapter <span class="variable">$Query</span> ,<span class="variable">$Connection</span></span><br><span class="line"><span class="variable">$Adapter</span>.Fill(<span class="variable">$Results</span>) </span><br><span class="line"><span class="variable">$Results</span> | <span class="built_in">export-csv</span> <span class="literal">-Path</span> <span class="variable">$ExportPath</span>  <span class="literal">-NoTypeInformation</span></span><br><span class="line"><span class="variable">$Connection</span>.Dispose()</span><br><span class="line"><span class="variable">$Connection</span>.Close()</span><br></pre></td></tr></table></figure><p>注意するべき点として、取得したクエリ内に “” (ダブルクオーテーション) が含まれる場合には ` (バックスラッシュ) でエスケープする必要があります。例えば取得したクエリが以下の場合、</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">DEFINE</span><br><span class="line">VAR __DS0Core = </span><br><span class="line">SUMMARIZECOLUMNS(</span><br><span class="line">ROLLUPADDISSUBTOTAL(</span><br><span class="line">ROLLUPGROUP(</span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">OrderQty</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPrice</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPriceDiscount</span>]</span><br><span class="line">), <span class="string">&quot;IsGrandTotalRowTotal&quot;</span></span><br><span class="line">),</span><br><span class="line"><span class="string">&quot;MTotal&quot;</span>, <span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">MTotal</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">VAR __DS0PrimaryWindowed = </span><br><span class="line">TOPN(</span><br><span class="line"><span class="number">502</span>,</span><br><span class="line">__DS0Core,</span><br><span class="line">[<span class="type">IsGrandTotalRowTotal</span>],</span><br><span class="line"><span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">OrderQty</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPrice</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPriceDiscount</span>],</span><br><span class="line"><span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">EVALUATE</span><br><span class="line">__DS0PrimaryWindowed</span><br><span class="line"></span><br><span class="line">ORDER BY</span><br><span class="line">[<span class="type">IsGrandTotalRowTotal</span>] DESC,</span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">OrderQty</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPrice</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPriceDiscount</span>]</span><br></pre></td></tr></table></figure><p>このように記載する必要があります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Query</span> = </span><br><span class="line"><span class="string">&quot;DEFINE</span></span><br><span class="line"><span class="string">VAR __DS0Core = </span></span><br><span class="line"><span class="string">SUMMARIZECOLUMNS(</span></span><br><span class="line"><span class="string">ROLLUPADDISSUBTOTAL(</span></span><br><span class="line"><span class="string">ROLLUPGROUP(</span></span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[OrderQty],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPrice],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPriceDiscount]</span></span><br><span class="line"><span class="string"># &quot;</span>IsGrandTotalRowTotal<span class="string">&quot;をバックスラッシュでエスケープ</span></span><br><span class="line"><span class="string">), `&quot;IsGrandTotalRowTotal`&quot;</span></span><br><span class="line"><span class="string">),</span></span><br><span class="line"><span class="string"># &quot;</span>MTotal<span class="string">&quot;をバックスラッシュでエスケープ</span></span><br><span class="line"><span class="string">`&quot;MTotal`&quot;, &#x27;SalesLT SalesOrderDetail&#x27;[MTotal]</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">VAR __DS0PrimaryWindowed = </span></span><br><span class="line"><span class="string">TOPN(</span></span><br><span class="line"><span class="string">502,</span></span><br><span class="line"><span class="string">__DS0Core,</span></span><br><span class="line"><span class="string">[IsGrandTotalRowTotal],</span></span><br><span class="line"><span class="string">0,</span></span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;[Name],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;[Name],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[OrderQty],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPrice],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPriceDiscount],</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EVALUATE</span></span><br><span class="line"><span class="string">__DS0PrimaryWindowed</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ORDER BY</span></span><br><span class="line"><span class="string">[IsGrandTotalRowTotal] DESC,</span></span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[OrderQty],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPrice],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPriceDiscount]&quot;</span></span><br></pre></td></tr></table></figure><p>作成したコマンドを実行することで、指定したパスに.csvファイルが出力されます。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; C:\PBISAMPLE\xmla<span class="literal">-export</span><span class="literal">-sample</span>.ps1</span><br></pre></td></tr></table></figure><p>生成された.CSVファイル</p><div align="center"><img src="xmla14.png"></div>  <h3 id="XMLAエンドポイントを利用したデータセットの更新"><a href="#XMLAエンドポイントを利用したデータセットの更新" class="headerlink" title="XMLAエンドポイントを利用したデータセットの更新"></a>XMLAエンドポイントを利用したデータセットの更新</h3><p>XMLAエンドポイントを利用することで、データセットの更新が行うことができます。XMLAエンドポイントでの更新は、Power BIの更新上限 (Premiumでは48回/日) にはカウントされないため、頻繁にデータセットを更新する必要がある場合にご利用いただけます。</p><h4 id="SSMSを利用したデータセット更新"><a href="#SSMSを利用したデータセット更新" class="headerlink" title="SSMSを利用したデータセット更新"></a>SSMSを利用したデータセット更新</h4><p>SSMSを利用してデータセット更新について説明します。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/analysis-services/tabular-models/process-database-table-or-partition-analysis-services?view=power-bi-premium-current&preserve-view=true">データベース、テーブル、またはパーティションの処理 (Analysis Services) | Microsoft Learn</a></p></div><ol><li><p>更新したいデータセットを右クリックし、 <strong>[データベースの処理]</strong> を選択します。</p><div align="center"><img src="xmla15.png"></div>  </li><li><p>モードを選択します。今回は例として”完全更新”を選択します。 <strong>[OK]</strong> をクリックし、更新を実行します。</p><p>それぞれのモードは以下の処理を表します。</p><table><thead><tr><th>モード</th><th>説明</th></tr></thead><tbody><tr><td><strong>既定の処理</strong></td><td>データベース オブジェクトの処理状態を検出し、処理されていないオブジェクトや部分的に処理されたオブジェクトを完全処理状態にするために必要な処理を行います。 空のテーブルとパーティションのデータが読み込まれ、階層、計算列、およびリレーションシップが構築または再構築 (再計算) されます。</td></tr><tr><td><strong>完全処理</strong></td><td>データベースとそのデータベースに含まれるすべてのオブジェクトを処理します。 既に処理されているオブジェクトに対して完全処理を実行すると、SQL Server Analysis Servicesオブジェクト内のすべてのデータが削除され、そのオブジェクトが処理されます。 この種の処理は、構造上の変更をオブジェクトに加えた場合に必要となります。 このオプションは最も多くのリソースを必要とします。</td></tr><tr><td><strong>消去の処理</strong></td><td>データベース オブジェクトからすべてのデータを削除します。</td></tr><tr><td><strong>再計算の処理</strong></td><td>階層、リレーションシップ、および計算列を更新して再計算します。</td></tr></tbody></table><div align="center"><img src="xmla16.png"></div>  </li><li><p>更新が成功したことを確認します。</p><div align="center"><img src="xmla17.png"></div>  </li></ol><p>手順2で <strong>[スクリプト]</strong> を選択すると、更新のためのTMSLスクリプトが表示されます。</p><div align="center"><img src="xmla30.png"></div>  <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;refresh&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objects&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;database&quot;</span>: <span class="string">&quot;rp-xmla-test-01&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>生成されたTMSLスクリプトは、SQL Server Agent ジョブや、SQL Server Integration Services(SSIS)、PowerShellのInvoke-ASCmdコマンドからの実行が可能です。例えば、SQL Server Agent ジョブを設定することで、スケジュール更新を行うことや、SSISでのETL処理後にデータセットを更新するといったことが可能となります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/analysis-services/tmsl/refresh-command-tmsl?view=asallproducts-allversions">Refresh コマンド (TMSL) | Microsoft Learn</a></p></div><p>また、データセットをすべて更新する以外にも、テーブルを更新することや、パーティションを更新することが可能です。データセットに増分更新を設定している場合は、パーティション単位での更新を行うことで、更新範囲を限定することができ、更新のパフォーマンスを向上させることができます。</p><p>テーブルを更新したい場合には、更新したいテーブルを右クリックし、 <strong>[テーブルの処理]</strong> を選択します。</p><div align="center"><img src="xmla18.png"></div>  <p>処理モードと処理するオブジェクトを選択し、更新を行います。</p><div align="center"><img src="xmla19.png"></div>  <p>また、パーティションを更新したい場合には、更新したいパーティションを右クリックし、 <strong>[パーティション]</strong> を選択します。</p><div align="center"><img src="xmla20.png"></div>  <p><strong>[処理]</strong> を選択します。</p><div align="center"><img src="xmla21.png"></div>  <p>処理モードと処理するオブジェクトを選択し、更新を行います。</p><div align="center"><img src="xmla22.png"></div>  <p>テーブルやパーティションの更新についても、同様にTMSLスクリプトでの更新が可能です。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// テーブルの更新</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;refresh&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objects&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;database&quot;</span>: <span class="string">&quot;rp-xmla-test-01&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;table&quot;</span>: <span class="string">&quot;SalesLT ProductCategory&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// パーティションの更新</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;refresh&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objects&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;database&quot;</span>: <span class="string">&quot;rp-xmla-test-01&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;table&quot;</span>: <span class="string">&quot;SalesLT SalesOrderDetail&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;partition&quot;</span>: <span class="string">&quot;SalesLT SalesOrderDetail-a283583f-1fe4-4dc5-bd55-46106f953eea&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>増分更新やパーティションについて、以下の公開情報やブログをご確認ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/incremental-refresh-overview">Power BI でのデータセットの増分更新とリアルタイム データ - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/incremental-refresh-xmla">Power BI での XMLA エンドポイントを使用した高度な増分更新およびリアルタイム データ - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_incremental_refresh/">増分更新の概要と設定方法 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><h4 id="PowerShellを利用したデータセット更新"><a href="#PowerShellを利用したデータセット更新" class="headerlink" title="PowerShellを利用したデータセット更新"></a>PowerShellを利用したデータセット更新</h4><p>PowerShellからの更新の例として、Invoke-ProcessASDatabaseを利用したデータセット更新について説明します。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/powershell/module/sqlserver/invoke-processasdatabase?view=sqlserver-ps">Invoke-ProcessASDatabase (SqlServer) | Microsoft Learn</a></p></div><p>SQL Server PowerShell モジュールのインストールがされていない場合には、以下のコマンドでインストールを行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Install-Module</span> <span class="literal">-Name</span> SqlServer</span><br></pre></td></tr></table></figure><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/sql/powershell/download-sql-server-ps-module?view=sql-server-ver16">SQL Server PowerShell モジュールのダウンロード - SQL Server | Microsoft Learn</a></p></div><p>インストール後、以下のコマンドを実行し、Invoke-ProcessASDatabase が含まれていることを確認します。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Get-Command</span> <span class="literal">-Module</span> sqlserver</span><br></pre></td></tr></table></figure><p>含まれていない場合には、以下のコマンドを実行し、プレビュー版のインストールを行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Install-Module</span> <span class="literal">-Name</span> SqlServer <span class="literal">-AllowPrerelease</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure><p>再度以下のコマンドを実行し、Invoke-ProcessASDatabase が含まれていることを確認します。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Get-Command</span> <span class="literal">-Module</span> sqlserver</span><br></pre></td></tr></table></figure><p>インストールが完了したら、Visual Studio Codeやメモ帳などお好みのエディタから以下のコードを入力し、.ps1ファイルとして保存します。こちらも、検証のためユーザー名とパスワードを平文で含めていますが、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。以下の例では、データセットの完全更新を行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> SqlServer <span class="literal">-Version</span> <span class="number">22.0</span>.<span class="number">49</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$Workspace</span> = <span class="string">&quot;powerbi://api.powerbi.com/v1.0/myorg/&lt;ワークスペース名&gt;&quot;</span></span><br><span class="line"><span class="variable">$Database</span> = <span class="string">&quot;&lt;データセット名&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$PowerBILogin</span> = <span class="string">&quot;&lt;アカウント名&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBIPassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;&lt;パスワード&gt;&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$Credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential (<span class="variable">$PowerBILogin</span>, <span class="variable">$PowerBIPassword</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-ProcessASDatabase</span> <span class="literal">-Server</span> <span class="variable">$Workspace</span> <span class="literal">-DatabaseName</span> <span class="variable">$Database</span> <span class="literal">-Credential</span> <span class="variable">$Credential</span> <span class="literal">-RefreshType</span> Full </span><br></pre></td></tr></table></figure><p>作成したコマンドを実行することで、データセットの更新が行われます。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; C:\PBISAMPLE\xmla<span class="literal">-refresh</span><span class="literal">-sample</span>.ps1</span><br><span class="line">Impact                                          XmlaResults</span><br><span class="line">------                                          -----------</span><br><span class="line">Microsoft.AnalysisServices.Tabular.ObjectImpact &#123;Microsoft.AnalysisServices.XmlaResult&#125;</span><br></pre></td></tr></table></figure><p>テーブルを更新する場合やパーティションを更新する場合には以下のコードとなります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Invoke-ProcessTable</span> <span class="literal">-TableName</span> <span class="string">&quot;&lt;テーブル名&gt;&quot;</span> <span class="literal">-RefreshType</span> Full <span class="literal">-Server</span> <span class="variable">$Workspace</span> <span class="literal">-DatabaseName</span> <span class="variable">$Database</span> <span class="literal">-Credential</span> <span class="variable">$Credential</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># パーティションの更新</span></span><br><span class="line"><span class="built_in">Invoke-ProcessPartition</span> <span class="literal">-TableName</span> <span class="string">&quot;&lt;テーブル名&gt;&quot;</span> <span class="literal">-PartitionName</span> <span class="string">&quot;&lt;パーティション名&gt;&quot;</span> <span class="literal">-RefreshType</span> Full <span class="literal">-Server</span> <span class="variable">$Workspace</span> <span class="literal">-Database</span> <span class="variable">$Database</span> <span class="literal">-Credential</span> <span class="variable">$Credential</span></span><br></pre></td></tr></table></figure><h3 id="データセットのバックアップ･復元"><a href="#データセットのバックアップ･復元" class="headerlink" title="データセットのバックアップ･復元"></a>データセットのバックアップ･復元</h3><p>大きいデータセットのストレージ形式や増分更新を設定したデータセット、XMLAエンドポイントを利用して変更されたデータセットはダウンロードすることができませんが、SSMSからXMLAエンドポイントを利用することでバックアップや復元が可能となります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-backup-restore-dataset">Power BI Premium データセットのバックアップと復元 - Power BI | Microsoft Learn</a></p></div><h3 id="バックアップ"><a href="#バックアップ" class="headerlink" title="バックアップ"></a>バックアップ</h3><p>バックアップを行う前に、ワークスペースにAzure Data Lake Storage Gen2を接続しておく必要があります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/dataflows/dataflows-azure-data-lake-storage-integration">Azure Data Lake Gen 2 を使用するようにデータフロー ストレージを構成する - Power BI | Microsoft Learn</a></p></div><div align="center"><img src="xmla23.png"></div>  <div align="center"><img src="xmla24.png"></div>  <p>設定が完了したら、SSMSでデータベースを右クリックし、 <strong>[バックアップ]</strong> を選択します。</p><div align="center"><img src="xmla25.png"></div>  <div align="center"><img src="xmla26.png"></div>  <p>バックアップが完了すると、接続されたAzure Data Lake Storage Gen2に.adfファイルが保存されます。</p><div align="center"><img src="xmla27.png"></div>  <h4 id="復元"><a href="#復元" class="headerlink" title="復元"></a>復元</h4><p>データセットを復元するには、SSMSでデータベースを右クリックし、 <strong>[復元]</strong> を選択します。</p><div align="center"><img src="xmla28.png"></div>  <p>復元するファイルを選択します。</p><div align="center"><img src="xmla29.png"></div>  <p>XMLAエンドポイントによって、よりPower BIの利用の幅が広がります。Power BI Premiumをご契約いただいていないユーザー様でも、試用版Power BI Premium Userのライセンスのご利用で本機能をお試しいただけます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_disable_trial_version/#Power-BI-%E8%A9%A6%E7%94%A8%E7%89%88%EF%BC%88%E7%84%A1%E6%96%99%E4%BD%93%E9%A8%93%EF%BC%89%E3%81%A8%E3%81%AF">Power BI 試用版（無料体験）を無効化する方法 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;Power BI Premium Per Capacity または Premium Per Userでは、XMLAエンドポイントを使用してデータセットに接続したり、更新したりすることができます。今回は  ｢XMLAエンドポイント｣ について説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="更新" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
    <category term="Power BI Premium" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Premium/"/>
    
    <category term="XMLAエンドポイント" scheme="https://jpbap-sqlbi.github.io/blog/tags/XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88/"/>
    
  </entry>
  
</feed>
