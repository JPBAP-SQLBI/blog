<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan CSS Support Power BI Blog</title>
  
  <subtitle>日本マイクロソフトPower BIサポートチームのブログです。チームの担当製品である Power BI の情報を中心にお届けします。</subtitle>
  <link href="https://jpbap-sqlbi.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpbap-sqlbi.github.io/blog/"/>
  <updated>2024-01-31T08:23:41.466Z</updated>
  <id>https://jpbap-sqlbi.github.io/blog/</id>
  
  <author>
    <name>Japan Power BI Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Power BI 用 Copilot を利用する</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_copilot_for_PBI/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_copilot_for_PBI/</id>
    <published>2024-01-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.466Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Power BI 用 Copilot は 2024年1月31日 時点でパブリックプレビューの状態で、いくつかの条件を満たしている場合にご利用いただくことができます。今回は現時点における、Power BI 用 Copilot のご利用条件、機能概要、制限事項などをご紹介します。</p><span id="more"></span><p>（Power BI 用 Copilot によって生成されるコンテンツの品質向上は継続的に取り組まれていますが、Copilot が生成する結果については何かを保証するものではなく、あくまで人間の見識によって責任をもって管理と判断をする必要がございます）</p><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="・目次"><a href="#・目次" class="headerlink" title="・目次"></a>・目次</h2><hr><p> <a href="#%E3%83%BB%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6">・使用条件</a><br> <a href="#%E3%83%BB%E6%A9%9F%E8%83%BD%E6%A6%82%E8%A6%81">・機能概要</a><br> <a href="#%E3%83%BB%E3%81%94%E7%95%99%E6%84%8F%E7%82%B9%E3%81%A8%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85">・ご留意点と制限事項</a></p><hr><h2 id="・使用条件"><a href="#・使用条件" class="headerlink" title="・使用条件"></a>・使用条件</h2><hr><p><strong>■ライセンス要件</strong><br>Power BI 用 Copilot をご利用いただけるのは、Premium 容量 (P1 以上)　またはFabric 容量（F64 以上) のワークスペースのみでございます。試用版 SKU はサポートされていません。かつ、ご利用の容量が以下の公開情報に記載のいずれかのリージョンにある必要があります。</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/fabric/admin/region-availability">Fabric が使用できるリージョン - Microsoft Fabric | Microsoft Learn</a><br>※Power BI 用 Copilot は、現在、段階的に展開がされている状況であるため、上記の条件を満たしている場合でも、お客様のテナントのリージョンによっては、試せる機能が限られる可能性がございます。</p><p>該当ワークスペースの共同作成者 or メンバー or 管理者のアクセス権を持っている必要があります。<br>また、ワークスペースの使用には、Power BI Pro ライセンス以上（または試用版ライセンス）が必要です。</p><p><strong>■テナント設定</strong><br>以下２つが有効化されている必要がございます（どちらも既定では無効）</p><p>・    [ユーザーは Copilot のプレビューや、Azure OpenAI によって提供されるその他の機能を使用できます]<br>・    [Azure OpenAI に送信されたデータは、テナントの地理的リージョン、コンプライアンス境界、または国内クラウド インスタンスの外部で処理できます] </p><div align="center"><img src="1.png"></div><p>※    テナント設定「ユーザーはFabricアイテムを作成できます」は関係しておらず、上記２つのテナント設定の有効化のみで Power BI 用 Copilot　はご利用可能です。</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/fabric/admin/service-admin-portal-copilot">Copilot の管理者設定 (プレビュー) - Microsoft Fabric | Microsoft Learn</a></p></br><p>上記の使用条件については以下の公開情報にまとめがございますので、必要に応じてご参照ください。</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/copilot-introduction">Power BI 用 Copilot (プレビュー) の概要 - Power BI | Microsoft Learn</a></p><div align="center"><img src="2.png"></div></br><hr><h2 id="・機能概要"><a href="#・機能概要" class="headerlink" title="・機能概要"></a>・機能概要</h2><hr><p>Power BI 用 Copilot における主な機能は以下でございます。</p><p><strong>機能:１： Power BI 用 Copilot を使用してレポートを作成する</strong><br>Power BI サービス上のセマンティックモデルをもとに、Copilot に指示をすることで、レポートを自動的に作成することができます。具体的な動作については、以下の公開情報、ならびに弊社 Power BI スペシャリストのブログなどをご参照ください。</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/copilot-create-report">Power BI サービス用の Copilot を使用してレポート ページを作成する - Power BI | Microsoft Learn</a><br>// ご参考：<a href="https://marshal115.hatenablog.com/entry/2023/12/22/082056">Copilot for Power BI（レポート作成） - テクテク日記 (hatenablog.com)</a></p><p><strong>機能:２： Power BI 用 Copilot を使用してレポートページに関する説明を作成する</strong><br>Power BI Desktop と Power BI サービスでは、Power BI 用 Copilot を使用して、数回クリックするだけでレポート ページに関する説明をすばやく作成できます。この説明とは、レポート全体、特定のページ、さらには選択した特定のビジュアルを要約したものになります。</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/copilot-create-narrative?tabs=powerbi-service">Power BI 用 Copilot を使用して説明を作成する - Power BI | Microsoft Learn</a></p><p><strong>機能:３： Power BI 用の Copilot を使用して Q&amp;A を強化する</strong><br>通常の Q&amp;A ビジュアルとその自然言語処理機能は、生成 AI に依存しませんが、Power BI 用の Copilot を使用すると、ユーザーの質問を理解する能力を迅速に向上させることができます。</p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/natural-language/q-and-a-copilot-enhancements">Power BI 用の Copilot を使用して Q&amp;A を強化する - Power BI | Microsoft Learn</a></p><p>Power BI Desktop の場合は、オプション設定で以下にチェックを入れておきます。</p><div align="center"><img src="3.png"></div></br><p><strong>（ 機能 : クイックメジャーの提案　）</strong><br>クイックメジャーでも [Copilot による提案] がご利用いただけますが、こちらは旧来のクイックメジャーの提案に代わるものであるため、先述した以下２つのテナント設定の有効化は不要でございます。</p><p>・    [ユーザーは Copilot のプレビューや、Azure OpenAI によって提供されるその他の機能を使用できます]<br>・    [Azure OpenAI に送信されたデータは、テナントの地理的リージョン、コンプライアンス境界、または国内クラウド インスタンスの外部で処理できます] </p><p>ただし、クイックメジャーの使用自体で以下２つのテナント設定が有効化されている必要があります。</p><p>・    [ユーザーはPower BI サービスでデータ モデルを編集できます (プレビュー)]  ※既定で有効<br>・    [ユーザー データが地域を離れられるようにする]　※既定で無効<br>　→クイックメジャーの提案機能は、現在米国のデータセンターにのみデプロイされている機械学習モデルが利用されるため、お客様のテナントリージョンが米国以外の場合、このテナント設定を有効にしない限り、クイックメジャーの機能が既定で無効になります。</p><div align="center"><img src="4.png"></div></br><p>■ Power BI Desktop<br>オプションと設定 &gt; オプション</p><div align="center"><img src="5.png"></div></br><p>クイックメジャーの使用画面のイメージは以下です。</p><div align="center"><img src="6.png"></div></br><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/quick-measure-suggestions">クイック メジャーの提案 - Power BI | Microsoft Learn</a></p><hr><h2 id="・ご留意点と制限事項"><a href="#・ご留意点と制限事項" class="headerlink" title="・ご留意点と制限事項"></a>・ご留意点と制限事項</h2><hr><p><strong>Power BI 用 Copilot のご利用の際、データのセキュリティとプライバシーに関しては以下の公開情報をご参照ください。</strong></p><p>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/fabric/get-started/copilot-privacy-security">Microsoft Fabric での Copilot のプライバシー、セキュリティ、責任ある使用 (プレビュー) - Microsoft Fabric | Microsoft Learn</a></p><p><strong>また、Power BI 用 Copilot はたくさんの制限事項があり代表的なものを以下に上げますが、機能それぞれの制限事項の詳細は、随時それぞれの最新の公開情報をご確認ください。</strong></p><p>・Copilot で作成するビジュアルの種類は指定できません<br>・生成されたビジュアルを指示で変更することはできません（手動で変更が可能）<br>・Copilot は複雑な意図を理解できません（意図しないビジュアルや説明が生成される場合もあります）<br>・etc</p><p>上述してきました各公開情報に「考慮事項と制限事項」がございますのでご参照ください。<br>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/copilot-create-report#considerations-and-limitations">Power BI サービス用の Copilot を使用してレポート ページを作成する - Power BI | Microsoft Learn - 考慮事項と制限事項</a><br>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/copilot-create-narrative?tabs=powerbi-service#considerations-and-limitations">Power BI 用 Copilot を使用して説明を作成する - Power BI | Microsoft Learn - 考慮事項と制限事項</a><br>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/natural-language/q-and-a-copilot-enhancements#limitations-and-considerations">Power BI 用の Copilot を使用して Q&amp;A を強化する - Power BI | Microsoft Learn - 考慮事項と制限事項</a><br>// 公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/quick-measure-suggestions#limitations-and-considerations">クイック メジャーの提案 - Power BI | Microsoft Learn  - 考慮事項と制限事項</a></p><p><strong>また、出力された結果のレビューは、コンテンツの正確性と妥当性を有意義に評価できる人が行う必要がございます。Copilot で出力される結果については十分にご確認いただいた上でご利用をお願いします。</strong></p></br></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Power BI 用 Copilot は 2024年1月31日 時点でパブリックプレビューの状態で、いくつかの条件を満たしている場合にご利用いただくことができます。今回は現時点における、Power BI 用 Copilot のご利用条件、機能概要、制限事項などをご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="テナント設定" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A/"/>
    
  </entry>
  
  <entry>
    <title>「Power BI Windows アプリ」のサポート終了</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_windows_app_reach_retirement/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_windows_app_reach_retirement/</id>
    <published>2024-01-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.934Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。<br>マイクロソフトでは、2023年12月31日をもちまして、Power BIの閲覧・共有を目的として開発されたアプリケーションである 「Power BI Windows アプリ」 のサポートを終了しました。<br>レポート作成が可能な 「Power BI Desktop」とは異なるアプリですが、ご質問をいただくことが多いため本ブログにて詳細をご案内いたします。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/lifecycle/announcements/power-bi-windows-app-retirement-12-31-2023">2023 年 12 月 31 日に廃止予定の Power BI Windows アプリ</a></p></div><p>今回サポート終了の対象の「Power BI Windows アプリ」は、以下イメージの通り、Power BIコンテンツの閲覧や共有を目的として開発されたアプリケーションです。<br>2023 年 12 月 31 日以降、このアプリはセキュリティ更新プログラム、セキュリティ以外の更新プログラム、バグ修正プログラムは提供されません。また、テクニカル サポートを受け取ることができなくなり、Microsoft アプリ ストアからダウンロードできる「Power BI Windows アプリ」も削除されます。<br>「Power BI Windows アプリ」のサポート終了後も、Power BI サービス(app.powerbi.com)で引き続きPower BIのコンテンツを閲覧・共有することが可能でございますので、ご安心ください。</p><div align="left"><img src="1.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/mobile/mobile-windows-10-phone-app-get-started">Windows 用の Power BI アプリの概要</a></p></div><p>また、冒頭でご案内の通り、「Power BI Windows アプリ」は、「Power BI Desktop」と異なるアプリケーションであり、「Power BI Windows アプリ」の廃止にPower BI Desktopの使用には影響はありません。<br>Power BI Desktopは、以下イメージの通り、データへ接続や変換を行い、データモデルをもとにデータ分析およびレポート作成可能なツールです。</p><div align="left"><img src="2.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-what-is-desktop">Power BI Desktop とは何ですか?</a></p></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;br&gt;マイクロソフトでは、2023年12月31日をもちまして、Power BIの閲覧・共有を目的として開発されたアプリケーションである 「Power BI Windows アプリ」 のサポートを終了しました。&lt;br&gt;</summary>
      
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Windows アプリ" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Windows-%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
  </entry>
  
  <entry>
    <title>Power BI のユーザーアクティビティ追跡方法の比較</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_activity_log_usage_metrics/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_activity_log_usage_metrics/</id>
    <published>2023-12-29T05:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.402Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのチャンです。   </p><p>Power BI のユーザーアクティビティの確認方法について、例えばどれぐらいの回数や頻度でレポートを閲覧しているか、実際ファイルのエクスポートを行なったかなどの行動に対して、ログを出力したり、レポート上で確認したいというご要望を、よくお問い合わせいただきますが、本ブログでは各追跡方法について詳しくご紹介いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="更新履歴"><a href="#更新履歴" class="headerlink" title="更新履歴"></a>更新履歴</h2><hr><span style="color: red;">Update: 2023/12/29</span><p>Admin Monitoring ワークスペースの機能紹介を追加いたしました。</p><ul><li><a href="https://powerbi.microsoft.com/ja-jp/blog/announcing-the-new-admin-monitoring-workspace-for-tenant-admins-public-preview/">Admin Monitoring for Tenant Admins | Microsoft Power BI ブログ</a></li></ul><hr><h2 id="Power-BIアクティビティログ"><a href="#Power-BIアクティビティログ" class="headerlink" title="Power BIアクティビティログ"></a>Power BIアクティビティログ</h2><hr><p>Power BI内のユーザーアクティビティを追跡する方法は、主に3つございます。</p><ol><li><a href="#%E5%88%A9%E7%94%A8%E7%8A%B6%E6%B3%81%E3%83%A1%E3%83%88%E3%83%AA%E3%83%83%E3%82%AF">利用状況メトリック</a></li><li><a href="#ActivityEvents">ActivityEvents</a></li><li><a href="#%E7%9B%A3%E6%9F%BB%E3%83%AD%E3%82%B0">監査ログ</a></li><li><a href="#%E7%AE%A1%E7%90%86%E8%80%85%E7%9B%A3%E8%A6%96%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B9%EF%BC%88Admin-Monitoring%EF%BC%89">管理者監視ワークスペース（Admin Monitoring）</a></li></ol><p>以下にてそれぞれご紹介いたします。</p><hr><h2 id="利用状況メトリック"><a href="#利用状況メトリック" class="headerlink" title="利用状況メトリック"></a>利用状況メトリック</h2><hr><p>利用状況メトリックでは、各レポートの閲覧回数やパフォーマンス状況、よく使うレポートやレポートページ、よくアクセスしているユーザーの集計を簡単に可視化した機能をご利用いただけます。</p><h4 id="■前提条件"><a href="#■前提条件" class="headerlink" title="■前提条件"></a>■前提条件</h4><p>本機能を利用いただくための前提条件は以下となります。</p><ul><li>Power BI Pro または Premium Per User (PPU) のライセンスが必要です。</li><li>レポート用の強化された利用状況の指標にアクセスするには、そのレポートに対する編集アクセス権を持っている必要があります。</li><li>Power BI 管理者が、コンテンツ作成者に向けて<a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-portal-audit-usage">利用状況の指標を有効にしている</a>必要があります。</li></ul><h4 id="■利用手順"><a href="#■利用手順" class="headerlink" title="■利用手順"></a>■利用手順</h4><p>有効化する手順について、以下ご案内いたします。</p><ol><li><p>ワークスペースのコンテンツ リストのいずれかから、レポートのオプション メニューを開き、 [利用状況のメトリック レポートを表示] を選択します。 </p><div align="center"><img src="usage_metrics1.png" alt="利用状況メトリック レポートを表示" title="利用状況メトリック レポートを表示"></div></li><li><p>メトリックレポートが生成中の間は、以下のようなポップアップウィンドウが表示されます。</p><div align="center"><img src="usage_metrics2.png" alt="メトリックレポート作成中" title="メトリックレポート作成中"></div></li><li><p>レポートの生成が完了したら、 [使用状況メトリックの表示] を選択します。</p><div align="center"><img src="usage_metrics3.png" alt="使用状況メトリックの表示" title="使用状況メトリックの表示"></div></li><li><p>初めて実行する場合は、古い利用状況の指標に関するレポートが開かれる場合があります。 強化された利用状況の指標に関するレポートを表示するには、右上の [新しい使用状況レポートをオフにする] スイッチを [オン] に切り替えます。<br>※強化された新しい利用状況では、古い利用状況より、多くの情報を可視化されています。例えば、同じワークスペース内の各レポートの閲覧状況の比較や、トレンドやパフォーマンスをご確認いただけます。</p><div align="center"><img src="usage_metrics4.png" alt="新しい使用状況レポートをオンにする" title="新しい使用状況レポートをオンにする"></div></li></ol><blockquote><p><strong>参考情報：</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-modern-usage-metrics">新しいモダン ワークスペースで使用状況メトリックを監視する (プレビュー) - Power BI | Microsoft Docs</a></li></ul></blockquote><hr><h2 id="ActivityEvents"><a href="#ActivityEvents" class="headerlink" title="ActivityEvents"></a>ActivityEvents</h2><hr><p>PowerShell を使ってユーザーアクティビティのログを出力できる機能ですが、Power BI サービス上の操作画面はございません。</p><h4 id="■前提条件-1"><a href="#■前提条件-1" class="headerlink" title="■前提条件"></a>■前提条件</h4><ul><li>Power BI (Fabric) 管理者、またはグローバル管理者のアカウントでサインインしていること</li><li>PowerShellでモジュールのインストール</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Install-Module -Name MicrosoftPowerBIMgmt</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="■利用手順-1"><a href="#■利用手順-1" class="headerlink" title="■利用手順"></a>■利用手順</h4><p>PowerShellでGet-PowerBIActivityEventを使用します。<br>一回で取得できるのは1日分なので、開始日と終了日で同じ日付値を参照する必要があります。</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Login-PowerBI</span><br><span class="line"></span><br><span class="line">$activities = Get-PowerBIActivityEvent -StartDateTime &#x27;<span class="number">2022</span>-<span class="number">07</span>-<span class="number">25</span>T00:<span class="number">00</span>:<span class="number">00</span>&#x27; -EndDateTime &#x27;<span class="number">2022</span>-<span class="number">07</span>-<span class="number">25</span>T23:<span class="number">59</span>:<span class="number">59</span>&#x27; | ConvertFrom-Json</span><br><span class="line"></span><br><span class="line">$activities</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$outputFile = &quot;C:\Temp\activities.csv&quot;</span><br><span class="line">$activities | Export-Csv $outputFile -NoTypeInformation</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="■PowerShellの実行結果"><a href="#■PowerShellの実行結果" class="headerlink" title="■PowerShellの実行結果"></a>■PowerShellの実行結果</h4><div align="center"><img src="powershellactivities2.png" alt="PowerShellの実行結果" title="PowerShellの実行結果"></div><h4 id="■エクスポートされたcsvファイル"><a href="#■エクスポートされたcsvファイル" class="headerlink" title="■エクスポートされたcsvファイル"></a>■エクスポートされたcsvファイル</h4><div align="center"><img src="powershellactivities.png" alt="エクスポートされたcsvファイル" title="エクスポートされたcsvファイル"></div><blockquote><p><strong>参考情報：</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-auditing#use-the-activity-log">アクティビティ ログの使用 - Power BI | Microsoft Docs</a></li></ul></blockquote><hr><h2 id="監査ログ"><a href="#監査ログ" class="headerlink" title="監査ログ"></a>監査ログ</h2><hr><p>監査ログは、Power BI独有の機能ではなく、Microsoft 365のコンプライアンス管理センターの機能でございます。<br>そのため、一度有効にすると、Power BIのログだけでなく、すべてのMicrosoft 365製品における監査ログが記録されるようになります。</p><h4 id="■前提条件-2"><a href="#■前提条件-2" class="headerlink" title="■前提条件"></a>■前提条件</h4><ul><li>監査ログにアクセスするには、グローバル管理者であるか、Exchange Online で Audit Logs (監査ログ) または View-Only Audit Logs (表示専用監査ログ) ロールが割り当てられている必要があります。</li></ul><h4 id="■利用手順-2"><a href="#■利用手順-2" class="headerlink" title="■利用手順"></a>■利用手順</h4><ol><li><p>Power BIサービスへサインインし、[設定]&gt;[管理ポータル] へアクセスします。</p><div align="center"><img src="auditlog1.png" alt="管理ポータルへアクセス" title="管理ポータルへアクセス"></div></li><li><p>[監査ログ] &gt; [Microsoft 365 管理センターに移動]を選択します。</p><div align="center"><img src="auditlog2.png" alt="Microsoft 365コンプライアンス管理センター" title="Microsoft 365コンプライアンス管理センター"></div></li><li><p>開始日と終了日を選択し、アクティビティで、Power BIで絞り、必要なイベントのみ選択します。<br>※もし監査ログが有効化されていない場合、有効化ボタンをクリックする必要がございます。</p><div align="center"><img src="auditlog3.png" alt="監査ログの検索" title="監査ログの検索"></div></li></ol><blockquote><p><strong>参考情報：</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-auditing#use-the-audit-log">監査ログの使用 - Power BI | Microsoft Docs</a></li></ul></blockquote><hr><h2 id="管理者監視ワークスペース（Admin-Monitoring）"><a href="#管理者監視ワークスペース（Admin-Monitoring）" class="headerlink" title="管理者監視ワークスペース（Admin Monitoring）"></a>管理者監視ワークスペース（Admin Monitoring）</h2><hr><p>2023年5月から新規に公開された管理者監視ワークスペース（Admin Monitoring）という機能では、「Feature Usage and Adoption」 と 「Purview Hub」 の二つのレポートが用意されています。</p><p>「Feature Usage and Adoption」の方は、監査ログに基づいて構築された分析ビューが用意されており、誰が何をしているかを理解するのに役立ち、特定の傾向、パターン、アクティビティを特定することで Power BI をより適切に管理できます。</p><div align="center"><img src="https://powerbiblogscdn.azureedge.net/wp-content/uploads/2023/05/Picture1.png"></div><br>「Purview Hub」の方は、機密データと項目の承認に関する分析情報を提供するレポートが含まれており、データ カタログ、情報保護、データ損失防止、監査など、Microsoft Purview ガバナンスおよびコンプライアンス ポータルのより高度な機能へのリンクとしても機能します。<div align="center"><img src="https://learn.microsoft.com/ja-jp/fabric/governance/media/use-microsoft-purview-hub/microsoft-purview-hub-full-report-admin.png"></div><h4 id="■前提条件-3"><a href="#■前提条件-3" class="headerlink" title="■前提条件"></a>■前提条件</h4><ul><li>Power BI (Fabric) 管理者、またはグローバル管理者のアカウントでサインインしている必要があります。</li><li>ワークスペース内のレポートを閲覧するには、 Power BI Pro または Premium Per User (PPU) のライセンスが必要です。</li></ul><h4 id="■利用手順-3"><a href="#■利用手順-3" class="headerlink" title="■利用手順"></a>■利用手順</h4><ol><li><p>管理者アカウントにて、<a href="https://app.powerbi.com/">Power BIサービス</a>へサインインし、[ワークスペース] &gt; [Admin monitoring] の順で選択します。</p><div align="center"><img src="admin_monitoring1.png"></div></li><li><p>ワークスペース内に、自動的に「Feature Usage and Adoption」と「Purview Hub」という二つのレポート及びセマンティックモデル（データセット）が生成されています。</p><div align="center"><img src="admin_monitoring2.png"></div></li></ol><blockquote><p><strong>参考情報：</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/fabric/admin/monitoring-workspace">管理者監視ワークスペースとは? - Microsoft Fabric | Microsoft Docs</a></li><li><a href="https://learn.microsoft.com/ja-jp/fabric/admin/feature-usage-adoption">機能の使用状況と導入レポート - Microsoft Fabric | Microsoft Docs</a></li><li><a href="https://powerbi.microsoft.com/ja-jp/blog/announcing-the-new-admin-monitoring-workspace-for-tenant-admins-public-preview/">Admin Monitoring for Tenant Admins | Microsoft Power BI ブログ</a></li><li><a href="https://learn.microsoft.com/ja-jp/fabric/governance/use-microsoft-purview-hub?tabs=admin-view">Microsoft Fabric の Microsoft Purview ハブ (プレビュー)- Microsoft Fabric | Microsoft Docs</a></li></ul></blockquote><hr><h2 id="比較"><a href="#比較" class="headerlink" title="比較"></a>比較</h2><hr><p>以下にて各追跡方法について表にまとめました。</p><table><thead><tr><th></th><th><strong>監査ログ</strong></th><th><strong>PowerShell ActivityEvents</strong></th><th><strong>利用状況メトリックレポート</strong></th><th><strong>Admin Monitoring</strong></th></tr></thead><tbody><tr><td><strong>目的</strong></td><td>Power BI およびその他サービスのユーザーアクティビティの追跡</td><td>Power BI ユーザー アクティビティの追跡</td><td>Power BIのレポートの利用状況確認（ワークスペース単位）</td><td>Fabric（ Power BI 含め）の各機能の利用状況確認（テナント単位）</td></tr><tr><td><strong>取得項目範囲</strong></td><td>Power BI 監査イベントに加えて、SharePoint Online、Exchange Online、Dynamics 365、及びその他のサービスからのイベントが含まれます</td><td>Power BI 監査イベントのみ</td><td>Power BI のワークスペース上のレポートの閲覧状況のみ</td><td>Fabric（ Power BI 含め）テナント内の機能の利用状況のみ</td></tr><tr><td><strong>必要な権限</strong></td><td>・ View-Only Audit Logs (表示専用監査ログ)<br>・グローバル管理者<br>・監査人</td><td>・グローバル管理者<br>・Power Platform 管理者<br>・Power BI (Fabric) 管理者</td><td>ワークスペースの管理者・メンバー・共同作成者</td><td>・グローバル管理者<br>・Power BI (Fabric) 管理者</td></tr><tr><td><strong>必要なPower BIライセンス</strong></td><td>-</td><td>-   -</td><td>Power BI Pro または Premium Per User (PPU) のライセンス</td><td>Power BI Pro または Premium Per User (PPU) のライセンス</td></tr><tr><td><strong>保管期間</strong></td><td>90日間 / 180日間※</td><td>30日間（一度に1日分のみ取得可能）</td><td>30日間</td><td>30日間</td></tr><tr><td><strong>タイムラグ</strong></td><td>監査を有効にしてから監査データを表示できるようになるまで、最大で 48 時間の遅延が発生する場合があります。</td><td>Power BI イベントを取得するまでに、最大 30 分の遅延が発生することがあります。</td><td>新しい利用状況データをインポートするには、最大で 24 時間かかることがあります。</td><td>1 日 1 回、自動的に更新され、管理者ワークスペースに初めてアクセスしてから約 10 分後に更新が行われます。</td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>※　監査 (Standard) の既定の保持期間が 90 日から 180 日に変更されました。 2023 年 10 月 17 日より前に生成された監査 (Standard) ログは、90 日間保持されます。 2023 年 10 月 17 日以降に生成された監査 (Standard) ログは、新しい既定の保持期間の 180 日に従います。<br>また、Office 365 E5 または Microsoft 365 E5 ライセンスの場合、監査ログ180日間（最長1年間）を保持することができます。E5 ライセンスに加えて、10 年間の監査ログ保持のアドオン ライセンスもございます。</p><blockquote><p>参考情報：</p><ul><li><a href="https://learn.microsoft.com/ja-jp/microsoft-365/compliance/audit-log-retention-policies?view=o365-worldwide">監査ログの保持ポリシーを管理する</a></li></ul></blockquote></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのチャンです。   &lt;/p&gt;
&lt;p&gt;Power BI のユーザーアクティビティの確認方法について、例えばどれぐらいの回数や頻度でレポートを閲覧しているか、実際ファイルのエクスポートを行なったかなどの行動に対して、ログを出力したり、レポート上で確認したいというご要望を、よくお問い合わせいただきますが、本ブログでは各追跡方法について詳しくご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Audit Log" scheme="https://jpbap-sqlbi.github.io/blog/tags/Audit-Log/"/>
    
    <category term="Activity Log" scheme="https://jpbap-sqlbi.github.io/blog/tags/Activity-Log/"/>
    
    <category term="Usage Metrics" scheme="https://jpbap-sqlbi.github.io/blog/tags/Usage-Metrics/"/>
    
    <category term="監査ログ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E7%9B%A3%E6%9F%BB%E3%83%AD%E3%82%B0/"/>
    
    <category term="アクティビティログ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%82%AF%E3%83%86%E3%82%A3%E3%83%93%E3%83%86%E3%82%A3%E3%83%AD%E3%82%B0/"/>
    
    <category term="利用状況メトリック" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E5%88%A9%E7%94%A8%E7%8A%B6%E6%B3%81%E3%83%A1%E3%83%88%E3%83%AA%E3%83%83%E3%82%AF/"/>
    
    <category term="使用状況メトリック" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E4%BD%BF%E7%94%A8%E7%8A%B6%E6%B3%81%E3%83%A1%E3%83%88%E3%83%AA%E3%83%83%E3%82%AF/"/>
    
    <category term="Admin Monitoring" scheme="https://jpbap-sqlbi.github.io/blog/tags/Admin-Monitoring/"/>
    
    <category term="管理者監視ワークスペース" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E7%AE%A1%E7%90%86%E8%80%85%E7%9B%A3%E8%A6%96%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>フクロウエラーについて</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/owl_error/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/owl_error/</id>
    <published>2023-12-28T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.398Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI サービスでは、何かしら問題が発生している場合にエラーメッセージが表示されますが、このようなフクロウの画像付きのエラーに遭遇したことはありますか。<br>頻度としては低いため突然フクロウが画面に現れると驚かれるかと思いますが、そんな時に落ち着いてトラブルシューティングや対処を進められるように、本記事ではこのフクロウエラーについて詳細をご紹介いたします。  </p><span id="more"></span><div align="left"><img src="1.png"></div></p><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div> </br><h2 id="フクロウエラーとは"><a href="#フクロウエラーとは" class="headerlink" title="フクロウエラーとは"></a><font color="DodgerBlue">フクロウエラーとは</font></h2><p>フクロウエラーの画面は、Power BI サービスとの接続において何らかの問題が発生した際に Power BI 内でリダイレクトされるページとなります。<br>画像は一例となりますが、フクロウエラーの画面は大きく ３ つの情報から構成されますので、フクロウが表示されたときは落ち着いて以下のポイントに注目しましょう。  </p><div align="left"><img src="2.png"></div></p><h3 id="1-フクロウの画像"><a href="#1-フクロウの画像" class="headerlink" title="1. フクロウの画像"></a><font color="HotPink">1. フクロウの画像</font></h3><p>事象によって、フクロウの画像が異なる場合があります。<br>冒頭で案内したようなフクロウのこともあれば、上の画像のように虫眼鏡をのぞいているフクロウだったり、ケガをしているフクロウのこともあります。<br>フクロウの様子の違いがサポートチームでの調査において有益な情報になることがあります。  </p><h3 id="2-エラーメッセージ"><a href="#2-エラーメッセージ" class="headerlink" title="2. エラーメッセージ"></a><font color="HotPink">2. エラーメッセージ</font></h3><p>上の画面のように、何かしらのメッセージが表示されることがあり、調査開始にあたり調査箇所の絞り込みのために有効な情報となります。ただし、このメッセージは汎用的である場合が多いです。<br>例えば、この 「お探しのページが見つかりませんでした。」  というメッセージの場合、“ページ自体が存在しないのか”、“存在するページにアクセスできないのか” は、後述の切り分けや次の項番 3 のエラー情報をもとに詳細調査を進める必要があります。  </p><h3 id="3-エラー情報詳細"><a href="#3-エラー情報詳細" class="headerlink" title="3. エラー情報詳細"></a><font color="HotPink">3. エラー情報詳細</font></h3><p>技術的な詳細情報や、サポートチームにて調査を進める際に必要なエラーメッセージ、日付と時刻、アクティビティ ID などが表示されます。<br>これらの情報をもとに、 Microsoft のデータセンター側に記録された内部ログにアクセスし、詳細な調査を行います。  </p><p>※    事象によっては、内部ログに詳細が記載されず、原因の特定に至らない場合もあります。  </p><h3 id="サポートチームからのお願い"><a href="#サポートチームからのお願い" class="headerlink" title="サポートチームからのお願い"></a><font color="OrangeRed">サポートチームからのお願い</font></h3><p>フクロウエラーの事象について詳細調査を進める場合、上記の情報が必須となります。<br>サポートチームへのお問い合わせを検討される場合は、後述の切り分け結果と共に、1 ～ 3 の情報が含まれる Power BI 画面全体の画面ショットと 2 , 3 のテキスト コピーをお問い合わせ時に必ず送付いただきますようお願いいたします。<br>これらの情報がそろっていない場合は、じゅうぶんな調査ができませんことを、何卒ご了承くださいませ。  </p> </br><h2 id="フクロウエラーの原因は？"><a href="#フクロウエラーの原因は？" class="headerlink" title="フクロウエラーの原因は？"></a><font color="DodgerBlue">フクロウエラーの原因は？</font></h2><p>フクロウエラーが発生するシナリオは実に様々です。<br>“ Power BI サービスとの接続において何らかの問題が発生した” と一言で言っても、その原因がユーザーの環境のネットワークに起因していることもあれば、特定のユーザーのアカウント状況に起因していることもあります。また、Power BI サービス側で何か障害が起きている可能性も考えられます。<br>発生する期間についても、一過性の事象であったり、継続している事象のこともあります。<br>これまで弊社サポートチームに寄せられたお問い合わせの中で確認できている事例としては、以下のものがあります。  </p><h3 id="1-アカウントやライセンスの問題"><a href="#1-アカウントやライセンスの問題" class="headerlink" title="1. アカウントやライセンスの問題"></a><font color="HotPink">1. アカウントやライセンスの問題</font></h3><p>・Microsoft Entra ID (旧 Azure AD ) で対象のユーザーが無効となっている<br>・Microsoft Entra ID  (旧 Azure AD ) で対象のユーザーが削除されている<br>・Microsoft Entra ID  (旧 Azure AD ) または Microsoft 365 管理センターで対象のユーザーに Power BI ライセンスが正しく割り当てられていない<br>・対象のユーザーがゲストアカウントであり、そのアカウントに問題が発生しており、招待されたテナントの Power BI にサインインできない   </p><p>これらの事象に合致または類似しているかどうかは、アカウントやライセンス割り当て状況の確認や、同じ環境にて別のユーザーでも事象が発生しているかを確認してください。<br>新規でテストアカウントを作成して再現するか確認することも有効です。  </p><h3 id="2-テナント移行-バックグランドメンテナンス（デプロイ）"><a href="#2-テナント移行-バックグランドメンテナンス（デプロイ）" class="headerlink" title="2. テナント移行/バックグランドメンテナンス（デプロイ）"></a><font color="HotPink">2. テナント移行/バックグランドメンテナンス（デプロイ）</font></h3><p>・バックエンド テナントのスケジュールされたメンテナンス/移行アクティビティが発生する  </p><p>これらはユーザー様の環境起因ではなく、Power BI サービス側のメンテナンス等によるものです。<br>時間をおくことで事象が解消するかしばらく様子を見るか、以下サイトにて、障害やメンテナンスが発生していないか確認してください。  </p><p><a href="https://support.fabric.microsoft.com/ja-JP/support/">Microsoft Fabric のサポート</a><br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/enterprise/view-service-health?view=o365-worldwide">Microsoft 365 サービス正常性を確認する方法</a></p><h3 id="3-ネットワークの問題"><a href="#3-ネットワークの問題" class="headerlink" title="3. ネットワークの問題"></a><font color="HotPink">3. ネットワークの問題</font></h3><p>・Power BI のテナント設定で Azure Private Links が有効かつ、パブリック インターネット アクセスが無効になっていることで、Power BI サービスにアクセスできない<br>・ユーザー環境にて VPN ブロックされている<br>・ユーザー環境にてファイアウォールブロックされている   </p><p>対象のご環境にてネットワーク関連の設定変更やメンテナンスが発生していなかったかや、異なるネットワークにて同じアカウントで事象が再現するか確認することで、ネットワークに起因しているかどうか切り分けをしてください。  </p> </br><h2 id="事象発生条件の切り分けチェックポイント"><a href="#事象発生条件の切り分けチェックポイント" class="headerlink" title="事象発生条件の切り分けチェックポイント"></a><font color="DodgerBlue">事象発生条件の切り分けチェックポイント</font></h2><p>上記含め、以下のリストに沿って事象発生条件の切り分けを行い、被疑箇所を絞り込んだ上で弊社サポートへお問合せいただくことで、スムーズな調査が開始できます。<br>解決しない場合は、上述でご案内のエラー情報と本切り分け結果を添えて、サポートまでお問い合わせください。  </p> </br><p>(1) 異なるネットワーク環境でも再現しますか。  </p><p>(2) ネットワーク環境を変更すると再現しない場合、対象ネットワークにおいて何か設定変更やメンテナンスはありましたか。  </p><p>(3) 複数アカウントでも再現しますか。それとも、特定のアカウントのみで発生しますか。  </p><p>(4) 特定のアカウントのみで発生している場合、以下設定状況はいかがですか。<br>　　‐ アカウントが無効になっていないか<br>　　- Power BI のライセンスは割り当たっているか（何のライセンスが割り当たっているか）<br>　　‐ Power BI のライセンスの再割り当て後、Power BI に再度サインインすることで事象が解消するか  </p><p>(5) 特定のアカウントがゲストユーザーの場合、招待受け入れはされましたか。  </p><p>(6) Power BI 管理ポータルのテナント設定にアクセスできる場合、<a href="https://learn.microsoft.com/ja-jp/fabric/admin/tenant-settings-index#advanced-networking">高度ネットワーク</a>の以下２項目の設定状況をご確認ください。　<br>　　‐　Azure Private Link<br>　　‐　パブリック　インターネット アクセスのブロック  </p><p>(7) 異なるブラウザを使用しても再現しますか。  </p><p>(8) ブラウザの履歴を削除しても再現しますか。  </p><p>(9) インプライベートモードのブラウザを起動しても再現しますか。    </p></br></br><p>以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI サービスでは、何かしら問題が発生している場合にエラーメッセージが表示されますが、このようなフクロウの画像付きのエラーに遭遇したことはありますか。&lt;br&gt;頻度としては低いため突然フクロウが画面に現れると驚かれるかと思いますが、そんな時に落ち着いてトラブルシューティングや対処を進められるように、本記事ではこのフクロウエラーについて詳細をご紹介いたします。  &lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="ふくろう" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%81%B5%E3%81%8F%E3%82%8D%E3%81%86/"/>
    
    <category term="フクロウ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%95%E3%82%AF%E3%83%AD%E3%82%A6/"/>
    
    <category term="owl" scheme="https://jpbap-sqlbi.github.io/blog/tags/owl/"/>
    
    <category term="エラー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A8%E3%83%A9%E3%83%BC/"/>
    
    <category term="error" scheme="https://jpbap-sqlbi.github.io/blog/tags/error/"/>
    
    <category term="トラブルシューティング" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0/"/>
    
  </entry>
  
  <entry>
    <title>REST API を組み合わせて情報を取得する</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/restapi/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/restapi/</id>
    <published>2023-12-28T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:42.066Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。</p><p>Power BI では多くの REST API が用意されていますが、すべての情報を REST API で取得することができるわけではなく、 REST API を組み合わせることで初めて取得することのできる情報があります。今回は例として、<a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/reports-get-reports-as-admin">Admin - Reports GetReportsAsAdmin</a> と <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/reports-get-report-users-as-admin">Admin - Reports GetReportUsersAsAdmin</a> を組み合わせて、テナント内のすべてのレポートのアクセス権限を取得する方法についてご案内します。REST API の開発の際に参考にしていただけますと幸いです。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></li><li><a href="#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%81%AE%E8%A7%A3%E8%AA%AC">コマンドの解説</a><ul><li><a href="#1-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A4%E3%83%B3">1) サインイン</a></li><li><a href="#2-GetReportsAsAdmin-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%97%E3%80%81%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88-ID-%E3%81%A8%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88%E5%90%8D%E3%82%92%E5%8F%96%E5%BE%97">2) GetReportsAsAdmin を実行し、レポート ID とレポート名を取得</a></li><li><a href="#3-%E5%90%84%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88-ID-%E3%81%AB%E5%AF%BE%E3%81%97%E3%81%A6-GetReportUsersAsAdmin-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%97%E3%80%81%E7%B5%90%E6%9E%9C%E3%82%92%E3%83%AA%E3%82%B9%E3%83%88%E3%81%AB%E8%BF%BD%E5%8A%A0">3) 各レポート ID に対して GetReportUsersAsAdmin を実行し、結果をリストに追加</a></li><li><a href="#4-CSV-%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%87%BA%E5%8A%9B">4) CSV ファイルに出力</a></li></ul></li><li><a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85">注意事項</a></li></ul><h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>今回は PowerShell で実行するスクリプトを作成します。早速ですが、作成するスクリプトは以下になります。それぞれのコマンドについて詳しく解説していきます。コマンドを実行する際には、管理者として実行することをおすすめします。管理者として実行しない場合には、エラーが発生する可能性があります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> MicrosoftPowerBIMgmt </span><br><span class="line"></span><br><span class="line"><span class="comment"># 1) サインイン</span></span><br><span class="line"><span class="built_in">Connect-PowerBIServiceAccount</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) GetReportsAsAdmin を実行し、レポート ID とレポート名を取得</span></span><br><span class="line"><span class="variable">$apiUrl</span> = <span class="string">&quot;https://api.powerbi.com/v1.0/myorg/admin/reports&quot;</span></span><br><span class="line"><span class="variable">$response</span> = <span class="built_in">Invoke-PowerBIRestMethod</span> <span class="literal">-Url</span> <span class="variable">$apiUrl</span> <span class="literal">-Method</span> GET | <span class="built_in">ConvertFrom-Json</span></span><br><span class="line"><span class="variable">$reports</span> = <span class="variable">$response</span>.value | <span class="built_in">Select-Object</span> id,name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) 各レポート ID に対して GetDatasetUsersAsAdmin を実行し、結果を追加</span></span><br><span class="line"><span class="variable">$allUsers</span> = <span class="built_in">New-Object</span> <span class="string">&#x27;System.Collections.Generic.List[object]&#x27;</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$report</span> <span class="keyword">in</span> <span class="variable">$reports</span>) &#123;</span><br><span class="line">    <span class="variable">$reportId</span> = <span class="variable">$report</span>.id</span><br><span class="line">    <span class="variable">$reportName</span> = <span class="variable">$report</span>.name</span><br><span class="line">    <span class="variable">$url</span> = <span class="string">&quot;https://api.powerbi.com/v1.0/myorg/admin/reports/<span class="variable">$reportId</span>/users&quot;</span></span><br><span class="line">    <span class="variable">$response</span> = <span class="built_in">Invoke-PowerBIRestMethod</span> <span class="literal">-Url</span> <span class="variable">$url</span> <span class="literal">-Method</span> Get | <span class="built_in">ConvertFrom-Json</span> </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$user</span> <span class="keyword">in</span> <span class="variable">$response</span>.value) &#123;</span><br><span class="line">        <span class="variable">$customObject</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> PSObject <span class="literal">-Property</span> <span class="selector-tag">@</span>&#123;</span><br><span class="line">            ReportId = <span class="variable">$reportId</span></span><br><span class="line">            ReportName = <span class="variable">$reportName</span></span><br><span class="line">            DisplayName = <span class="variable">$user</span>.displayName</span><br><span class="line">            EmailAddress = <span class="variable">$user</span>.emailAddress</span><br><span class="line">            GroupUserAccessRight = <span class="variable">$user</span>.reportUserAccessRight</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$allUsers</span>.Add(<span class="variable">$customObject</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4) CSV ファイルに出力</span></span><br><span class="line"><span class="variable">$csvFilePath</span> = <span class="string">&#x27;./AllReportUsers.csv&#x27;</span></span><br><span class="line"><span class="variable">$allUsers</span> | <span class="built_in">Export-Csv</span> <span class="literal">-Path</span> <span class="variable">$csvFilePath</span> <span class="literal">-NoTypeInformation</span> <span class="literal">-Encoding</span> UTF8</span><br></pre></td></tr></table></figure><p>もし、MicrosoftPowerBIMgmt をインストールしていない場合には、あらかじめ以下の公開情報を参考にしていただきインストールをしていただく必要があります。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/powershell/power-bi/overview?view=powerbi-ps#installation">Windows PowerShellと PowerShell Core 用の Microsoft Power BI コマンドレット - インストール | Microsoft Learn</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> MicrosoftPowerBIMgmt</span><br></pre></td></tr></table></figure><h2 id="コマンドの解説"><a href="#コマンドの解説" class="headerlink" title="コマンドの解説"></a>コマンドの解説</h2><h3 id="1-サインイン"><a href="#1-サインイン" class="headerlink" title="1) サインイン"></a>1) サインイン</h3><p>以下のコマンドを実行して、 Power BI へのサインインを行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1) サインイン</span></span><br><span class="line"><span class="built_in">Connect-PowerBIServiceAccount</span></span><br></pre></td></tr></table></figure><p>もしもサインインを自動で行いたい場合には、以下のスクリプトを実行することでサインインが可能です。ただし、スクリプトにユーザー アカウントやパスワード、サービス プリンシパルのシークレット キーを記載することは危険ですので、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ユーザー アカウントを利用する場合</span></span><br><span class="line"><span class="variable">$PowerBILogin</span> = <span class="string">&quot;&lt;メールアドレス&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBIPassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;&lt;パスワード&gt;&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential (<span class="variable">$PowerBILogin</span>, <span class="variable">$PowerBIPassword</span>)</span><br><span class="line"><span class="built_in">Connect-PowerBIServiceAccount</span> <span class="literal">-Credential</span> <span class="variable">$credential</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># サービス プリンシパルを利用する場合</span></span><br><span class="line"><span class="variable">$clientId</span> = <span class="string">&quot;&lt;アプリケーションID&gt;&quot;</span></span><br><span class="line"><span class="variable">$clientSecret</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;&lt;シークレット キー&gt;&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$tenantId</span> = <span class="string">&quot;&lt;テナントID&gt;&quot;</span></span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$clientId</span>, <span class="variable">$clientSecret</span></span><br><span class="line"><span class="built_in">Connect-PowerBIServiceAccount</span> <span class="literal">-ServicePrincipal</span> <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-TenantId</span> <span class="variable">$tenantId</span></span><br></pre></td></tr></table></figure><p>もしサービス プリンシパルをご利用いただく場合には、以下の記事についてもご参照ください。</p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/ServicePrincipal/">Power BI Service でサービス プリンシパルを利用する | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><h3 id="2-GetReportsAsAdmin-を実行し、レポート-ID-とレポート名を取得"><a href="#2-GetReportsAsAdmin-を実行し、レポート-ID-とレポート名を取得" class="headerlink" title="2) GetReportsAsAdmin を実行し、レポート ID とレポート名を取得"></a>2) GetReportsAsAdmin を実行し、レポート ID とレポート名を取得</h3><p>以下のコマンドで、<a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/reports-get-reports-as-admin">Admin - Reports GetReportsAsAdmin</a> の REST API を実行します。<br>実行結果を変数 <em>response</em> として格納します。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2) GetReportsAsAdmin を実行し、レポート ID とレポート名を取得</span></span><br><span class="line"><span class="variable">$apiUrl</span> = <span class="string">&quot;https://api.powerbi.com/v1.0/myorg/admin/reports&quot;</span></span><br><span class="line"><span class="variable">$response</span> = <span class="built_in">Invoke-PowerBIRestMethod</span> <span class="literal">-Url</span> <span class="variable">$apiUrl</span> <span class="literal">-Method</span> GET | <span class="built_in">ConvertFrom-Json</span></span><br></pre></td></tr></table></figure><p>Invoke-PowerBIRestMethod は、サインインしているプロファイルを利用して Power BI Service への REST API を実行する コマンドです。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoftpowerbimgmt.profile/invoke-powerbirestmethod?view=powerbi-ps">Invoke-PowerBIRestMethod (MicrosoftPowerBIMgmt.Profile) | Microsoft Learn</a></p><p>今回実行する Admin - Reports GetReportsAsAdmin は、 GET の API ですので、 Invoke-PowerBIRestMethod での -Method オプションは GET を指定します。</p><div align="center"><img src="restapi01.png"></div>  <p>この API では、レポート ID やレポート名、作成日時などを取得することができますが、この後の手順に必要なレポート ID とレポート名のみを変数 <em>reports</em> に格納します。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/powershell/module/microsoft.powershell.utility/select-object?view=powershell-7.4">Select-Object (Microsoft.PowerShell.Utility) - PowerShell | Microsoft Learn</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$reports</span> = <span class="variable">$response</span>.value | <span class="built_in">Select-Object</span> id,name</span><br></pre></td></tr></table></figure><h3 id="3-各レポート-ID-に対して-GetReportUsersAsAdmin-を実行し、結果をリストに追加"><a href="#3-各レポート-ID-に対して-GetReportUsersAsAdmin-を実行し、結果をリストに追加" class="headerlink" title="3) 各レポート ID に対して GetReportUsersAsAdmin を実行し、結果をリストに追加"></a>3) 各レポート ID に対して GetReportUsersAsAdmin を実行し、結果をリストに追加</h3><p>以下のコマンドで、 <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/reports-get-report-users-as-admin">Admin - Reports GetReportUsersAsAdmin</a> の REST API を実行します。はじめに結果を格納するための空の配列を作成し、その後、取得したレポート ID ごとにユーザーのアクセス権限を取得･格納しています。今回は、レポート ID 、レポート名、ユーザー名、メールアドレス、アクセス権限を出力するよう設定しています。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3) 各レポート ID に対して GetDatasetUsersAsAdmin を実行し、結果を追加</span></span><br><span class="line"><span class="variable">$allUsers</span> = <span class="built_in">New-Object</span> <span class="string">&#x27;System.Collections.Generic.List[object]&#x27;</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$report</span> <span class="keyword">in</span> <span class="variable">$reports</span>) &#123;</span><br><span class="line">    <span class="variable">$reportId</span> = <span class="variable">$report</span>.id</span><br><span class="line">    <span class="variable">$reportName</span> = <span class="variable">$report</span>.name</span><br><span class="line">    <span class="variable">$url</span> = <span class="string">&quot;https://api.powerbi.com/v1.0/myorg/admin/reports/<span class="variable">$reportId</span>/users&quot;</span></span><br><span class="line">    <span class="variable">$response</span> = <span class="built_in">Invoke-PowerBIRestMethod</span> <span class="literal">-Url</span> <span class="variable">$url</span> <span class="literal">-Method</span> Get | <span class="built_in">ConvertFrom-Json</span> </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$user</span> <span class="keyword">in</span> <span class="variable">$response</span>.value) &#123;</span><br><span class="line">        <span class="variable">$customObject</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> PSObject <span class="literal">-Property</span> <span class="selector-tag">@</span>&#123;</span><br><span class="line">            ReportId = <span class="variable">$reportId</span></span><br><span class="line">            ReportName = <span class="variable">$reportName</span></span><br><span class="line">            DisplayName = <span class="variable">$user</span>.displayName</span><br><span class="line">            EmailAddress = <span class="variable">$user</span>.emailAddress</span><br><span class="line">            GroupUserAccessRight = <span class="variable">$user</span>.reportUserAccessRight</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$allUsers</span>.Add(<span class="variable">$customObject</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-CSV-ファイルに出力"><a href="#4-CSV-ファイルに出力" class="headerlink" title="4) CSV ファイルに出力"></a>4) CSV ファイルに出力</h3><p>最後に、取得した配列をもとに CSV ファイルを作成します。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4) CSV ファイルに出力</span></span><br><span class="line"><span class="variable">$csvFilePath</span> = <span class="string">&#x27;./AllReportUsers.csv&#x27;</span></span><br><span class="line"><span class="variable">$allUsers</span> | <span class="built_in">Export-Csv</span> <span class="literal">-Path</span> <span class="variable">$csvFilePath</span> <span class="literal">-NoTypeInformation</span> <span class="literal">-Encoding</span> UTF8</span><br></pre></td></tr></table></figure><p>以下のような CSV ファイルが作成されます。</p><div align="center"><img src="restapi02.png"></div> <h2 id="注意事項"><a href="#注意事項" class="headerlink" title="注意事項"></a>注意事項</h2><ul><li>REST API ごとに制限事項 (呼び出し回数等) がありますので、実行する際はご注意ください。例えば、GetReportsAsAdmin の REST API は 10 分間で 1 要求までの制限があります。</li><li>重ねてとなりますが、スクリプトにユーザー アカウントやパスワード、サービス プリンシパルのシークレット キーを記載することは危険ですので、実運用時には別ファイルから取得するなどの構成としてください。</li></ul><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;/p&gt;
&lt;p&gt;Power BI では多くの REST API が用意されていますが、すべての情報を REST API で取得することができるわけではなく、 REST API を組み合わせることで初めて取得することのできる情報があります。今回は例として、&lt;a href=&quot;https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/reports-get-reports-as-admin&quot;&gt;Admin - Reports GetReportsAsAdmin&lt;/a&gt; と &lt;a href=&quot;https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/reports-get-report-users-as-admin&quot;&gt;Admin - Reports GetReportUsersAsAdmin&lt;/a&gt; を組み合わせて、テナント内のすべてのレポートのアクセス権限を取得する方法についてご案内します。REST API の開発の際に参考にしていただけますと幸いです。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="REST API" scheme="https://jpbap-sqlbi.github.io/blog/tags/REST-API/"/>
    
  </entry>
  
  <entry>
    <title>オンプレミス データ ゲートウェイのインストールの手順</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/all_gateway_howto_Installation/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/all_gateway_howto_Installation/</id>
    <published>2023-11-29T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.318Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのファムです。</p><p>Power BIサービスに発行したレポートをWebブラウザーやモバイル端末で利用する場合、ファイルやデータベースなどオンプレミス環境（社内ネットワークなど）にあるデータソースの更新にはオンプレミス データ ゲートウェイが必要です。</p><p>本ブログでは、オンプレミス データ ゲートウェイの構築方法についてご紹介いたします。</p><span id="more"></span></br><div class="alert is-important"><p class="alert-title">重要</p><p>弊社サポートをご利用いただいている場合、状況に合わせた調査方針を策定するため、記載の内容とご案内が異なる場合がございます。</p><p>ご不明な点がございましたら弊社サポート担当までお気軽にご質問ください。</p><p>また掲載している画像・手順は投稿時点のものとなります。最新の情報とは異なる可能性がございますので予めご了承ください。</p></div></br><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#1%EF%BC%8E%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%81%A8%E3%81%AF">オンプレミス データ ゲートウェイとは</a></li><li><a href="#2%EF%BC%8E%E6%A8%99%E6%BA%96%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%82%92%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89%E3%81%8A%E3%82%88%E3%81%B3%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B">標準ゲートウェイをダウンロードおよびインストールする</a></li><li><a href="#3%EF%BC%8E%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%EF%BC%9A%E6%A7%8B%E6%88%90%E6%99%82%E3%81%AB%E7%99%BA%E7%94%9F%E3%81%99%E3%82%8B%E3%82%A8%E3%83%A9%E3%83%BC">オンプレミス データ ゲートウェイのトラブルシューティング：構成時に発生するエラー</a></li><li><a href="#4%EF%BC%8EPower-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0%E6%89%8B%E9%A0%86%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">Power BI サービスのデータセット更新手順について</a></li><li><a href="#5%EF%BC%8E%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%81%AE%E3%81%94%E5%8F%82%E8%80%83%E6%83%85%E5%A0%B1">オンプレミス データ ゲートウェイのご参考情報</a></br></li></ol><hr><h2 id="1．オンプレミス-データ-ゲートウェイとは"><a href="#1．オンプレミス-データ-ゲートウェイとは" class="headerlink" title="1．オンプレミス データ ゲートウェイとは"></a>1．オンプレミス データ ゲートウェイとは</h2><p>オンプレミス データ ゲートウェイとは、オンプレミス環境のデータとPower BIサービス間においてセキュリティで保護されたデータ転送を行うための「ブリッジ」です。オンプレミス データ ゲートウェイのイメージは、以下のPower BI構成の概要図をご参考ください。</p></br><div align="center"><img src="pic1.png"></div><p>オンプレミス データ ゲートウェイをご利用いただけるサービスは、Power BI、Power Apps、Power Automate、Azure Analysis Services、および Azure Logic Apps が含まれていますが、本ブログは、Power BIの利用を前提に執筆します。</p><blockquote><p><strong>参考情報</strong><br> <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/wp-onpremises-gateway">オンプレミス ゲートウェイについて</a></p></blockquote><h2 id="2．標準ゲートウェイをダウンロードおよびインストールする"><a href="#2．標準ゲートウェイをダウンロードおよびインストールする" class="headerlink" title="2．標準ゲートウェイをダウンロードおよびインストールする"></a>2．標準ゲートウェイをダウンロードおよびインストールする</h2><ol><li>以下のサイトにアクセスし、「<strong>標準ゲートウェイをダウンロードします</strong>」をクリックします。<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-install">オンプレミス データ ゲートウェイをインストールする</a></li></ol></br><div align="center"><img src="pic2.png"></div><ol start="2"><li>ゲートウェイ インストーラーで、既定のインストール パスをそのまま使用し、利用規約に同意してから、「<strong>インストール</strong>」 を選択します。</li></ol></br><div align="center"><img src="pic3.png"></div><ol start="3"><li>Microsoft 365 組織アカウントのメール アドレスを入力して、「<strong>サインイン</strong>」 を選択します。ここで使用するアカウントが、構成したオンプレミス データ ゲートウェイの管理者となります。</li></ol></br><div align="center"><img src="pic4.png"></div><ol start="4"><li>ゲートウェイの登録画面にて<br>・ゲートウェイがまだ作成されておらず、対象のコンピューターに登録する場合、「<strong>このコンピューターに新しいゲートウェイを登録します。</strong>」を選択し、「<strong>次へ</strong>」をクリックします。手順5をご参考ください。<br>・既存のゲートウェイを対象のコンピューターに移行、復元、または置き換える場合、「<strong>既存のゲートウェイを以降、復元、または置き換えます。</strong>」を選択し、「<strong>次へ</strong>」をクリックします。手順6をご参考ください。</li></ol></br><div align="center"><img src="pic5.png"></div><ol start="5"><li>①にゲートウェイの名前を入力します。 ②に回復キーを入力し、③に確認用として同一の回復キーを入力します。このキーは、ゲートウェイを復旧または移動する場合に必要になります。 「<strong>構成</strong>」 をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div><ol start="6"><li>既存のゲートウェイを移行、復元、または置き換える場合、「<strong>使用可能なゲートウェイ クラスター</strong>」と「<strong>利用可能なゲートウェイ</strong>」を選択し、「<strong>回復キー</strong>」を入力後、「<strong>構成</strong>」をクリックします。</li></ol></br><div align="center"><img src="pic7.png"></div><ol start="7"><li>ゲートウェイの構成が成功すると、以下の画面をご確認いただけます。<br>※画像は 2023年 10月 版の オンプレミス データ ゲートウェイの構成完了画面です。オンプレミス データ ゲートウェイは原則として常に最新版をご利用ください。</li></ol></br><div align="center"><img src="pic8.png"></div><blockquote><p><strong>参考情報</strong><br> <a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-install">オンプレミス データ ゲートウェイをインストールする</a></p></blockquote></br><h2 id="3．オンプレミス-データ-ゲートウェイのトラブルシューティング：構成時に発生するエラー"><a href="#3．オンプレミス-データ-ゲートウェイのトラブルシューティング：構成時に発生するエラー" class="headerlink" title="3．オンプレミス データ ゲートウェイのトラブルシューティング：構成時に発生するエラー"></a>3．オンプレミス データ ゲートウェイのトラブルシューティング：構成時に発生するエラー</h2><p>ゲートウェイ構成時にエラーが発生した際にまずお試しいただきたいトラブルシューティングについて、以下のブログにおまとめしておりますので、併せてご参考ください。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/gateway_troubleshooting/">オンプレミス データ ゲートウェイのトラブルシューティング：構成時に発生するエラー</a></p></br><h2 id="4．Power-BI-サービスのデータセット更新手順について"><a href="#4．Power-BI-サービスのデータセット更新手順について" class="headerlink" title="4．Power BI サービスのデータセット更新手順について"></a>4．Power BI サービスのデータセット更新手順について</h2><p>ゲートウェイが正常に構成できたら、いよいよゲートウェイを経由してデータセットの更新をご設定いただけます。Power BI サービス上でのデータ更新設定方法について、以下のブログにおまとめしておりますので、併せてご参考ください。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_refresh_settings/">Power BI サービスのデータセット更新手順について</a></p></br><h2 id="5．オンプレミス-データ-ゲートウェイのご参考情報"><a href="#5．オンプレミス-データ-ゲートウェイのご参考情報" class="headerlink" title="5．オンプレミス データ ゲートウェイのご参考情報"></a>5．オンプレミス データ ゲートウェイのご参考情報</h2><p>ゲートウェイに関するブログは、下記の公開情報を併せてご参考ください。</p><ol><li><p>以下のブログでは、Power Platform管理センターから組織内のユーザーに対してオンプレミス データ ゲートウェイのインストールを制御する手順をご紹介します。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_gateway_Installation_control/">Power Platform管理センターからオンプレミス データ ゲートウェイのインストールの制御方法</a></p></li><li><p>以下のブログでは、オンプレミス データ ゲートウェイにセキュリティーロールを紹介します。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_gateway_role/">オンプレミス データ ゲートウェイのセキュリティーロール</a></p></li></ol></br>以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。<hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのファムです。&lt;/p&gt;
&lt;p&gt;Power BIサービスに発行したレポートをWebブラウザーやモバイル端末で利用する場合、ファイルやデータベースなどオンプレミス環境（社内ネットワークなど）にあるデータソースの更新にはオンプレミス データ ゲートウェイが必要です。&lt;/p&gt;
&lt;p&gt;本ブログでは、オンプレミス データ ゲートウェイの構築方法についてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="on-premises data gateway" scheme="https://jpbap-sqlbi.github.io/blog/tags/on-premises-data-gateway/"/>
    
    <category term="Gateway" scheme="https://jpbap-sqlbi.github.io/blog/tags/Gateway/"/>
    
    <category term="Install" scheme="https://jpbap-sqlbi.github.io/blog/tags/Install/"/>
    
    <category term="Troubleshooting" scheme="https://jpbap-sqlbi.github.io/blog/tags/Troubleshooting/"/>
    
    <category term="Refresh" scheme="https://jpbap-sqlbi.github.io/blog/tags/Refresh/"/>
    
  </entry>
  
  <entry>
    <title>Power BI のテナント設定の状況を一括抽出する方法</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_api_export_tenant_settings/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_api_export_tenant_settings/</id>
    <published>2023-11-29T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.402Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Power BI を管理していくうえで、テナント設定が今どのような設定状況になっているか、一覧で把握したいというお問い合わせをいただくことがございます。その場合、すべての設定項目を管理ポータルのテナント設定で目視の確認をするには工数がかかりますが、APIを利用する ことで一覧を簡単に抽出することができます。今回はその具体的な方法をご紹介します 。</p><span id="more"></span><div align="center"><img src="1.png"></div></br><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><p> <a href="#%E6%A6%82%E8%A6%81%E3%81%A8%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6">概要と前提条件</a><br> <a href="#%E6%89%8B%E9%A0%86">手順</a><br> <a href="#%E3%83%A6%E3%83%BC%E3%82%B9%E3%82%B1%E3%83%BC%E3%82%B9">ユースケース</a></p><hr><h2 id="概要と前提条件"><a href="#概要と前提条件" class="headerlink" title="概要と前提条件"></a>概要と前提条件</h2><hr><p>REST API の Get Tenant Settings は、テナント設定の全設定状況を 1 つの JSON 応答で返します。</p><p>// 公開情報：<a href="https://learn.microsoft.com/en-us/rest/api/fabric/admin/tenants/get-tenant-settings?tabs=HTTP">Tenants - Get Tenant Settings - REST API (Admin) | Microsoft Learn</a></p><p>この REST API を実行するには、Office 365 グローバル管理者か Fabric 管理者の権限を持っているか、サービス プリンシパルを使用して認証する必要があります。また、Tenant.Read.All または Tenant.ReadWrite.All スコープも必要です。</p></br><hr><h2 id="手順"><a href="#手順" class="headerlink" title="手順"></a>手順</h2><hr><p>具体的な手順は以下です。</p><ol><li>Tenants - Get Tenant Settings のページにアクセスをします。</li></ol><p>// 公開情報：<a href="https://learn.microsoft.com/en-us/rest/api/fabric/admin/tenants/get-tenant-settings?tabs=HTTP">Tenants - Get Tenant Settings - REST API (Admin) | Microsoft Learn</a></p><ol start="2"><li>「Try it」 を押下します。<div align="center"><img src="2.png"></div></li></ol></br><ol start="3"><li>実行する管理者アカウントでサインインします。<br>①「新しいソース」 &gt; 「その他」<div align="center"><img src="3.png"></div></li></ol></br><ol start="4"><li>パラメータなどは特に編集する必要はなく、下部の「Run」 押下します。</li></ol><div align="center"><img src="4.png"></div></br><ol start="5"><li>結果が返ります。各項目の意味は以下のとおりです。</li></ol><div align="center"><img src="5.png"></div></br><hr><h2 id="ユースケース"><a href="#ユースケース" class="headerlink" title="ユースケース"></a>ユースケース</h2><hr><p>よくあるお問い合わせのシナリオから、本記事で紹介した機能のユースケースをいくつか箇条書きでご紹介いたします。同じご要望がある場合、ご参考にしていただけますと幸いです。<br></br><br>•    現在 の構成を設定状況から文書化する<br>•    管理者以外のユーザーとテナント設定の状況を共有する<br>•    さまざまな環境 (開発、テスト、運用など) のテナント設定の比較する<br>•    テナント設定の変更履歴を保存して、必要に応じて追跡する<br>•    etc</p></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 公開情報：<a href="https://learn.microsoft.com/en-us/rest/api/fabric/admin/tenants/get-tenant-settings?tabs=HTTP">Tenants - Get Tenant Settings - REST API (Admin) | Microsoft Learn</a></p></div></br><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Power BI を管理していくうえで、テナント設定が今どのような設定状況になっているか、一覧で把握したいというお問い合わせをいただくことがございます。その場合、すべての設定項目を管理ポータルのテナント設定で目視の確認をするには工数がかかりますが、APIを利用する ことで一覧を簡単に抽出することができます。今回はその具体的な方法をご紹介します 。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="テナント設定" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A/"/>
    
  </entry>
  
  <entry>
    <title>Power BI の行レベルのセキュリティー (RLS)</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_rls/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_rls/</id>
    <published>2023-10-31T06:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.806Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのチャンです。 </p><p>Power BI でレポートを共有するにあたり、同じレポートで閲覧する場合でも、ユーザーごとで閲覧可能なデータの範囲を設定したい業務要件がよく見られます。今回はユーザーごとで表示されるデータの制御を実施できる Power BI の行レベルのセキュリティーという機能を詳しく案内していきます。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6">前提条件</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E4%BE%8B">使用例</a></li><li><a href="#%E8%80%83%E6%85%AE%E4%BA%8B%E9%A0%85%E3%81%A8%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85">考慮事項と制限事項</a></li></ol><hr><h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><hr><p>行レベルのセキュリティー (RLS: Row-level Security) は、すべての権限のユーザーに対して適用する機能ではございません。ワークスペースに対して、コンテンツの作成、編集、削除ができない権限を有しているユーザーにのみ適用可能です。<br>また、RLSが適用されないユーザーは、セキュリティフィルターが適用されず、すべてのデータ行が見られます。</p><h4 id="〇-RLS-が適用されるユーザーの権限"><a href="#〇-RLS-が適用されるユーザーの権限" class="headerlink" title="〇 RLS が適用されるユーザーの権限"></a>〇 RLS が適用されるユーザーの権限</h4><ul><li>ワークスペースのビューアー</li><li>レポートの読み取り</li><li>組織アプリの読み取り</li></ul><h4 id="×-RLS-が適用されないユーザーの権限"><a href="#×-RLS-が適用されないユーザーの権限" class="headerlink" title="× RLS が適用されないユーザーの権限"></a>× RLS が適用されないユーザーの権限</h4><ul><li>ワークスペースの管理者</li><li>ワークスペースのメンバー</li><li>ワークスペースの共同作成者</li></ul><p>もしユーザーが同時に RLS が適用されない権限（例：ワークスペースのメンバー）のグループと、 RLS が適用される権限（例：ワークスペースのビューアー）のグループに所属している場合、上位の権限であるメンバーが適用されるため、 RLS によって閲覧可能なデータ範囲の制御は機能しません。</p><h4 id="■-上位から下位のワークスペース権限"><a href="#■-上位から下位のワークスペース権限" class="headerlink" title="■ 上位から下位のワークスペース権限"></a>■ 上位から下位のワークスペース権限</h4><p>管理者 &gt; メンバー &gt; 共同作成者 &gt; ビューアー</p><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-rls">Power BI での行レベルのセキュリティ (RLS) - Power BI | Microsoft Learn</a></p></blockquote><hr><h2 id="使用例"><a href="#使用例" class="headerlink" title="使用例"></a>使用例</h2><hr><p>行レベルセキュリティー (RLS) は、主にデータのフィルター条件を直接に記載するシンプルな方法と、ユーザーのユーザープリンシパル名 (UPN) を検知してデータテーブルのリレーションシップによって動的に制御する方法がございます。</p><p>以下にてそれぞれ使用例をご紹介いたします。</p><ul><li><a href="#%E2%96%A0-%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6">前提条件</a></li><li><a href="#%E2%96%A0-%E4%BD%BF%E7%94%A8%E4%BE%8B%E2%91%A0%EF%BC%9A%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%BC%E6%9D%A1%E4%BB%B6%E3%82%92%E7%9B%B4%E6%8E%A5%E3%81%AB%E8%A8%98%E8%BC%89%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">使用例①：静的なフィルター</a></li><li><a href="#%E2%96%A0-%E4%BD%BF%E7%94%A8%E4%BE%8B%E2%91%A1%EF%BC%9A%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E5%90%8D%E3%82%92%E6%A4%9C%E7%9F%A5%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%B7%E3%83%83%E3%83%97%E3%81%AB%E3%82%88%E3%81%A3%E3%81%A6%E5%8B%95%E7%9A%84%E3%81%AB%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">使用例②：動的なフィルター</a></li></ul><h3 id="■-前提条件"><a href="#■-前提条件" class="headerlink" title="■ 前提条件"></a>■ 前提条件</h3><p>二つの例ともに、ユーザーのアクセス権限の追加手順を省略していますが、レポートを発行したワークスペースに対して、事前に対象のRLS適用ユーザーを「ビューアー」として追加していることを前提としています。</p><blockquote><p><strong>参考情報</strong><br><a href="../pbi_contents_share_1/">Power BI サービスでのコンテンツ共有方法の種類</a></p></blockquote><h3 id="■-使用例①：フィルター条件を直接に記載する方法"><a href="#■-使用例①：フィルター条件を直接に記載する方法" class="headerlink" title="■ 使用例①：フィルター条件を直接に記載する方法"></a>■ 使用例①：フィルター条件を直接に記載する方法</h3><p>フィルター条件を直接に記載する方法の手順についてご紹介いたします。</p><ol><li><p>Power BI Desktop でレポートを開き、[モデリング] &gt; [ロールの管理] の順で選択すると、ロールの管理のウィザードが表示されます。<br>[新規] をクリックし、ロールの名前を入力いただき、フィルター条件をかけたいテーブルを選択し、フィルター条件の設定を実施します。<br>以下の例では、Country が「 Canada 」のデータのみを閲覧できるように、RLS のロールを作成します。</p><div align="center"><img src="role_filter.png"></div></li><li><p>[DAX エディターに切り替えるボタン] をクリックいただくと、直接 DAX のフィルター条件を記載いただくことも可能です。</p><div align="center"><img src="role_filter_dax.png"></div></li><li><p>保存すれば、これで Power BI Desktop での設定は完了ですが、こちらの設定で正しくフィルターかけているかを確認するために、[モデリング] &gt; [表示方法] を選択し、先ほど作成したロールを選択して、[OK] で確定させれば、そのロールで表示した場合の画面をご確認いただけます。</p><div align="center"><img src="test_result_country_canada.png"></div></li><li><p>問題なく設定できていることを確認できたら、レポートを Power BI サービスへ発行します。</p></li><li><p>発行後に、こちらのロールを適用したいユーザーを追加する必要があるため、データセットに対して […] &gt; [セキュリティ]を選択します。</p><div align="center"><img src="dataset_security.png"></div></li><li><p>次の画面で、適用したいユーザーを追加します。</p><div align="center"><img src="dataset_security_user.png"></div></li><li><p>追加後に、ロールに対して[…] &gt; [ロールとしてテスト] を実施し、想定通りの表示ができるかテストします。</p><div align="center"><img src="dataset_security_roletest.png"></div></li><li><p>[次のユーザーとして表示] を選択すると、特定のユーザーの観点でどうデータが見られるかのテストが可能です。<br>以下 User01 の例では、想定通りのフィルターがかかった状態のレポートが表示されることを確認できました。</p><div align="center"><img src="dataset_security_roletest_user01.png"></div><br>また、セキュリティのロールに追加されていない User02 の例では、適切なロールが適用されないため、ビジュアルの部分にエラーが表示されます。<br><div align="center"><img src="dataset_security_roletest_user02.png"></div></li></ol><div class="alert is-success"><p class="alert-title">ヒント</p><p>本記事では、Power BI Desktop で RLS ロールを作成する方法を紹介していますが、現在 Power BI サービスでRLS ロールを作成する、及びセキュリティで対象のユーザーを割り当てることができるようになっていますので、詳細に関しては以下のブログ記事をご参考ください。</p><p><a href="../pbi_modify_model_in_service/">Power BI サービスでデータモデルを編集する</a></p></div><h3 id="■-使用例②：ユーザーのユーザープリンシパル名を検知してデータテーブルのリレーションシップによって動的に制御する方法"><a href="#■-使用例②：ユーザーのユーザープリンシパル名を検知してデータテーブルのリレーションシップによって動的に制御する方法" class="headerlink" title="■ 使用例②：ユーザーのユーザープリンシパル名を検知してデータテーブルのリレーションシップによって動的に制御する方法"></a>■ 使用例②：ユーザーのユーザープリンシパル名を検知してデータテーブルのリレーションシップによって動的に制御する方法</h3><p>RLS の適用対象ユーザーが少ない場合には、各ユーザーに対して、適用するフィルターを Power BI 内のロール管理で実施いただけますが、大量なユーザーに対してそれぞれ異なるフィルター条件を設定する場合には、画面上の操作では相当な労力や時間がかかることが想定されます。</p><p>以下にて、その際の代替案をご案内します。こちらの方法では、事前にフィルター条件が含まれているデータテーブルを用意いただく必要がございますが、ユーザーのユーザープリンシパル名 (UPN) を検知して動的に閲覧可能なデータを制御できます。</p><ol><li>以下の例では、ユーザーが所属しているセグメントの情報を利用して、該当セグメントによって閲覧可能なデータを制御します。<br>実際の運用シナリオにおいて、セグメントを、各会社の部署、事業部などに置き換えて想像いただければと思います。<br>まず、以下のような3つのテーブルを用意します。</li></ol><ul><li><b>所属部署の一覧のマスターテーブル</b><br>例：Segmentテーブル<br><div align="center"><img src="table_segment.png"></div></li><li><b>所属部署とユーザープリンシパル名が紐づいたマスターテーブル</b><br>例：UPN_Segmentテーブル<br><div align="center"><img src="table_segment_upn.png"></div></li><li><b>売上情報といったファクトテーブル</b><br>例：Salesテーブル<br><div align="center"><img src="table_sales.png"></div></li></ul><ol start="2"><li><p>Power BI のレポートにインポートし、以下画像のようにリレーションシップを設定します。<br>•    Segmentテーブルから、Salesテーブルに対して、1対多の単一方向のリレーションシップ<br>•    UPN_Segmentテーブルから、Segmentテーブルに対して、1対多の双方向リレーションシップ、かつ両方向にセキュリティーフィルターを適用する</p><br><div align="center"><img src="rls_relationships.png"></div><br></li><li><p>[モデリング] &gt; [ロールの管理] にて、新規のロールを作成し、UPN情報が入っているテーブルで、[DAX エディターに切り替えるボタン] をクリックいただき、以下の関数を入力します。<br>※ [UPN] は列名なので、適宜UPN情報の列名を置き換えてください。</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[UPN] = USERPRINCIPALNAME()</span><br></pre></td></tr></table></figure><br><div align="center"><img src="role_upn.png"></div>  4. ここまで設定した内容を保存すれば、これで Power BI Desktop での設定は完了ですが、こちらの設定で正しくフィルターかけているかを確認するために、[モデリング] > [表示方法] を選択し、先ほど作成したロールを選択した上で、[その他のユーザー] にてテストしたいユーザープリンシパル名を入力し、[OK] で確定させれば、そのロールとユーザー名で表示した場合の画面をご確認いただけます。<br><div align="center"><img src="test_result_segment_role.png"></div><ol start="5"><li><p>問題なく設定できていることを確認できたら、レポートを Power BI サービスへ発行します。</p></li><li><p>発行後に、こちらのロールを適用したいユーザーを追加する必要があるため、データセットに対して […] &gt; [セキュリティ]を選択します。</p><div align="center"><img src="dataset_security.png"></div></li><li><p>次の画面で、適用したいユーザーやユーザーをメンバーとして追加したセキュリティグループを追加します。</p><div align="center"><img src="dataset_security_usergroup.png"></div></li></ol><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/admin/email/create-edit-or-delete-a-security-group?view=o365-worldwide">Microsoft 365 管理センターでセキュリティ グループを作成、編集、削除する | Microsoft Learn</a></p></blockquote><ol start="8"><li><p>追加後に、ロールに対して[…] &gt; [ロールとしてテスト] を実施し、想定通りの表示ができるかテストします。</p><div align="center"><img src="dataset_security_roletest2.png"></div></li><li><p>[次のユーザーとして表示] を選択すると、特定のユーザーの観点でどうデータが見られるかのテストが可能です。<br>以下 User01 の例では、想定通りのフィルターがかかった状態のレポートが表示されることを確認できました。</p><div align="center"><img src="dataset_security_roletest_user01_2.png"></div></li></ol><div class="alert is-success"><p class="alert-title">ヒント</p><p>本記事では、Power BI Desktop で RLS ロールを作成する方法を紹介していますが、現在 Power BI サービスでRLS ロールを作成する、及びセキュリティで対象のユーザーを割り当てることができるようになっていますので、詳細に関しては以下のブログ記事をご参考ください。</p><p><a href="../pbi_modify_model_in_service/">Power BI サービスでデータモデルを編集する</a></p></div><hr><h2 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h2><hr><h4 id="ゲストユーザーに対する-RLS"><a href="#ゲストユーザーに対する-RLS" class="headerlink" title="ゲストユーザーに対する RLS"></a>ゲストユーザーに対する RLS</h4><p>ゲストユーザーに対しても、RLSを適用することが可能ですが、Microsoft Entra（旧 Azure Active Directory）上では、ゲストユーザーのユーザープリンシパル名 (UPN) に #EXT# 識別子が含まれています。</p><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/entra/external-id/user-properties#key-properties-of-the-microsoft-entra-b2b-collaboration-user">Microsoft Entra B2B コラボレーション ユーザーのプロパティ | Microsoft Learn</a></p></blockquote><p>しかしながら、Power BI で USERPRINCIPALNAME() でユーザーの UPN を取得する場合は、Power BI サービスへサインインしているユーザー名を取得します。ユーザー名は、プロファイルアイコンをクリックして、ご確認いただけます。こちらのユーザー名は、ほとんどの場合は、 #EXT# 識別子を含まない本来のメールアドレスとなります。</p><div align="center"><img src="profile_icon_upn.png"></div><p>もし前セッションで紹介した<a href="#%E2%96%A0-%E4%BD%BF%E7%94%A8%E4%BE%8B%E2%91%A1%EF%BC%9A%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E5%90%8D%E3%82%92%E6%A4%9C%E7%9F%A5%E3%81%97%E3%81%A6%E3%83%87%E3%83%BC%E3%82%BF%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB%E3%81%AE%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%B7%E3%83%83%E3%83%97%E3%81%AB%E3%82%88%E3%81%A3%E3%81%A6%E5%8B%95%E7%9A%84%E3%81%AB%E5%88%B6%E5%BE%A1%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">使用例②</a>の方を採用する場合、ユーザープリンシパル名 (UPN) はゲストユーザーが Power BI サービスへサインインする際のユーザー名に準じます。</p><blockquote><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/rls-guidance">Power BI Desktop での行レベルのセキュリティ (RLS) のガイダンス | Microsoft Learn</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-rls">Power BI での行レベルのセキュリティ (RLS) | Microsoft Learn</a></li></ul></blockquote><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。 </p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのチャンです。 &lt;/p&gt;
&lt;p&gt;Power BI でレポートを共有するにあたり、同じレポートで閲覧する場合でも、ユーザーごとで閲覧可能なデータの範囲を設定したい業務要件がよく見られます。今回はユーザーごとで表示されるデータの制御を実施できる Power BI の行レベルのセキュリティーという機能を詳しく案内していきます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="データモデル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB/"/>
    
    <category term="行レベルのセキュリティー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%A1%8C%E3%83%AC%E3%83%99%E3%83%AB%E3%81%AE%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%BC/"/>
    
    <category term="RLS" scheme="https://jpbap-sqlbi.github.io/blog/tags/RLS/"/>
    
    <category term="ユーザーごと表示されるデータの制御" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%94%E3%81%A8%E8%A1%A8%E7%A4%BA%E3%81%95%E3%82%8C%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%88%B6%E5%BE%A1/"/>
    
    <category term="Row Level Security" scheme="https://jpbap-sqlbi.github.io/blog/tags/Row-Level-Security/"/>
    
    <category term="ロール管理" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AD%E3%83%BC%E3%83%AB%E7%AE%A1%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>pbix ファイルのデータソースのファイル格納場所が変更される場合の対処策</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_changing_datasource_file_place/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_changing_datasource_file_place/</id>
    <published>2023-09-29T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.414Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Excel ファイルや CSV ファイルをデータソースにして Power BI レポートを作成したあと、「ファイルの格納場所が変更になる」という場合がございます。<br>その場合、基本的にはレポートを新規作成して新しい格納場所にあるファイルに接続をしますが、既存レポートが作りこんだ内容である場合、「そのレポートの作りを残したままデータソースの接続先だけを変更したい」というお問い合わせがよくあります。今回はその代表的な対処策を１つご紹介します。</p><span id="more"></span><div align="center"><img src="1.jpg"></div></br><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><p> <a href="#%E6%9C%AC%E3%83%96%E3%83%AD%E3%82%B0%E3%81%AE%E5%89%8D%E6%8F%90">本ブログの前提</a><br> <a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E6%A0%BC%E7%B4%8D%E5%A0%B4%E6%89%80%E3%81%8C%E5%A4%89%E6%9B%B4%E3%81%95%E3%82%8C%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E5%AF%BE%E5%87%A6%E7%AD%96">データソースのファイルの格納場所が変更される場合の対処策</a></p><hr><h2 id="本ブログの前提"><a href="#本ブログの前提" class="headerlink" title="本ブログの前提"></a>本ブログの前提</h2><hr><p>Excel ファイルや CSV ファイルをデータソースにしていて、そのファイルの格納場所がローカルフォルダから SharePoint フォルダに変更される場合その逆、またはローカルフォルダ内（SharePoint フォルダ内）で移動される場合を想定しています。</p></br><hr><h2 id="データソースのファイルの格納場所が変更される場合の対処策"><a href="#データソースのファイルの格納場所が変更される場合の対処策" class="headerlink" title="データソースのファイルの格納場所が変更される場合の対処策"></a>データソースのファイルの格納場所が変更される場合の対処策</h2><hr><p>Power BI Desktop で pbixファイルを開いて、Power Query エディターで、データソースの接続部分を新しい接続先に差し替えます。具体的な手順は以下です。</p><ol><li><p>バックアップとして、対象の pbix ファイルをコピーしておきます。</p></li><li><p>対象の pbix ファイルを開き、「データの変換」から Power Query エディターを開きます。</p><div align="center"><img src="2.jpg"></div></li></ol></br><ol start="3"><li>新しい接続先のダミーのクエリを以下の手順で生成してコピーします。<br>①「新しいソース」 &gt; 「その他」<div align="center"><img src="3.jpg"></div></li></ol></br><p>② 新しい接続先のコネクタ（以下例は SharePoint フォルダー）でデータを取得します。</p><div align="center"><img src="4.jpg"></div></br><p>③ ②で作成した新しいクエリ（テーブル）を選択 &gt; ホーム &gt; 詳細エディター　を押して、<br>クエリ（画像の赤太枠の部分）をコピーして、「キャンセル」で閉じます。</p><div align="center"><img src="5.jpg"></div></br><ol start="4"><li>既存のクエリ（テーブル）選択  &gt; ホーム &gt; 詳細エディター　を押して、３でコピーしたクエリの部分（例でいうと「ソース」から「変更された型」まで）を差し替えます。</li></ol><div align="center"><img src="6.jpg"></div></br><p>※注意点<br>・貼り付け用のクエリ以上の部分を消さないようにします（上記画像だと「追加されたカスタム」の行は残す）<br>・貼り付けたクエリのうしろにステップが存在する場合は、以下画像のように貼り付けたクエリの最後に「,（カンマ）」を忘れずに付けます（付けないと「’,’ が必要です」というエラーメッセージが出る）</p><div align="center"><img src="7.jpg"></div></br><p>・読み込んでいるクエリ（テーブル）が複数ある場合は、すべて差し替えます。</p><p>（差し替えがすべて完了したら、手順３で作成したダミーのクエリは削除して問題ありません。）</p></br><p>４．Power Query エディターを「閉じて適用」をします。</p><div align="center"><img src="8.jpg"></div></br>適用後は、レポートが変更前と変わらず表示できていることを確認しましょう。Power BI サービスにレポートを発行している場合は、再度、発行をしてデータセット更新の設定を改めて行ってください。</br><p>上記でご紹介した内容はあくまで１つの方法論でございます。<br>結論としては、Power Query 内のデータソースへの接続部分のクエリで、データソースの変更後の格納場所や名前を問題なく指定することができれば解決となります。 </p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort">レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn</a></p></div></br><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Excel ファイルや CSV ファイルをデータソースにして Power BI レポートを作成したあと、「ファイルの格納場所が変更になる」という場合がございます。&lt;br&gt;その場合、基本的にはレポートを新規作成して新しい格納場所にあるファイルに接続をしますが、既存レポートが作りこんだ内容である場合、「そのレポートの作りを残したままデータソースの接続先だけを変更したい」というお問い合わせがよくあります。今回はその代表的な対処策を１つご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
    <category term="データソース設定" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E8%A8%AD%E5%AE%9A/"/>
    
  </entry>
  
  <entry>
    <title>Power BI 利用時のパフォーマンス測定や最適化について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/performance/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/performance/</id>
    <published>2023-09-29T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:42.058Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。</p><p>Power BI Service でデータ更新を行った際に、以下のエラーが発生したことはありませんか。</p><blockquote><p>Resource Governing: This query uses more memory than the configured limit. The query — or calculations referenced by it — might be too memory-intensive to run. Either simplify the query or its calculations, or if using Power BI Premium, you may reach out to your capacity administrator to see if they can increase the per-query memory limit. More details: consumed memory 6369 MB, memory limit 6144 MB. See <a href="https://go.microsoft.com/fwlink/?linkid=2159752">https://go.microsoft.com/fwlink/?linkid=2159752</a> to learn more.</p></blockquote><p>こちらのエラーは、データセットの更新時にクエリあたりのメモリ上限を超過した際に発生するエラーとなります。本エラーが発生した場合、基本的には上位の SKU にアップグレードしてリソースを増強する必要がありますが、データモデルの最適化やビジュアルの修正によってエラーが解消する場合もございます。パフォーマンス改善に役立つ公開情報についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#Power-BI-Desktop">Power BI Desktop</a><ul><li><a href="#1-%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E6%9C%80%E9%81%A9%E5%8C%96">1.データモデルの最適化</a></li><li><a href="#2-%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9%E3%81%AE%E6%B8%AC%E5%AE%9A">2.パフォーマンスの測定</a></li><li><a href="#3-%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88%E9%96%8B%E7%99%BA%EF%BD%A5%E5%8F%82%E7%85%A7%E3%81%AE%E5%8A%B9%E7%8E%87%E5%8C%96">3.レポート開発･参照の効率化</a></li></ul></li><li><a href="#Power-BI-Service">Power BI Service</a></li><li><a href="#Power-BI-Premium-Per-Capacity-Premium-%E5%AE%B9%E9%87%8F">Power BI Premium Per Capacity (Premium 容量)</a></li><li><a href="#Microsoft-Fabric">Microsoft Fabric</a></li></ul><h2 id="Power-BI-Desktop"><a href="#Power-BI-Desktop" class="headerlink" title="Power BI Desktop"></a>Power BI Desktop</h2><p>Power BI Desktop でのパフォーマンス測定･改善については、1) データモデルの改善、 2) パフォーマンスの測定 についてご案内します。</p><h3 id="1-データモデルの最適化"><a href="#1-データモデルの最適化" class="headerlink" title="1.データモデルの最適化"></a>1.データモデルの最適化</h3><p>前提としてデータモデルは、スタースキーマで構築されることが推奨されます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/star-schema">スター スキーマと Power BI での重要性を理解する - Power BI | Microsoft Learn</a></p></div><p>処理が複雑となる場合は、 Power BI で列を追加したり、メジャーを作成したりすることや、 Power Query での加工処理を行うと、 Power BI Desktop ではクライアントのリソースを、 Power BI Service では共有リソースを使用するため、データソース側で行うことが望ましいです。 Power BI で変換を行う場合には利用しているデータモデルに応じて以下の公開情報を参照してデータモデルの最適化をご検討ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/import-modeling-data-reduction">インポート モデリングのデータ削減手法 - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/directquery-model-guidance">Power BI Desktop の DirectQuery モデルのガイダンス - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/composite-model-guidance">Power BI Desktop の複合モデルのガイダンス - Power BI | Microsoft Learn</a></p></div><p>Power Query を使用する場合には以下のベスト プラクティスをご一読ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-query/best-practices">Power Query を使用するときのベスト プラクティス - Power Query | Microsoft Learn</a></p></div><h3 id="2-パフォーマンスの測定"><a href="#2-パフォーマンスの測定" class="headerlink" title="2.パフォーマンスの測定"></a>2.パフォーマンスの測定</h3><p>パフォーマンス アナライザーを利用することで、レポートでどのビジュアルの表示に時間がかかっているか、またどの部分がボトルネックになっているかを確認することができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-performance-analyzer">Power BI Desktop でパフォーマンス アナライザーを使用してレポート要素のパフォーマンスを確認する - Power BI | Microsoft Learn</a></p></div><p>外部ツールとなりますが、 DAX Studio を利用することでもパフォーマンスを確認することができます。DAX Studio を利用する場合には、パフォーマンス アナライザーを利用してクエリ実行時のデータを .json ファイルとしてエクスポートし、エクスポートした .json ファイルを DAX Studio で読み込むことで、クエリの一覧を確認し、実行速度順にクエリを確認することや、また、クエリを再度実行することで DAX Studio 上でクエリの詳細を確認することができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://www.sqlbi.com/articles/importing-performance-analyzer-data-in-dax-studio/">Importing Performance Analyzer data into DAX Studio - SQLBI</a></p></div><h3 id="3-レポート開発･参照の効率化"><a href="#3-レポート開発･参照の効率化" class="headerlink" title="3.レポート開発･参照の効率化"></a>3.レポート開発･参照の効率化</h3><p>レポートの開発時には、 [最適化リボン] を利用することでビジュアルを追加した際のデータ更新を停止することができるため、データソースが大容量の場合であってもデータが読み込まれる時間を削減することができ、効率的な開発が可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-optimize-ribbon">Power BI Desktop の最適化リボン - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-optimize-ribbon-scenarios">Power BI Desktop の最適化リボンを使用した DirectQuery 最適化のシナリオ - Power BI | Microsoft Learn</a></p></div><p>また、レポートのスライサーやフィルターが多い場合には、一度にスライサーやフィルターを適用することで、クエリの実行回数を減らすことができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/buttons-apply-all-clear-all-slicers?tabs=powerbi-desktop">レポートにすべてのスライサーを適用およびクリアするボタンを作成する - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/power-bi-report-filter?tabs=powerbi-desktop#apply-filters-button">Power BI レポートでフィルターを書式設定する - フィルターの [適用] ボタン | Microsoft Learn</a></p></div><h2 id="Power-BI-Service"><a href="#Power-BI-Service" class="headerlink" title="Power BI Service"></a>Power BI Service</h2><p>現在、プレビュー機能で Power BI Service でもデータモデルの編集が可能ですが、 Power BI Service からデータモデルを編集する場合にも Power BI Desktop で紹介したデータモデルのデータ削減方法が利用できます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/service-edit-data-models">Power BI サービスでデータ モデルを編集する (プレビュー) - Power BI | Microsoft Learn</a></p></div><p>Power BI Service では、データフローを利用することでデータの加工が可能です。データフローをご利用いただいている場合には以下の公開情報をご一読ください。複数のトピックについてリンクがあります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/dataflows/dataflows-best-practices">データフローのベスト プラクティス - Power BI | Microsoft Learn</a></p></div><div align="center"><img src="performance01.png"></div>  <h2 id="Power-BI-Premium-Per-Capacity-Premium-容量"><a href="#Power-BI-Premium-Per-Capacity-Premium-容量" class="headerlink" title="Power BI Premium Per Capacity (Premium 容量)"></a>Power BI Premium Per Capacity (Premium 容量)</h2><p>Premium 容量では、パフォーマンスをモニタリングするためのアプリがあります。アプリから時系列で容量の利用率や上限を超過しているかどうかの推移や、各アイテムのリソースの利用状況をご確認いただけます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-install-app?tabs=1st">Premium メトリック アプリをインストールする - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-metrics-app">Premium メトリック アプリを使用して Power BI Premium 容量を監視します。 - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-concepts">Power BI Premium の最大能力負荷、過負荷、自動スケーリング - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-smoothing">Power BI Premium の CPU スムージング。 - Power BI | Microsoft Learn</a></p></div><p>また、データセットの使用できるメモリの使用量上限の設定など、データセット、データフローの更新やクエリ、ページ分割されたレポートの実行、AI 機能を処理する各ワークロードの動作を制御することも可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-premium-workloads">Power BI Premium でワークロードを構成する方法 - Power BI | Microsoft Learn</a></p></div><div align="center"><img src="performance02.png"></div>  <p>Premium 容量の P1･P2 をご利用いただいている場合で、冒頭に記載したクエリあたりの最大メモリエラーが発生している場合、Premium Per User (PPU) 試用版を利用することで、上位の SKU にアップグレードした場合にエラーが解消するかを確認することが可能です。PPU は、 Premium 容量の SKU の P3 に相当するため、試用版を利用して一度更新を実行いただき、エラーが解消する場合には SKU のアップグレードをご検討ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-what-is#capacities-and-skus">Power BI Premium とは - 容量と SKU | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/service-self-service-signup-for-power-bi#use-self-service-sign-up-to-start-an-individual-trial-of-the-power-bi-paid-version">個人として Power BI サービスにサインアップまたは購入する - セルフサービス サインアップを使用して Power BI 有料バージョンの個人向け試用版を開始する | Microsoft Learn</a></p></div><div align="center"><img src="performance03.png"></div>  <h2 id="Microsoft-Fabric"><a href="#Microsoft-Fabric" class="headerlink" title="Microsoft Fabric"></a>Microsoft Fabric</h2><p>Microsoft Fabric についても、Premium 容量と同様にパフォーマンス測定のためのアプリがあります。Premium 容量と同様に、アプリから時系列で容量の利用率や上限を超過しているかどうかの推移や、各アイテムのリソースの利用状況をご確認いただけます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app">Microsoft Fabric Capacity Metrics アプリとは? - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app-install?tabs=1st">Microsoft Fabric Capacity Metrics (Microsoft Fabric 容量メトリック) アプリをインストールする - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app-overview-page">メトリック アプリの概要ページを理解する - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/metrics-app-timepoint-page">メトリック アプリのタイムポイント ページについて - Microsoft Fabric | Microsoft Learn</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;/p&gt;
&lt;p&gt;Power BI Service でデータ更新を行った際に、以下のエラーが発生したことはありませんか。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Resource Governing: This query uses more memory than the configured limit. The query — or calculations referenced by it — might be too memory-intensive to run. Either simplify the query or its calculations, or if using Power BI Premium, you may reach out to your capacity administrator to see if they can increase the per-query memory limit. More details: consumed memory 6369 MB, memory limit 6144 MB. See &lt;a href=&quot;https://go.microsoft.com/fwlink/?linkid=2159752&quot;&gt;https://go.microsoft.com/fwlink/?linkid=2159752&lt;/a&gt; to learn more.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;こちらのエラーは、データセットの更新時にクエリあたりのメモリ上限を超過した際に発生するエラーとなります。本エラーが発生した場合、基本的には上位の SKU にアップグレードしてリソースを増強する必要がありますが、データモデルの最適化やビジュアルの修正によってエラーが解消する場合もございます。パフォーマンス改善に役立つ公開情報についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="データセット" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88/"/>
    
    <category term="パフォーマンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%91%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%B3%E3%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Desktop のインストール・更新方法について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/powerbidesktop_install/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/powerbidesktop_install/</id>
    <published>2023-09-28T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:42.066Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI Desktop にはインストール方法が 2 種類あることをご存じですか？<br>最小要件や提供される機能は基本的には同じですが、いくつかの制限事項や違いがあります。<br>本記事では、両者の違いをわかりやすくご案内しておりますので、どちらのインストール方法を採用するか迷った際にはご参考にしていただけますと幸いです。   </p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="Power-BI-Desktop-のインストール方法は２種類"><a href="#Power-BI-Desktop-のインストール方法は２種類" class="headerlink" title="Power BI Desktop のインストール方法は２種類"></a><font color="DodgerBlue">Power BI Desktop のインストール方法は２種類</font></h2><p>Power BI Desktop は、以下２つの方法で Windows 8.1 以上の PC にインストールして使用できる無償のアプリケーションです。   </p><p>・<a href="https://www.microsoft.com/ja-jp/download/details.aspx?id=58494">ダウンロードセンター</a>から Power BI Desktop のインストーラをダウンロードしてインストールする<br>・Microsoft Store からインストールする  </p><p>ご参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-get-the-desktop">Power BI Desktop の取得</a> </p><h3 id="Power-BI-Desktop-のインストーラをダウンロードしてインストールする"><a href="#Power-BI-Desktop-のインストーラをダウンロードしてインストールする" class="headerlink" title="Power BI Desktop のインストーラをダウンロードしてインストールする"></a><font color="HotPink">Power BI Desktop のインストーラをダウンロードしてインストールする</font></h3><p>ダウンロードセンターから、ご使用の OS と同じ bit 数のインストーラをダウンロードしインストールします。<br>この方法でインストールした場合、次回以降の更新は毎回同じように、ダウンロードセンターからインストーラを取得して上書きインストールする必要があります。<br>また、インストール時には管理者権限が必要です。<br>組織やユーザーのタイミングで更新を行いたい場合や、Microsoft Store を利用できない場合はこちらの方法をご検討いただければと思います。     </p><h3 id="Microsoft-Store-からインストールする"><a href="#Microsoft-Store-からインストールする" class="headerlink" title="Microsoft Store からインストールする"></a><font color="HotPink">Microsoft Store からインストールする</font></h3><p>Microsoft Store からストアアプリとしてインストールします。<br>インストール後の Power BI Desktop アプリとしての機能は基本的にはダウンロードセンターから入手したものと差はありません。<br>ストアアプリとは Microsoft Store から入手・自動更新できるアプリであり、管理者権限を必要とせず標準ユーザーでもインストールできるように設計されています。<br>サンドボックスという、他のアプリケーションやシステムとは隔離された仮想的な空間で動作するため、セキュリティが高い特徴があります。<br>その他ストアプリのメリットとして、各更新のダウンロード量が少なくなること、言語サポートなどがあります。<br>Microsoft Store を利用できる場合や、その後自動更新をしたい場合、ユーザー権限でインストールさせたい場合はこちらの方法をご検討いただければと思います。 </p><h3 id="比較表"><a href="#比較表" class="headerlink" title="比較表 "></a><font color="HotPink">比較表 </font></h3><table><thead><tr><th align="center"></th><th>ダウンロードセンターからインストーラをダウンロードしてインストール</th><th>Microsoft Store からストアアプリとしてインストール</th></tr></thead><tbody><tr><td align="center">最小要件</td><td>・Windows 8.1 または Windows Server 2012 R2 以降 <br>・.NET 4.6.2 以降 <br>・メモリ (RAM): 2 GB 以上使用可能、4 GB 以上を推奨) <br>・WebView2 <br>その他以下公開情報を参照 <br><a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-get-the-desktop#minimum-requirements">最小要件</a></td><td>・Windows 8.1 または Windows Server 2012 R2 以降 <br>・.NET 4.6.2 以降 <br>・メモリ (RAM): 2 GB 以上使用可能、4 GB 以上を推奨) <br>・WebView2 <br>その他以下公開情報を参照 <br><a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-get-the-desktop#minimum-requirements">最小要件</a></td></tr><tr><td align="center">金額</td><td>無償</td><td>無償</td></tr><tr><td align="center">インストールに必要な権限</td><td>管理者特権が必要</td><td>標準ユーザーの権限にてインストール可能</td></tr><tr><td align="center">インストールパス（既定）</td><td>C:\Program Files\Microsoft Power BI Desktop(既定)</td><td>C:\Program Files\WindowsApps</td></tr><tr><td align="center">更新方法</td><td>ダウンロードセンターから都度インストーラを入手</td><td>自動更新が可能</td></tr><tr><td align="center">更新頻度</td><td>月1回程度（マイナーアップデートが発生することもあり） <br>ご参考：<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_feature_roadmap/">Power BIのアップデート情報について</a></td><td>月1回程度（マイナーアップデートが発生することもあり） <br>ご参考：<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_feature_roadmap/">Power BIのアップデート情報について</a></td></tr><tr><td align="center">その他制限事項</td><td>ー</td><td>・SAP コネクタを使用する場合、SAP ドライバー ファイルを Windows\System32 フォルダーに移動することが必要な場合がある <br>・Microsoft Store から Power BI Desktop をインストールしても、.exe バージョンのユーザー設定はコピーされないため、最近使ったデータ ソースに再接続し、資格情報を再入力することが必要な場合がある <br>・Oracle データベース コネクタを使用する場合場合、ドライバーの問題によりOracleデータベースに接続できない可能性がある <br>対処策は以下公開情報を参照 <br>  <a href="https://learn.microsoft.com/ja-jp/power-query/connectors/oracle-database#troubleshooting">Oracle データソース - トラブルシューティング</a></td></tr></tbody></table> </br><h2 id="使用しているPower-BI-Desktopがどちらのインストール方法でインストールされたか確認する方法"><a href="#使用しているPower-BI-Desktopがどちらのインストール方法でインストールされたか確認する方法" class="headerlink" title="使用しているPower BI Desktopがどちらのインストール方法でインストールされたか確認する方法"></a><font color="DodgerBlue">使用しているPower BI Desktopがどちらのインストール方法でインストールされたか確認する方法</h2> </font>   <p>Power BI Desktop を起動した状態で、タスク マネージャーを起動し、プロセス タブの一覧から Power BI Desktop アプリを展開し、“Microsoft Power BI Desktop” で右クリック ＞ プロパティを開きます。<br>“場所” に表示されるパスで確認できます。<br>以下例では、パスが “C:\Program Files\Microsoft Power BI Desktop\” 配下なので、ダウンロードセンターから入手した Power BI Desktop であることが確認できます。 </p><div align="left"><img src="1.png"></div></p> </br><h2 id="組織での一括インストールや更新方法について"><a href="#組織での一括インストールや更新方法について" class="headerlink" title="組織での一括インストールや更新方法について"></a><font color="DodgerBlue">組織での一括インストールや更新方法について</h2> </font>  <p>上記ダウンロードセンターから入手する従来のデスクトップアプリとストアアプリのどちらを採用するかにより、検討可能な方法は異なってまいります。<br>Power BI Desktop に特化した運用方法のベストプラクティスはご用意がありませんので、ユーザー様の組織において、既存のデスクトップアプリやストアアプリをどのように運用されているかをご確認の上ご検討いただければと存じます。   </p> </br>   <p>以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI Desktop にはインストール方法が 2 種類あることをご存じですか？&lt;br&gt;最小要件や提供される機能は基本的には同じですが、いくつかの制限事項や違いがあります。&lt;br&gt;本記事では、両者の違いをわかりやすくご案内しておりますので、どちらのインストール方法を採用するか迷った際にはご参考にしていただけますと幸いです。   &lt;/p&gt;</summary>
    
    
    
    
    <category term="アップデート" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%83%88/"/>
    
    <category term="更新" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
    <category term="PowerBIDesktop　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBIDesktop/"/>
    
    <category term="インストール" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB/"/>
    
    <category term="ストアアプリ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B9%E3%83%88%E3%82%A2%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
    <category term="MicrosoftStore" scheme="https://jpbap-sqlbi.github.io/blog/tags/MicrosoftStore/"/>
    
  </entry>
  
  <entry>
    <title>Power BIワークスペースのガバナンス</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_workspace_governance/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_workspace_governance/</id>
    <published>2023-08-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.942Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。<br>Power BI管理者は、 [管理ポータル]からテナントに存在するワークスペースの容量やアクセス設定を変更できること、皆さんご存知かと思います。一方で、データセットの更新エラーの修正、機密データへのアクセスの制御、ユーザーが組織を離れるときのコンテンツ引き継ぎ、データ使用量の制御や、会社のポリシーとの従業員のコンプライアンスの確保などのために、[マイワークスペース]へのアクセスが必要になる場合があります。<br>この場合、Power BI管理者がユーザーのマイワークスペースにアクセスする機能を使用することで、マイワークスペースのガバナンスを実現可能です。この記事では、その手順ついて詳しく説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></br></p><p></br></p></div><hr><h2 id="Power-BI管理者がマイワークスペースにアクセスする手順"><a href="#Power-BI管理者がマイワークスペースにアクセスする手順" class="headerlink" title="Power BI管理者がマイワークスペースにアクセスする手順"></a>Power BI管理者がマイワークスペースにアクセスする手順</h2><hr><p>マイワークスペースのアクセス権限を取得する方法は、基本的には共有ワークスペースの方法と同じです。<br>１．Power BIサービスで[設定]＞[管理ポータル]＞[ワークスペース]を選択します。</p><div align="left"><img src="1.png"></div><p>２．必要に応じて、ワークスペース名を絞り込みます。<br>※マイワークスペースの[名前]は、「PersonalWorkspace ユーザー名」で、[型]は「個人用グループ」です</p><div align="left"><img src="2.png"></div><p>３．[︙]（アクション）＞[アクセスの許可]を選択します。</p><div align="left"><img src="3.png"></div><p>※選択後、「アクセス権が正常に取得されました」との通知が表示されます</p><div align="left"><img src="4.png"></div><p>４．アクセス権限の取得後、マイワークスペースは[ユーザー名]の名前で、ワークスペース一覧で表示されるようになります。<br>アクセス権限を取得したマイワークスペースにアクセスいただき、必要に応じて中身のコンテンツの削除や修正、別のワークスペースへの移動などの操作をすることが可能となります</p><div align="left"><img src="5.png"></div></br><hr><h2 id="注意事項"><a href="#注意事項" class="headerlink" title="注意事項"></a>注意事項</h2><hr><p>・マイワークスペースへのアクセス権限は 24 時間後に自動的に取り消されます。<br>・退職し削除されたユーザーのマイワークスペースは [削除済み] として表示され、コンテンツは 90 日間保持されます。<br>・コンテンツの保持期間中、管理者はマイ ワークスペースを[復元]オプションを利用できます。</p><div align="left"><img src="6.png"></div></br><hr><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><hr><ul><li> <a href="https://powerbi.microsoft.com/en-us/blog/announcing-my-workspace-governance-improvement-public-preview/">Microsoft Power BI Blog：Announcing My workspace governance improvement</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-portal-workspaces">公開情報：ワークスペースを管理する</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-platform-release-plan/2022wave2/power-bi/improve-my-workspace-governance">公開情報：自分のワークスペースのガバナンスを改善する</a></li></ul><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;br&gt;Power BI管理者は、 [管理ポータル]からテナントに存在するワークスペースの容量やアクセス設定を変更できること、皆さんご存知かと思います。一方で、データセットの更新エラーの修正、機密データへのアクセスの制御、ユーザーが組織を離れるときのコンテンツ引き継ぎ、データ使用量の制御や、会社のポリシーとの従業員のコンプライアンスの確保などのために、[マイワークスペース]へのアクセスが必要になる場合があります。&lt;br&gt;この場合、Power BI管理者がユーザーのマイワークスペースにアクセスする機能を使用することで、マイワークスペースのガバナンスを実現可能です。この記事では、その手順ついて詳しく説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="ワークスペース" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B9/"/>
    
    <category term="ガバナンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%AC%E3%83%90%E3%83%8A%E3%83%B3%E3%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>トラブル発生時の事象調査における情報採集</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace_NewVer/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace_NewVer/</id>
    <published>2023-08-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.330Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのファムです。<br>Power BI を利用される際に、エラーが発生するなど想定したとおりに動作しない場合、事象が起こる原因を特定するための調査が必要になる場合があります。<br>以前<a href="https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace/">「トラブル発生時の事象調査に必要な情報の採取手順について(通信編)」</a>について記載しましたが、現象によって必要な情報は異なりますので、以下は複数のパターンを想定して問題が発生する場合の情報採取手順についてご紹介いたします。</p><span id="more"></span></br><div class="alert is-important"><p class="alert-title">重要</p><p>弊社サポートをご利用いただいている場合、状況に合わせた調査方針を策定するため、記載の内容とご案内が異なる場合がございます。</p><p>ご不明な点がございましたら弊社サポート担当までお気軽にご質問ください。</p><p>また掲載している画像・手順は投稿時点のものとなります。最新の情報とは異なる可能性がございますので予めご了承ください。</p></div></br><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#1%EF%BC%8EFiddler%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">Fiddlerトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#2%EF%BC%8EPower-BI-Desktop%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">Power BI Desktopトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#3%EF%BC%8E%E3%83%96%E3%83%A9%E3%82%A6%E3%82%B6%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">ブラウザトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#4%EF%BC%8EFiddler%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8Power-BI-Desktop%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8%E3%82%B9%E3%83%86%E3%83%83%E3%83%97%E8%A8%98%E9%8C%B2%E3%83%84%E3%83%BC%E3%83%AB%EF%BC%88PSR%EF%BC%89%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">FiddlerトレースとPower BI Desktopトレースとステップ記録ツール（PSR）の採取手順</a></li><li><a href="#5%EF%BC%8E%E3%83%97%E3%83%AD%E3%82%BB%E3%82%B9-%E3%83%A2%E3%83%8B%E3%82%BF%E3%83%BC%E3%81%A8Power-BI-Desktop%E3%83%88%E3%83%AC%E3%83%BC%E3%82%B9%E3%81%A8Xbox-Game-Bar%E3%81%AB%E3%82%88%E3%82%8B%E9%8C%B2%E7%94%BB%E3%81%AE%E6%8E%A1%E5%8F%96%E6%89%8B%E9%A0%86">プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順</a></br></li></ol><hr><h2 id="1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順"><a href="#1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順"></a>1．Fiddlerトレースとステップ記録ツール（PSR）の採取手順</h2><p>・HTTP/S トレース（Fiddler トレース）： クライアントに導入するソフトウェア。使用するアプリケーションなどを通じて端末と接続先のHTTP/S 通信を記録し通信状況の差異を確認するツール<br>・PSR（ステップ記録ツール）：　操作ごとに画面キャプチャを記録するツール</p><p><strong>1．Fiddlerのインストール</strong></p><ol><li>Telerik 社の Web サイトより、適宜必要項目を入力し「Download for Windows」を選択し、インストーラをダウンロードします。その後、採取対象の環境へインストールします。<br><a href="https://www.telerik.com/download/fiddler">https://www.telerik.com/download/fiddler</a></li></ol></br><div align="center"><img src="pic1.png"></div><ol start="2"><li>採取対象の環境で、Fiddler を起動します。<br>※Fiddler の採取時は可能な限り不要なアプリケーションを閉じ、事象再現のみのトレースが取れるように設定ください。</li><li>自動的にトレースが開始されるため、メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。または[F12]キーでもトレースの停止/再開が可能です。</li></ol></br><div align="center"><img src="pic2.png"></div><ol start="4"><li>メニュー バーから [Tools] - [Options] を選択します。</li></ol></br><div align="center"><img src="pic3.png"></div><ol start="5"><li>HTTPS タブをクリックし、”Capture HTTPS CONNECTS” および “Decrypt HTTPS traffic” のチェック ボックスをオンにし、OK ボタンをクリックし、Fiddler Options を閉じます。</li></ol></br><div align="center"><img src="pic4.png"></div><p>“Decrypt HTTPS traffic” のチェック ボックスをオンにすることで、以下の警告が表示されることがございます。Yes ボタンをクリックします。<br>“Fiddler generates a unique root CA certificate to intercept HTTPS traffic. You may choose to have Windows trust this root certificate to avoid security warnings about the untrusted root certificate. You should ONLY click ‘Yes’ on a computer used exclusively for TEST purposes.”<br>上記警告で Yes を選択すると、セキュリティ警告が表示されますので、”はい” を選択します。<br>これにより、ログインユーザーの個人ストアならびに、ローカルコンピューターの信頼されたルート証明機関ストアに発行者が “DO_NOT_TRUST_FiddlerRoot” である証明書が追加されます。</p><ol start="6"><li>画面右側にある Filters - User Filter がオフになっていることを確認します。</li></ol></br><div align="center"><img src="pic5.png"></div><p><strong>2．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div><p><strong>3．Fiddler トレースの開始</strong><br>Fiddler のメニューバーの[File] - [Capture Traffic] を選択し、トレースを再開します。<br>この時左側のウィンドウでトレースが取れていることをご確認ください。</p><p><strong>4．事象の再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>5．Fiddler トレースの停止</strong></p><ol><li>事象再現後、Fiddler メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。</li><li>Fiddler のメニュー バーから [File] - [Save] - [All Sessions] を選択し、.saz 形式でログを保存します。</li></ol></br><div align="center"><img src="pic7.png"></div><ol start="3"><li>一度 Fiddler を終了し、閉じます。</li></ol><p><strong>6．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>Fiddlerトレースとステップ記録ツール (PSR)の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p><p>Fiddler 自体が Proxy の役目となるため、ご利用環境からインターネットへの通信において Proxy サーバーがございましたら、利用する貴社の Proxy を通るようにご設定ください。<br>※外部サイトではございますが、手順についてまとめられたサイトがありますので、ご参考ください。<br>参考情報：<a href="http://did2.blog64.fc2.com/blog-entry-8.html">プロキシ環境でのfiddler</a></p><p><strong>ネットワーク環境においてプロキシをご利用いただいている場合</strong></p><p>Fiddler 自体が Proxy の役目となるため、ご利用環境からインターネットへの通信において Proxy サーバーがございましたら、利用する貴社の Proxy を通るようにご設定ください。</p><p>※外部サイトではございますが、手順についてまとめられたサイトがありますので、ご参考ください。<br>参考情報：<a href="http://did2.blog64.fc2.com/blog-entry-8.html">プロキシ環境でのfiddler</a></p><h2 id="2．Power-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順"><a href="#2．Power-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="2．Power BI Desktopトレースとステップ記録ツール（PSR）の採取手順"></a>2．Power BI Desktopトレースとステップ記録ツール（PSR）の採取手順</h2><p>・Desktop トレース  ：Power BI Desktopの処理を記録するためのトレース<br>・PSR（ステップ記録ツール） ：操作ごとに画面キャプチャを記録するツール</p><p><strong>1．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div></br><p><strong>2．Power BI Desktopトレースの採取手順</strong><br>開いている Power BI Desktop をすべて閉じます。<br>以下の Traces フォルダーおよびその配下のフォルダーにあるログファイルをすべて削除します。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>1)「環境変数」の「ユーザー変数」に 変数名：PBI_forceTracing、変数値： 1 を設定します。</p></br><div align="center"><img src="pic9.png"></div><p>2)左上にあるキャプチャウィンドウから、マイクをオフにし、●ボタンをクリックすると、録画が開始されます。</p></br><div align="center"><img src="pic10.png"></div><p><strong>3．事象再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>4．Power BI Desktop トレース停止</strong><br>Power BI Desktop を閉じます。<br>現象再現後、トーレスに関しましては、以下の Power BI Desktop フォルダーに生成されます。<br>該当の Traces フォルダーを以下の弊社アップロードサイトへご送付ください。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>&lt;トレース無効化手順&gt;<br>「環境変数」の「ユーザー変数」に 設定した PBI_forceTracing  1 を削除します。</p><p><strong>5．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>Power BI Desktopトレースとステップ記録ツール (PSR) の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p><h2 id="3．ブラウザトレースとステップ記録ツール（PSR）の採取手順"><a href="#3．ブラウザトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="3．ブラウザトレースとステップ記録ツール（PSR）の採取手順"></a>3．ブラウザトレースとステップ記録ツール（PSR）の採取手順</h2><p>・ブラウザ トレース  ：ブラウザの処理を記録するためのトレース<br>・PSR（ステップ記録ツール）　：操作ごとに画面キャプチャを記録するツール</p><p><strong>1．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div></br><p><strong>2．ブラウザトレースの開始</strong></p><ol><li>ブラウザを起動し、Chrome のシークレットモードまたはEdge のIn-Private モードで新しいウィンドウを開きます。</li><li>F12 を押下し、ネットワーク を選択し、セッションをクリアした後、開始ボタンを押下します。</li></ol><p>Microsoft Edge の場合：<br></br></p><div align="center"><img src="pic11.png"></div></br><p>Chrome の場合：<br></br></p><div align="center"><img src="pic12.png"></div></br><p><strong>3．事象再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>4．ブラウザトレースの停止</strong><br>停止 ボタンを押下し、HARファイルとしてエクスポート ボタンよりファイルをエクスポートします。<br>※取得したトレース上で右クリックしていただき、「HAR としてすべて保存する」からでもエクスポート可能です。</p><p>Microsoft Edgeの場合：<br></br></p><div align="center"><img src="pic13.png"></div><p>Chrome の場合：<br></br></p><div align="center"><img src="pic14.png"></div><p><strong>5．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>ブラウザトレースとステップ記録ツール (PSR) の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p></br><h2 id="4．FiddlerトレースとPower-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順"><a href="#4．FiddlerトレースとPower-BI-Desktopトレースとステップ記録ツール（PSR）の採取手順" class="headerlink" title="4．FiddlerトレースとPower BI Desktopトレースとステップ記録ツール（PSR）の採取手順"></a>4．FiddlerトレースとPower BI Desktopトレースとステップ記録ツール（PSR）の採取手順</h2><p>・HTTP/S トレース（Fiddler トレース） ：クライアントに導入するソフトウェア。使用するアプリケーションなどを通じて端末と接続先のHTTP/S 通信を記録し通信状況の差異を確認するツール<br>・Desktop トレース    ：Power BI Desktopの処理を記録するためのトレース<br>・PSR（ステップ記録ツール）　：操作ごとに画面キャプチャを記録するツール</p><p><strong>1．Fiddlerのインストール</strong></p><ol><li>Telerik 社の Web サイトより、適宜必要項目を入力し「Download for Windows」を選択し、インストーラをダウンロードします。その後、採取対象の環境へインストールします。<br><a href="https://www.telerik.com/download/fiddler">https://www.telerik.com/download/fiddler</a></li></ol></br><div align="center"><img src="pic1.png"></div><ol start="2"><li>採取対象の環境で、Fiddler を起動します。<br>※Fiddler の採取時は可能な限り不要なアプリケーションを閉じ、事象再現のみのトレースが取れるように設定ください。</li><li>自動的にトレースが開始されるため、メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。または[F12]キーでもトレースの停止/再開が可能です。</li></ol></br><div align="center"><img src="pic2.png"></div><ol start="4"><li>メニュー バーから [Tools] - [Options] を選択します。</li></ol></br><div align="center"><img src="pic3.png"></div><ol start="5"><li>HTTPS タブをクリックし、”Capture HTTPS CONNECTS” および “Decrypt HTTPS traffic” のチェック ボックスをオンにし、OK ボタンをクリックし、Fiddler Options を閉じます。</li></ol></br><div align="center"><img src="pic4.png"></div><p>“Decrypt HTTPS traffic” のチェック ボックスをオンにすることで、以下の警告が表示されることがございます。Yes ボタンをクリックします。<br>“Fiddler generates a unique root CA certificate to intercept HTTPS traffic. You may choose to have Windows trust this root certificate to avoid security warnings about the untrusted root certificate. You should ONLY click ‘Yes’ on a computer used exclusively for TEST purposes.”<br>上記警告で Yes を選択すると、セキュリティ警告が表示されますので、”はい” を選択します。<br>これにより、ログインユーザーの個人ストアならびに、ローカルコンピューターの信頼されたルート証明機関ストアに発行者が “DO_NOT_TRUST_FiddlerRoot” である証明書が追加されます。</p><ol start="6"><li>画面右側にある Filters - User Filter がオフになっていることを確認します。</li></ol></br><div align="center"><img src="pic5.png"></div><p><strong>2．画面キャプチャ準備・開始 「ステップ記録ツール (PSR)」</strong></p><ol><li>コマンドプロンプトを右クリックで [管理者として実行] を選択の上起動します。<br>※[管理者として実行] を選択しなかった場合、一部手順のスクリーンショットが記録されないことがあります。</li><li>以下のコマンドを実行し、ステップ記録ツールを起動します。<br>psr.exe</li><li>“問題ステップ記録ツール” が起動しましたら、右端の ▼ をクリックし、表示されるメニューから [設定] をクリックします。</li><li>“保存する最新の取り込み画像数” を 25 から 100 に変更し、 OK をクリックします。</li><li>[記録の開始] をクリックします。</li></ol></br><div align="center"><img src="pic6.png"></div><p><strong>3．Fiddler トレースの開始</strong><br>Fiddler のメニューバーの[File] - [Capture Traffic] を選択し、トレースを再開します。<br>この時左側のウィンドウでトレースが取れていることをご確認ください。</p><p><strong>4．Power BI Desktopトレースの採取手順</strong><br>開いている Power BI Desktop をすべて閉じます。<br>以下の Traces フォルダーおよびその配下のフォルダーにあるログファイルをすべて削除します。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>1)「環境変数」の「ユーザー変数」に 変数名：PBI_forceTracing、変数値： 1 を設定します。</p></br><div align="center"><img src="pic9.png"></div><p>2)左上にあるキャプチャウィンドウから、マイクをオフにし、●ボタンをクリックすると、録画が開始されます。</p></br><div align="center"><img src="pic10.png"></div><p><strong>5．事象の再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>6．Fiddler トレースの停止</strong></p><ol><li>事象再現後、Fiddler メニュー バーの[File] - [Capture Traffic] を選択し、トレースを停止します。</li><li>Fiddler のメニュー バーから [File] - [Save] - [All Sessions] を選択し、.saz 形式でログを保存します。</li></ol></br><div align="center"><img src="pic7.png"></div><ol start="3"><li>一度 Fiddler を終了し、閉じます。</li></ol><p><strong>7．Power BI Desktop トレース停止</strong><br>Power BI Desktop を閉じます。<br>現象再現後、トーレスに関しましては、以下の Power BI Desktop フォルダーに生成されます。<br>該当の Traces フォルダーを以下の弊社アップロードサイトへご送付ください。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>&lt;トレース無効化手順&gt;<br>「環境変数」の「ユーザー変数」に 設定した PBI_forceTracing  1 を削除します。</p><p><strong>8．画面キャプチャの停止</strong></p><ol><li>[記録の停止] をクリックします。</li><li>“名前を付けて保存” のダイアログが表示されますので、ファイルの保存場所、ファイル名を指定し、 [保存] をクリックします。<br>※本ツールは、ボタンクリックやマウスドラッグなど、マウスクリックの際に画像が記録されます。手順の最後にエラーが発生するような現象の場合、エラー画面も把握できるようにクリックしてください。<br>※保存したファイルを開き、画像が採取できていることをご確認ください。画像数が100 を超える場合、古いものから順に削除されますので手順 4 の数値を 100 より大きな数値にご変更ください。</li></ol></br><div align="center"><img src="pic8.png"></div><p>FiddlerトレースとPower BI Desktopトレースとステップ記録ツール (PSR)の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。</p><p><strong>ネットワーク環境においてプロキシをご利用いただいている場合</strong><br>Fiddler 自体が Proxy の役目となるため、ご利用環境からインターネットへの通信において Proxy サーバーがございましたら、利用する貴社の Proxy を通るようにご設定ください。</p><p>※外部サイトではございますが、手順についてまとめられたサイトがありますので、ご参考ください。<br>参考情報：<a href="http://did2.blog64.fc2.com/blog-entry-8.html">プロキシ環境でのfiddler</a></p><h2 id="5．プロセス-モニターとPower-BI-DesktopトレースとXbox-Game-Barによる録画の採取手順"><a href="#5．プロセス-モニターとPower-BI-DesktopトレースとXbox-Game-Barによる録画の採取手順" class="headerlink" title="5．プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順"></a>5．プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順</h2><p>・プロセス モニター ：リアルタイムのファイル システム、レジストリ、プロセス/スレッド アクティビティを示す Windows 用の高度な監視ツール<br>・Desktop トレース    ：Power BI Desktopの処理を記録するためのトレース<br>・Xbox Game Barによる録画    ：操作ごとに録画するツール</p><p><strong>1．プロセス モニターのインストール</strong></p><ol><li>以下のWebサイトより、インストーラーをダウンロードします。<br><a href="https://learn.microsoft.com/ja-jp/sysinternals/downloads/procmon">プロセス モニター - Sysinternals | Microsoft Learn</a></li></ol></br><div align="center"><img src="pic15.png"></div><ol start="2"><li>採取対象の環境で、Procmon.exe を 管理者権限で起動します。<br>※プロセス モニターを実施時に、可能な限り不要なアプリケーションを閉じ、事象再現のみのトレースが取れるように設定ください。</li></ol><p>“Process Monitor License Agreement” が表示された場合は、内容をご確認の上 [Agree] を選択します。<br></br></p><div align="center"><img src="pic16.png"></div><ol start="3"><li><p>フィルタ指定メニューが自動表示された場合は [Cancel] を選択します。<br>※ [Cancel] を選択後、情報採取が開始されます。</p></li><li><p>開始された情報採取を一旦停止するため、[File] - [Capture Events] を選択し、チェックを外します。<br>　[Edit] – [Clear Display]を選択します。<br>※ ツールバーに存在する “虫眼鏡” のアイコンをクリックすることにより、同様に情報採取を停止することが可能となります。</p></br></li></ol><div align="center"><img src="pic17.png"></div><p><strong>2．Power BI Desktopトレースの採取手順</strong><br>開いている Power BI Desktop をすべて閉じます。<br>以下の Traces フォルダーおよびその配下のフォルダーにあるログファイルをすべて削除します。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces</p><p>「環境変数」の「ユーザー変数」に 変数名：PBI_forceTracing、変数値： 1 を設定します。</p></br><div align="center"><img src="pic9.png"></div><p><strong>3．Xbox Game Barによる録画開始</strong></p><ol><li>XBOX Game Barが起動します。<br>Windowsのスタートボタンから、[Xbox]と入力するとアプリが表示されますので、こちらを選択して起動できます。</li></ol></br><div align="center"><img src="pic18.png"></div><ol start="2"><li>左上にあるキャプチャウィンドウから、マイクをオフにし、●ボタンをクリックすると、録画が開始されます。</li></ol></br><div align="center"><img src="pic19.png"></div><p><strong>4．プロセス モニターの開始</strong><br>情報採取準備が完了した後、以下の手順でプロセス モニターによるトレース採取を開始します。<br>[File] - [Capture Events] を選択し、チェックを付けます。</p><p><strong>5．事象再現</strong><br>実際の事象が起きる操作を再現します。</p><p><strong>6．Power BI Desktop トレース停止</strong><br>Power BI Desktop を閉じます。<br>現象再現後、トーレスに関しましては、以下の Power BI Desktop フォルダーに生成されます。<br>該当の Traces フォルダーを以下の弊社アップロードサイトへご送付ください。</p><p>%LOCALAPPDATA%\Microsoft\Power BI Desktop\Traces<br>または<br>%USERPROFILE%\Microsoft\Power BI Desktop Store App\Traces<br>&lt;トレース無効化手順&gt;<br>「環境変数」の「ユーザー変数」に 設定した PBI_forceTracing  1 を削除します。</p><p><strong>7．プロセス モニターの停止</strong></p><ol><li><p>[File] - [Capture Events] を選択し、チェックを外します。</p></li><li><p>メニューの [File] から [Save] メニューを選択し、プロセス モニタートレース情報を任意のパスに保存します。<br>※ オプションは既定のままで問題ございません。</p></li></ol></br><div align="center"><img src="pic20.png"></div><p><strong>8．録画停止</strong></p><ol><li>画面右上に表示されているウィンドウの■ボタンをクリックし、停止します。</br></li></ol><div align="center"><img src="pic21.png"></div><ol start="2"><li>キャプチャのギャラリーにてファイルの場所を開きます。</br></li></ol><div align="center"><img src="pic22.png"></div><p>こちらの画面が出ない場合は、Xbox Game Barの[キャプチャを表示する]をクリックすると、ギャラリーが表示されます。<br></br></p><div align="center"><img src="pic23.png"></div><ol start="3"><li>保存先の動画を確認します。<br>デフォルト設定での保存先は、C:\Users[アカウント名]\Videos\Captures<br>や、エクスプローラ画面における[ビデオ]フォルダ内の[キャプチャ]フォルダとなっております。</li></ol></br><div align="center"><img src="pic24.png"></div><p>プロセス モニターとPower BI DesktopトレースとXbox Game Barによる録画の採取手順は以上となります。必要に応じて弊社サポートまで採取いただいた情報をご提供ください。<br></br><br>以上、本ブログ が少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのファムです。&lt;br&gt;Power BI を利用される際に、エラーが発生するなど想定したとおりに動作しない場合、事象が起こる原因を特定するための調査が必要になる場合があります。&lt;br&gt;以前&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/all_howto_trace/&quot;&gt;「トラブル発生時の事象調査に必要な情報の採取手順について(通信編)」&lt;/a&gt;について記載しましたが、現象によって必要な情報は異なりますので、以下は複数のパターンを想定して問題が発生する場合の情報採取手順についてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Troubleshooting" scheme="https://jpbap-sqlbi.github.io/blog/tags/Troubleshooting/"/>
    
    <category term="Fiddler" scheme="https://jpbap-sqlbi.github.io/blog/tags/Fiddler/"/>
    
    <category term="PSR" scheme="https://jpbap-sqlbi.github.io/blog/tags/PSR/"/>
    
    <category term="Power BI Desktop trace" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop-trace/"/>
    
    <category term="browser trace" scheme="https://jpbap-sqlbi.github.io/blog/tags/browser-trace/"/>
    
    <category term="Process Monitor" scheme="https://jpbap-sqlbi.github.io/blog/tags/Process-Monitor/"/>
    
    <category term="Xbox Game Bar" scheme="https://jpbap-sqlbi.github.io/blog/tags/Xbox-Game-Bar/"/>
    
  </entry>
  
  <entry>
    <title>Power BIにおけるデータソースのパラメーター化</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_datasoource_parameter/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_datasoource_parameter/</id>
    <published>2023-07-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.482Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。<br>Power BI では、Power Queryのパラメーターを活用して、データセットのデータソースを動的に変更する方法があることをご存知ですか。パラメーターを使ってデータソースに接続し、パラメーターを編集することで、データソースを必要に応じて簡単に変更できます。これにより、異なる要件に対応する柔軟性を持ったレポートを作成し、レポートの再利用性と拡張性を向上させられます。<br>今回の記事では、SQL Serverを例に、データソースのパラメーター化の設定方法をご紹介いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%8C%96%E3%81%AE%E5%BF%9C%E7%94%A8%E4%BE%8B">データソースのパラメーター化の応用例</a></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E5%8C%96%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86">データソースのパラメーター化設定手順</a></li><li><a href="#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%81%AE%E5%A4%89%E6%9B%B4%E6%96%B9%E6%B3%95">パラメーターの変更方法</a></li><li><a href="#Excel%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88">Excelデータソースの場合</a></li><li><a href="#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC%E3%82%92%E9%81%A9%E7%94%A8%E3%81%97%E3%81%9F%E5%A0%B4%E5%90%88%E3%81%AE%E5%8B%95%E4%BD%9C">パラメーターを適用した場合の動作</a></br></li></ol><hr><h2 id="データソースのパラメーター化の応用例"><a href="#データソースのパラメーター化の応用例" class="headerlink" title="データソースのパラメーター化の応用例"></a>データソースのパラメーター化の応用例</h2><hr><p>・開発／テスト／本番など異なるデータソース環境の間で簡単に切り替えたい場合<br>・部門や地域ごとに異なるデータソースを使用している場合<br>・Power BI Serviceに発行されたデータセットのデータソースを切り替えたい場合<br><br></p><hr><h2 id="データソースのパラメーター化設定手順"><a href="#データソースのパラメーター化設定手順" class="headerlink" title="データソースのパラメーター化設定手順"></a>データソースのパラメーター化設定手順</h2><hr><p>※今回検証を行った環境では、１つのサーバーに「Northwind」と「test」という２つのデータベースを用意しています。</p><div align="left"><img src="1.png"></div><p>１．データソースのパラメーターを設定する前に、まずはPower Queryエディターの[表示]タブで、パラメーターの[常に許可]にチェックを入れます。</p><div align="left"><img src="2.png"></div><p>設定後は以下のように、データソースに接続する際に、固定の接続先だけでなく、サーバー名やデータベース名のパラメーターで作成し、設定可能になります。</p><div align="left"><img src="3.png"></div><p>２．SQL Serverの接続画面から[新しいパラメーター]を選択し、サーバー名やデータベース名のパラメーターを設定します。</p><div align="left"><img src="4.png"></div>※パラメーターの[種類]が[すべて]に設定されている場合、Power BI サービスでパラメーターを編集できない可能性がございますため、[テキスト]もしくは[10進数]に設定していただく必要がございます。<div class="alert is-success"><p class="alert-title">ヒント</p><p>参考事例：<a href="https://community.fabric.microsoft.com/t5/Service/Parameter-is-disabled-for-editing-in-power-bi-service/m-p/398733">Parameter is disabled for editing in power bi service - Microsoft Fabric Community</a></p></div><p>３．設定されたパラメーターを使って、SQL Serverデータベースに接続します。</p><div align="left"><img src="5.png"></div><p>以上で、データソースのパラメーター化設定が完了です！</p><br><hr><h2 id="パラメーターの変更方法"><a href="#パラメーターの変更方法" class="headerlink" title="パラメーターの変更方法"></a>パラメーターの変更方法</h2><hr><h3 id="Power-BI-Desktopの場合"><a href="#Power-BI-Desktopの場合" class="headerlink" title="Power BI Desktopの場合"></a>Power BI Desktopの場合</h3><p>１．[ホーム]タブの[データの変換]より、[パラメーターの編集]を選択します。</p><div align="left"><img src="6.png"></div><p>２．ポップアップ画面から、データソースのパラメーターを変更できます。<br>※以下例では、データベース名のパラメーターを「Northwind」を「test」に変更しました。</p><div align="left"><img src="7.png"></div><br><h3 id="Power-BI-サービスの場合"><a href="#Power-BI-サービスの場合" class="headerlink" title="Power BI サービスの場合"></a>Power BI サービスの場合</h3><p>１．ワークスペースから、データセットの[・・・]＞[設定]を選択します。</p><div align="left"><img src="8.png"></div><p>２．設定画面の[パラメーター]から、データソースのパラメーターを変更できます。</p><div align="left"><img src="9.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-parameters">Power BI サービスのパラメーター設定を編集する - Power BI | Microsoft Learn</a></p><p></p><p></p><p></p><p></p></div><hr><h2 id="Excelデータソースの場合"><a href="#Excelデータソースの場合" class="headerlink" title="Excelデータソースの場合"></a>Excelデータソースの場合</h2><hr><p>本記事の前半では、接続時にデータソースのパラメーター化する方法をご紹介しましたが、実は、データソースのパラメーターは必ずしも接続時に設定する必要がなく、接続後にも[詳細エディター]より設定可能です。<br>例えば、Excelファイルの場合、接続時に特定の Excel ファイルをデータソースとして指定する必要がありますため、SQL Serverのように、接続画面からデータソースのパラメーターを設定できません。<br>その場合、Excelファイルへ接続後にパラメーターを設定することができますので、以下の例にて説明します。</p><p>１．[UFO_US.xlsx]というExcelファイルに接続しますと、[詳細エディター]では以下のように表示されます。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let</span><br><span class="line">    ソース <span class="built_in">=</span> Excel.Workbook(File.Contents(<span class="string">&quot;C:\Users\lyuyue\Documents\UFO_US.xlsx&quot;</span>), null, <span class="built_in">true</span>),</span><br><span class="line">    UFO_US_Sheet <span class="built_in">=</span> ソース&#123;[Item<span class="built_in">=</span><span class="string">&quot;UFO&quot;</span>,Kind<span class="built_in">=</span><span class="string">&quot;Sheet&quot;</span>]&#125;[Data],</span><br><span class="line">    昇格されたヘッダー数 <span class="built_in">=</span> Table.PromoteHeaders(UFO_US_Sheet, [PromoteAllScalars<span class="built_in">=</span><span class="built_in">true</span>]),</span><br><span class="line">    変更された型 <span class="built_in">=</span> Table.TransformColumnTypes(昇格されたヘッダー数,&#123;&#123;<span class="string">&quot;datetime&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;city&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;state&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;country&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;shape&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;duration (seconds)&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;duration (hours/min)&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;comments&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;date posted&quot;</span>, <span class="keyword">type</span> date&#125;, &#123;<span class="string">&quot;latitude&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;longitude &quot;</span>, <span class="keyword">type</span> number&#125;&#125;)</span><br><span class="line">in</span><br><span class="line">    変更された型</span><br></pre></td></tr></table></figure><p>２．Power Query エディターの[ホーム]＞[パラメーターの管理]＞[新しいパラメーター]を選択します。</p><div align="left"><img src="10.png"></div><p>３．Excelファイルのファイルパス変更用のパラメーターを作成します。</p><div align="left"><img src="11.png"></div><p>４．[詳細エディター]を開き、２行目のありましたファイルパスの部分をパラメーター名に差し替えます。</p><figure class="highlight m"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let</span><br><span class="line">    ソース <span class="built_in">=</span> Excel.Workbook(File.Contents(ファイルパス), null, <span class="built_in">true</span>),</span><br><span class="line">    UFO_US_Sheet <span class="built_in">=</span> ソース&#123;[Item<span class="built_in">=</span><span class="string">&quot;UFO&quot;</span>,Kind<span class="built_in">=</span><span class="string">&quot;Sheet&quot;</span>]&#125;[Data],</span><br><span class="line">    昇格されたヘッダー数 <span class="built_in">=</span> Table.PromoteHeaders(UFO_US_Sheet, [PromoteAllScalars<span class="built_in">=</span><span class="built_in">true</span>]),</span><br><span class="line">    変更された型 <span class="built_in">=</span> Table.TransformColumnTypes(昇格されたヘッダー数,&#123;&#123;<span class="string">&quot;datetime&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;city&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;state&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;country&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;shape&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;duration (seconds)&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;duration (hours/min)&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;comments&quot;</span>, <span class="keyword">type</span> text&#125;, &#123;<span class="string">&quot;date posted&quot;</span>, <span class="keyword">type</span> date&#125;, &#123;<span class="string">&quot;latitude&quot;</span>, <span class="keyword">type</span> number&#125;, &#123;<span class="string">&quot;longitude &quot;</span>, <span class="keyword">type</span> number&#125;&#125;)</span><br><span class="line">in</span><br><span class="line">    変更された型</span><br></pre></td></tr></table></figure><p>５．パラメーターの設定後は以下のように、接続先のファイルパスを変更することが可能になります。</p><div align="left"><img src="12.png"></div><br><br><hr><h2 id="パラメーターを適用した場合の動作"><a href="#パラメーターを適用した場合の動作" class="headerlink" title="パラメーターを適用した場合の動作"></a>パラメーターを適用した場合の動作</h2><hr><p>最後にExcelのサンプルファイルでのパラメーターを変更し、適用した動作についてご紹介します。<br>以下の通り、[ファイルパス]のパラメーターを編集することで、データソースを「US」と「US以外」のファイル間で、必要に応じて切り替え可能です。<br>同様のスキーマのデータソースが複数存在し、切り替えが必要である場合はぜひこの方法をご活用ください。</p><div align="left"><img src="13.png"></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。<br><br></p><hr><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><hr><ul><li> <a href="https://support.microsoft.com/ja-jp/office/%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC-%E3%82%AF%E3%82%A8%E3%83%AA%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B-power-query-5eb365bc-3982-4ab2-8830-b205a69e0f33">公開情報：パラメーター クエリを作成する (Power Query)</a></li><li> <a href="https://www.phdata.io/blog/how-to-parameterize-data-sources-power-bi/">外部情報：How to Parameterize Data Sources in Power BI | phData</a></li><li> <a href="https://data-marc.com/2018/11/15/parameterize-your-data-source/">外部情報：Parameterize your data source! – Data – Marc</a></li><li> <a href="https://www.youtube.com/watch?v=OnaDJkGOmIE">ビデオ：Making data source parameters easy in Power BI Desktop - Guy in a Cube</a></li></ul><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;br&gt;Power BI では、Power Queryのパラメーターを活用して、データセットのデータソースを動的に変更する方法があることをご存知ですか。パラメーターを使ってデータソースに接続し、パラメーターを編集することで、データソースを必要に応じて簡単に変更できます。これにより、異なる要件に対応する柔軟性を持ったレポートを作成し、レポートの再利用性と拡張性を向上させられます。&lt;br&gt;今回の記事では、SQL Serverを例に、データソースのパラメーター化の設定方法をご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="パラメーター" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%BC/"/>
    
    <category term="Power Query" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-Query/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Report Server のサポートについて</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbirs_support_boundary/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbirs_support_boundary/</id>
    <published>2023-07-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:42.058Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>日頃から、マイクロソフトのサポート サービスをご利用いただき誠にありがとうございます。<br>以前、<a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて</a> の記事で、私たち Power BI サポート チームで提供しているサービスの詳細についてご紹介いたしました。<br>今回は、Power BI Report Server に関するサポートについてご紹介いたします。</p><br /><h5 id="※-Power-BI-Report-Server-とは"><a href="#※-Power-BI-Report-Server-とは" class="headerlink" title="※ Power BI Report Server とは"></a><strong>※ Power BI Report Server とは</strong></h5><p>お客様が管理されているオンプレミスのサーバー上に Power BI のレポートを配信・共有できる Web サービスの仕組みを構築できる製品です。<br>詳細は<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_pbirs/">Power BI Report Server とは</a> の記事におまとめしておりますので、ご参考にしていただければと思います。</p><span id="more"></span><br /><h4 id="Power-BI-Report-Serverのサポート-プラン"><a href="#Power-BI-Report-Serverのサポート-プラン" class="headerlink" title="Power BI Report Serverのサポート プラン"></a><font color="RoyalBlue">Power BI Report Serverのサポート プラン</font></h4><p>サポート チームに Power BI Report Server および Power BI Report Server 用 Power BI Desktop のお問合せをいただく場合、プロフェッショナル サポートやユニファイド サポート (旧プレミアサポート) といった有償サポート契約が必要となります。<br>プロフェッショナル契約の場合は対処策のご案内まで、ユニファイド サポートの場合は対処策のご案内に加え、原因追及の調査が可能となります。</p><p>基本的なサポート範囲については、<a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて</a> の記事<br>と同様になりますので、ご一読くださいますようお願いいたします。</p><br /><h4 id="Power-BI-Report-Serverのサポート-タイムライン"><a href="#Power-BI-Report-Serverのサポート-タイムライン" class="headerlink" title="Power BI Report Serverのサポート タイムライン"></a><font color="RoyalBlue">Power BI Report Serverのサポート タイムライン</font></h4><p>Power BI Report Server は、基本的には毎年 1 月、 5 月、 9 月の年 3 回リリースされており、リリース後のサポート期間は 1 年となります。<br>詳細は、以下公開情報におまとめしておりますので、お問合せ前にご使用中の Power BI Report Server がサポート対象のバージョンであることをご確認くださいますようお願いいたします。</p><p>ご参考：<a href="https://learn.microsoft.com/ja-jp/power-bi/report-server/support-timeline">Power BI レポート サーバーのサポート タイムライン</a></p><br /><h4 id="その他ご参考：アップデート情報"><a href="#その他ご参考：アップデート情報" class="headerlink" title="その他ご参考：アップデート情報"></a><font color="RoyalBlue">その他ご参考：アップデート情報</font></h4><p><a href="https://learn.microsoft.com/ja-jp/power-bi/report-server/changelog">Power BI Report Server の変更ログ</a></p><p>リリースされた各ビルドの新しい項目とバグの修正をご案内しております。</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/report-server/whats-new">Power BI レポート サーバーの新機能</a></p><p>変更ログの公開情報と一部情報が重複する部分もありますが、Power BI Report Server と Power BI Report Server 向け Power BI Desktop の最新バージョンの新機能について説明しております。</p><p><a href="https://powerbi.microsoft.com/ja-jp/blog/power-bi-report-server-may-2023-feature-summary/">Power BI Report Server May 2023 Feature Summary</a></p><p>Power BI Report Server 用 Power BI Desktop の新機能詳細についてはこちらの公式ブログもご参考にしていただければと思います。<br>[Power BI Report Server Month yyyy Feature Summary] という命名規則のタイトルにて、その月の更新について機能ごとに詳細を案内しています。</p><p>※上記リンクは本ブログが公開された 2023 年 7 月時点での最新情報のリンク (Power BI Report Server May 2023 Feature Summary) となります。</p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;日頃から、マイクロソフトのサポート サービスをご利用いただき誠にありがとうございます。&lt;br&gt;以前、&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/&quot;&gt;Power BI のお問い合わせについて&lt;/a&gt; の記事で、私たち Power BI サポート チームで提供しているサービスの詳細についてご紹介いたしました。&lt;br&gt;今回は、Power BI Report Server に関するサポートについてご紹介いたします。&lt;/p&gt;
&lt;br /&gt;

&lt;h5 id=&quot;※-Power-BI-Report-Server-とは&quot;&gt;&lt;a href=&quot;#※-Power-BI-Report-Server-とは&quot; class=&quot;headerlink&quot; title=&quot;※ Power BI Report Server とは&quot;&gt;&lt;/a&gt;&lt;strong&gt;※ Power BI Report Server とは&lt;/strong&gt;&lt;/h5&gt;&lt;p&gt;お客様が管理されているオンプレミスのサーバー上に Power BI のレポートを配信・共有できる Web サービスの仕組みを構築できる製品です。&lt;br&gt;詳細は&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_pbirs/&quot;&gt;Power BI Report Server とは&lt;/a&gt; の記事におまとめしておりますので、ご参考にしていただければと思います。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI Report Server" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Report-Server/"/>
    
    <category term="お問い合わせ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B/"/>
    
    <category term="サポート範囲" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88%E7%AF%84%E5%9B%B2/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Service でサービス プリンシパルを利用する</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/ServicePrincipal/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/ServicePrincipal/</id>
    <published>2023-07-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.158Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。</p><p>Azure Active Directoryでは、皆さまが普段利用されているユーザー アカウント (例: <a href="mailto:&#101;&#120;&#97;&#x6d;&#112;&#108;&#101;&#64;&#x63;&#x6f;&#110;&#x74;&#x6f;&#x73;&#x6f;&#x2e;&#99;&#x6f;&#x6d;">&#101;&#120;&#97;&#x6d;&#112;&#108;&#101;&#64;&#x63;&#x6f;&#110;&#x74;&#x6f;&#x73;&#x6f;&#x2e;&#99;&#x6f;&#x6d;</a>) のほかに、サービス プリンシパルを利用することでもリソースにアクセスすることが可能です。Power BI では、レポートを他サービス/アプリケーションに埋め込む (Power BI Embedded) 場合や、REST API を実行する場合に利用されます。</p><p>本記事では、サービス プリンシパルについて説明し、例として PowerShell から REST API <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events">Get Activity Events</a> を実行する方法や、Power Automate からこの REST API を実行する方法についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E3%81%A8%E3%81%AF">サービス プリンシパルとは</a></li><li><a href="#%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB%E3%81%AE%E4%BD%9C%E6%88%90">サービス プリンシパルの作成</a><ul><li><a href="#%E6%89%8B%E9%A0%861-%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%99%BB%E9%8C%B2">手順1 アプリの登録</a></li><li><a href="#%E6%89%8B%E9%A0%862-%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%BE%E3%81%9F%E3%81%AF%E3%82%B7%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90">手順2 証明書またはシークレットの作成</a><ul><li><a href="#%E8%A8%BC%E6%98%8E%E6%9B%B8%E3%81%AE%E7%99%BB%E9%8C%B2%E3%82%92%E8%A1%8C%E3%81%86%E5%A0%B4%E5%90%88">証明書の登録を行う場合</a></li><li><a href="#%E3%82%B7%E3%83%BC%E3%82%AF%E3%83%AC%E3%83%83%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88">シークレットを作成する場合</a></li></ul></li><li><a href="#%E6%89%8B%E9%A0%863-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E8%A8%B1%E5%8F%AF%E3%80%81%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E3%81%AE%E8%A8%AD%E5%AE%9A">手順3 アクセス許可、スコープの設定</a><ul><li><a href="#%E5%BF%85%E8%A6%81%E3%81%AA%E6%A8%A9%E9%99%90%E3%81%AE%E7%A2%BA%E8%AA%8D">必要な権限の確認</a></li><li><a href="#%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E8%A8%B1%E5%8F%AF%E3%81%AE%E8%A8%AD%E5%AE%9A">アクセス許可の設定</a>    </li><li><a href="#%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%97%E3%81%AE%E8%A8%AD%E5%AE%9A">スコープの設定</a></li></ul></li></ul></li><li><a href="#Power-BI-%E3%81%AE%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A">Power BI のテナント設定</a></li><li><a href="#%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B">実際に動かしてみる</a><ul><li><a href="#%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">事前準備</a></li><li><a href="#PowerShell-%E3%81%8B%E3%82%89-API-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B">PowerShell から API を実行する</a></li><li><a href="#Power-Automate-%E3%81%8B%E3%82%89-API-%E3%82%92%E5%AE%9F%E8%A1%8C%E3%81%99%E3%82%8B">Power Automate から API を実行する</a></li></ul></li></ul><h2 id="サービス-プリンシパルとは"><a href="#サービス-プリンシパルとは" class="headerlink" title="サービス プリンシパルとは"></a>サービス プリンシパルとは</h2><p>サービス プリンシパルは、テナントまたはディレクトリ内のアプリケーション インスタンスで、アプリがアクセスできるAzure AD テナント内のリソースやアプリにアクセスできるユーザー、アプリが実際に行えることの定義を持ちます。</p><blockquote><p>サービス プリンシパルは、アプリケーションが使用される各テナントで作成され、グローバルに一意なアプリ オブジェクトが参照されます。 サービス プリンシパル オブジェクトには、特定のテナント内でアプリが実際に実行できること、アプリにアクセスできるユーザー、アプリからアクセスできるリソースを定義します。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/app-objects-and-service-principals?tabs=browser#service-principal-object">サービス プリンシパル オブジェクト</a></p></blockquote><p>普段皆さまが利用しているユーザー アカウント (例: <a href="mailto:&#x65;&#x78;&#x61;&#109;&#112;&#108;&#x65;&#64;&#x63;&#111;&#x6e;&#x74;&#x6f;&#x73;&#x6f;&#46;&#99;&#x6f;&#x6d;">&#x65;&#x78;&#x61;&#109;&#112;&#108;&#x65;&#64;&#x63;&#111;&#x6e;&#x74;&#x6f;&#x73;&#x6f;&#46;&#99;&#x6f;&#x6d;</a>) は、人間が利用することを想定したアカウントとなります。そのため、スケジュールで実行することが想定されるようなスクリプトの場合には、ユーザー アカウントを利用することは推奨されず、サービス プリンシパルを利用することが推奨されます。</p><p>例えば、以下のような要件では、ユーザー アカウントではなくサービス プリンシパルを利用することで業務負荷を低減することが可能な場合があります。サービス プリンシパルでは、証明書またはシークレットを利用した認証を行いますが、例えば、シークレット キーの有効期限は最長2年となっているため、パスワードの有効期限ポリシーよりも有効期限が長い場合には、更新作業の頻度を抑えることが可能です。</p><ul><li>業務での利用のため、スクリプトによってREST APIを実行し、アクティビティ ログを取得している。</li><li>資格情報にユーザー アカウントを利用している。</li><li>ポリシー上、定期的なパスワードの更新が必須となっており、パスワード更新後には資格情報の更新作業が発生する。</li></ul><h2 id="サービス-プリンシパルの作成"><a href="#サービス-プリンシパルの作成" class="headerlink" title="サービス プリンシパルの作成"></a>サービス プリンシパルの作成</h2><p>サービス プリンシパルはAzure Portal、PowerShell、Azure CLI、Microsoft Graph APIでの作成が可能です。また、Power BI Embdded用にサービス プリンシパルを作成する場合には、 <a href="https://app.powerbi.com/embedsetup">Power BI 埋め込み分析セットアップ ツール</a> での作成も可能です。本記事では、Azure Portalでの作成方法についてご案内いたします。その他の方法につきましては、以下の公開情報をご確認ください。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/howto-create-service-principal-portal">ポータルで Azure AD アプリとサービス プリンシパルを作成する - Microsoft Entra | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/develop/howto-authenticate-service-principal-powershell">Azure アプリ ID を作成する (PowerShell) - Microsoft Entra | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/cli/azure/create-an-azure-service-principal-azure-cli">サービス プリンシパルの操作 - Azure CLI | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/graph/api/serviceprincipal-post-serviceprincipals?view=graph-rest-1.0&tabs=http">serviceprincipal を作成する - Microsoft Graph v1.0 | Microsoft Learn</a><br>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/developer/embedded/register-app?tabs=customers#set-up-your-environment">Power BI Embedded を設定する - 環境の設定方法 | Microsoft Learn</a></p><h3 id="手順1-アプリの登録"><a href="#手順1-アプリの登録" class="headerlink" title="手順1 アプリの登録"></a>手順1 アプリの登録</h3><ol><li><p><a href="https://ms.portal.azure.com/#home">Azure Portal</a> にアクセスします。</p></li><li><p><strong>[Azure Active Directory]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal01.png"></div>  </li><li><p><strong>[アプリの登録]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal02.png"></div>  </li><li><p><strong>[新規登録]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal03.png"></div>  </li><li><p>名前を入力し、 <strong>[登録]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal04.png"></div>  </li></ol><p>アプリの作成は以上で完了です。</p><h3 id="手順2-証明書またはシークレットの作成"><a href="#手順2-証明書またはシークレットの作成" class="headerlink" title="手順2 証明書またはシークレットの作成"></a>手順2 証明書またはシークレットの作成</h3><p>次に、認証に利用する証明書の登録またはシークレットの作成を行います。</p><h4 id="証明書の登録を行う場合"><a href="#証明書の登録を行う場合" class="headerlink" title="証明書の登録を行う場合"></a>証明書の登録を行う場合</h4><ol><li><p><strong>[証明書とシークレット]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal05.png"></div>  </li><li><p><strong>[証明書]</strong> タブを開き、 <strong>[証明書のアップロード]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal06.png"></div>  </li><li><p>証明書をアップロードし、 <strong>[追加]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal07.png"></div>  </li><li><p>証明書がアップロードされたことを確認します。</p><div align="center"><img src="ServicePrincipal08.png"></div>  </li></ol><h4 id="シークレットを作成する場合"><a href="#シークレットを作成する場合" class="headerlink" title="シークレットを作成する場合"></a>シークレットを作成する場合</h4><ol><li><p><strong>[証明書とシークレット]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal05.png"></div>  </li><li><p><strong>[クライアント シークレット]</strong> タブを開き、 <strong>[新しいクライアント シークレット]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal09.png"></div>  </li><li><p>説明、有効期限を設定し、 <strong>[追加]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal10.png"></div>  </li><li><p>シークレットが作成されたことを確認します。このとき、 <strong>必ず “値” を控えておきます</strong>。一度ウインドウを閉じてしまうと、一部が非表示となり再度表示することやコピーすることができなくなります。</p><div align="center"><img src="ServicePrincipal11.png"></div>  </li></ol><h3 id="手順3-アクセス許可、スコープの設定"><a href="#手順3-アクセス許可、スコープの設定" class="headerlink" title="手順3 アクセス許可、スコープの設定"></a>手順3 アクセス許可、スコープの設定</h3><p>このあとは、実行したい内容に応じてアプリのアクセス許可やスコープを設定します。本手順では、後の REST API 実行のための権限設定を行います。</p><h4 id="必要な権限の確認"><a href="#必要な権限の確認" class="headerlink" title="必要な権限の確認"></a>必要な権限の確認</h4><p>実行したいAPIの公開情報を確認します。今回は <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events">Admin - Get Activity Events - REST API (Power BI Power BI REST APIs) | Microsoft Learn</a> を実行します。</p><blockquote><h2 id="アクセス許可"><a href="#アクセス許可" class="headerlink" title="アクセス許可"></a>アクセス許可</h2><ul><li>ユーザーは管理者権限 (Office 365グローバル管理者や Power BI サービス管理者など) を持っているか、サービス プリンシパルを使用して認証する必要があります。</li><li>委任されたアクセス許可がサポートされています。</li></ul><p><u>サービス の prinicipal 認証で実行する場合、アプリには、Azure portalで Power BI に対して管理者の同意が必要な使用許可が設定<strong>されていないことが必要</strong>です。</u></p><h2 id="必要なスコープ"><a href="#必要なスコープ" class="headerlink" title="必要なスコープ"></a>必要なスコープ</h2><p>Tenant.Read.All または Tenant.ReadWrite.All</p><p>標準の委任された管理者アクセス トークンを使用して認証する場合にのみ関連します。 <u>サービス プリンシパルによる認証を使用する場合は、存在しない必要があります。</u></p></blockquote><div align="center"><img src="ServicePrincipal12.png"></div>  <h4 id="アクセス許可の設定"><a href="#アクセス許可の設定" class="headerlink" title="アクセス許可の設定"></a>アクセス許可の設定</h4><ol><li><p><strong>[API のアクセス許可]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal13.png"></div>  </li><li><p>今回利用するAPIではアクセス許可は不要なので、 <strong>[･･･]</strong> &gt; <strong>[すべてのアクセス許可を削除]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal14.png"></div>  </li><li><p>確認が求められますが、 <strong>[はい、削除します]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal15.png"></div>  </li><li><p>アクセス許可が削除されたことを確認します。</p><div align="center"><img src="ServicePrincipal16.png"></div>  </li></ol><h4 id="スコープの設定"><a href="#スコープの設定" class="headerlink" title="スコープの設定"></a>スコープの設定</h4><ol><li><p><strong>[API の公開]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal17.png"></div>  </li><li><p>今回利用するAPIでは、スコープは存在しない必要があるため、未定義であることを確認します。</p><div align="center"><img src="ServicePrincipal18.png"></div>  </li></ol><h2 id="Power-BI-のテナント設定"><a href="#Power-BI-のテナント設定" class="headerlink" title="Power BI のテナント設定"></a>Power BI のテナント設定</h2><p>Power BI でサービス プリンシパルを利用して REST API を実行するためには、テナント設定 <strong>[Power BI APIの使用をサービス プリンシパルに許可]</strong> 、 <strong>[読み取り専用管理APIの使用をサービス プリンシパルに許可する]</strong> を有効化する必要がございます。</p><ul><li><p>Power BI APIの使用をサービス プリンシパルに許可</p> <div align="center"> <img src="ServicePrincipal19.png"> </div>  </li><li><p>読み取り専用管理APIの使用をサービス プリンシパルに許可する<br>こちらの設定は、セキュリティ グループ単位での有効化となります。そのため、Azure ADからセキュリティ グループを作成し、作成したサービス プリンシパルをグループに追加した上で、セキュリティ グループに対して設定を有効化します。</p><p>詳細な手順については以下の公開情報をご確認ください。<br>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/read-only-apis-service-principal-authentication">読み取り専用の管理 API に対してサービス プリンシパル認証を有効にする - Power BI | Microsoft Learn</a></p> <div align="center"> <img src="ServicePrincipal20.png"> </div>  </li></ul><h2 id="実際に動かしてみる"><a href="#実際に動かしてみる" class="headerlink" title="実際に動かしてみる"></a>実際に動かしてみる</h2><p>PowerShell および Power Automate から <a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events">Get Activity Events</a> を実行してみましょう。今回は例としてシークレットを利用した認証を行います。</p><h3 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h3><p>APIの実行にはアプリケーション (クライアント) ID、ディレクトリ (テナントID)、シークレット キー (値) が必要になるので、事前に確認しておきます。</p><div align="center"><img src="ServicePrincipal21.png"></div>  <div align="center"><img src="ServicePrincipal22.png"></div>  <h3 id="PowerShell-から-API-を実行する"><a href="#PowerShell-から-API-を実行する" class="headerlink" title="PowerShell から API を実行する"></a>PowerShell から API を実行する</h3><p>PowerShell から API を実行してみましょう。サンプルコードは以下になります。アプリケーションID、シークレット キー、テナントIDはお手元の環境に合わせて入力します。</p><p>アクティビティ ログの取得は1日単位となるので、StartDateTime、EndDateTimeは同一日付とする必要があります。<br>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_activity_log_usage_metrics/">Power BI のユーザーアクティビティ追跡方法の比較 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><p>Visual Studio Code やメモ帳などお好みのエディタから以下のコードを入力し、.ps1 ファイルとして保存します。検証のためユーザー名とパスワードを平文で含めていますが、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> <span class="literal">-Name</span> MicrosoftPowerBIMgmt </span><br><span class="line"></span><br><span class="line"><span class="variable">$clientId</span> = <span class="string">&quot;&lt;アプリケーションID&gt;&quot;</span></span><br><span class="line"><span class="variable">$secret</span> = <span class="string">&quot;&lt;シークレット キー&gt;&quot;</span></span><br><span class="line"><span class="variable">$clientSecret</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="literal">-String</span> <span class="variable">$secret</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$tenantId</span> = <span class="string">&quot;&lt;テナントID&gt;&quot;</span></span><br><span class="line"><span class="variable">$credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential <span class="variable">$clientId</span>, <span class="variable">$clientSecret</span></span><br><span class="line"><span class="built_in">Connect-PowerBIServiceAccount</span> <span class="literal">-ServicePrincipal</span> <span class="literal">-Credential</span> <span class="variable">$credential</span> <span class="literal">-TenantId</span> <span class="variable">$tenantId</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$activities</span> = <span class="built_in">Get-PowerBIActivityEvent</span> <span class="literal">-StartDateTime</span> <span class="string">&#x27;2023-07-20T00:00:00&#x27;</span> <span class="literal">-EndDateTime</span> <span class="string">&#x27;2023-07-20T23:59:59&#x27;</span> | <span class="built_in">ConvertFrom-Json</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$outputFile</span> = <span class="string">&quot;C:\Temp\activities.csv&quot;</span></span><br><span class="line"><span class="variable">$activities</span> | <span class="built_in">Export-Csv</span> <span class="variable">$outputFile</span> <span class="literal">-NoTypeInformation</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Disconnect-PowerBIServiceAccount</span></span><br></pre></td></tr></table></figure><p>上記サンプルコードを実行すると、C:\Temp 以下に activities.csv が生成されます。</p><div align="center"><img src="ServicePrincipal23.png"></div>  <h3 id="Power-Automate-から-API-を実行する"><a href="#Power-Automate-から-API-を実行する" class="headerlink" title="Power Automate から API を実行する"></a>Power Automate から API を実行する</h3><p>Power Automate から REST API を実行することも可能です。実行にあたっては組み込みの HTTP コネクタ (プレミアム コネクタ) が必要となります。</p><p>以下の手順でフローを作成します。</p><ol><li><p><strong>[作成]</strong> &gt; <strong>[インスタント クラウド フロー]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal24.png"></div>  </li><li><p><strong>[フローを手動でトリガーする]</strong> を選択します。</p><div align="center"><img src="ServicePrincipal25.png"></div>  </li><li><p>操作で組み込みの HTTP コネクタを選択します。</p><div align="center"><img src="ServicePrincipal26.png"></div>  </li><li><p>以下のとおり設定します。</p><ul><li><p>方法: GET</p></li><li><p>URI: <a href="https://api.powerbi.com/v1.0/myorg/admin/activityevents">https://api.powerbi.com/v1.0/myorg/admin/activityevents</a></p></li><li><p>クエリ: </p><ul><li>startDateTime: ‘2023-07-03T00:00:00.000Z’</li><li>endDateTime: ‘2023-07-03T23:59:00.000Z’</li></ul></li><li><p>認証: Active Directory OAuth</p></li><li><p>テナント: &lt;テナントID&gt;</p></li><li><p>対象ユーザー: <a href="https://analysis.windows.net/powerbi/api">https://analysis.windows.net/powerbi/api</a></p></li><li><p>クライアント ID: &lt;クライアントID&gt;</p></li><li><p>資格情報の種類: シークレット</p></li><li><p>シークレット: &lt;シークレット キー&gt;</p></li></ul><div align="center"><img src="ServicePrincipal27.png"></div>  </li><li><p>設定できたら、 <strong>[保存]</strong> を選択して保存し、テストを実行します。アクティビティ ログが取得できていることを確認します。</p><div align="center"><img src="ServicePrincipal28.png"></div>  <div align="center"><img src="ServicePrincipal29.png"></div>  </li></ol><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;/p&gt;
&lt;p&gt;Azure Active Directoryでは、皆さまが普段利用されているユーザー アカウント (例: &lt;a href=&quot;mailto:&amp;#101;&amp;#120;&amp;#97;&amp;#x6d;&amp;#112;&amp;#108;&amp;#101;&amp;#64;&amp;#x63;&amp;#x6f;&amp;#110;&amp;#x74;&amp;#x6f;&amp;#x73;&amp;#x6f;&amp;#x2e;&amp;#99;&amp;#x6f;&amp;#x6d;&quot;&gt;&amp;#101;&amp;#120;&amp;#97;&amp;#x6d;&amp;#112;&amp;#108;&amp;#101;&amp;#64;&amp;#x63;&amp;#x6f;&amp;#110;&amp;#x74;&amp;#x6f;&amp;#x73;&amp;#x6f;&amp;#x2e;&amp;#99;&amp;#x6f;&amp;#x6d;&lt;/a&gt;) のほかに、サービス プリンシパルを利用することでもリソースにアクセスすることが可能です。Power BI では、レポートを他サービス/アプリケーションに埋め込む (Power BI Embedded) 場合や、REST API を実行する場合に利用されます。&lt;/p&gt;
&lt;p&gt;本記事では、サービス プリンシパルについて説明し、例として PowerShell から REST API &lt;a href=&quot;https://learn.microsoft.com/ja-jp/rest/api/power-bi/admin/get-activity-events&quot;&gt;Get Activity Events&lt;/a&gt; を実行する方法や、Power Automate からこの REST API を実行する方法についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="REST API" scheme="https://jpbap-sqlbi.github.io/blog/tags/REST-API/"/>
    
    <category term="サービス プリンシパル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%83%97%E3%83%AA%E3%83%B3%E3%82%B7%E3%83%91%E3%83%AB/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft Fabric パブリック プレビュー</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/microsoft_fabric/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/microsoft_fabric/</id>
    <published>2023-06-17T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.338Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>この度、Microsoft Fabric (以下 Fabric) がパブリック プレビューとして公開されました。<br>Fabric はデータサイエンスやリアルタイム分析、可視化などデータに関する操作が行えるオールインワンの分析ソリューションです。<br>本記事では、Fabricとはどのような製品なのかご説明します。また、Fabricは 2023 年 7 月 1 日より既定で有効化されますので、設定についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p>また、冒頭でもお伝えしました通り、Fabric は現在パブリックプレビュー中でございますので、ご案内した内容が今後変更される可能性が十分にございますことをご了承いただきますようお願いいたします。</p></div><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#Microsoft-Fabric%E3%81%A8%E3%81%AF">Microsoft Fabricとは</a></li><li><a href="#Fabric-%E3%81%AE%E5%88%A9%E7%94%A8">Fabric の利用</a><ul><li><a href="#Fabric-%E8%A9%A6%E7%94%A8%E7%89%88%E3%81%AE%E9%96%8B%E5%A7%8B">Fabric 試用版の開始</a></li><li><a href="#Fabric-%E5%AE%B9%E9%87%8F%E3%81%AE%E4%BD%9C%E6%88%90">Fabric 容量の作成</a></li></ul></li><li><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9">ライセンス</a></li><li><a href="#Fabric-%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A">Fabric に関するテナント設定</a></li><li><a href="#Fabric-%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">Fabric に関するお問い合わせについて</a></li></ul><h2 id="Microsoft-Fabricとは"><a href="#Microsoft-Fabricとは" class="headerlink" title="Microsoft Fabricとは"></a>Microsoft Fabricとは</h2><p>Fabric は 端的に表現するとPower BI、Azure Synapse Analytics、Azure Data Factory を1つのSaaS環境で利用できるオールインワンの分析ソリューションです。この統合によって、データを一元管理でき、コラボレーションをより容易に行うことが可能となります。Fabric で利用できる機能は以下になります。</p><div align="center"><img src="Fabric01.png"></div>  <ul><li><p><strong>Data Engineering</strong><br>ユーザーが構造化データ/非構造化データを一元管理できるレイクハウスを作成することや、Python や R、Scala を利用した対話型のノートブックを作成したデータ分析、データを収集･処理･変換するデータ パイプラインを実行することが可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-engineering/data-engineering-overview">Microsoft Fabric のデータ エンジニアリングとは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-engineering/tutorial-lakehouse-introduction">Lakehouse のエンド ツー エンドのシナリオ: 概要とアーキテクチャ - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric02.png"></div>  </li><li><p><strong>Data Factory</strong><br>さまざまなデータ ソースからデータを取り込み、変換できるデータフローを作成できるほか、データ パイプラインを使用して、複数のタスクを実行できるワークフローを構築することができます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-factory/data-factory-overview">Data Factory とは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-factory/tutorial-end-to-end-introduction">Data Factory のエンド ツー エンドのシナリオ - 概要とアーキテクチャ - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric03.png"></div></li><li><p><strong>Data Science</strong><br>データの取得、クレンジングから、モデルのトレーニングといった機械学習モデルの構築から、デプロイ、運用までを実行できます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-science/data-science-overview">Microsoft Fabric のデータ サイエンス - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-science/tutorial-data-science-introduction">データ サイエンスのチュートリアル - 作業の開始 - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric04.png"></div>  </li><li><p><strong>Data Warehouse</strong><br>さまざまなデータ ソースに接続し、ウェアハウスを構築することができます。ウェアハウスでは、接続されたデータを簡単に結合することができるため、より少ないリソースで分析が可能となります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-warehouse/data-warehousing">Microsoft Fabric のデータ ウェアハウスとは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/data-warehouse/tutorial-introduction">データ ウェアハウスのチュートリアル - 概要 - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric05.png"></div>  </li><li><p><strong>Real-Time Analytics</strong><br>Fabric の Real-Time Analytics は、ストリーミングと時系列データに最適化されており、構造化データだけでなく、半構造化データ、非構造化データに対して優れたパフォーマンスを備えています。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/real-time-analytics/overview">Microsoft Fabric のReal-Time Analytics の概要 - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"><img src="Fabric06.png"></div>  </li><li><p><strong>Power BI</strong><br>Power BI は、データに迅速かつ直感的にアクセスして、データを使用してより適切な意思決定を行うことができます。 </p></li></ul><p>これらのように、Fabric ではデータの取得から可視化まで、エンドツーエンドで扱うことができる SaaS プラットフォームとなります。<br>より詳細に Fabric について知りたい方は、以下の公開情報やトレーニングをご参照ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/get-started/microsoft-fabric-overview">Microsoft Fabric とは - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/">Microsoft Fabric のドキュメント - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/get-started/end-to-end-tutorials">Microsoft Fabric のエンド ツー エンドのチュートリアル - Microsoft Fabric | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/training/paths/get-started-fabric/">Microsoft Fabric の概要 - Training | Microsoft Learn</a></p></div><h2 id="Fabric-の利用"><a href="#Fabric-の利用" class="headerlink" title="Fabric の利用"></a>Fabric の利用</h2><h3 id="Fabric-試用版の開始"><a href="#Fabric-試用版の開始" class="headerlink" title="Fabric 試用版の開始"></a>Fabric 試用版の開始</h3><p>Fabric は、現在 60 日間の試用が可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/get-started/fabric-trial">Fabric (プレビュー) 試用版 - Microsoft Fabric | Microsoft Learn</a></p></div><p>試用版の利用を開始するには、アカウント マネージャーを開き、 <strong>[無料体験する]</strong> を選択するか、</p><div align="center"><img src="Fabric07.png"></div> <div align="center"><img src="Fabric08.png"></div>  <p>ワークスペースを開き、 <strong>[+ 新規]</strong> &gt; <strong>[すべて表示]</strong> を選択し、</p><div align="center"><img src="Fabric09.png"></div>  <p>Fabric アイテムを選択すると、ワークスペースのアップグレードが求められるため、</p><div align="center"><img src="Fabric10.png"></div>  <p><strong>[アップグレード]</strong> を選択してワークスペースを試用版容量ワークスペースにアップグレードし、Fabric の試用を開始します。</p><div align="center"><img src="Fabric11.png"></div>  <p>Fabric 試用版をキャンセルするか、60 日の試用版の利用期限が終了したのち Fabric 容量へ移行しない場合には、試用版容量が削除されますのでご注意ください。</p><h3 id="Fabric-容量の作成"><a href="#Fabric-容量の作成" class="headerlink" title="Fabric 容量の作成"></a>Fabric 容量の作成</h3><p>Fabric を利用するには、Azure Portal 上から Fabric 容量を購入する必要があります。</p><p>Azure Portal にアクセスし、 <strong>[Microsoft Fabric (プレビュー)]</strong> を選択します。</p><div align="center"><img src="Fabric12.png"></div>  <p><strong>[ファブリック容量 の作成]</strong> を選択します。</p><div align="center"><img src="Fabric13.png"></div>  <p>サブスクリプション、リソースグループ、容量の名前、リージョン、サイズ、Fabric 容量管理者を設定し、 <strong>[確認と作成]</strong> を選択します。</p><div align="center"><img src="Fabric14.png"></div>  <h2 id="ライセンス"><a href="#ライセンス" class="headerlink" title="ライセンス"></a>ライセンス</h2><p>これまで、Power BI では Power BI Free、Power BI Pro、Power BI Premium Per User (PPU)、Power BI Premium Per Capacity (Premium容量)の4つのライセンスがあり、ワークスペースについては Pro、Premium Per User、Premium 容量、Embedded の4つのライセンス モードがありました。<br>Fabric によって、ワークスペースのライセンスモードには、Fabric 容量と、Fabric 試用版が追加されました。</p><div align="center"><img src="Fabric15.png"></div>  <p>Fabric のワークロードを利用する場合には、Fabric 容量を作成し、Fabric 容量を割り当てたワークスペースに Fabric アイテムを作成するほか、従来のPremium 容量にも Fabric アイテムを作成することが可能です。以下はライセンスとワークスペースのライセンスについて整理した表になります。</p><table><thead><tr><th></th><th>Pro</th><th>Premium Per User (PPU)</th><th>Premium容量</th><th>Embedded</th><th>Fabric</th></tr></thead><tbody><tr><td>SKU</td><td>なし</td><td>P3</td><td>P1 ~ P5</td><td>EM ~ EM3 / A1~ A8</td><td>F2 ~ F2048</td></tr><tr><td>ワークスペースにあるコンテンツを参照できるユーザー ライセンス</td><td>Pro、PPU</td><td>PPU</td><td>Free、Pro、PPU</td><td>埋め込みの方法によって (*1)</td><td>F64 未満の SKU の場合は Pro、F64 以上の場合は Free、Pro、PPU</td></tr><tr><td>Fabric アイテムの作成</td><td>不可</td><td>不可</td><td>可</td><td>不可</td><td>可</td></tr><tr><td>Embedded での利用</td><td>不可</td><td>不可</td><td>可</td><td>可</td><td>可</td></tr><tr><td>ライセンスの管理</td><td>Microsoft 365 管理センター</td><td>Microsoft 365 管理センター</td><td>Microsoft 365 管理センター</td><td>Azure Portal</td><td>Azure Portal</td></tr></tbody></table><p>*1 埋め込みの方法によって異なります。詳しくは以下の記事をご参照ください。<br>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_embedded_license/">Power BI Embedded とは？ライセンスと埋め込み方法 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><p>ライセンスについては以下の公開情報もご参照ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/enterprise/licenses">Microsoft Fabric ライセンス - Microsoft Fabric | Microsoft Learn</a></p></div><p>また、従来のライセンスについては以下のブログをご確認ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded） | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><h2 id="Fabric-に関するテナント設定"><a href="#Fabric-に関するテナント設定" class="headerlink" title="Fabric に関するテナント設定"></a>Fabric に関するテナント設定</h2><p><strong>[管理ポータル]</strong> &gt; <strong>[テナント設定]</strong> &gt; <strong>[ユーザーは Fabric アイテムを作成できます (パブリック プレビュー)]</strong> を有効化することで、ユーザーが Fabric アイテムを作成することができるようになります。</p><div align="center"><img src="Fabric16.png"></div>  <p>テナント全体で有効にしたくない場合には、Premium 容量単位で有効にすることも可能です。 <strong>[管理ポータル]</strong> &gt; <strong>[容量の設定]</strong> から Premium 容量を選択し、 <strong>[委任されたテナントの設定]</strong> &gt; <strong>[ユーザーは Fabric アイテムを作成できます (パブリック プレビュー)]</strong> を有効化します。このとき、 <strong>[テナント設定]</strong> でこの設定を無効にしている場合には、 <strong>[テナント管理者の選択をオーバーライドする]</strong> にチェックが入っていることを確認します。</p><div align="center"><img src="Fabric17.png"></div>  <div class="alert is-important"><p class="alert-title">重要</p><p>なお、上記設定を無効にしない場合には、【2023 年 7 月 1 日】 にすべての Power BI ユーザーに対して Microsoft Fabric が有効になりますのでご注意ください。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/fabric/admin/fabric-switch">organizationに対して Microsoft Fabric を有効にする - Microsoft Fabric | Microsoft Learn</a></p></div><div align="center"> <img src="Fabric18.png"> </div>  <h2 id="Fabric-に関するお問い合わせについて"><a href="#Fabric-に関するお問い合わせについて" class="headerlink" title="Fabric に関するお問い合わせについて"></a>Fabric に関するお問い合わせについて</h2><p>Power BI サポートでは、Fabric に関するお問い合わせもご支援が可能でございますが、プレビュー機能でございますため、ご案内ができない内容を含むためご回答が難しい場合や、その後機能が変更される場合などがございます。予めご了承いただくとともに、スムーズな回答のため、お問い合わせの際には事前に以下の公開情報やブログ記事をご一読いただけますと幸いでございます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/support/service-support-options">Power BI Pro、Power BI Premium、Fabric のサポート オプション - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary/">Power BI のお問い合わせについて | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/support_boundary2/">Power BI の開発支援・コンサルティングを含む内容に関するお問い合わせについて | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;この度、Microsoft Fabric (以下 Fabric) がパブリック プレビューとして公開されました。&lt;br&gt;Fabric はデータサイエンスやリアルタイム分析、可視化などデータに関する操作が行えるオールインワンの分析ソリューションです。&lt;br&gt;本記事では、Fabricとはどのような製品なのかご説明します。また、Fabricは 2023 年 7 月 1 日より既定で有効化されますので、設定についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Fabric" scheme="https://jpbap-sqlbi.github.io/blog/tags/Fabric/"/>
    
  </entry>
  
  <entry>
    <title>セルフサービス サインアップの無効化</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_self-service-signup/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_self-service-signup/</id>
    <published>2023-06-08T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.814Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。</p><p>Power BI にはいくつかのライセンスがあることを、こちらのブログ「 <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）</a> 」でご紹介させていただきました。</p><p>無償版の Power BI Free ライセンスについては、組織において無制限でライセンスを取得しご利用いただけますが、ライセンス管理者様が割り当てを行わずとも、ユーザー自身でライセンスの利用を開始すること (セルフサービス サインアップ) が可能です。</p><p>今回は、管理者が組織内のユーザーに対して、”ユーザー自身で Power BI Free ライセンスの利用を開始できるようにするかどうかを制御する方法” についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ul><li><a href="#%E7%9B%AE%E6%AC%A1">目次</a></li><li><a href="#%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4">更新履歴</a></li><li><a href="#%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E8%87%AA%E8%BA%AB%E3%81%8C-power-bi-free-%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E3%81%AE%E5%88%A9%E7%94%A8%E9%96%8B%E5%A7%8B%E3%81%99%E3%82%8B%E3%81%93%E3%81%A8%E3%82%92%E5%88%B6%E5%BE%A1%E3%81%97%E3%81%9F%E3%81%84%E3%81%AE%E3%81%AF%E3%81%A9%E3%82%93%E3%81%AA%E6%99%82">ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？</a></li><li><a href="#%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%A8%E3%81%AF">セルフサービス サインアップとは？</a></li><li><a href="#%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96%E6%89%8B%E9%A0%86">セルフサービス サインアップの無効化手順</a><ul><li><a href="#1-%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">1. 事前準備</a></li><li><a href="#2-microsoftgraph-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%81%AE%E5%AE%9F%E8%A1%8C">2. Microsoft.Graph モジュールの実行</a></li><li><a href="#3-%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%82%92%E6%9C%89%E5%8A%B9%E3%81%AB%E6%88%BB%E3%81%97%E3%81%9F%E3%81%84%E3%81%A8%E3%81%8D">3. セルフサービス サインアップを有効に戻したいとき</a></li></ul></li></ul><hr><h2 id="更新履歴"><a href="#更新履歴" class="headerlink" title="更新履歴"></a>更新履歴</h2><hr><p>2023/6/09 (記: 山本)<br>MSOnline モジュールが2023年6月30日に廃止予定であることに伴い、<a href="#%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96%E6%89%8B%E9%A0%86">セルフサービス サインアップの無効化手順</a> に使用するモジュールの変更およびスクリプトの修正を行ないました。MSOnline モジュールの廃止に関する詳細については Azure Identity サポートチームのブログをご参照ください。</p><blockquote><p><strong>参考情報</strong><br><a href="https://jpazureid.github.io/blog/azure-active-directory/how-to-determine-depreacated-azuread-msol/">Azure AD Graph / MSOnline PowerShell モジュール利用状況の調べ方</a></p></blockquote></br><hr><h2 id="ユーザー自身が-Power-BI-Free-ライセンスの利用開始することを制御したいのはどんな時？"><a href="#ユーザー自身が-Power-BI-Free-ライセンスの利用開始することを制御したいのはどんな時？" class="headerlink" title="ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？"></a>ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？</h2><hr><p>Power BI 管理者様や IT 管理者様、これから Power BI 導入のプロジェクトを進められるご担当者様などから、「ユーザーが勝手に Power BI Freeライセンスの利用を開始することを制御したい」とご要望をいただくことがたくさんあります。<br>組織によって背景は様々ですが、多くのお問合せは以下のような場合の時にいただきます。<br>このようなシナリオに該当する場合は、”セルフサービス サインアップ” 機能を無効にすることをご検討ください。</p><ul><li>ライセンス割り当ては管理者側で完全に制御したい</li><li>Power BI を組織内で徐々に展開していることを検討しているため、知らないうちにユーザーが勝手に利用することを防ぎたい</li><li>有償ライセンスのみを利用することを検討しているため、Power BI Free を利用させたくない</li></ul></br><hr><h2 id="セルフサービス-サインアップとは？"><a href="#セルフサービス-サインアップとは？" class="headerlink" title="セルフサービス サインアップとは？"></a>セルフサービス サインアップとは？</h2><hr><p>セルフサービス サインアップとは、管理者側が各ユーザーへのライセンス割り当てをしなくてもユーザー側のサインアップ作業によってライセンスの取得およびサービスの利用開始が可能となる機能です。</p><p>本機能を無効化することで、ユーザーが勝手に Power BI Free ライセンスを利用開始することを制御できます。</p></br><div class="alert is-warning"><p class="alert-title">警告</p><p>無効化の設定は他のセルフサービス プログラムと一括で管理されているため、例えば Power Apps のセルフサービス サインアップなども無効化されます。</p><p>サービスごとに制御する方法はご用意がないことを、ご注意くださいますようお願いいたします。</p></div></br><blockquote><p><strong>参考情報</strong><br>セルフ サービスサインアップが有効なプログラムの一覧はこちらでご案内しております。<br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/admin/misc/self-service-sign-up?view=o365-worldwide">セルフサービスでのサインアップと購入を有効または無効にする - Power BI | Microsoft Learn</a>   </p></blockquote><hr><h2 id="セルフサービス-サインアップの無効化手順"><a href="#セルフサービス-サインアップの無効化手順" class="headerlink" title="セルフサービス サインアップの無効化手順"></a>セルフサービス サインアップの無効化手順</h2><hr><p>セルフサービス サインアップ無効化の一連の設定手順を詳細におまとめいたしました。</p><div class="alert is-info"><p class="alert-title">Note</p><p>本操作はすべて PowerShell 上で実行することを想定しています。</p><p>また本操作は、テナント管理者を想定した操作手順となります。</p></div></br><h4 id="1-事前準備"><a href="#1-事前準備" class="headerlink" title="1. 事前準備"></a>1. 事前準備</h4><p>セルフサービス サインアップの無効化には、PowerShell の Microsoft.Graph モジュール (Microsoft Graph PowerShell SDK) を使用します。<br>次の4つの前提条件を満たしておく必要がありますので、各種準備をします。</p><ul><li>PowerShell 5.1 以降</li><li>.NET Framework 4.7.2以降</li><li>PowerShellGet 最新バージョン</li><li>PowerShellスクリプトの実行ポリシーは、リモート署名またはそれ以下に制限されていること</li></ul></br><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/installation?view=graph-powershell-1.0#prerequisites">Install the Microsoft Graph PowerShell SDK</a></p></blockquote></br><p><strong>1) PowerShell のバージョンを確認する</strong></p><p>管理者として Windows PowerShell を起動し、以下のコマンドを実行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$PSVersionTable</span></span><br></pre></td></tr></table></figure><p>次のように <code>PSVersion</code> の値が 5.1 以上であればサポートされます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Name                           Value</span><br><span class="line">----                           -----</span><br><span class="line">PSVersion                      <span class="number">5.1</span>.<span class="number">20348.1366</span></span><br><span class="line">PSEdition                      Desktop</span><br><span class="line">PSCompatibleVersions           &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>...&#125;</span><br><span class="line">BuildVersion                   <span class="number">10.0</span>.<span class="number">20348.1366</span></span><br><span class="line">CLRVersion                     <span class="number">4.0</span>.<span class="number">30319.42000</span></span><br><span class="line">WSManStackVersion              <span class="number">3.0</span></span><br><span class="line">PSRemotingProtocolVersion      <span class="number">2.3</span></span><br><span class="line">SerializationVersion           <span class="number">1.1</span>.<span class="number">0.1</span></span><br></pre></td></tr></table></figure><p>バージョンが満たない場合、ご利用の環境に合わせて、PowerShell のインストールやアップデートをお試しください。</p></br><p><strong>2) .NET Framework 4.7.2 以降のインストール状況を確認する</strong></p><p>.NET Framework のインストール状況の確認には、いくつかの方法がございますが、ここでは PowerShell を使用して .NET 4.7.2 以上のバージョンがインストールされているかどうか確認します。</p><p>次のコマンドを実行し、<code>True</code> が返ってきたら .NET Framework 4.7.2 に対応していることが確認できます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">Get-ItemPropertyValue</span> <span class="literal">-LiteralPath</span> <span class="string">&#x27;HKLM:SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full&#x27;</span> <span class="literal">-Name</span> Release) <span class="operator">-ge</span> <span class="number">461808</span></span><br></pre></td></tr></table></figure><p><code>False</code> の場合には <a href="https://learn.microsoft.com/ja-jp/dotnet/framework/install/">インストール ガイド</a> を参考に、アップデートをお試しください。</p><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/dotnet/framework/migration-guide/how-to-determine-which-versions-are-installed">方法: インストールされている .NET Framework バージョンを確認する</a></p></blockquote></br><p><strong>3) PowerShellGet を最新バージョンにする</strong></p><p>次のコマンドを実行し、<code>PowerShellGet</code> を最新バージョンにしておきます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> PowerShellGet <span class="literal">-Force</span></span><br></pre></td></tr></table></figure><p>次のプロンプトが表示される場合は <code>Y</code> を入力し、<code>Enter</code> キーで続行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">続行するには NuGet プロバイダーが必要です</span><br><span class="line">PowerShellGet で NuGet ベースのリポジトリを操作するには、<span class="string">&#x27;2.8.5.201&#x27;</span> 以降のバージョンの NuGetプロバイダーが必要です。</span><br><span class="line">NuGet プロバイダーは <span class="string">&#x27;C:\Program Files\PackageManagement\ProviderAssemblies&#x27;</span> または<span class="string">&#x27;C:\Users\XX\AppData\Local\PackageManagement\ProviderAssemblies&#x27;</span></span><br><span class="line">に配置する必要があります。<span class="string">&#x27;Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force&#x27;</span> を実行して NuGet プロバイダーをインストールすることもできます。今すぐ PowerShellGet で NuGet プロバイダーをインストールしてインポートしますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">N</span>] いいえ(N)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;Y&quot;</span>):</span><br></pre></td></tr></table></figure></br><p>次の警告が表示されアップデートが中断される場合、PowerShell の SecurityProtocol が TLS1.2 に設定されていない可能性があります。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">警告: Unable to resolve package source <span class="string">&#x27;https://www.powershellgallery.com/api/v2&#x27;</span>.</span><br><span class="line">PackageManagement\<span class="built_in">Install-Package</span> : 指定された検索条件とパッケージ名 <span class="string">&#x27;PowerShellGet&#x27;</span> と一致するものが見つかりませんでした。登録されている使用可能なすべてのパッケージ ソースを確認するには、<span class="built_in">Get-PSRepository</span> を使用します。</span><br><span class="line">発生場所 C:\Program Files\WindowsPowerShell\Modules\PowerShellGet\<span class="number">1.0</span>.<span class="number">0.1</span>\PSModule.psm1:<span class="number">1772</span> 文字:<span class="number">21</span></span><br><span class="line">+ ...          <span class="variable">$null</span> = PackageManagement\<span class="built_in">Install-Package</span> @PSBoundParameters</span><br><span class="line">+                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (Microsoft.Power....InstallPackage:InstallPackage) [<span class="built_in">Install-Package</span>], Exception</span><br><span class="line">    + FullyQualifiedErrorId : NoMatchFoundForCriteria,Microsoft.PowerShell.PackageManagement.Cmdlets.InstallPackage</span><br></pre></td></tr></table></figure><p>次のコマンドを実行し、<code>Tls12</code> が含まれていない場合、</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">Net.ServicePointManager</span>]::SecurityProtocol</span><br></pre></td></tr></table></figure><p>次のコマンドで <code>Tls12</code> を強制し、再度 <code>Install-Module PowerShellGet -Force</code> をお試しください。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">Net.SecurityProtocolType</span>]::Tls12</span><br></pre></td></tr></table></figure></br><p>また場合によっては、次の警告が表示され、<code>PowerShellGet</code> のインストールが中断されることがあります。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">信頼されていないリポジトリ</span><br><span class="line">信頼されていないリポジトリからモジュールをインストールしようとしています。このリポジトリを信頼する場合は、<span class="built_in">Set-PSRepository</span></span><br><span class="line">コマンドレットを実行して、リポジトリの InstallationPolicy の値を変更してください。<span class="string">&#x27;PSGallery&#x27;</span> からモジュールをインストールしますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">A</span>] すべて続行(A)  [<span class="type">N</span>] いいえ(N)  [<span class="type">L</span>] すべて無視(L)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;N&quot;</span>):</span><br></pre></td></tr></table></figure><p>この場合には、<code>Set-ExecutionPolicy</code> を <code>Unrestricted</code> に変更するコマンドを実行し、再度お試しください。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> <span class="literal">-ExecutionPolicy</span> Unrestricted <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure></br><p><strong>4) PowerShell スクリプトの実行ポリシーを変更する</strong></p><p>続けて次のコマンドを実行し、PowerShell スクリプトの実行ポリシーを変更します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> <span class="literal">-ExecutionPolicy</span> RemoteSigned <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure><p>コマンドを実行後、次のようなプロンプトが表示される場合、<code>A</code> を入力し、<code>Enter</code> キーで続行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">実行ポリシーの変更</span><br><span class="line">実行ポリシーは、信頼されていないスクリプトからの保護に役立ちます。実行ポリシーを変更すると、about_Execution_Policies</span><br><span class="line">のヘルプ トピック (http://go.microsoft.com/fwlink/?LinkID=<span class="number">135170</span>)</span><br><span class="line">で説明されているセキュリティ上の危険にさらされる可能性があります。実行ポリシーを変更しますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">A</span>] すべて続行(A)  [<span class="type">N</span>] いいえ(N)  [<span class="type">L</span>] すべて無視(L)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;N&quot;</span>):</span><br></pre></td></tr></table></figure><p>次のコマンドを実行し、実行ポリシーが <code>RemoteSigned</code> となっていることを確認します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ExecutionPolicy</span> <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure></br><p><strong>5) Microsoft.Graph をインストールする</strong></p><p>次のコマンドを実行し、Microsoft.Graph モジュールをインストールします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> Microsoft.Graph <span class="literal">-Scope</span> CurrentUser</span><br></pre></td></tr></table></figure><p><code>信頼されていないレポジトリ</code> と表示される場合がありますが、<code>A</code> を入力し、<code>Enter</code> キーで続行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">信頼されていないリポジトリ</span><br><span class="line">信頼されていないリポジトリからモジュールをインストールしようとしています。このリポジトリを信頼する場合は、<span class="built_in">Set-PSRepository</span></span><br><span class="line">コマンドレットを実行して、リポジトリの InstallationPolicy の値を変更してください。<span class="string">&#x27;PSGallery&#x27;</span> からモジュールをインストールしますか?</span><br><span class="line">[<span class="type">Y</span>] はい(Y)  [<span class="type">A</span>] すべて続行(A)  [<span class="type">N</span>] いいえ(N)  [<span class="type">L</span>] すべて無視(L)  [<span class="type">S</span>] 中断(S)  [?] ヘルプ (既定値は <span class="string">&quot;N&quot;</span>):</span><br></pre></td></tr></table></figure><p>Microsoft.Graph のインストール後、次のコマンドでモジュールが確認できれば、インストールは成功です。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-InstalledModule</span> Microsoft.Graph</span><br></pre></td></tr></table></figure><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Version    Name                                Repository           Description</span><br><span class="line">-------    ----                                ----------           -----------</span><br><span class="line"><span class="number">1.27</span>.<span class="number">0</span>     Microsoft.Graph                     PSGallery            Microsoft Graph PowerShell module</span><br></pre></td></tr></table></figure></br><h4 id="2-Microsoft-Graph-モジュールの実行"><a href="#2-Microsoft-Graph-モジュールの実行" class="headerlink" title="2. Microsoft.Graph モジュールの実行"></a>2. Microsoft.Graph モジュールの実行</h4><p><strong>1) Microsoft Graph にサインインする</strong></p><p>次のコマンドを実行し、Microsoft.Graph にサインインします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-MgGraph</span> <span class="literal">-Scopes</span> <span class="string">&quot;Policy.ReadWrite.Authorization&quot;</span></span><br></pre></td></tr></table></figure><p>ブラウザに遷移し、Microsoft 365 へのサインイン画面が表示されますので、<br>テナント管理者のアカウントでサインインします。</p><p>初めて上記コマンドを実行する場合、スコープに従ってアクセス許可が要求されます。<br>[組織の代理として同意する] にチェックをつけ [承諾] をクリックします。</p><div align="center"><img src="3.png" width=50%></div></br><p>その後 <code>Welcome To Microsoft Graph!</code> と表示されると、認証成功となります。</p></br><p><strong>2) Azure Active Directory 内のドメイン取得</strong></p><p>アクセス先ドメインを確認します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-MgDomain</span></span><br></pre></td></tr></table></figure><p><strong>3) セルフサービス サインアップに関するテナント設定を確認する</strong></p><p>次のコマンドを実行し、セルフサービス サインアップに関するテナント設定の状態を確認します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-MgPolicyAuthorizationPolicy</span> | <span class="built_in">Format-List</span> *Email*</span><br></pre></td></tr></table></figure><p>AllowEmailVerifiedUsersToJoinOrganization が新規ユーザーに対するテナントの自動参加の可否を決める機能であり、AllowedToSignUpEmailBasedSubscriptions　既存ユーザーに対するライセンスの自動配布の可否を決める機能です。<br>この時点で両方の値が False の場合、次の項番4を実施する必要はありません。<br>既にセルフサービス サインアップの機能は無効になっています。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AllowEmailVerifiedUsersToJoinOrganization : True</span><br><span class="line">AllowedToSignUpEmailBasedSubscriptions    : True</span><br></pre></td></tr></table></figure></br><p><strong>4) セルフサービス サインアップを無効化する</strong></p><p>セルフサービス サインアップを無効化したい場合、次のコマンドを実行し、両機能を <code>false</code> にします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-MgPolicyAuthorizationPolicy</span> <span class="literal">-AllowEmailVerifiedUsersToJoinOrganization</span>:<span class="variable">$false</span> <span class="literal">-AllowedToSignUpEmailBasedSubscriptions</span>:<span class="variable">$false</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.graph.identity.signins/update-mgpolicyauthorizationpolicy?view=graph-powershell-1.0">Update-MgPolicyAuthorizationPolicy (Microsoft.Graph.Identity.SignIns) | Microsoft Learn</a></p></blockquote></br><p>上記設定後、Power BI のライセンスをもたないユーザーが Power BI にサインインしようとしても、以下画面の通りセルフサービス サインアップができなくなります。</p><div align="center"><img src="2.png"></div></br><p><strong>5) Microsoft Graph のサインイン セッションを切断</strong></p><p>最後に次のコマンドを実行し、Microsoft Graph へのセッションを切断します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Disconnect-MgGraph</span></span><br></pre></td></tr></table></figure></br><h4 id="3-セルフサービス-サインアップを有効に戻したいとき"><a href="#3-セルフサービス-サインアップを有効に戻したいとき" class="headerlink" title="3. セルフサービス サインアップを有効に戻したいとき"></a>3. セルフサービス サインアップを有効に戻したいとき</h4><p>セルフサービス サインアップを有効化したい場合、次のコマンドを実行し、両機能を <code>true</code> にします。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Update-MgPolicyAuthorizationPolicy</span> <span class="literal">-AllowEmailVerifiedUsersToJoinOrganization</span>:<span class="variable">$true</span> <span class="literal">-AllowedToSignUpEmailBasedSubscriptions</span>:<span class="variable">$true</span></span><br></pre></td></tr></table></figure></br><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-disable-self-service#use-powershell-azure-ad-and-microsoft-365-to-enable-and-disable-self-service">組織でのセルフサービス サインアップの使用 - Microsoft 365 admin | Microsoft Learn</a></p></blockquote></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;/p&gt;
&lt;p&gt;Power BI にはいくつかのライセンスがあることを、こちらのブログ「 &lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/&quot;&gt;Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）&lt;/a&gt; 」でご紹介させていただきました。&lt;/p&gt;
&lt;p&gt;無償版の Power BI Free ライセンスについては、組織において無制限でライセンスを取得しご利用いただけますが、ライセンス管理者様が割り当てを行わずとも、ユーザー自身でライセンスの利用を開始すること (セルフサービス サインアップ) が可能です。&lt;/p&gt;
&lt;p&gt;今回は、管理者が組織内のユーザーに対して、”ユーザー自身で Power BI Free ライセンスの利用を開始できるようにするかどうかを制御する方法” についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="ライセンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9/"/>
    
    <category term="Power BI Free" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Free/"/>
    
    <category term="セルフサービス サインアップ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97/"/>
    
  </entry>
  
  <entry>
    <title>Power BI サービスでデータモデルを編集する</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_modify_model_in_service/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_modify_model_in_service/</id>
    <published>2023-05-31T06:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.586Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのチャンです。 </p><p>2023 年 4 月 下旬より、新機能リリースによって、Power BI サービスでもデータセット（データモデル）の編集が可能となりました！</p><p>これまでは、 Power BI サービス上で複数ユーザーで実施可能な共同作業はレポートの編集のみでしたが、本機能により、新しいメジャーや計算列の作成、リレーションシップの管理、行レベルセキュリティのロール作成などといったデータセットの編集作業が、毎回.PBIX ファイルをダウンロードせずとも、Power BI サービス上で、直接実施することができます。早速本機能について詳細をご紹介していきます。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></p><p></p><p></p><p>また、本機能は開発段階 (プレビュー) でございますため、今後予告なしに機能が削除されたり、</p><p>動作変更が発生する可能性がありますことをあらかじめご了承くださいますようお願い申し上げます。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E6%9C%AC%E6%A9%9F%E8%83%BD%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B%E8%A8%AD%E5%AE%9A">本機能を有効化する設定</a></li><li><a href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%E3%83%BB%E3%83%A1%E3%83%AA%E3%83%83%E3%83%88">使用方法・メリット</a></li><li><a href="#%E8%80%83%E6%85%AE%E4%BA%8B%E9%A0%85%E3%81%A8%E5%88%B6%E9%99%90%E4%BA%8B%E9%A0%85">考慮事項と制限事項</a></li></ol><hr><h2 id="本機能を有効化する設定"><a href="#本機能を有効化する設定" class="headerlink" title="本機能を有効化する設定"></a>本機能を有効化する設定</h2><hr><h4 id="テナント設定"><a href="#テナント設定" class="headerlink" title="テナント設定"></a>テナント設定</h4><p> 既定値では有効となっていますが、 Power BI 管理者権限を持つアカウントにて、[管理ポータル] &gt; [テナント設定] にて以下の設定「ユーザーはPower BI サービスでデータ モデルを編集できます (プレビュー)」を有効化します。</p><div align="center"><img src="tenant_settings.png"></div><h4 id="ワークスペースの設定"><a href="#ワークスペースの設定" class="headerlink" title="ワークスペースの設定"></a>ワークスペースの設定</h4><p>本機能を使用したいワークスペースに対して、ワークスペースの管理者にて、[設定]を開き、[Power BI] [全般] &gt; データモデルの設定の中に、「ユーザーは Power BI サービスでデータ モデルを編集できます (プレビュー)」にチェックを入れてください。</p><div align="center"><img src="workspace_settings.png"></div><p>チェックを入れて、有効化されたら、発行済みのデータセットに対して、[…]でオプションを展開すると、「オープンデータモデル」という選択肢が有効になっていることがわかります。</p><div align="center"><img src="dataset_options.png"></div><p>[オープンデータモデル]をクリックすると、モデルの編集画面へアクセスできます。</p><div align="center"><img src="open_data_model.png"></div><hr><h2 id="使用方法・メリット"><a href="#使用方法・メリット" class="headerlink" title="使用方法・メリット"></a>使用方法・メリット</h2><hr><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>以下の画像の選択肢の通り、Power BI サービス上で、新しいメジャー、計算列と計算テーブル、行レベルセキュリティ用の新しいロールを作成できます。</p><div align="center"><img src="open_data_model2.png"></div><blockquote><p><strong>参考情報</strong><br>メジャーの作成</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-tutorial-create-measures">チュートリアル: Power BI Desktop で独自のメジャーを作成する</a></li></ul><p>計算列の作成</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-tutorial-create-calculated-columns">チュートリアル: Power BI Desktop で計算列を作成する</a></li></ul><p>計算テーブルの作成</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-calculated-tables">Power BI Desktop で計算テーブルを作成する</a></li></ul><p>行レベルセキュリティについて</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-rls">Power BI での行レベルのセキュリティ (RLS)</a></li></ul></blockquote><p>リレーションシップにつきましても作成できますが、現状アイコンがないため、例えば以下の例で示すように Calendar テーブルと financials テーブルの間でリレーションシップを作成する場合、まずリレーションシップとして設定したい両方の「 Date 」列に対して、片方のテーブルの列をドラッグして、もう片方の列にドロップします。</p><div align="center"><img src="tables.png"></div><p>そうすると、リレーションシップを設定するウィザードが表示されますので、そこから詳細なリレーションシップを設定できます。</p><div align="center"><img src="relationship.png"></div></br><div align="center"><img src="relationship2.png"></div><blockquote><p><strong>参考情報</strong><br>モデルのリレーションシップについて</p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/desktop-relationships-understand">Power BI Desktop でのモデル リレーションシップ</a></li></ul></blockquote><h4 id="メリット"><a href="#メリット" class="headerlink" title="メリット"></a>メリット</h4><p>メジャー・計算列・計算テーブルの作成機能においては、数式のオートコンプリート（入力すると、自動的に利用可能な関数や完全な数式を提示してくれる機能）が実装されているため、 Power BI Desktop でのモデル編集と比較しても全く劣りません。</p><p>また、物理的にレポートファイルの受け渡しをせずとも、簡単に複数のユーザーによる編集が可能な点、会社のルールや端末のスペックにより Power BI Desktop アプリケーションのインストールができないユーザーでも実施できることなども、大きなメリットでございます。</p><p>行レベルセキュリティの作成に関して、特に Power BI Desktop より便利な点としては、ロールを定義したら、すぐに、作成したロールに適用したいユーザーまで設定できることです。</p><div align="center"><img src="rls_role.png"></div><p>これまでは、まずは Power BI Desktop でロールを作成し、 Power BI サービスへ発行してから、データセットの[セキュリティ]から行レベルセキュリティの適用ユーザーを設定する必要がありましたが、本機能を利用することで、一連の流れとして同じ画面内で設定できるため、よりスムーズなオペレーションを実施できます。</p><hr><h2 id="考慮事項と制限事項"><a href="#考慮事項と制限事項" class="headerlink" title="考慮事項と制限事項"></a>考慮事項と制限事項</h2><hr><p>本記事を執筆した時点では、プレビュー機能なため、Power BI Desktop との機能差異や制限事項がまだ多く存在しています。<br>その中から、一部ご紹介いたします。</p><ul><li><p>データ モデルを変更すると、変更は自動的に保存されます。 変更は永続的であり、元に戻すオプションはございませんので十分にご注意ください。</p></li><li><p>本機能はモデルの編集のみなため、新しいデータソースへの接続や、 Power Query によるデータ加工は実施できません。代わりにデータフローやデータマートのご利用をご検討ください。</p></li></ul><div class="alert is-info"><p class="alert-title">Note</p><p><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_dataflow_dataset/">Power BI データフローとデータセット及びデータマートの紹介と比較</a></p></div><ul><li><p>増分更新が設定されているデータセット、デプロイパイプラインによるデプロイされたデータセット、 XMLA エンドポイントによって変更されたデータセット、ライブ接続を持つデータセットなどはサポートされていません。</p></li><li><p>現在はマイワークスペースを含め、すべてのライセンスのワークスペースでご利用可能ですが、 今後一部の Pro ライセンスのワークスペースでは利用できなくなります。</p></li><li><p>データソース側のテーブルや列に対して、名前を変更することはできません。</p></li><li><p>テーブルのストレージモードの変更ができません。</p></li></ul><p>上述した考慮事項の他にもございますので、詳細につきまして、以下の公開情報にて最新状況をご確認ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/service-edit-data-models?source=recommendations#considerations-and-limitations">考慮事項と制限事項 | Power BI サービスでデータ モデルを編集する (プレビュー)</a></p></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。 </p><blockquote><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/service-edit-data-models">Power BI サービスでデータ モデルを編集する (プレビュー)</a> </li></ul></blockquote>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのチャンです。 &lt;/p&gt;
&lt;p&gt;2023 年 4 月 下旬より、新機能リリースによって、Power BI サービスでもデータセット（データモデル）の編集が可能となりました！&lt;/p&gt;
&lt;p&gt;これまでは、 Power BI サービス上で複数ユーザーで実施可能な共同作業はレポートの編集のみでしたが、本機能により、新しいメジャーや計算列の作成、リレーションシップの管理、行レベルセキュリティのロール作成などといったデータセットの編集作業が、毎回.PBIX ファイルをダウンロードせずとも、Power BI サービス上で、直接実施することができます。早速本機能について詳細をご紹介していきます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="データモデル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%83%A2%E3%83%87%E3%83%AB/"/>
    
    <category term="Power BIサービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="モデル編集" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A2%E3%83%87%E3%83%AB%E7%B7%A8%E9%9B%86/"/>
    
    <category term="リレーションシップ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AA%E3%83%AC%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%B7%E3%83%83%E3%83%97/"/>
    
    <category term="メジャー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A1%E3%82%B8%E3%83%A3%E3%83%BC/"/>
    
    <category term="計算列" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%A8%88%E7%AE%97%E5%88%97/"/>
    
    <category term="行レベルのセキュリティー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%A1%8C%E3%83%AC%E3%83%99%E3%83%AB%E3%81%AE%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3%E3%83%BC/"/>
    
  </entry>
  
  <entry>
    <title>オンプレミス データ ゲートウェイのトラブルシューティング：構成時に発生するエラー</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/gateway_troubleshooting/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/gateway_troubleshooting/</id>
    <published>2023-05-30T15:00:00.000Z</published>
    <updated>2024-01-31T08:23:41.338Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>オンプレミス上のデータを取得するなどの目的で、対象のサーバーと Power BI サービスをブリッジする機能としてオンプレミス データ ゲートウェイ (※1) がありますが、このゲートウェイの構成時にエラーが発生するというお問合せをいただくことがよくあります。<br>今回は、ゲートウェイ構成時にエラーが発生した際にまずお試しいただきたいトラブルシューティングをご案内いたします。  </p><p>※1 <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-onprem">オンプレミス データ ゲートウェイとは</a></p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><br /><br /><hr><h2 id="構成時に発生するエラー"><a href="#構成時に発生するエラー" class="headerlink" title="構成時に発生するエラー"></a><font color="RoyalBlue">構成時に発生するエラー</font></h2><hr><p>ゲートウェイ アプリをインストールした後に、ゲートウェイの管理者となるユーザーアカウントにてサインインし、新しいゲートウェイの登録を行い構成を完了させます。<br>この構成作業中に、ゲートウェイ アプリ上に以下のようなエラーメッセージが表示され、後続の処理に進めないことがあります。  </p><br /> <p>「ゲートウェイの詳細を更新できませんでした。ゲートウェイを実行するアカウントの変更が必要な場合があります。」<br>「ゲートウェイ サービスの正常性チェックがタイムアウトになり失敗しました。」<br>「ゲートウェイを作成できませんでした、もう一度お試しください。」<br>「ネットワーク要求で予期しないエラーが返されました。」<br>「ネットワーク接続が制限されています。」<br>「ゲートウェイは正しく構成されているがローカルネットワーク接続の問題によりアクセスできません。」   </p><br /><hr><h2 id="トラブルシューティング"><a href="#トラブルシューティング" class="headerlink" title="トラブルシューティング"></a><font color="RoyalBlue">トラブルシューティング</font></h2><hr><p>上記いずれかのエラーが発生している場合は、ゲートウェイを構成するための前提条件を満たせていない可能性があります。<br>このため、まずは以下の点をご確認くださいますようお願いいたします。  </p><br /><h3 id="1-最新版のゲートウェイをインストールする"><a href="#1-最新版のゲートウェイをインストールする" class="headerlink" title="1. 最新版のゲートウェイをインストールする"></a><font color="LightCoral">1. 最新版のゲートウェイをインストールする</font></h3><p>ゲートウェイの更新プログラムは毎月リリースしており、古いバージョンで発生する問題が解消している可能性があります。<br>古いバージョンをインストールしている場合は、最新版で事象が解消するかご確認いただきますようお願いいたします。  </p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-update?source=recommendations">オンプレミスのデータ ゲートウェイの更新</a>  </p><br />  <h3 id="2-ゲートウェイに必要な通信を許可する"><a href="#2-ゲートウェイに必要な通信を許可する" class="headerlink" title="2. ゲートウェイに必要な通信を許可する"></a><font color="LightCoral">2. ゲートウェイに必要な通信を許可する</font></h3><p>ゲートウェイは、以下公式ドキュメント “オンプレミス データ ゲートウェイの通信設定を調整する” でご案内しているFQDN、送信ポートの許可設定が必要となります。<br>ファイアウォールにて通信の接続を制限しているご環境の場合は、ドキュメントに記載されている通信許可の設定がお済みであるかご確認いただきますようお願いいたします。　  </p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-communication">オンプレミス データ ゲートウェイの通信設定を調整する</a>  </p><br />  <h3 id="3-ゲートウェイ-構成ファイルの設定"><a href="#3-ゲートウェイ-構成ファイルの設定" class="headerlink" title="3. ゲートウェイ 構成ファイルの設定"></a><font color="LightCoral">3. ゲートウェイ 構成ファイルの設定</font></h3><p>対象のご環境にプロキシサーバーが存在している場合、以下公式ドキュメント “オンプレミス データ ゲートウェイのプロキシ設定を構成する” の通り、事前にゲートウェイの構成ファイルの設定が必要となります。</p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-proxy">オンプレミス データ ゲートウェイのプロキシ設定を構成する</a> </p><h4 id="lt-詳細手順-gt"><a href="#lt-詳細手順-gt" class="headerlink" title="&lt;詳細手順&gt;"></a><strong>&lt;詳細手順&gt;</strong></h4><ol><li>次の２つのファイルを確認し、テキストエディタなどで開きます。  </li></ol><blockquote><p>C:\Program Files\On-premises data gateway\enterprisegatewayconfigurator.exe.config<br>C:\Program Files\On-premises data gateway\Microsoft.PowerBI.EnterpriseGateway.exe.config  </p></blockquote><ol start="2"><li>以下表記の部分を変更します。<br>※　“http://192.168.1.10:3128” の部分には、実際のプロキシサーバーのアドレスを入力いただきます。  </li></ol><p><strong>変更前 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;system.net&gt;  </span><br><span class="line">    &lt;defaultProxy useDefaultCredentials=&quot;true&quot; /&gt;  </span><br><span class="line">&lt;/system.net&gt;  </span><br></pre></td></tr></table></figure></p><p><strong>変更後 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;system.net&gt;</span><br><span class="line">    &lt;defaultProxy useDefaultCredentials=&quot;true&quot;&gt;</span><br><span class="line">        &lt;proxy </span><br><span class="line">            autoDetect=&quot;false&quot; </span><br><span class="line">            proxyaddress=&quot; http://192.168.1.10:3128&quot; </span><br><span class="line">            bypassonlocal=&quot;false&quot; </span><br><span class="line">            usesystemdefault=&quot;true&quot;</span><br><span class="line">        /&gt; </span><br><span class="line">    &lt;/defaultProxy&gt;</span><br><span class="line">&lt;/system.net&gt;  </span><br></pre></td></tr></table></figure></p><p>変更後、各ファイルを保存します。</p><p>※　ゲートウェイがプロキシを介してクラウド データ ソースに接続する場合や、対象のご環境によっては、以下構成ファイルを編集する必要があります。  </p><blockquote><p>C:\Program Files\On-premises data gateway\m\Microsoft.Mashup.Container.NetFX45.exe.config  </p></blockquote><p><strong>変更前 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;startup&gt;</span><br><span class="line">    &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.5.2&quot;/&gt;</span><br><span class="line">  &lt;/startup&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><p><strong>変更後 例</strong><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;system.net&gt;</span><br><span class="line">        &lt;defaultProxy useDefaultCredentials=&quot;true&quot; enabled=&quot;true&quot;&gt;</span><br><span class="line">        &lt;proxy proxyaddress=&quot;http://192.168.1.10:3128&quot; bypassonlocal=&quot;true&quot; /&gt;</span><br><span class="line">        &lt;/defaultProxy&gt;</span><br><span class="line">    &lt;/system.net&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></p><h4 id="lt-プロキシサーバー有無のご確認方法-gt"><a href="#lt-プロキシサーバー有無のご確認方法-gt" class="headerlink" title="&lt;プロキシサーバー有無のご確認方法&gt;"></a><strong>&lt;プロキシサーバー有無のご確認方法&gt;</strong></h4><p>コマンドプロンプトから、以下のコマンドを実行します。<br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh winhttp show proxy</span><br></pre></td></tr></table></figure></p><p>実行結果が以下結果の場合は、プロキシ設定がされていませんが、以下結果 <font color="red"><strong>以外</strong></font>の場合、プロキシ設定がされております。</p><p>――――――――――――――――<br>現在の WinHTTP プロキシ設定:<br>直接アクセス (プロキシ サーバーなし)。<br>――――――――――――――――   </p><br />  <h3 id="4．サービスアカウントの変更"><a href="#4．サービスアカウントの変更" class="headerlink" title="4．サービスアカウントの変更"></a><font color="LightCoral">4．サービスアカウントの変更</font></h3><p>以下公式ドキュメント “オンプレミスのデータ ゲートウェイ サービス アカウントを変更する” に記載される通り、ゲートウェイのサービスは、ゲートウェイ専用のサービスアカウント “NT SERVICE\PBIEgwService” によって実行されますが、対象のご環境によっては、そのままだとエラーが発生する場合があります。<br>上記 １～3 の設定確認をクリアしている場合、サービス アカウントをドメインユーザーまたは PC にサインインしているローカルユーザーに変更することで事象に変化があるかご確認いただきますようお願いいたします。  </p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-service-account">オンプレミスのデータ ゲートウェイ サービス アカウントを変更する</a></p><br /> <hr><h2 id="その他ご参考情報"><a href="#その他ご参考情報" class="headerlink" title="その他ご参考情報"></a><font color="RoyalBlue">その他ご参考情報</font></h2><hr><p>以下公式ドキュメントでもゲートウェイのトラブルシューティングに関する情報をご案内していますので、合わせてご参考にしていただきますようお願いいたします。　　</p><p>ご参考情報：<br><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-tshoot">オンプレミス データ ゲートウェイのトラブルシューティング</a></p><br /> <br /> 以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。<hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;オンプレミス上のデータを取得するなどの目的で、対象のサーバーと Power BI サービスをブリッジする機能としてオンプレミス データ ゲートウェイ (※1) がありますが、このゲートウェイの構成時にエラーが発生するというお問合せをいただくことがよくあります。&lt;br&gt;今回は、ゲートウェイ構成時にエラーが発生した際にまずお試しいただきたいトラブルシューティングをご案内いたします。  &lt;/p&gt;
&lt;p&gt;※1 &lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-onprem&quot;&gt;オンプレミス データ ゲートウェイとは&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerBI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBI/"/>
    
    <category term="Onpreisesdatagateway" scheme="https://jpbap-sqlbi.github.io/blog/tags/Onpreisesdatagateway/"/>
    
    <category term="gateway" scheme="https://jpbap-sqlbi.github.io/blog/tags/gateway/"/>
    
    <category term="troubleshooting" scheme="https://jpbap-sqlbi.github.io/blog/tags/troubleshooting/"/>
    
  </entry>
  
</feed>
