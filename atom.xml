<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Japan CSS Support Power BI Blog</title>
  
  <subtitle>日本マイクロソフトPower BIサポートチームのブログです。チームの担当製品である Power BI の情報を中心にお届けします。</subtitle>
  <link href="https://jpbap-sqlbi.github.io/blog/atom.xml" rel="self"/>
  
  <link href="https://jpbap-sqlbi.github.io/blog/"/>
  <updated>2023-04-12T04:01:09.471Z</updated>
  <id>https://jpbap-sqlbi.github.io/blog/</id>
  
  <author>
    <name>Japan Power BI Team</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Power BI で ExpressRoute の使用について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_expressroute/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_expressroute/</id>
    <published>2023-03-31T07:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.471Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのチャンです。<br>オンプレミス環境と Microsoft クラウドサービスの間に、プライベートな通信ルートで接続できる Microsoft Azure ExpressRoute という機能がございます。<br>Power BI の公式情報では詳細な記載がない場合が多いため、お客様よりよくご質問いただく内容につきまして、本ブログにてまとめてご紹介いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="Microsoft-Azure-ExpressRoute-とは"><a href="#Microsoft-Azure-ExpressRoute-とは" class="headerlink" title="Microsoft Azure ExpressRoute とは"></a>Microsoft Azure ExpressRoute とは</h2><hr><p>Microsoft Azure ExpressRoute では、専用のプライベート接続を使用してオンプレミスのネットワークを Microsoft Cloud Services に接続できます。<br>サービスの名前は Azure ExpressRoute ですが、Microsoft 365、Microsoft Power Platform、Dynamics 365 などの Azure 上に構築されたサービスへのプライベート接続もサポートしています。</p><div align="center"><img src="https://learn.microsoft.com/ja-jp/power-platform/guidance/expressroute/media/expressroute-overview.png"></div><hr><h2 id="Power-BI-で-ExpressRoute-を使用するには"><a href="#Power-BI-で-ExpressRoute-を使用するには" class="headerlink" title="Power BI で ExpressRoute を使用するには"></a>Power BI で ExpressRoute を使用するには</h2><hr><h4 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h4><p>お客様のオンプレミスのご環境から、 Power BI への接続において ExpressRoute をご利用いただくには、ExpressRoute のプロバイダーをご契約いただいた上で、お客様側の企業ネットワークにて ExpressRoute を経由するよう、ネットワークのルーティングを設定いただく必要がございます。</p><p>Power BI への接続においては、 Microsoft ピアリングを利用することとなりますが、ExpressRoute 回線が Azure Microsoft ピアリングに対して有効になっている場合は、Azure 内で使用されている <a href="https://learn.microsoft.com/ja-jp/azure/virtual-network/ip-services/public-ip-addresses#public-ip-addresses">パブリック IP アドレスの範囲</a> に回線経由でアクセスできます。</p><p>Power BI は Azure 上に構築されており、 Azure リージョン コミュニティを介して ExpressRoute を使用できます。Power BI テナントのリージョンを確認する方法については、<a href="https://learn.microsoft.com/ja-jp/power-bi/service-admin-where-is-my-tenant-located">こちら</a> をご確認ください。</p><blockquote><p><strong>参考情報</strong></p><ul><li><a href="https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-locations-providers">ExpressRoute のピアリングの場所と接続パートナー - Power BI | Microsoft Learn</a></li><li><a href="https://learn.microsoft.com/ja-jp/azure/expressroute/expressroute-faqs#microsoft-peering">Microsoft ピアリング | ExpressRoute の FAQ - Power BI | Microsoft Learn</a></li></ul></blockquote></br><h4 id="設定方法"><a href="#設定方法" class="headerlink" title="設定方法"></a>設定方法</h4><p>ExpressRoute の利用において、Power BI 側にて管理者による特別の設定は必要ございません。</p><p>お客様のネットワークから、Power BI への接続に関して、ExpressRoute を経由するよう、「 <a href="https://learn.microsoft.com/ja-jp/power-bi/admin/power-bi-allow-list-urls">Power BI URL を許可リストに追加する</a>」という公開情報に記載されているエンドポイント に対してお客様の企業ネットワークのルーティング対象として設定いただくことが必要な作業として考えられます。</p><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-bi/admin/power-bi-allow-list-urls">Power BI URL を許可リストに追加する - Power BI | Microsoft Learn</a></br></li></ul></blockquote><p>しかしながら、上記の許可リストに記載されている一部の通信においては、ExpressRoute を経由することがサポートされていません。</p><p>一例としては、<a href="https://learn.microsoft.com/ja-jp/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide#microsoft-365-common-and-office-online">Microsoft 365 Common と Office Online の URL</a> に記載されているエンドポイントで、「認証」セッションに含まれる Power BI サービスへサインイン時に使用される Azure AD 認証など、 ExpressRoute 非対応のものが一部含まれています。</p><p>そのため、Power BI へのアクセスにおいて、すべてのエンドポイントを ExpressRoute へ経由することができませんので、企業ネットワークにてインターネット接続をブロックしてしまうと、Power BI をご利用いただくのに支障が出る可能性があることをご理解ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>なお、ExpressRoute をお客様の企業内のネットワークにて、どのようにルーティングされるかは、各企業様によって実際の方法が異なりますので、弊サポートから詳細な手順をご案内することができません。予めご了承ください。</p><p></br></p></div><hr><h2 id="よくある質問"><a href="#よくある質問" class="headerlink" title="よくある質問"></a>よくある質問</h2><hr><h4 id="Q1：ExpressRoute-を利用して-Power-BI-へ接続したいが、Power-BI-で何か設定する必要がありますか。"><a href="#Q1：ExpressRoute-を利用して-Power-BI-へ接続したいが、Power-BI-で何か設定する必要がありますか。" class="headerlink" title="Q1：ExpressRoute を利用して Power BI へ接続したいが、Power BI で何か設定する必要がありますか。"></a>Q1：ExpressRoute を利用して Power BI へ接続したいが、Power BI で何か設定する必要がありますか。</h4><p><strong>A1：</strong> Power BI 側にて管理者による特別の設定は必要ございません。お客様のネットワークで ExpressRoute を経由するよう設定いただく必要があります。</p></br><h4 id="Q2：ExpressRoute-を設定したらインターネット経由の接続ができなくなりますか。"><a href="#Q2：ExpressRoute-を設定したらインターネット経由の接続ができなくなりますか。" class="headerlink" title="Q2：ExpressRoute を設定したらインターネット経由の接続ができなくなりますか。"></a>Q2：ExpressRoute を設定したらインターネット経由の接続ができなくなりますか。</h4><p><strong>A2：</strong> Power BI サービス側では、インターネットから直接受信するトラフィックはブロックしません。また、ExpressRoute は、インターネットから直接受信したトラフィックからの応答をブロックしません。</p><p>ExpressRoute をご利用いただくにあたり、以下の2点を認識いただくことが重要です。</p><ul><li><p>お客様の企業ネットワーク内からのトラフィックが ExpressRoute を使用することを保証しないこと。 企業ネットワーク内のプロキシルールとルーティング ルールがこれを決定するため、企業ネットワーク内からの要求が ExpressRoute を使用するように設定する必要があること。</p></li><li><p>他の接続 (たとえば、インターネット上のユーザー) が Power BI へのダイレクト アクセスすることをブロックしないこと</p></li></ul><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="https://learn.microsoft.com/ja-jp/power-platform/guidance/expressroute/setup#client-traffic">クライアント トラフィック | ExpressRoute を Microsoft Power Platform 用に設定する - Power BI | Microsoft Learn</a></li></ul></blockquote><p>もし Power BI サービス側で、インターネットからのアクセスを禁止したい場合は、代わりに、Azure Private Link のご利用をご検討ください。</p><p>詳細につきましては、以下のブログ記事と公開情報をご参照いただけますと幸いです。</p><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="../pbi_privatelink">Power BI Service へのアクセス制御② Azure Private Link</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-private-links">Power BI へのセキュリティで保護されたアクセスのためのプライベート エンドポイント - Power BI | Microsoft Learn</a></li></ul></blockquote></br><h4 id="Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute-を利用できますか。"><a href="#Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute-を利用できますか。" class="headerlink" title="Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute を利用できますか。"></a>Q3：オンプレミスデータゲートウェイがインストールされている環境で、ExpressRoute を利用できますか。</h4><p><strong>A3：</strong> はい、ご利用いただけます。Power BI サービスと同様に、オンプレミスデータゲートウェイ側にて特別の設定は必要ございません。お客様の企業ネットワークにて対象の通信設定を実施する場合、以下の公開情報にて必要な通信エンドポイントをご確認ください。</p><blockquote><p><strong>参考情報</strong> </p><ul><li><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-communication">Port | オンプレミス データ ゲートウェイの通信設定を調整する - Power BI | Microsoft Learn</a></li></ul></blockquote><p>しかしながら、オンプレミスデータゲートウェイがインストールされている環境でインターネットアクセスを完全にブロックしてしまった場合、一部正しく通信できないエンドポイントがございますので、ご留意ください。</p><p>具体的には、Azure Active Directory (Azure AD) と OAuth2 認証部分において、ExpressRoute 非対応のエンドポイントが含まれています。</p></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><blockquote><p><strong>本ブログの関連記事</strong></p><ul><li><a href="../pbi_pbiservice_network/">Power BI の通信設定</a></li><li><a href="../pbi_privatelink">Power BI Service へのアクセス制御② Azure Private Link</a></li></ul></blockquote></br><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのチャンです。&lt;br&gt;オンプレミス環境と Microsoft クラウドサービスの間に、プライベートな通信ルートで接続できる Microsoft Azure ExpressRoute という機能がございます。&lt;br&gt;Power BI の公式情報では詳細な記載がない場合が多いため、お客様よりよくご質問いただく内容につきまして、本ブログにてまとめてご紹介いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Express Route" scheme="https://jpbap-sqlbi.github.io/blog/tags/Express-Route/"/>
    
    <category term="通信" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E9%80%9A%E4%BF%A1/"/>
    
  </entry>
  
  <entry>
    <title>よくある「並べ替え」のお問い合わせ</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_sorting/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_sorting/</id>
    <published>2023-03-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:10.015Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Power BI でレポートを作成しているとき、ビジュアル内のデータの「並べ替え」を行いたいことがあると思います。<br>今回は「並べ替え」についてよくあるお問い合わせと、その代表的な解決策をご紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><p> <a href="#%E5%89%8D%E6%8F%90%EF%BC%9A%E3%83%93%E3%82%B8%E3%83%A5%E3%82%A2%E3%83%AB%E3%81%AE%E3%83%A1%E3%83%8B%E3%83%A5%E3%83%BC%E3%80%8C%E8%BB%B8%E3%81%AE%E4%B8%A6%E3%81%B3%E6%9B%BF%E3%81%88%E3%80%8D">前提：ビジュアルのメニュー「軸の並び替え」</a><br> <a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%91%EF%BC%9A%E5%88%97%E3%81%8C%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E5%9E%8B%E3%81%A7%E3%81%82%E3%82%8B%E3%81%9F%E3%82%81%E6%84%8F%E5%9B%B3%E3%81%97%E3%81%9F%E9%A0%86%E3%81%AB%E3%81%AA%E3%82%89%E3%81%AA%E3%81%84%E5%A0%B4%E5%90%88">ケース１：列がテキスト型であるため意図した順にならない場合</a><br> <a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%92%EF%BC%9A%EF%BC%92%E3%81%A4%E3%81%AE%E5%88%97%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%80%8C%E4%B8%A6%E3%81%B3%E6%9B%BF%E3%81%88%E3%80%8D%E3%81%97%E3%81%9F%E3%81%84%E5%A0%B4%E5%90%88">ケース２：２つの列を使って「並び替え」したい場合</a></p><hr><h2 id="前提：ビジュアルのメニュー「軸の並び替え」"><a href="#前提：ビジュアルのメニュー「軸の並び替え」" class="headerlink" title="前提：ビジュアルのメニュー「軸の並び替え」"></a>前提：ビジュアルのメニュー「軸の並び替え」</h2><hr><p>ビジュアル内のフィールドで並べ替え（昇順/降順）をしたい場合は、以下図の手順で可能です。</p><p>ビジュアル右上 (…) &gt; 軸の並べ替え &gt; フィールド名と昇順/降順を選択</p><div align="center"><img src="1.png"></div></br><p>凡例についても、凡例に使用している列で「並べ替え」を行うことが可能です。</p></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort">レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn</a></p></div></br><hr><h2 id="ケース１：列がテキスト型であるため意図した順にならない場合"><a href="#ケース１：列がテキスト型であるため意図した順にならない場合" class="headerlink" title="ケース１：列がテキスト型であるため意図した順にならない場合"></a>ケース１：列がテキスト型であるため意図した順にならない場合</h2><hr><p>特定の列で並べ替えをしようと思っても、列がテキスト型である場合は意図した順にならず、<br>テキストによる並び順になってしまいます（見た目が数値でも）</p><p>例） X軸の「月（テキスト型）」で昇順にした場合。1から始まる名称が先頭に並んでいる</p><div align="center"><img src="2.png"></div> </br><p>この問題を解決するには、根本的にはデータアーキテクトの観点でデータソース側のデータの持ち方を変更するということが<br>重要な場合もありますが、Power BI 上でどうにかしたいという場合は、別の列をもとに並べ替えるという解決策があります。<br>具体的な手順は以下です。</p></br><p>ステップ１：並べ替えのもととなる数値型の列を作成する（すでにある場合はステップ２へ）</p><p>① Power Query エディタを開く<br>Power BI Desktop &gt; ホーム &gt; データの変換</p><div align="center"><img src="3.png"></div></br><p>② 列を作成する（以下は一例です。シナリオによっては別の方法で列を作成します）<br>列の追加 &gt; 例からの列 &gt; 選択範囲から &gt; 例をいくつか入力すると法則から値が自動入力される</p><div align="center"><img src="4.png"></div></br><p>③ Power Query エディタを閉じて適用する</p><div align="center"><img src="5.png"></div></br><p>ステップ２ ： 「列で並べ替え」を設定する</p><p>テキスト型のフィールドを選択 &gt; 列で並べ替え &gt; 作成した数値型の列を選択する</p><div align="center"><img src="6.png"></div></br><p>ステップ３：[軸の並べ替え] をすると、裏側では数値型をもとにして並び替えが完了する</p><div align="center"><img src="7.png"></div></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-sort-by-column?tabs=powerbi-desktop">Power BI で 1 つの列をほかの列で並べ替える - Power BI | Microsoft Learn</a></p></div></br><hr><h2 id="ケース２：２つの列を使って「並び替え」したい場合"><a href="#ケース２：２つの列を使って「並び替え」したい場合" class="headerlink" title="ケース２：２つの列を使って「並び替え」したい場合"></a>ケース２：２つの列を使って「並び替え」したい場合</h2><hr><p>列１の値の中で重複するものが存在していて、列２の値も含めて並べ替えをしたい場合、<br>列１の並べ替えを実施した後に、Shift キーを押しながら列２のヘッダーをクリックすると、<br>列１の並べ替えを保持したまま、列２の並べ替えを設定することが可能です。</p><p>以下テーブルビジュアルを例にご説明いたします。<br>「列１」をクリックして並べ替えをした後、Shift キーを押しながら「列2」をクリックします。すると、列１内で重複した値 “3” や “2” に対する列２の値が、それぞれ降順で並べ替えられているのがわかります。</p><p>※昇順と降順の切り替えは、Shift キーを押したままもう一度ヘッダーをクリックする</p><div align="center"><img src="8.png"></div></br><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort">レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn</a></p></div></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Power BI でレポートを作成しているとき、ビジュアル内のデータの「並べ替え」を行いたいことがあると思います。&lt;br&gt;今回は「並べ替え」についてよくあるお問い合わせと、その代表的な解決策をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
  </entry>
  
  <entry>
    <title>XMLAエンドポイント</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_xmlaendpoint/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_xmlaendpoint/</id>
    <published>2023-03-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:10.071Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>Power BI Premium Per Capacity または Premium Per Userでは、XMLAエンドポイントを使用してデータセットに接続したり、更新したりすることができます。今回は  ｢XMLAエンドポイント｣ について説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88-%E3%81%A8%E3%81%AF">XMLAエンドポイント とは</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A">XMLAエンドポイントの設定</a><ul><li><a href="#%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%8B%E3%82%89XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">テナント設定からXMLAエンドポイントの設定を有効化する</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-Capacity">XMLAエンドポイントの設定 (Power BI Premium Per Capacity)</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-User">XMLAエンドポイントの設定 (Power BI Premium Per User)</a></li></ul></li><li><a href="#SQL-Server-Management-Studio-SSMS-%E3%81%8B%E3%82%89%E3%81%AE%E6%8E%A5%E7%B6%9A">SQL Server Management Studio (SSMS) からの接続</a></li><li><a href="#%E3%82%BB%E3%82%AD%E3%83%A5%E3%83%AA%E3%83%86%E3%82%A3">セキュリティ</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E5%88%A9%E7%94%A8">XMLAエンドポイントの利用</a><ul><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88">XMLAエンドポイントを利用したエクスポート</a>    </li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E6%9B%B4%E6%96%B0">XMLAエンドポイントを利用したデータセットの更新</a><ul><li><a href="#SSMS%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">SSMSを利用したデータセット更新</a></li><li><a href="#PowerShell%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">PowerShellを利用したデータセット更新</a></li></ul></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97%EF%BD%A5%E5%BE%A9%E5%85%83">データセットのバックアップ･復元</a><ul><li><a href="#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97">バックアップ</a></li><li><a href="#%E5%BE%A9%E5%85%83">復元</a></li></ul></li></ul></li></ul><h2 id="XMLAエンドポイント-とは"><a href="#XMLAエンドポイント-とは" class="headerlink" title="XMLAエンドポイント とは"></a>XMLAエンドポイント とは</h2><p>XMLAとは、 <strong>XML for Analysis</strong> の略称で、Microsoft Analysis Services エンジンによって使用される通信プロトコルを指します。Excel や SSMS といったクライアント アプリケーションとPower BI のワークスペース･データセットを管理するエンジンとの間の通信には、この XMLA プロトコルが使用されます。これらの接続は、一般的に XMLA エンドポイントと呼ばれるものを経由します。<br>Power BI の設定では、規定で設定されている “読み取り専用” の接続により、クエリを実行してデータを取得できるほか、”読み取り/書き込み” の接続によりデータセットを更新することも可能となります。また、XMLAエンドポイントでの更新は、Power BIの更新上限 (Premiumでは48回/日) にはカウントされないといったメリットがあります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考＃ <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-connect-tools">Power BI での XMLA エンドポイントを使用したデータセットの接続と管理 - Power BI | Microsoft Learn</a></p></div><h2 id="XMLAエンドポイントの設定"><a href="#XMLAエンドポイントの設定" class="headerlink" title="XMLAエンドポイントの設定"></a>XMLAエンドポイントの設定</h2><p>Power BI でXMLAエンドポイントを利用するためには、以下の設定を行います。それぞれの設定を変更するには、Power BI 管理者や、Premium容量の管理者である必要がありますのでご留意ください。</p><ul><li><a href="#%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%8B%E3%82%89XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">テナント設定からXMLAエンドポイントの設定を有効化する</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-Capacity">XMLAエンドポイントの設定 (Power BI Premium Per Capacity)</a></li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%81%AE%E8%A8%AD%E5%AE%9A-Power-BI-Premium-Per-User">XMLAエンドポイントの設定 (Power BI Premium Per User)</a></li></ul><h3 id="テナント設定からXMLAエンドポイントの設定を有効化する"><a href="#テナント設定からXMLAエンドポイントの設定を有効化する" class="headerlink" title="テナント設定からXMLAエンドポイントの設定を有効化する"></a>テナント設定からXMLAエンドポイントの設定を有効化する</h3><p>テナントでXMLAエンドポイントを有効化するには、管理ポータルにアクセスし、 <strong>[テナント設定]</strong> &gt; <strong>[統合の設定]</strong> &gt; <strong>[XMLAエンドポイントとオンプレミスのデータセットによる “Excelで分析” の許可]</strong> を有効化します。</p><div align="center"><img src="xmla01.png"></div>  <h3 id="XMLAエンドポイントの設定-Power-BI-Premium-Per-Capacity"><a href="#XMLAエンドポイントの設定-Power-BI-Premium-Per-Capacity" class="headerlink" title="XMLAエンドポイントの設定 (Power BI Premium Per Capacity)"></a>XMLAエンドポイントの設定 (Power BI Premium Per Capacity)</h3><p>XMLAエンドポイントは規定では “読み取り専用” に設定されていますが、無効化したい場合や、”読み取り/書き込み” に設定を変更したい場合は、以下の手順で設定を変更します。</p><p>管理ポータルを開き、 <strong>[容量の設定]</strong>  から容量を選択します。</p><div align="center"><img src="xmla02.png"></div>  <p><strong>[ワークロード]</strong> &gt; <strong>[XMLA エンドポイント]</strong> の設定を変更します。</p><div align="center"><img src="xmla03.png"></div>  <h3 id="XMLAエンドポイントの設定-Power-BI-Premium-Per-User"><a href="#XMLAエンドポイントの設定-Power-BI-Premium-Per-User" class="headerlink" title="XMLAエンドポイントの設定 (Power BI Premium Per User)"></a>XMLAエンドポイントの設定 (Power BI Premium Per User)</h3><p>Power BI Premium Per UserでXMLAエンドポイントの設定を変更したい場合は、以下の手順になります。</p><p>管理ポータルを開き、 <strong>[Premium Per User]</strong> &gt; <strong>[データセットのワークロード設定]</strong> &gt; <strong>[XMLA エンドポイント]</strong> の設定を変更します。</p><div align="center"><img src="xmla04.png"></div>  <h2 id="SQL-Server-Management-Studio-SSMS-からの接続"><a href="#SQL-Server-Management-Studio-SSMS-からの接続" class="headerlink" title="SQL Server Management Studio (SSMS) からの接続"></a>SQL Server Management Studio (SSMS) からの接続</h2><p>以下の手順により、SQL Server Management Studio (SSMS) からワークスペースへ接続します。SSMSは、以下のリンクより無償でダウンロードいただくことが可能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver16">SQL Server Management Studio (SSMS) のダウンロード - SQL Server Management Studio (SSMS) | Microsoft Learn</a></p></div><h3 id="1-ワークスペースの接続-URL-の取得"><a href="#1-ワークスペースの接続-URL-の取得" class="headerlink" title="1.ワークスペースの接続 URL の取得"></a>1.ワークスペースの接続 URL の取得</h3><p>ワークスペースの <strong>[設定]</strong> &gt; <strong>[プレミアム]</strong> &gt; <strong>[ワークスペース接続]</strong> で <strong>[コピー]</strong> を選択します。</p><div align="center"><img src="xmla05.png"></div>  <h3 id="2-SSMSからの接続"><a href="#2-SSMSからの接続" class="headerlink" title="2.SSMSからの接続"></a>2.SSMSからの接続</h3><p>SQL Server Management Studio を開き、 <strong>[接続]</strong> &gt; <strong>[サーバーに接続]</strong> を選択します。</p><p>以下のように設定したら、 <strong>[接続]</strong> を選択します。</p><table><thead><tr><th>項目</th><th>設定</th></tr></thead><tbody><tr><td>サーバーの種類</td><td>Analysis Services</td></tr><tr><td>サーバー名</td><td>手順1で取得したワークスペースの URL</td></tr><tr><td>認証</td><td>Active Directory - MFA で汎用</td></tr><tr><td>ユーザー名</td><td>Power BI にサインインするユーザー ID</td></tr></tbody></table><div align="center"><img src="xmla06.png"></div>  <p>必要な権限のあるユーザーが接続に成功すると、ワークスペースに存在するデータセットが表示されます。</p><div align="center"><img src="xmla07.png"></div>  <h2 id="セキュリティ"><a href="#セキュリティ" class="headerlink" title="セキュリティ"></a>セキュリティ</h2><p>サインインするユーザーに割り当てられているロールが Analysis Services の権限と対応しており、それによってXMLAエンドポイントを使用して行える操作が異なります。以下がそれを整理した表になります。</p><table><thead><tr><th><strong>Power BI アクセス許可</strong></th><th><strong>Analysis Services権限</strong></th><th><strong>実際の動作</strong></th></tr></thead><tbody><tr><td>Power  BIビューアー</td><td>Analysis  Services権限ないユーザー</td><td>データベース（データセット）を参照できない</td></tr><tr><td>Power  BI共同作成者・メンバー・管理者</td><td>Analysis  Servicesデータベース管理者</td><td>新しいデータセットを配置し、SSMS で TMSL スクリプトを実行することができます。</td></tr><tr><td>データセットのビルドアクセス</td><td>Analysis  Services データベース閲覧者</td><td>データの使用と視覚化のためにデータセットに接続し、データセットを参照できます。  行レベル セキュリティ (RLS) 規則が適用され、内部データセットのメタデータを参照することはできません。</td></tr></tbody></table><p>実際の動作は以下のようになります。</p><p><strong>＜XMLAエンドポイントに接続できるが、データセットに接続できない＞</strong></p><p>（ビューアー権限）エンドポイントまたは接続できていますが、データベースの配下に何も表示されません。</p><div align="center"><img src="xmla08.png"></div>  <p><strong>＜XMLAエンドポイントに接続できて、データセットに接続できている状態（ReadまたはRead/Write）＞</strong></p><p>（共同作成者・メンバー・管理者の権限）エンドポイントまたは接続できていて、データベース配下にテーブル（データセット）が表示されています。</p><div align="center"><img src="xmla09.png"></div>  <h2 id="XMLAエンドポイントの利用"><a href="#XMLAエンドポイントの利用" class="headerlink" title="XMLAエンドポイントの利用"></a>XMLAエンドポイントの利用</h2><p>これまでXMLAエンドポイントの設定について説明してきましたが、実際の活用方法についていくつかご紹介します。</p><ul><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88">XMLAエンドポイントを利用したエクスポート</a>    </li><li><a href="#XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E6%9B%B4%E6%96%B0">XMLAエンドポイントを利用したデータセットの更新</a><ul><li><a href="#SSMS%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">SSMSを利用したデータセット更新</a></li><li><a href="#PowerShell%E3%82%92%E5%88%A9%E7%94%A8%E3%81%97%E3%81%9F%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E6%9B%B4%E6%96%B0">PowerShellを利用したデータセット更新</a></li></ul></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%AE%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97%EF%BD%A5%E5%BE%A9%E5%85%83">データセットのバックアップ･復元</a><ul><li><a href="#%E3%83%90%E3%83%83%E3%82%AF%E3%82%A2%E3%83%83%E3%83%97">バックアップ</a></li><li><a href="#%E5%BE%A9%E5%85%83">復元</a></li></ul></li></ul><h3 id="XMLAエンドポイントを利用したエクスポート"><a href="#XMLAエンドポイントを利用したエクスポート" class="headerlink" title="XMLAエンドポイントを利用したエクスポート"></a>XMLAエンドポイントを利用したエクスポート</h3><p>XMLAエンドポイントへ接続し、PowerShellのコマンドを利用してデータをエクスポートすることが可能です。<br>Power BI内部で利用しているクエリを実行して取得することができますので、データセットに存在する列のみでなく、メジャーを利用した計算結果を取得することも可能です。</p><p>以下に取得方法を説明します。</p><h4 id="クエリの取得"><a href="#クエリの取得" class="headerlink" title="クエリの取得"></a>クエリの取得</h4><p>Power BI Desktopのパフォーマンス アナライザーを利用して、利用しているクエリを取得します。</p><ol><li>Power BI Desktopを開き、 <strong>[パフォーマンス アナライザー]</strong> を実行し、**[記録の開始]** を選択します。</li></ol>  <div align="center">  <img src="xmla10.png">  </div>  <ol start="2"><li><p><strong>[ビジュアルを更新します]</strong> を選択します。レポート内のビジュアルが更新されます。</p><div align="center"><img src="xmla11.png"></div>  </li><li><p>各ビジュアルの更新時間が表示されます。 <strong>[クエリのコピー]</strong> を選択します。</p><div align="center"><img src="xmla12.png"></div>  </li><li><p>メモ帳などに <strong>[貼り付け]</strong> して保存しておきます。</p><div align="center"><img src="xmla13.png"></div>  </li></ol><h4 id="コマンドの作成"><a href="#コマンドの作成" class="headerlink" title="コマンドの作成"></a>コマンドの作成</h4><p>PowerShellで実行するコマンドを作成します。動作確認のために使用しているPowerShellの環境は以下になります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="variable">$PSVersionTable</span></span><br><span class="line"></span><br><span class="line">Name                           Value</span><br><span class="line">----                           -----</span><br><span class="line">PSVersion                      <span class="number">7.3</span>.<span class="number">3</span></span><br><span class="line">PSEdition                      Core</span><br><span class="line">GitCommitId                    <span class="number">7.3</span>.<span class="number">3</span></span><br><span class="line">OS                             Microsoft Windows <span class="number">10.0</span>.<span class="number">22621</span></span><br><span class="line">Platform                       Win32NT</span><br><span class="line">PSCompatibleVersions           &#123;<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>…&#125;</span><br><span class="line">PSRemotingProtocolVersion      <span class="number">2.3</span></span><br><span class="line">SerializationVersion           <span class="number">1.1</span>.<span class="number">0.1</span></span><br><span class="line">WSManStackVersion              <span class="number">3.0</span></span><br></pre></td></tr></table></figure><p>Visual Studio Codeやメモ帳などお好みのエディタから以下のコードを入力し、.ps1ファイルとして保存します。検証のためユーザー名とパスワードを平文で含めていますが、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="string">&quot;Microsoft.AnalysisServices.AdomdClient&quot;</span>) </span><br><span class="line"><span class="variable">$PowerBIEndpoint</span> = <span class="string">&quot;powerbi://api.powerbi.com/v1.0/myorg/&lt;ワークスペース名&gt;;initial catalog=&lt;データセット名&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBILogin</span> = <span class="string">&quot;&lt;アカウント名&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBIPassword</span> = <span class="string">&quot;&lt;パスワード&gt;&quot;</span> </span><br><span class="line"><span class="variable">$Query</span> = <span class="string">&quot;&lt;取得したクエリ&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$ExportPath</span> = <span class="string">&quot;&lt;保存したいパス&gt;&quot;</span></span><br><span class="line">  </span><br><span class="line"><span class="variable">$Connection</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Data.OleDb.OleDbConnection</span><br><span class="line"><span class="variable">$Results</span> = <span class="built_in">New-Object</span> System.Data.DataTable</span><br><span class="line"><span class="variable">$Connection</span>.ConnectionString = <span class="string">&quot;Provider=MSOLAP.8;Data Source=&quot;</span>+ <span class="variable">$PowerBIEndpoint</span> +<span class="string">&quot;;UID=&quot;</span>+ <span class="variable">$PowerBILogin</span> +<span class="string">&quot;;PWD=&quot;</span>+ <span class="variable">$PowerBIPassword</span>  </span><br><span class="line"><span class="variable">$Connection</span>.Open() </span><br><span class="line"><span class="variable">$Adapter</span> = <span class="built_in">New-Object</span> <span class="literal">-TypeName</span> System.Data.OleDb.OleDbDataAdapter <span class="variable">$Query</span> ,<span class="variable">$Connection</span></span><br><span class="line"><span class="variable">$Adapter</span>.Fill(<span class="variable">$Results</span>) </span><br><span class="line"><span class="variable">$Results</span> | <span class="built_in">export-csv</span> <span class="literal">-Path</span> <span class="variable">$ExportPath</span>  <span class="literal">-NoTypeInformation</span></span><br><span class="line"><span class="variable">$Connection</span>.Dispose()</span><br><span class="line"><span class="variable">$Connection</span>.Close()</span><br></pre></td></tr></table></figure><p>注意するべき点として、取得したクエリ内に “” (ダブルクオーテーション) が含まれる場合には ` (バックスラッシュ) でエスケープする必要があります。例えば取得したクエリが以下の場合、</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">DEFINE</span><br><span class="line">VAR __DS0Core = </span><br><span class="line">SUMMARIZECOLUMNS(</span><br><span class="line">ROLLUPADDISSUBTOTAL(</span><br><span class="line">ROLLUPGROUP(</span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">OrderQty</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPrice</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPriceDiscount</span>]</span><br><span class="line">), <span class="string">&quot;IsGrandTotalRowTotal&quot;</span></span><br><span class="line">),</span><br><span class="line"><span class="string">&quot;MTotal&quot;</span>, <span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">MTotal</span>]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">VAR __DS0PrimaryWindowed = </span><br><span class="line">TOPN(</span><br><span class="line"><span class="number">502</span>,</span><br><span class="line">__DS0Core,</span><br><span class="line">[<span class="type">IsGrandTotalRowTotal</span>],</span><br><span class="line"><span class="number">0</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">OrderQty</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPrice</span>],</span><br><span class="line"><span class="number">1</span>,</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPriceDiscount</span>],</span><br><span class="line"><span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">EVALUATE</span><br><span class="line">__DS0PrimaryWindowed</span><br><span class="line"></span><br><span class="line">ORDER BY</span><br><span class="line">[<span class="type">IsGrandTotalRowTotal</span>] DESC,</span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;</span>[<span class="type">Name</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">OrderQty</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPrice</span>],</span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;</span>[<span class="type">UnitPriceDiscount</span>]</span><br></pre></td></tr></table></figure><p>このように記載する必要があります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Query</span> = </span><br><span class="line"><span class="string">&quot;DEFINE</span></span><br><span class="line"><span class="string">VAR __DS0Core = </span></span><br><span class="line"><span class="string">SUMMARIZECOLUMNS(</span></span><br><span class="line"><span class="string">ROLLUPADDISSUBTOTAL(</span></span><br><span class="line"><span class="string">ROLLUPGROUP(</span></span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[OrderQty],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPrice],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPriceDiscount]</span></span><br><span class="line"><span class="string"># &quot;</span>IsGrandTotalRowTotal<span class="string">&quot;をバックスラッシュでエスケープ</span></span><br><span class="line"><span class="string">), `&quot;IsGrandTotalRowTotal`&quot;</span></span><br><span class="line"><span class="string">),</span></span><br><span class="line"><span class="string"># &quot;</span>MTotal<span class="string">&quot;をバックスラッシュでエスケープ</span></span><br><span class="line"><span class="string">`&quot;MTotal`&quot;, &#x27;SalesLT SalesOrderDetail&#x27;[MTotal]</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">VAR __DS0PrimaryWindowed = </span></span><br><span class="line"><span class="string">TOPN(</span></span><br><span class="line"><span class="string">502,</span></span><br><span class="line"><span class="string">__DS0Core,</span></span><br><span class="line"><span class="string">[IsGrandTotalRowTotal],</span></span><br><span class="line"><span class="string">0,</span></span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;[Name],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;[Name],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[OrderQty],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPrice],</span></span><br><span class="line"><span class="string">1,</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPriceDiscount],</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">EVALUATE</span></span><br><span class="line"><span class="string">__DS0PrimaryWindowed</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ORDER BY</span></span><br><span class="line"><span class="string">[IsGrandTotalRowTotal] DESC,</span></span><br><span class="line"><span class="string">&#x27;SalesLT Product&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT ProductCategory&#x27;[Name],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[OrderQty],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPrice],</span></span><br><span class="line"><span class="string">&#x27;SalesLT SalesOrderDetail&#x27;[UnitPriceDiscount]&quot;</span></span><br></pre></td></tr></table></figure><p>作成したコマンドを実行することで、指定したパスに.csvファイルが出力されます。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; C:\PBISAMPLE\xmla<span class="literal">-export</span><span class="literal">-sample</span>.ps1</span><br></pre></td></tr></table></figure><p>生成された.CSVファイル</p><div align="center"><img src="xmla14.png"></div>  <h3 id="XMLAエンドポイントを利用したデータセットの更新"><a href="#XMLAエンドポイントを利用したデータセットの更新" class="headerlink" title="XMLAエンドポイントを利用したデータセットの更新"></a>XMLAエンドポイントを利用したデータセットの更新</h3><p>XMLAエンドポイントを利用することで、データセットの更新が行うことができます。XMLAエンドポイントでの更新は、Power BIの更新上限 (Premiumでは48回/日) にはカウントされないため、頻繁にデータセットを更新する必要がある場合にご利用いただけます。</p><h4 id="SSMSを利用したデータセット更新"><a href="#SSMSを利用したデータセット更新" class="headerlink" title="SSMSを利用したデータセット更新"></a>SSMSを利用したデータセット更新</h4><p>SSMSを利用してデータセット更新について説明します。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/analysis-services/tabular-models/process-database-table-or-partition-analysis-services?view=power-bi-premium-current&preserve-view=true">データベース、テーブル、またはパーティションの処理 (Analysis Services) | Microsoft Learn</a></p></div><ol><li><p>更新したいデータセットを右クリックし、 <strong>[データベースの処理]</strong> を選択します。</p><div align="center"><img src="xmla15.png"></div>  </li><li><p>モードを選択します。今回は例として”完全更新”を選択します。 <strong>[OK]</strong> をクリックし、更新を実行します。</p><p>それぞれのモードは以下の処理を表します。</p><table><thead><tr><th>モード</th><th>説明</th></tr></thead><tbody><tr><td><strong>既定の処理</strong></td><td>データベース オブジェクトの処理状態を検出し、処理されていないオブジェクトや部分的に処理されたオブジェクトを完全処理状態にするために必要な処理を行います。 空のテーブルとパーティションのデータが読み込まれ、階層、計算列、およびリレーションシップが構築または再構築 (再計算) されます。</td></tr><tr><td><strong>完全処理</strong></td><td>データベースとそのデータベースに含まれるすべてのオブジェクトを処理します。 既に処理されているオブジェクトに対して完全処理を実行すると、SQL Server Analysis Servicesオブジェクト内のすべてのデータが削除され、そのオブジェクトが処理されます。 この種の処理は、構造上の変更をオブジェクトに加えた場合に必要となります。 このオプションは最も多くのリソースを必要とします。</td></tr><tr><td><strong>消去の処理</strong></td><td>データベース オブジェクトからすべてのデータを削除します。</td></tr><tr><td><strong>再計算の処理</strong></td><td>階層、リレーションシップ、および計算列を更新して再計算します。</td></tr></tbody></table><div align="center"><img src="xmla16.png"></div>  </li><li><p>更新が成功したことを確認します。</p><div align="center"><img src="xmla17.png"></div>  </li></ol><p>手順2で <strong>[スクリプト]</strong> を選択すると、更新のためのTMSLスクリプトが表示されます。</p><div align="center"><img src="xmla30.png"></div>  <figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;refresh&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objects&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;database&quot;</span>: <span class="string">&quot;rp-xmla-test-01&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>生成されたTMSLスクリプトは、SQL Server Agent ジョブや、SQL Server Integration Services(SSIS)、PowerShellのInvoke-ASCmdコマンドからの実行が可能です。例えば、SQL Server Agent ジョブを設定することで、スケジュール更新を行うことや、SSISでのETL処理後にデータセットを更新するといったことが可能となります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/analysis-services/tmsl/refresh-command-tmsl?view=asallproducts-allversions">Refresh コマンド (TMSL) | Microsoft Learn</a></p></div><p>また、データセットをすべて更新する以外にも、テーブルを更新することや、パーティションを更新することが可能です。データセットに増分更新を設定している場合は、パーティション単位での更新を行うことで、更新範囲を限定することができ、更新のパフォーマンスを向上させることができます。</p><p>テーブルを更新したい場合には、更新したいテーブルを右クリックし、 <strong>[テーブルの処理]</strong> を選択します。</p><div align="center"><img src="xmla18.png"></div>  <p>処理モードと処理するオブジェクトを選択し、更新を行います。</p><div align="center"><img src="xmla19.png"></div>  <p>また、パーティションを更新したい場合には、更新したいパーティションを右クリックし、 <strong>[パーティション]</strong> を選択します。</p><div align="center"><img src="xmla20.png"></div>  <p><strong>[処理]</strong> を選択します。</p><div align="center"><img src="xmla21.png"></div>  <p>処理モードと処理するオブジェクトを選択し、更新を行います。</p><div align="center"><img src="xmla22.png"></div>  <p>テーブルやパーティションの更新についても、同様にTMSLスクリプトでの更新が可能です。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// テーブルの更新</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;refresh&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objects&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;database&quot;</span>: <span class="string">&quot;rp-xmla-test-01&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;table&quot;</span>: <span class="string">&quot;SalesLT ProductCategory&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// パーティションの更新</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;refresh&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;full&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;objects&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;database&quot;</span>: <span class="string">&quot;rp-xmla-test-01&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;table&quot;</span>: <span class="string">&quot;SalesLT SalesOrderDetail&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;partition&quot;</span>: <span class="string">&quot;SalesLT SalesOrderDetail-a283583f-1fe4-4dc5-bd55-46106f953eea&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>増分更新やパーティションについて、以下の公開情報やブログをご確認ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/incremental-refresh-overview">Power BI でのデータセットの増分更新とリアルタイム データ - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/incremental-refresh-xmla">Power BI での XMLA エンドポイントを使用した高度な増分更新およびリアルタイム データ - Power BI | Microsoft Learn</a></p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_incremental_refresh/">増分更新の概要と設定方法 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><h4 id="PowerShellを利用したデータセット更新"><a href="#PowerShellを利用したデータセット更新" class="headerlink" title="PowerShellを利用したデータセット更新"></a>PowerShellを利用したデータセット更新</h4><p>PowerShellからの更新の例として、Invoke-ProcessASDatabaseを利用したデータセット更新について説明します。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/powershell/module/sqlserver/invoke-processasdatabase?view=sqlserver-ps">Invoke-ProcessASDatabase (SqlServer) | Microsoft Learn</a></p></div><p>SQL Server PowerShell モジュールのインストールがされていない場合には、以下のコマンドでインストールを行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Install-Module</span> <span class="literal">-Name</span> SqlServer</span><br></pre></td></tr></table></figure><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/sql/powershell/download-sql-server-ps-module?view=sql-server-ver16">SQL Server PowerShell モジュールのダウンロード - SQL Server | Microsoft Learn</a></p></div><p>インストール後、以下のコマンドを実行し、Invoke-ProcessASDatabase が含まれていることを確認します。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Get-Command</span> <span class="literal">-Module</span> sqlserver</span><br></pre></td></tr></table></figure><p>含まれていない場合には、以下のコマンドを実行し、プレビュー版のインストールを行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Install-Module</span> <span class="literal">-Name</span> SqlServer <span class="literal">-AllowPrerelease</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure><p>再度以下のコマンドを実行し、Invoke-ProcessASDatabase が含まれていることを確認します。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; <span class="built_in">Get-Command</span> <span class="literal">-Module</span> sqlserver</span><br></pre></td></tr></table></figure><p>インストールが完了したら、Visual Studio Codeやメモ帳などお好みのエディタから以下のコードを入力し、.ps1ファイルとして保存します。こちらも、検証のためユーザー名とパスワードを平文で含めていますが、セキュリティの観点からこのまま利用することは避け、実運用時には別ファイルから取得するなどの構成としてください。以下の例では、データセットの完全更新を行います。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> SqlServer <span class="literal">-Version</span> <span class="number">22.0</span>.<span class="number">49</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$Workspace</span> = <span class="string">&quot;powerbi://api.powerbi.com/v1.0/myorg/&lt;ワークスペース名&gt;&quot;</span></span><br><span class="line"><span class="variable">$Database</span> = <span class="string">&quot;&lt;データセット名&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$PowerBILogin</span> = <span class="string">&quot;&lt;アカウント名&gt;&quot;</span></span><br><span class="line"><span class="variable">$PowerBIPassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;&lt;パスワード&gt;&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$Credential</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential (<span class="variable">$PowerBILogin</span>, <span class="variable">$PowerBIPassword</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-ProcessASDatabase</span> <span class="literal">-Server</span> <span class="variable">$Workspace</span> <span class="literal">-DatabaseName</span> <span class="variable">$Database</span> <span class="literal">-Credential</span> <span class="variable">$Credential</span> <span class="literal">-RefreshType</span> Full </span><br></pre></td></tr></table></figure><p>作成したコマンドを実行することで、データセットの更新が行われます。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\System32&gt; C:\PBISAMPLE\xmla<span class="literal">-refresh</span><span class="literal">-sample</span>.ps1</span><br><span class="line">Impact                                          XmlaResults</span><br><span class="line">------                                          -----------</span><br><span class="line">Microsoft.AnalysisServices.Tabular.ObjectImpact &#123;Microsoft.AnalysisServices.XmlaResult&#125;</span><br></pre></td></tr></table></figure><p>テーブルを更新する場合やパーティションを更新する場合には以下のコードとなります。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">Invoke-ProcessTable</span> <span class="literal">-TableName</span> <span class="string">&quot;&lt;テーブル名&gt;&quot;</span> <span class="literal">-RefreshType</span> Full <span class="literal">-Server</span> <span class="variable">$Workspace</span> <span class="literal">-DatabaseName</span> <span class="variable">$Database</span> <span class="literal">-Credential</span> <span class="variable">$Credential</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># パーティションの更新</span></span><br><span class="line"><span class="built_in">Invoke-ProcessPartition</span> <span class="literal">-TableName</span> <span class="string">&quot;&lt;テーブル名&gt;&quot;</span> <span class="literal">-PartitionName</span> <span class="string">&quot;&lt;パーティション名&gt;&quot;</span> <span class="literal">-RefreshType</span> Full <span class="literal">-Server</span> <span class="variable">$Workspace</span> <span class="literal">-Database</span> <span class="variable">$Database</span> <span class="literal">-Credential</span> <span class="variable">$Credential</span></span><br></pre></td></tr></table></figure><h3 id="データセットのバックアップ･復元"><a href="#データセットのバックアップ･復元" class="headerlink" title="データセットのバックアップ･復元"></a>データセットのバックアップ･復元</h3><p>大きいデータセットのストレージ形式や増分更新を設定したデータセット、XMLAエンドポイントを利用して変更されたデータセットはダウンロードすることができませんが、SSMSからXMLAエンドポイントを利用することでバックアップや復元が可能となります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-backup-restore-dataset">Power BI Premium データセットのバックアップと復元 - Power BI | Microsoft Learn</a></p></div><h3 id="バックアップ"><a href="#バックアップ" class="headerlink" title="バックアップ"></a>バックアップ</h3><p>バックアップを行う前に、ワークスペースにAzure Data Lake Storage Gen2を接続しておく必要があります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/transform-model/dataflows/dataflows-azure-data-lake-storage-integration">Azure Data Lake Gen 2 を使用するようにデータフロー ストレージを構成する - Power BI | Microsoft Learn</a></p></div><div align="center"><img src="xmla23.png"></div>  <div align="center"><img src="xmla24.png"></div>  <p>設定が完了したら、SSMSでデータベースを右クリックし、 <strong>[バックアップ]</strong> を選択します。</p><div align="center"><img src="xmla25.png"></div>  <div align="center"><img src="xmla26.png"></div>  <p>バックアップが完了すると、接続されたAzure Data Lake Storage Gen2に.adfファイルが保存されます。</p><div align="center"><img src="xmla27.png"></div>  <h4 id="復元"><a href="#復元" class="headerlink" title="復元"></a>復元</h4><p>データセットを復元するには、SSMSでデータベースを右クリックし、 <strong>[復元]</strong> を選択します。</p><div align="center"><img src="xmla28.png"></div>  <p>復元するファイルを選択します。</p><div align="center"><img src="xmla29.png"></div>  <p>XMLAエンドポイントによって、よりPower BIの利用の幅が広がります。Power BI Premiumをご契約いただいていないユーザー様でも、試用版Power BI Premium Userのライセンスのご利用で本機能をお試しいただけます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_disable_trial_version/#Power-BI-%E8%A9%A6%E7%94%A8%E7%89%88%EF%BC%88%E7%84%A1%E6%96%99%E4%BD%93%E9%A8%93%EF%BC%89%E3%81%A8%E3%81%AF">Power BI 試用版（無料体験）を無効化する方法 | Japan CSS Support Power BI Blog (jpbap-sqlbi.github.io)</a></p></div><p>以上、本ブログが少しでも皆さまのお役に立てますと幸いでございます。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;Power BI Premium Per Capacity または Premium Per Userでは、XMLAエンドポイントを使用してデータセットに接続したり、更新したりすることができます。今回は  ｢XMLAエンドポイント｣ について説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="更新" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%9B%B4%E6%96%B0/"/>
    
    <category term="Power BI Premium" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Premium/"/>
    
    <category term="XMLAエンドポイント" scheme="https://jpbap-sqlbi.github.io/blog/tags/XMLA%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88/"/>
    
  </entry>
  
  <entry>
    <title>組織内のユーザーのマイ ワークスペースへアクセスする方法</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_control_access_myworkspace/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_control_access_myworkspace/</id>
    <published>2023-02-27T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.395Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのファムです。</p><p>組織内のユーザーが退職やプロジェクト離任時に、そのユーザーのマイ ワークスペースで作成されたレポートやデータセットにアクセスしたい場面がございませんでしょうか。実は、Power BI管理者権限のユーザーなら、組織内のユーザーのマイ ワークスペースへ適用するごとに24時間限定でアクセスできる機能がございます。</p><p>本ブログでは、Power BI 管理者権限で組織内のユーザーのマイ ワークスペースへアクセスする方法の手順をご紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>ご紹介する機能は、現時点ではプレビュー機能で開発段階のため、今後予告なしに機能が削除されたり、または動作変更が発生する可能性があったりしますので、あらかじめご了承ください。</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></br></p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E3%83%9E%E3%82%A4-%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B9%E3%81%A8%E3%81%AF">マイ ワークスペースとは</a></li><li><a href="#%E7%B5%84%E7%B9%94%E5%86%85%E3%81%AE%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E3%83%9E%E3%82%A4-%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%B9%E3%83%9A%E3%83%BC%E3%82%B9%E3%81%B8%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B%E6%89%8B%E9%A0%86">組織内のユーザーのマイ ワークスペースへアクセスする手順</a></br></li></ol><hr><h2 id="マイ-ワークスペースとは"><a href="#マイ-ワークスペースとは" class="headerlink" title="マイ ワークスペースとは"></a>マイ ワークスペースとは</h2><hr><p>すべての Power BI ユーザーには、マイ ワークスペースと呼ばれる個人用ワークスペースがあり、ユーザーはそこで自分のコンテンツを操作できます。 通常、マイ ワークスペースにアクセスできるのはそのマイ ワークスペースの所有者のみですが、Power BI 管理者は一連の機能を使用して、それらのワークスペースを管理できます。</p><blockquote><p><strong>参考情報</strong><br> <a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-portal-workspaces#gain-access-to-any-users-my-workspace">マイ ワークスペースを管理する</a><br>※本情報の内容（添付文書、リンク先などを含む）は作成日時点でのものであり、予告なく変更される場合があります。</p></blockquote><hr><h2 id="組織内のユーザーのマイ-ワークスペースへアクセスする手順"><a href="#組織内のユーザーのマイ-ワークスペースへアクセスする手順" class="headerlink" title="組織内のユーザーのマイ ワークスペースへアクセスする手順"></a>組織内のユーザーのマイ ワークスペースへアクセスする手順</h2><hr><p>Power BI管理者権限のユーザーで、Power BIサービスにサインイン後、「<strong>…</strong>」＞ 「<strong>設定</strong>」＞ 「<strong>管理ポータル</strong>」＞ 「<strong>ワークスペース</strong>」へ移動します。</p><p>ユーザーのマイ ワークスペースの確認方法は、ワークスペースの名前が「<strong>PersonalWorkspace ＋ ユーザー名</strong>」となっているか、またはワークスペースの型が「<strong>個人用グループアクティブ</strong>」となっていることを確認します。</p><div align="center"><img src="image1.png"></div><p>アクセスしたいユーザーのマイ ワークスペースを選択し、「<strong>アクセスの取得</strong>」を押下します。その時点で、該当のユーザーのマイ ワークスペースにアクセスできます。<br>※「アクセスの取得」ボタンを押下した時点から24時間後に、アクセス権限が自動的に解除されます。</p><div align="center"><img src="image2.png"></div><p>管理者の「<strong>ワークスペース</strong>」から、該当のユーザーのマイ ワークスペースを確認できます。</p><div align="center"><img src="image3.png"></div><p>該当ユーザーの「<strong>マイ ワークスペース</strong>」にアクセスし、ワークスペース内のコンテンツを確認できます。</p><div align="center"><img src="image4.png"></div><p>マイ ワークスペースのレポートやデータセットの閲覧、.pbixファイルのダウンロードなどを行うことも可能です。</p><div align="center"><img src="image5.png"></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのファムです。&lt;/p&gt;
&lt;p&gt;組織内のユーザーが退職やプロジェクト離任時に、そのユーザーのマイ ワークスペースで作成されたレポートやデータセットにアクセスしたい場面がございませんでしょうか。実は、Power BI管理者権限のユーザーなら、組織内のユーザーのマイ ワークスペースへ適用するごとに24時間限定でアクセスできる機能がございます。&lt;/p&gt;
&lt;p&gt;本ブログでは、Power BI 管理者権限で組織内のユーザーのマイ ワークスペースへアクセスする方法の手順をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="users in your organization" scheme="https://jpbap-sqlbi.github.io/blog/tags/users-in-your-organization/"/>
    
    <category term="myworkspace" scheme="https://jpbap-sqlbi.github.io/blog/tags/myworkspace/"/>
    
    <category term="control" scheme="https://jpbap-sqlbi.github.io/blog/tags/control/"/>
    
  </entry>
  
  <entry>
    <title>Power BI サービスに発行したレポートの時刻のずれについて</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_service_timezone/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_service_timezone/</id>
    <published>2023-02-27T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:10.011Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI Desktopで作成したレポートを Power BI サービスに発行した後、相対時間のスライサー、フィルターの結果、Now 関数や DateTimeZone 関数などで取得した日付と時刻のデータにずれが生じて困ったことはありませんか。<br>今回は、この日付と時刻のデータにずれが生じる理由と対処策をご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div></br><hr><h2 id="Power-BI-サービスの協定世界時-UTC-の時刻に基づいている"><a href="#Power-BI-サービスの協定世界時-UTC-の時刻に基づいている" class="headerlink" title="Power BI サービスの協定世界時 (UTC) の時刻に基づいている"></a>Power BI サービスの協定世界時 (UTC) の時刻に基づいている</h2><p>Power BI のデータ モデルには、タイムゾーン情報が含まれていません。<br>Power BI Desktop は、アプリをインストールした PC のシステム時間に基づき動作します。<br>このため、日本の時間に合わせた PC 上で、例えば DAX の Now 関数や Power Query の <code>DateTimeZone.LocalNow</code> 関数を使用した場合は、日本時間に合わせて日付と時刻の情報を取得します。<br>一方で Power BI サービスは、グローバルでのコンテンツ共有を想定しており、統一したタイムゾーンベースでの可視化をベースとすることを理由に、テナントのリージョンや言語設定、ユーザーが使用する PC のシステム時間やブラウザ言語にかかわらず、 協定世界時 (UTC) の時刻に基づき動作します。<br>この違いにより、Power BI サービスに発行したレポート上の日付と時刻の情報にずれが生じる場合があります。</p><p>参考情報：<br><a href="https://learn.microsoft.com/ja-jp/dax/date-and-time-functions-dax">日付と時刻関数</a><br><a href="https://learn.microsoft.com/ja-jp/powerquery-m/datetimezone-functions">DateTimeZone 関数</a> </p></br><h2 id="日本のユーザーは-9-時間のずれを考慮する必要がある"><a href="#日本のユーザーは-9-時間のずれを考慮する必要がある" class="headerlink" title="日本のユーザーは 9 時間のずれを考慮する必要がある"></a>日本のユーザーは 9 時間のずれを考慮する必要がある</h2><p>協定世界時 (UTC) と日本標準時 (JST) の時差は 9 時間です。<br>このため、Power BI サービス上でレポートを使用する場合は、 9 時間の差を考慮する必要があります。<br>具体的には、取得した時間に +9 時間する計算をしたり、タイムゾーン情報を変更する関数を使用するなどして工夫することで対処します。<br>次の項では、2つの例をご案内いたします。 </p><p>参考情報：<br><a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/slicer-filter-relative-time#considerations-and-limitations">Power BI で相対時間のスライサーおよびフィルターを作成する- 考慮事項と制限事項</a> </p></br> <h2 id="対処策の例"><a href="#対処策の例" class="headerlink" title="対処策の例"></a>対処策の例</h2><p><strong>例１：Now 関数で現在の日付と時刻の情報を取得している場合</strong><br>以下のように、<a href="https://learn.microsoft.com/ja-jp/dax/utcnow-function-dax">UTCNow</a> 関数で UTC の現在の日付と時刻を取得し +9 時間する列を作成します。</p><blockquote><p>UTCNow+9 = <font color="DodgerBlue">UTCNOW</font>() + <font color="DodgerBlue">TIME</font>(<font color="DarkTurquoise">9</font>,<font color="DarkTurquoise">0</font>,<font color="DarkTurquoise">0</font>)</p></blockquote><p>Power BI Desktop 上では、どちらも日本時間で表示されます。</p><div align="center"><img src="1.png"></div></p><p>Power BI サービスに発行すると、<code>Now</code> 関数で取得した [Now] 列のデータは UTC の時間ですが、 <code>UTCNow</code> 関数で UTC の現在の日付と時刻を取得し +9 時間した [UTCNow＋9] 列は、日本時間で表示することができます。</p><div align="center"><img src="2.png"></div></p></br><p><strong>例２：Power Query で現在の日付と時刻情報を取得する場合</strong><br>Power Query で <code>DateTime.LocalNow</code> などの関数を使用すると、現在の日付と時刻の情報を取得できます。<br>しかしながら、上述の通りこのまま Power BI サービスに発行すると 9 時間のずれが発生するため、タイムゾーン情報を変更する関数 <a href="https://learn.microsoft.com/ja-jp/powerquery-m/datetimezone-switchzone">DateTimeZone.SwitchZone</a> を使用することで時間のずれを回避し、Power BI サービス上でも日本時間にて日付と時刻の情報を取得することができます。</p><p>Power Query で <code>DateTime.LocalNow</code> 関数を用いて現在の日付と時刻の情報を取得した場合：<br>PCのシステム時間に基づきます。</p><blockquote><p>＝ DateTime.LocalNow()</p></blockquote><div align="center"><img src="3.png"></div></p><p><code>DateTimeZone.SwitchZone</code> 関数を用いて、タイムゾーン情報を +9 時間に変更した場合：<br>UTC に +9 時間するので、結果として日本の時間になります。</p><blockquote><p>= DateTimeZone.SwitchZone(DateTimeZone.UtcNow(),<font color="DarkTurquoise">09</font>)</p></blockquote><div align="center"><img src="4.png"></div></p><p>Power BI Desktop 上では、どちらも日本時間で表示されます。</p><div align="center"><img src="5.png"></div></p><p>Power BI サービス に発行すると、<code>DateTime.LocalNow</code> 関数を用いたほうは UTC の時間で表示されますが、<code>DateTimeZone.SwitchZone</code> 関数を用いたほうは UTC に+9 時間しているため、日本の時間になります。</p><div align="center"><img src="6.png"></div></p></br><p>このように、時刻のずれが生じた場合は、UTC とのずれを考慮したレポート作成を実施していただきますようお願いいたします。</p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI Desktopで作成したレポートを Power BI サービスに発行した後、相対時間のスライサー、フィルターの結果、Now 関数や DateTimeZone 関数などで取得した日付と時刻のデータにずれが生じて困ったことはありませんか。&lt;br&gt;今回は、この日付と時刻のデータにずれが生じる理由と対処策をご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="PowerBI" scheme="https://jpbap-sqlbi.github.io/blog/tags/PowerBI/"/>
    
    <category term="UTC" scheme="https://jpbap-sqlbi.github.io/blog/tags/UTC/"/>
    
    <category term="相対時間" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E7%9B%B8%E5%AF%BE%E6%99%82%E9%96%93/"/>
    
    <category term="タイムゾーン" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%BF%E3%82%A4%E3%83%A0%E3%82%BE%E3%83%BC%E3%83%B3/"/>
    
    <category term="9時間" scheme="https://jpbap-sqlbi.github.io/blog/tags/9%E6%99%82%E9%96%93/"/>
    
    <category term="JST" scheme="https://jpbap-sqlbi.github.io/blog/tags/JST/"/>
    
    <category term="DateTimeZone" scheme="https://jpbap-sqlbi.github.io/blog/tags/DateTimeZone/"/>
    
    <category term="Now" scheme="https://jpbap-sqlbi.github.io/blog/tags/Now/"/>
    
  </entry>
  
  <entry>
    <title>Power BI テーマについて</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_theme_introduction/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_theme_introduction/</id>
    <published>2023-02-27T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:10.031Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。<br>レポートやダッシュボードのデザインを一括で設定する方法として、Power BI テーマという便利な機能があることをみなさんご存知でしょうか？<br>今回は、Power BI テーマの機能や利用方法について紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#Power-BI-%E3%81%AE%E3%83%86%E3%83%BC%E3%83%9E%E3%81%A8%E3%81%AF">Power BIのテーマとは</a></li><li><a href="#%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88%E3%83%86%E3%83%BC%E3%83%9E%E3%81%AE%E8%A8%AD%E5%AE%9A%E6%96%B9%E6%B3%95">レポートテーマの設定方法</a></li><li><a href="#%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%83%80%E3%83%83%E3%82%B7%E3%83%A5%E3%83%9C%E3%83%BC%E3%83%89%E3%83%86%E3%83%BC%E3%83%9E">カスタムダッシュボードテーマ</a></li><li><a href="#Power-BI%E3%83%86%E3%83%BC%E3%83%9E%E3%81%AE%E9%81%8B%E7%94%A8%E6%96%B9%E6%B3%95">Power BIテーマの運用方法</a></li><li><a href="#%E3%83%86%E3%83%BC%E3%83%9E%E3%82%AE%E3%83%A3%E3%83%A9%E3%83%AA%E3%83%BC">テーマギャラリー</a></br></li></ol><hr><h2 id="Power-BI-のテーマとは"><a href="#Power-BI-のテーマとは" class="headerlink" title="Power BI のテーマとは"></a>Power BI のテーマとは</h2><hr><p>Power BIのテーマ機能を使用すると、コンテンツの全体にデザインが適用され、すべてのビジュアルで設定されたテーマの色や文字の書式が既定値として使用されます。<br>テーマ機能は現在、レポートとダッシュボードに設定できますが、本ブログは主にレポートでのテーマ設定を中心に紹介していきます。</p><h3 id="テーマ設定のメリット"><a href="#テーマ設定のメリット" class="headerlink" title="テーマ設定のメリット"></a>テーマ設定のメリット</h3><p>・既定で選択できないフォントを使用可能になります</p><div align="left"><img src="1.png"></div><p>・既定で選択できる[テーマの色]を変更できます</p><div align="left"><img src="2.png"></div><p>・組織内で使用されるレポートのデザインを統一できます</p><p>・レポートやビジュアルのデザインを一括設定することで工数が減ります　など<br><br></p><hr><h2 id="レポートテーマの設定方法"><a href="#レポートテーマの設定方法" class="headerlink" title="レポートテーマの設定方法"></a>レポートテーマの設定方法</h2><hr><p>Power BI Desktop の レポートテーマは、[表示]リボンのテーマセクションから、以下3つの方法で設定することが可能です。<br>①    組み込み：既定のテーマがございますのでそのまま使用可能<br>②    カスタム：一般的なレポートテーマのオプションをカスタマイズ可能<br>③    JSON：カスタム設定よりさらに細かな制御が可能</p><div align="left"><img src="3.png"></div><h3 id="カスタム設定で指定可能な内容"><a href="#カスタム設定で指定可能な内容" class="headerlink" title="カスタム設定で指定可能な内容"></a>カスタム設定で指定可能な内容</h3><p>■名前と色<br>テーマの色：レポートで主に使用される色<br>センチメントの色：正、負、または中立の結果を示すために、主要業績評価指標 (KPI) のビジュアルとウォーターフォール図で使用される色<br>分岐の色：データポイントが範囲内かどうかを示すために条件付き書式設定で使用される色<br>構造色 ：ビジュアル要素の軸グリッド線、強調表示色、背景色など</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-report-themes#set-structural-colors">Power BI Desktop でレポート テーマを使用する - Power BI | Microsoft Learn―構造色を設定する</a></p></div><p>■テキスト<br>全般（データと軸ラベルを含む各視覚エフェクト）、タイトル（各ビジュアルの主要なタイトルと軸のタイトル）、カードとKPIのコールアウト値、主要なインフルエンサービジュアルのタブヘッダーのテキストフォント、サイズ及び色を設定できます。</p><p>■ビジュアル<br>背景：背景色や透明度を設定できます。<br>罫線：色や半径を設定できます。<br>ヘッダー：各ビジュアルの上部領域の背景色、枠線やアイコンの色、透明度を設定できます。<br>ツールヒント：背景色、ラベルや値のテキストの色を設定できます。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-custom-tooltips">Power BI Desktop でのヒントのカスタマイズ - Power BI | Microsoft Learn</a></p></div><p>■ページ<br>[壁紙]及び[ページの背景]の背景色や透明度を設定できます。</p><p>■フィルター<br>[フィルターウィンドウ]、[使用可能なフィルターカード]及び[適用されたフィルターカード]の背景色、透明度、フォントとアイコンの色やサイズを設定できます。</p><h3 id="JSONでレポートテーマを細かく制御する"><a href="#JSONでレポートテーマを細かく制御する" class="headerlink" title="JSONでレポートテーマを細かく制御する"></a>JSONでレポートテーマを細かく制御する</h3><p>カスタム設定で指定できない内容については、JSONで設定行うことで、より細かな制御を実現できます。例えば既定では選択可能なフォントが限られた数や種類しかありませんので、レポートで日本語を使用する際にフォントにこまることはありませんか。Power BIテーマを設定することで、既定のリストに存在しない日本語のフォントに簡単に変えることができます。</p><p>例えば、以下のJSONを使用することで、レポートのすべての文字フォントを”Meiryo”に指定することができます。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;CustomTheme&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;textClasses&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;callout&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;header&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;title&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;largeTitle&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;label&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;semiboldLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;largeLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;smallLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;lightLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;boldLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;largeLightLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;smallLightLabel&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;fontFace&quot;</span>: <span class="string">&quot;Meiryo&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JSONの作成方法ですが、Power BI では”JSON スキーマ” に基づいてカスタムテーマが検証されます。そのため、設定可能な項目などを確認するには、テーマの設定に使用できるプロパティを”JSON スキーマ”をGitHubから取得して、ご確認いただく必要がございます。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://github.com/microsoft/powerbi-desktop-samples/tree/main/Report%20Theme%20JSON%20Schema">Report Theme JSON Schema at main · microsoft/powerbi-desktop-samples · GitHub</a></p></div><p>また、”JSON スキーマ”を確認しても、実際な設定につまずくこともあるかもしれません。以下のGitHubページでは、ビジュアルごとにテーマを設定したサンプルコードを用意しておりますため、ご参照いただけますと幸いです。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="/blog/master/README/">PowerBI-ThemeTemplates/README.md at master · MattRudy/PowerBI-ThemeTemplates · GitHub</a></p></div><p>なお、以下の公開情報に、基本なJSON構文やすぐご利用可能な例文が紹介されておりますで、必要に応じてご活用ください。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-report-themes">Power BI Desktop でレポート テーマを使用する - Power BI | Microsoft Learn</a></p></div><hr><h2 id="カスタムダッシュボードテーマ"><a href="#カスタムダッシュボードテーマ" class="headerlink" title="カスタムダッシュボードテーマ"></a>カスタムダッシュボードテーマ</h2><hr><p>Power BIレポートに適用するテーマは、ダッシュボードにも適用することができます。 既にレポート テーマが適用されているレポートからのタイルをピン留めする場合は、現在のテーマを保持するか、ダッシュボード テーマを使用するかを選択できます。<br>以下画面ショットの通り、ダッシュボード画面から[編集]＞[ダッシュボード テーマ]から、JSONのアップロードや、カスタムテーマの設定が可能です。<br>※ダッシュボードのカスタムテーマは、レポートからピン留めされたタイルでのみ機能します。</p><div align="left"><img src="4.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/service-dashboard-themes">Power BI サービスのダッシュボード テーマを使用する - Power BI | Microsoft Learn</a></p></div><hr><h2 id="Power-BIテーマの運用方法"><a href="#Power-BIテーマの運用方法" class="headerlink" title="Power BIテーマの運用方法"></a>Power BIテーマの運用方法</h2><hr><p>レポートテーマを作成したあとの運用方法は、JSONファイルや、テンプレートレポートで運用する方法をご紹介します。</p><h3 id="JSONでの運用"><a href="#JSONでの運用" class="headerlink" title="JSONでの運用"></a>JSONでの運用</h3><p>JSON スキーマをもとに作成したJSONファイル、もしくはテーマのカスタマイズを行い適用したあとに、[現在のテーマを保存]を選択することで、JSONファイルとしてエクスポートして運用できます。JSONで運用する場合、すでに作成済のレポートや、ダッシュボードにも適用することも可能で、様々な場面に対応できる運用方法となっております。</p><div align="left"><img src="5.png"></div><h3 id="テンプレートレポートでの運用"><a href="#テンプレートレポートでの運用" class="headerlink" title="テンプレートレポートでの運用"></a>テンプレートレポートでの運用</h3><p>一方、JSON運用を行う場合は、ユーザーに参照する手順の説明が必要など、運用が難しい場合は、Power BIのテンプレートレポートでの運用もございます。<br>以下画面ショットのとおり、レポートをテンプレートレポート(.pbitファイル)としてエクスポートすることが可能です。エクスポートされた.pbitファイルは、データやクエリの定義や、ビジュアルやテーマの定義が含まれますが、データは含まれず、手軽に共有できるサイズになります。.pbitファイルをユーザーに共有して運用をすることで、ユーザーは、設定されているテーマをベースにレポートを作成できますので、レポートにJSONを適用する手間はありません。</p><div align="left"><img src="6.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-report-themes#setting-structural-colors">Power BI Desktop でレポート テーマを使用する - Power BI | Microsoft Learn</a></p></div><hr><h2 id="テーマギャラリー"><a href="#テーマギャラリー" class="headerlink" title="テーマギャラリー"></a>テーマギャラリー</h2><hr><p>Power BI コミュニティサイトは、世界中にいるさまざまなPower BIのエンジニアや有識者にて運営されており、お互いにPower BIの課題を解決し合う場となっております。<br>そのコミュニティサイトに、ユーザーの皆様がご作成、ご共有いただきましたPower BIが、テーマギャラリーでシェアされています、レポートのデザインを行う際にご参照いただけますと幸いでございます。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>参考情報：<a href="https://community.powerbi.com/t5/Themes-Gallery/bd-p/ThemesGallery">Themes Gallery - Microsoft Power BI Community</a></p></div><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;br&gt;レポートやダッシュボードのデザインを一括で設定する方法として、Power BI テーマという便利な機能があることをみなさんご存知でしょうか？&lt;br&gt;今回は、Power BI テーマの機能や利用方法について紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI テーマ" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%83%86%E3%83%BC%E3%83%9E/"/>
    
    <category term="Power BI デザイン" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3/"/>
    
  </entry>
  
  <entry>
    <title>Power BI のアップデート情報について</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_feature_roadmap/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_feature_roadmap/</id>
    <published>2023-01-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.471Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI では、Power BI Desktop、Power BI サービス、Power BI 用モバイル アプリ、オンプレミス データ ゲートウェイを定期的に更新しており、基本的には毎月 1 回メジャー アップデートが行われ、月によってはその後マイナー アップデートがリリースされることがあります。 </p><p>アップデートでは、既知の問題の修正や機能追加が行われますが、公開ドキュメントではどのような情報が開示されているのか、また、それらの情報をどこから確認できるか気になったことはありませんか？</p><p>本ブログでは、Power BI のアップデート履歴やプレビュー機能のロードマップなど、レポート開発ご担当者様から組織の IT 管理者様まで、すべての Power BI ユーザー様にとって役に立つ情報を網羅してご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="メジャー-アップデートについて"><a href="#メジャー-アップデートについて" class="headerlink" title="メジャー アップデートについて"></a>メジャー アップデートについて</h2><p>冒頭でもご案内した通り、Power BI Desktop 、Power BI サービス、Power BI 用モバイル アプリ、オンプレミス データ ゲートウェイは月 1 回程度の頻度でメジャーなアップデートが行われ、それぞれ以下サイトよりアップデート情報をご確認いただけます。<br>なお、各公開情報において共通の<font color="DeepPink">ご注意事項</font>がありますので、以下をご理解いただいた上で読み進めていただきますようお願いいたします。</p><p><font color="DeepPink">＝ ご注意事項 ＝</font></p><p>・既知の問題の修正履歴やセキュリティ更新に関する情報は公開しておりません。<br>・弊社では最新版のアプリの使用を推奨していることからも、過去バージョンで発生していた問題については、最新バージョンにアップデートすることで事象が解消するかお試しいただきますようお願いいたします。<br>・Microsoft の Power BI に関する公式ドキュメントは、はじめに英語版のドキュメントが作成され、そのドキュメントを翻訳し、日本語等各言語の公開情報が作成される流れとなっております。このため、タイミングによっては日本語ドキュメントの更新が遅れる場合やドキュメント内のリンクが正しくない場合がございます。<br> ※ 英語版ドキュメントは、URLの”ja-jp”の箇所を”en-us”に変更することでアクセスいただけます。<br>・プレビュー機能は、今後予告なしに機能が削除される、または動作変更が発生する可能性のある機能となりますことをあらかじめご了承くださいますようお願いいたします。</p><p><font color="DeepPink">＝＝＝＝＝＝＝＝</font></p><h3 id="Power-BI-Desktop-・-Power-BI-サービス"><a href="#Power-BI-Desktop-・-Power-BI-サービス" class="headerlink" title="Power BI Desktop ・ Power BI サービス"></a><strong>Power BI Desktop ・ Power BI サービス</strong></h3><p><a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-latest-update?tabs=powerbi-service">Power BI の新機能</a><br>Power BI Desktop と Power BI サービスに対する最新の更新情報について説明しています。<br>新しい機能や大きな変更点について、一部の機能についてはブログ、ビデオ (公式 Youtube)、記事 (公式ドキュメント) が用意されており、各リンクも案内しています。</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/fundamentals/desktop-latest-update-archive?tabs=powerbi-service">Power BI Desktop と Power BI サービスに対する過去の月次更新</a><br>Power BI Desktop と Power BI サービスに対する前月以前の更新情報についてのアーカイブとなります。<br>なお、過去数か月前までの Power BI Desktop のダウンロードが可能ですが、リンクがないものについてはすでに提供が終了されており、サポート対象外となります。　</p><p><a href="https://powerbi.microsoft.com/ja-jp/blog/power-bi-december-2022-feature-summary/">Power BI Month yyyy Feature Summary</a><br>Power BI チームの公式ブログです。<br>[Power BI Month yyyy Feature Summary] という命名規則のタイトルにて、その月の更新について機能ごとに詳細を案内しています。<br>※上記リンクは本ブログが公開された 2023 年 1 月時点での最新情報のリンク (Power BI December 2022 Feature Summary) となります。</p><p><a href="https://www.youtube.com/@MicrosoftPowerBI">Power BI Update - Month yyyy</a><br>Power B Iの公式 Youtube チャンネルです。<br>[Power BI Month yyyy] という命名規則のタイトルにて、その月の更新について機能ごとに詳細を案内しています。 </p><br><h3 id="Power-BI-用モバイル-アプリ"><a href="#Power-BI-用モバイル-アプリ" class="headerlink" title="Power BI 用モバイル アプリ"></a><strong>Power BI 用モバイル アプリ</strong></h3><p><a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/mobile/mobile-whats-new-in-the-mobile-apps">Power BI 用モバイル アプリの新機能</a><br>過去バージョン～最新バージョンでリリースされた新機能について説明しています。</p><p><a href="https://powerbi.microsoft.com/ja-jp/blog/tag/mobile/">モバイル アプリ向けの Power BI チームのブログ</a><br>Mobile というタグがつけられたPower BI 用モバイル アプリに関する投稿がまとめられています。</p><br><h3 id="オンプレミス-データ-ゲートウェイ"><a href="#オンプレミス-データ-ゲートウェイ" class="headerlink" title="オンプレミス データ ゲートウェイ"></a><strong>オンプレミス データ ゲートウェイ</strong></h3><p><a href="https://learn.microsoft.com/ja-jp/data-integration/gateway/service-gateway-monthly-updates">これまでのオンプレミス データ ゲートウェイの月次更新</a><br>オンプレミス データ ゲートウェイの最新の 6 つの更新について説明しています。<br>アプリのダウンロードもこちらのサイトから可能です。</p><p><a href="https://powerbi.microsoft.com/ja-jp/blog/on-premises-data-gateway-december-release/">On-premises data gateway Month release</a><br>Power BI チームの公式ブログです。<br>[On-premises data gateway Month release] という命名規則のタイトルにて、その月の更新について機能ごとに詳細を案内しています。</p><p>※上記リンクは本ブログが公開された 2023 年 1 月時点での最新情報のリンク (On-premises data gateway December release) となります。</p><br><h2 id="新機能と予定されている機能について"><a href="#新機能と予定されている機能について" class="headerlink" title="新機能と予定されている機能について"></a>新機能と予定されている機能について</h2><p>Power BI では、プレビュー機能としてリリースされ、のちにGA （一般提供） に切り替わる機能があります。<br>現時点でプレビュー機能としてリリースされている機能やすでにGAされた機能については、以下サイトからご確認いただけます。</p><p><a href="https://community.powerbi.com/t5/Data-Stories-Gallery/Power-BI-Release-Plan/m-p/930557">Power BI Release Plan</a><br>コミュニティで公開されているレポートとなります。</p><p><a href="https://learn.microsoft.com/ja-jp/power-platform-release-plan/2022wave2/power-bi/planned-features">Power BI の新機能と予定されている機能</a><br>2022 年 10 月から 2023 年 3 月まで(2022　Wave2と呼ばれます。) のリリースで予定されている機能の一覧を示します。</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-connect-to-power-bi-release-plan">Power BI リリース計画レポートに接続する</a><br>上記のPower BI リリース計画の情報については、Power BI サービス上でテンプレート アプリから確認することも可能です。<br>詳細な手順をこちらで案内しています。</p><div align="left"><img src="1.png"></div></p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI では、Power BI Desktop、Power BI サービス、Power BI 用モバイル アプリ、オンプレミス データ ゲートウェイを定期的に更新しており、基本的には毎月 1 回メジャー アップデートが行われ、月によってはその後マイナー アップデートがリリースされることがあります。 &lt;/p&gt;
&lt;p&gt;アップデートでは、既知の問題の修正や機能追加が行われますが、公開ドキュメントではどのような情報が開示されているのか、また、それらの情報をどこから確認できるか気になったことはありませんか？&lt;/p&gt;
&lt;p&gt;本ブログでは、Power BI のアップデート履歴やプレビュー機能のロードマップなど、レポート開発ご担当者様から組織の IT 管理者様まで、すべての Power BI ユーザー様にとって役に立つ情報を網羅してご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
    <category term="Power BI モバイル" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%83%A2%E3%83%90%E3%82%A4%E3%83%AB/"/>
    
    <category term="オンプレミス データ ゲートウェイ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4/"/>
    
    <category term="リリースプラン" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AA%E3%83%AA%E3%83%BC%E3%82%B9%E3%83%97%E3%83%A9%E3%83%B3/"/>
    
    <category term="更新情報" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%9B%B4%E6%96%B0%E6%83%85%E5%A0%B1/"/>
    
    <category term="アップデート" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%83%83%E3%83%97%E3%83%87%E3%83%BC%E3%83%88/"/>
    
    <category term="新機能" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%96%B0%E6%A9%9F%E8%83%BD/"/>
    
    <category term="Feature" scheme="https://jpbap-sqlbi.github.io/blog/tags/Feature/"/>
    
    <category term="ロードマップ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AD%E3%83%BC%E3%83%89%E3%83%9E%E3%83%83%E3%83%97/"/>
    
  </entry>
  
  <entry>
    <title>Power Platform管理センターからオンプレミス データ ゲートウェイのインストールの制御方法</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_gateway_Installation_control/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_gateway_Installation_control/</id>
    <published>2023-01-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.491Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのファムです。</p><p>本ブログでは、Power Platform管理センターから組織内のユーザーに対してオンプレミス データ ゲートウェイのインストールを制御する手順をご紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></br></p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%81%A8%E3%81%AF">オンプレミス データ ゲートウェイとは</a></li><li><a href="#Power-Platform-%E7%AE%A1%E7%90%86%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC%E3%81%8B%E3%82%89%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%AE%E5%88%B6%E5%BE%A1%E6%89%8B%E9%A0%86">Power Platform 管理センターからオンプレミス データ ゲートウェイのインストールの制御手順</a></li><li><a href="#%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%82%8B%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AE%E6%8C%99%E5%8B%95">オンプレミス データ ゲートウェイをインストールできるユーザーの場合の挙動</a></li><li><a href="#%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%84%E3%83%A6%E3%83%BC%E3%82%B6%E3%83%BC%E3%81%AE%E5%A0%B4%E5%90%88%E3%81%AE%E6%8C%99%E5%8B%95">オンプレミス データ ゲートウェイをインストールできないユーザーの場合の挙動</a></li><li><a href="#%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9-%E3%83%87%E3%83%BC%E3%82%BF-%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4-%E5%80%8B%E4%BA%BA%E7%94%A8%E3%83%A2%E3%83%BC%E3%83%89-%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E5%88%B6%E5%BE%A1%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">オンプレミス データ ゲートウェイ (個人用モード)のインストール制御について</a></br></li></ol><hr><h2 id="オンプレミス-データ-ゲートウェイとは"><a href="#オンプレミス-データ-ゲートウェイとは" class="headerlink" title="オンプレミス データ ゲートウェイとは"></a>オンプレミス データ ゲートウェイとは</h2><hr><p>Power BI サービス上のレポートを最新データに更新するためには、データセットとデータソースを接続する必要がありますが、データソースがオンプレミス環境にある場合は、オンプレミス データゲートウェイが必要です。</p><p>オンプレミス データ ゲートウェイとは、オンプレミス環境のデータとPower BIサービス間においてセキュリティで保護されたデータ転送を行うための「ブリッジ」です。オンプレミス データ ゲートウェイのイメージは、以下のPower BI構成の概要図をご参考ください。</p><div align="center"><img src="image1.png"></div><p> <strong>参考情報：</strong><br> <a href="https://learn.microsoft.com/ja-jp/power-platform/admin/wp-onpremises-gateway">オンプレミス ゲートウェイについて</a></p><hr><h2 id="Power-Platform-管理センターからオンプレミス-データ-ゲートウェイのインストールの制御手順"><a href="#Power-Platform-管理センターからオンプレミス-データ-ゲートウェイのインストールの制御手順" class="headerlink" title="Power Platform 管理センターからオンプレミス データ ゲートウェイのインストールの制御手順"></a>Power Platform 管理センターからオンプレミス データ ゲートウェイのインストールの制御手順</h2><hr><p><a href="https://admin.powerplatform.microsoft.com/">Microsoft Power Platform 管理センター</a>にサインインします。「<strong>データ（プレビュー）</strong>」  ＞ 「<strong>オンプレミス データ ゲートウェイ</strong>」　＞　「<strong>ゲートウェイのテナント管理</strong>」にオンを設定し、　「<strong>ゲートウェイのインストール担当者の管理</strong>」をクリックします。</p><div align="center"><img src="image2.png"></div><p><strong>・ユーザーを追加する場合</strong><br>「<strong>ゲートウェイのインストール担当者の管理</strong>」画面から、ゲートウェイをインストールさせたいユーザーを追加します。追加されているユーザーは、「<strong>現在のゲートウェイ インストーラー</strong>」の一覧から確認できます。こちらの一覧に表示されているユーザーは、ゲートウェイをインストール可能であり、この一覧に表示されていないユーザーはゲートウェイをインストールできないようになります。<br></br></p><div align="center"><img src="image3.png"></div><p><strong>・ユーザーを削除する場合</strong><br>追加したユーザーに対して、オンプレミス データ ゲートウェイをインストールさせたくない場合は、「<strong>現在のゲートウェイ インストーラー</strong>」の一覧から「<strong>×</strong>」をクリックし、削除します。</p><div align="center"><img src="image4.png"></div><hr><h2 id="オンプレミス-データ-ゲートウェイをインストールできるユーザーの場合の挙動"><a href="#オンプレミス-データ-ゲートウェイをインストールできるユーザーの場合の挙動" class="headerlink" title="オンプレミス データ ゲートウェイをインストールできるユーザーの場合の挙動"></a>オンプレミス データ ゲートウェイをインストールできるユーザーの場合の挙動</h2><hr><p>オンプレミス データ ゲートウェイをインストールできるユーザーは、オンプレミス データ ゲートウェイからサインインを試みると、以下のように正常にサインインできます。また、構成しているゲートウェイをご確認できます。</p><div align="center"><img src="image5.png"></div><hr><h2 id="オンプレミス-データ-ゲートウェイをインストールできないユーザーの場合の挙動"><a href="#オンプレミス-データ-ゲートウェイをインストールできないユーザーの場合の挙動" class="headerlink" title="オンプレミス データ ゲートウェイをインストールできないユーザーの場合の挙動"></a>オンプレミス データ ゲートウェイをインストールできないユーザーの場合の挙動</h2><hr><p>オンプレミス データ ゲートウェイをインストールできないユーザーは、オンプレミス データ ゲートウェイからサインインを試みると、エラーメッセージ「<strong>インストールに失敗しました。オンプレミス データ ゲートウェイをインストールできるユーザーが組織により制限されています。サービス管理者またはテナント管理者にお問い合わせください。</strong>」が表示されます。<br>こちらのエラーメッセージが表示されるユーザーが、オンプレミス データ ゲートウェイをインストールできるようにしたい場合は、管理者ロールのユーザーからPower Platform管理センターでゲートウェイのインストール担当者として追加してもらう必要があります。</p><div align="center"><img src="image6.png"></div><div align="center"><img src="image7.png"></div></br><hr><h2 id="オンプレミス-データ-ゲートウェイ-個人用モード-のインストール制御について"><a href="#オンプレミス-データ-ゲートウェイ-個人用モード-のインストール制御について" class="headerlink" title="オンプレミス データ ゲートウェイ (個人用モード) のインストール制御について"></a>オンプレミス データ ゲートウェイ (個人用モード) のインストール制御について</h2><hr><p>オンプレミス データ ゲートウェイには、Power BI でのみ機能するオンプレミス データ ゲートウェイ (個人用モード) (以下、個人用ゲートウェイと表記します) という異なる種類のゲートウェイがあります。<br>名前の通り自分専用のゲートウェイとして、ローカルコンピューターに配置し、ローカルのデータソースとの接続・データセットの更新に使用されるゲートウェイです。</p><blockquote><p>[参考情報]<br><a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-personal-mode">Power BI で個人用ゲートウェイを使用する</a></p></blockquote></br><p>Power Platform 管理センターや Power BI サービスの [接続とゲートウェイの管理] 画面からは、個人用ゲートウェイのインストール制御は行なえません。<br>しかし、テナント内すべてのゲートウェイに対して管理コマンドの実行が可能な<strong>オンプレミス データ ゲートウェイ管理用の PowerShell コマンドレット</strong>を使用することで、個人用ゲートウェイに対してもインストールの制御・ユーザーの追加などが可能になります。</p><p>このセクションでは、個人用ゲートウェイのインストールを制御し、特定のユーザーのみにインストール権限を付与する手順について説明いたします。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>・ オンプレミス データ ゲートウェイ管理用の PowerShell コマンドレットは、パブリックプレビューの機能となります。</p><p>・ また、オンプレミス データ ゲートウェイ管理用の PowerShell コマンドレットでインストール制御を行なうためには、テナント管理者 (Power BI 管理者またはPower Platform 管理者、グローバル管理者) 権限を持っている必要があります。</p></div></br><h3 id="個人用ゲートウェイの制御手順"><a href="#個人用ゲートウェイの制御手順" class="headerlink" title="個人用ゲートウェイの制御手順"></a>個人用ゲートウェイの制御手順</h3><h4 id="1-オンプレミス-データ-ゲートウェイ管理用の-PowerShell-コマンドレットをインストール"><a href="#1-オンプレミス-データ-ゲートウェイ管理用の-PowerShell-コマンドレットをインストール" class="headerlink" title="1. オンプレミス データ ゲートウェイ管理用の PowerShell コマンドレットをインストール"></a>1. オンプレミス データ ゲートウェイ管理用の PowerShell コマンドレットをインストール</h4><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> <span class="literal">-Name</span> DataGateway</span><br></pre></td></tr></table></figure><div class="alert is-success"><p class="alert-title">ヒント</p><p><code>DataGateway</code> コマンドレットを使用するためには、Windows OS 標準の Windows PowerShell とは別に Powershell 6.2.2 以降のバージョンが必要です。</p><p>PowerShell は以下 Github からダウンロード可能です。</p><p><a href="https://github.com/PowerShell/PowerShell">Github - PowerShell</a></p></div></br><h4 id="2-テナント管理者のアカウントでデータ-ゲートウェイ-サービスに接続"><a href="#2-テナント管理者のアカウントでデータ-ゲートウェイ-サービスに接続" class="headerlink" title="2. テナント管理者のアカウントでデータ ゲートウェイ サービスに接続"></a>2. テナント管理者のアカウントでデータ ゲートウェイ サービスに接続</h4><p>ブラウザで認証画面が表示されますので、テナント管理者のアカウントで接続をお試しください。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-DataGatewayServiceAccount</span></span><br></pre></td></tr></table></figure></br><h4 id="3-テナントのゲートウェイインストールの制御状態を確認"><a href="#3-テナントのゲートウェイインストールの制御状態を確認" class="headerlink" title="3. テナントのゲートウェイインストールの制御状態を確認"></a>3. テナントのゲートウェイインストールの制御状態を確認</h4><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-DataGatewayTenantPolicy</span></span><br></pre></td></tr></table></figure><p>通常のオンプレミス データ ゲートウェイのみがインストール制御されている場合、<code>Policy</code> が <code>EnterpriseInstallRestricted</code> という状態である結果が得られます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#実行結果</span></span><br><span class="line">TenantObjectId                                            Policy</span><br><span class="line">--------------                                            ------</span><br><span class="line"><span class="number">12345678</span><span class="literal">-xxxx</span><span class="literal">-xxxx</span><span class="literal">-xxxx</span><span class="literal">-8ce9ff2d5099</span> EnterpriseInstallRestricted</span><br></pre></td></tr></table></figure></br><h4 id="4-個人用ゲートウェイのインストール制御を追加"><a href="#4-個人用ゲートウェイのインストール制御を追加" class="headerlink" title="4. 個人用ゲートウェイのインストール制御を追加"></a>4. 個人用ゲートウェイのインストール制御を追加</h4><p>ゲートウェイのインストールポリシーを設定する <code>Set-DataGatewayTenantPolicy</code> コマンドを実行します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-DataGatewayTenantPolicy</span> <span class="literal">-PersonalGatewayInstallPolicy</span> Restricted</span><br><span class="line"><span class="built_in">Get-DataGatewayTenantPolicy</span></span><br></pre></td></tr></table></figure><p><code>Policy</code> に <code>PersonalInstallRestricted</code> が追加され、個人用ゲートウェイのインストールも制御された状態となりました。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#実行結果</span></span><br><span class="line">TenantObjectId                                                                       Policy</span><br><span class="line">--------------                                                                       ------</span><br><span class="line"><span class="number">12345678</span><span class="literal">-xxxx</span><span class="literal">-xxxx</span><span class="literal">-xxxx</span><span class="literal">-8ce9ff2d5099</span> PersonalInstallRestricted, EnterpriseInstallRestricted</span><br></pre></td></tr></table></figure></br><p>実際に、個人用ゲートウェイをインストールしようとすると以下の画面のように、インストールが制限されている旨が表示されます。</p><div align="center"><img src="image8.png"></div></br><h4 id="5-ユーザーごとに制御"><a href="#5-ユーザーごとに制御" class="headerlink" title="5. ユーザーごとに制御"></a>5. ユーザーごとに制御</h4><p>一部のユーザーにのみインストールを許可させたい場合、続けて本手順も実施します。<br>まずは許可させたいユーザーの <code>ObjectId</code> を取得します。<br><code>ObjectId</code> は Azure Active Directry のユーザー情報から確認できる他、Az PowerShell モジュールの <code>Get-AzADUser</code> コマンドで取得することも可能です。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>Az PowerShell モジュールの詳細については以下公開情報をご覧ください。</p><p><a href="https://learn.microsoft.com/ja-jp/powershell/azure/install-az-ps">Azure Az PowerShell モジュールをインストールする</a></p></div></br><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-AzAccount</span></span><br><span class="line"><span class="variable">$user1</span> = <span class="variable">$</span>(<span class="built_in">Get-AzADUser</span> <span class="literal">-ObjectId</span> <span class="string">&quot;user1@contoso.onmicrosoft.com&quot;</span>).Id</span><br></pre></td></tr></table></figure></br><div align="center"><img src="image9.png"></div></br><p>取得した <code>ObjectId</code> を <code>Set-DataGatewayInstaller</code> コマンドでインストールを許可するユーザーとして追加します。<br>このとき <code>GatewayType</code> パラメーターを <code>Personal</code> とすることで、個人用ゲートウェイを対象にすることができます。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-DataGatewayInstaller</span> <span class="literal">-PrincipalObjectIds</span> <span class="variable">$user1</span> <span class="literal">-Operation</span> Add <span class="literal">-GatewayType</span> Personal</span><br><span class="line"><span class="built_in">Get-DatagatewayInstaller</span></span><br></pre></td></tr></table></figure><p>以下のように、<code>ObjectId</code> に対して <code>Personal</code> の <code>GatewayType</code> が付与されていれば、許可された状態となります。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#実行結果</span></span><br><span class="line">PrincipalObjectId                    GatewayType</span><br><span class="line">-----------------                    -----------</span><br><span class="line"><span class="number">12345678</span><span class="literal">-xxxx</span><span class="literal">-xxxx</span><span class="literal">-xxxx</span><span class="literal">-571d358d8e63</span> Personal</span><br></pre></td></tr></table></figure></br><blockquote><p>[参考情報]<br><a href="https://learn.microsoft.com/ja-jp/powershell/gateway/overview?view=datagateway-ps">オンプレミス データ ゲートウェイ管理用の PowerShell コマンドレット (パブリック プレビュー)</a></p></blockquote></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのファムです。&lt;/p&gt;
&lt;p&gt;本ブログでは、Power Platform管理センターから組織内のユーザーに対してオンプレミス データ ゲートウェイのインストールを制御する手順をご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Admin" scheme="https://jpbap-sqlbi.github.io/blog/tags/Admin/"/>
    
    <category term="オンプレミスデータゲートウェイ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4/"/>
    
  </entry>
  
  <entry>
    <title>Power BI のマップビジュアルで地名が正常に認識されない場合</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_map_areaname/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_map_areaname/</id>
    <published>2023-01-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.527Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チーム 丸山です。</p><p>Power BI のマップビジュアルは、地名ごとに集計された数値をマップ上に自動でバブル表示できるとても便利なビジュアルですが、データソースの地名の持ち方によっては地名が正常に認識されず、マップ上に結果が表示されないことがあります。<br>今回はこの問題が起きたときの原因と対応策についてご紹介します。</p><span id="more"></span><div align="center"><img src="image1.png"></div><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E3%83%9E%E3%83%83%E3%83%97%E3%83%93%E3%82%B8%E3%83%A5%E3%82%A2%E3%83%AB%E3%81%A7%E5%9C%B0%E5%90%8D%E3%81%8C%E6%AD%A3%E5%B8%B8%E3%81%AB%E8%AA%8D%E8%AD%98%E3%81%95%E3%82%8C%E3%81%AA%E3%81%84%E5%8E%9F%E5%9B%A0">マップビジュアルで地名が正常に認識されない原因</a></li><li><a href="#%E5%AF%BE%E5%BF%9C%E7%AD%96">対応策</a></li></ol><hr><h2 id="マップビジュアルで地名が正常に認識されない原因"><a href="#マップビジュアルで地名が正常に認識されない原因" class="headerlink" title="マップビジュアルで地名が正常に認識されない原因"></a>マップビジュアルで地名が正常に認識されない原因</h2><hr><p>Power BI のマップビジュアルは Bing Maps（ <a href="https://www.bing.com/maps/">https://www.bing.com/maps/</a> ）を使用しているため、Bing Maps上の地名に基づいてビジュアルが表示されます。このため、データソースの地名が Bing Maps 上の地名と相違する文字列である場合、マップビジュアルで認識することができず該当地域に集計結果が表示されません。</p><p>例えばアメリカは、Bing Maps 上では「アメリカ合衆国」ですが、データソース側で「アメリカ」という文字列でデータを持っている場合は、マップビジュアルのアメリカの欄に集計結果が表示されないという問題が起きます。つまり、Bing Maps 上の表記とデータソースの国名データ表記が一致していないことが原因となります。</p><div align="center"><img src="image1.png"></div><hr><h2 id="対応策"><a href="#対応策" class="headerlink" title="対応策"></a>対応策</h2><hr><p>対応策としては、データ側の地名を Bing Maps の表記に合わせるということになります。<br>上述 ”アメリカ” の例では、Bing Maps の表記 ”アメリカ合衆国” に合わせることで正常に地図に表示されます。</p><p>なお、地名の正式名称や定義などは時勢に応じて都度変わることから、一覧情報としてのご提供はご用意がないため、もしマップビジュアルで正しく認識されていない地名がある場合、Bing Maps（ <a href="https://www.bing.com/maps/">https://www.bing.com/maps/</a> ）で表記をチェックしてください。</p><div align="center"><img src="image2.png"></div> データ側の地名を変更する方法については、データソース自体で地名を変更する他に、データ取得の際に Power Query でデータ変換をすることも可能です。この方法であれば、データソースのデータはそのままであるため、業務影響や対応負荷は最小限にできる可能性があります。以下に具体的な手順をご案内いたします。<p>１．Power BI Desktop から Power Query エディターを開く</p><p>ホーム &gt; データの変換</p><div align="center"><img src="image3.png"></div><p>２．該当の列で右クリック &gt; 値の置換 &gt; 任意の地名を入力 &gt; OK</p><div align="center"><img src="image4.png"></div><p>３．データが置換されたことを確認</p><div align="center"><img src="image5.png"></div><p>４．Power Query エディターを閉じて適用する</p><div align="center"><img src="image6.png"></div><p>下記図のように、無事にマップビジュアルに「「アメリカ合衆国」でバブルの表示がされるようになりました。</p><div align="center"><img src="image7.png"></div><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://support.microsoft.com/ja-jp/office/%E5%80%A4%E3%81%AE%E7%BD%AE%E6%8F%9B-power-query-28256517-f1e9-4dc3-832f-45786e9cf721">値の置換 (Power Query) - Microsoft サポート</a></p></div><p>また補足ではございますが、よりマップビジュアルの精度を上げたいという場合は、<br>地名ではなく緯度経度の情報もご利用をご検討いただけますと幸いでございます。</p><div class="alert is-info"><p class="alert-title">Note</p><p>// 参考情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/visuals/power-bi-map-tips-and-tricks#in-power-bi-tips-to-get-better-results-when-using-map-visualizations">Power BI マップの視覚エフェクトに関するヒントとテクニック</a></p><p> <div align="center"></p><p> <img src="image8.png"></p><p> </div></p></div></br><blockquote><p><strong>本ブログの関連記事</strong></p><ul><li><a href="../pbi_map_visual/">Power BIのマップビジュアル</a></li></ul></blockquote></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チーム 丸山です。&lt;/p&gt;
&lt;p&gt;Power BI のマップビジュアルは、地名ごとに集計された数値をマップ上に自動でバブル表示できるとても便利なビジュアルですが、データソースの地名の持ち方によっては地名が正常に認識されず、マップ上に結果が表示されないことがあります。&lt;br&gt;今回はこの問題が起きたときの原因と対応策についてご紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
    <category term="マップビジュアル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%9E%E3%83%83%E3%83%97%E3%83%93%E3%82%B8%E3%83%A5%E3%82%A2%E3%83%AB/"/>
    
    <category term="地図" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E5%9C%B0%E5%9B%B3/"/>
    
    <category term="地理データ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E5%9C%B0%E7%90%86%E3%83%87%E3%83%BC%E3%82%BF/"/>
    
    <category term="Azure Map" scheme="https://jpbap-sqlbi.github.io/blog/tags/Azure-Map/"/>
    
    <category term="Bing Map" scheme="https://jpbap-sqlbi.github.io/blog/tags/Bing-Map/"/>
    
    <category term="ArcGIS Map" scheme="https://jpbap-sqlbi.github.io/blog/tags/ArcGIS-Map/"/>
    
  </entry>
  
  <entry>
    <title>Power BI のリアルタイム分析</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_realtime_analytics/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_realtime_analytics/</id>
    <published>2023-01-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.875Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山本です。<br>Power BI では、様々なタイプのデータセットを作成することができますが、その中でもデータを即時に集約・可視化することに特化したリアルタイム データセットという種類があります。</p><p>今回はリアルタイム データセットとはどのようなもので、どのように扱うことができるか、紹介していきます。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%81%A8%E3%81%AF">リアルタイム データセットとは</a></li><li><a href="#%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0-%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BB%E3%83%83%E3%83%88%E3%82%92%E4%BD%9C%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86">リアルタイム データセットを作ってみよう</a></li></ol><hr><h2 id="リアルタイム-データセットとは"><a href="#リアルタイム-データセットとは" class="headerlink" title="リアルタイム データセットとは"></a>リアルタイム データセットとは</h2><hr><p>リアルタイム データセットとは、Power BI サービスで作成できるデータセットの種類であり、データソースからプッシュされたデータを、ダッシュボードを通じてリアルタイムに表示することができるデータセットです。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>リアルタイム データセットは Power BI サービスでのみ作成でき、Power BI Desktop では作成できません。</p><p>またリアルタイム データセットは、マイワークスペースや共有ワークスペースどちらでも作成することができ、通常のデータセットと同じライセンスモデルでご利用いただけます。</p></div></br><p>リアルタイム データセットには「プッシュ データセット」、「ストリーミング データセット」、「PubNub ストリーミング データセット」の３つの種類区分があります。</p><ul><li>プッシュ データセット<br>リアルタイム データセットにおいて、データを保管するデータベースを保持するデータセットであり、過去のデータを履歴として蓄積することが可能です。</li><li>ストリーミング データセット<br>入力されたデータを保存できるデータベースが存在しませんが、データをデータベースに入力したりデータベースから読み取ったりする必要がないため、リアルタイムデータを素早く表示することに特化しています。</li><li>PubNub ストリーミング データセット<br>PubNub SDK を使用して、既存の PubNub データ ストリームからデータを読み込むことができるストリーミング データセットです。<br>PubNub データストリームに直接接続し、データを可視化するため、Power BI にデータは保存されません。</li></ul><p>さらにデータセットを作成する際に [履歴データの解析] を有効にすることで、プッシュ データセットとストリーミング データセット両方の機能を持つ プッシュ ストリーミング データセットを作成することが可能です。</p><div align="center"><img src="0.png"></div></br><ul><li>プッシュ ストリーミング データセット<br>これは、プッシュデータセットとしての履歴保持のメリットを持ちつつ、送信されるデータサイズが 15KB 以内の場合、ストリーミング データセットと同様にダッシュボードでのリアルタイム表示が可能という特徴があります。</li></ul><p>以下にそれぞれのデータセットの特徴をまとめました。</p></br><table><thead><tr><th></th><th>プッシュ データセット</th><th>ストリーミング データセット</th><th>プッシュ ストリーミング データセット</th><th>PubNub ストリーミング データセット</th></tr></thead><tbody><tr><td>データの保存性</td><td>保持</td><td>1時間の一時キャッシュ</td><td>保持</td><td>非保持 (PubNub から読み込み)</td></tr><tr><td>表示方法</td><td>レポート (ダッシュボードにピン止めも可)</td><td>ダッシュボードタイル (カスタム ストリーミング データとして接続)</td><td>レポート・ダッシュボードタイル (カスタム ストリーミング データとして接続)</td><td>ダッシュボードタイル (カスタム ストリーミング データとして接続)</td></tr><tr><td>表示速度</td><td>〇</td><td>◎</td><td>◎</td><td>◎</td></tr><tr><td>ダッシュボード タイルの更新</td><td>通常更新</td><td>リアルタイム更新</td><td>送信データサイズが 15KB 以内の場合、ダッシュボードのカスタム ストリーミング データとしてリアルタイム更新</td><td>リアルタイム更新</td></tr><tr><td>送信データサイズの上限</td><td>16MB/送信</td><td>15KB/送信</td><td>16MB/送信</td><td>PubNub 側に依存</td></tr><tr><td>スループットの上限</td><td>100万行/時間当たり</td><td>なし</td><td>なし(送信データサイズが 15KB を超過する場合、100万行/時間当たり)</td><td>PubNub 側に依存</td></tr></tbody></table><div class="alert is-success"><p class="alert-title">ヒント</p><p>プッシュ データセットやプッシュ ストリーミング データセットで、レポートのライブページをダッシュボードにピン止めする場合、リアルタイムにデータは反映されず、一定秒数待つかレポート側での更新を確認する必要があります。</p><p>リアルタイム表示が必要な場合、ビジュアル自体のピン止めをご検討ください。</p></div></br><hr><h2 id="リアルタイム-データセットを作ってみよう"><a href="#リアルタイム-データセットを作ってみよう" class="headerlink" title="リアルタイム データセットを作ってみよう"></a>リアルタイム データセットを作ってみよう</h2><hr><p>リアルタイム データセットは、その特性上、温度や湿度などの環境データや工場のセンサーデータなど、常に測定できるデータを収集し、可視化することに向いていますが、手動でのデータ追加や Power Automate を使用してデータを送信したりすることも可能です。</p><p>今回はストリーミング データセットを使用して、PowerShell から REST API を実行する形でデータ送信を検証してみます。</p><h3 id="PowerShell-を使用したデータ送信の検証"><a href="#PowerShell-を使用したデータ送信の検証" class="headerlink" title="PowerShell を使用したデータ送信の検証"></a>PowerShell を使用したデータ送信の検証</h3><ol><li>Power BI サービスのワークスペースにアクセスし、[+ 新規 &gt; ストリーミング データセット] をクリックします。</li></ol><div align="center"><img src="1.png"></div></br><div class="alert is-success"><p class="alert-title">ヒント</p><p>リアルタイム データセットの作成は、Power BI サービス (GUI) のほか、REST API を使用して CLI でも作成することが可能です。</p><p><a href="https://learn.microsoft.com/ja-jp/rest/api/power-bi/push-datasets/datasets-post-dataset-in-group">(参考) POST Push Datasets</a></p></div></br><ol start="2"><li>データのソースとして [API] をクリックし、[次へ] をクリックします。</li></ol><div align="center"><img src="2.png"></div></br><ol start="3"><li>データセット名を入力し、データを格納するカラム名・データ型を決めます。<br>データ型は「テキスト」型、「数値」型、「日時」型から選択できます。<br>またストリーミング データセットとして作成するため [履歴データの解析] は<code>オフ</code>のままにします。<br>最後に [作成] ボタンをクリックします。</li></ol><div align="center"><img src="3.png"></div></br><ol start="4"><li>ストリーミング データセットが作成されました。<br>続けて、実際にデータを格納してみます。<br>[PowerShell] タブをクリックし、表示されているスクリプトをコピーしておきます。</li></ol><div align="center"><img src="4.png"></div></br><div class="alert is-warning"><p class="alert-title">警告</p><p>この方法で取得した URL または endpoint には、データセットの送信要求が自動的に承認される rowkey が付与されており、Azure AD 認証なしでデータの送信が可能となります。運用データをご利用いただく場合、URL や rowkey の取り扱いにはご注意ください。</p></div></br><ol start="5"><li>データを表示するためのダッシュボードを作成します。<br>ワークスペースの [+新規 &gt; ダッシュボード] をクリックし、ダッシュボード名を入力します。</li></ol><div align="center"><img src="5.png"></div></br><ol start="6"><li>[編集 &gt; タイルの追加] をクリックし、リアルタイムデータの [カスタム ストリーミング データ] をクリックし、[次へ] をクリックします。</li></ol><div align="center"><img src="6.png"></div></br><ol start="7"><li>先ほど作成したデータセットを選択し、[次へ] をクリックします。</li></ol><div align="center"><img src="7.png"></div></br><ol start="8"><li>視覚化デザインでは、表示するビジュアルの種類を選ぶことができ、また表示する列や値を選ぶことが可能です。<br>ここでは、視覚化タイプは [カード] のまま、フィールドの [+ 値の追加] をクリックし、[Score] を選択します。</li></ol><div align="center"><img src="8.png"></div></br><ol start="9"><li>タイルの詳細では、タイトルやサブタイトルなどの設定が可能です。<br>ここでは特に変更せず [適用] をクリックします。</li></ol><div align="center"><img src="9.png"></div></br><ol start="10"><li>ダッシュボード上に score のカードビジュアル タイルが表示されました。</li></ol><div align="center"><img src="10.png"></div></br><ol start="11"><li>実際にストリーミング データセットにデータを追加します。<br>コピーしたスクリプトを PowerShell で実行します。<br>ダッシュボードを開いた画面と比べてみると、実行されたデータがすぐ反映されることが確認できます。<br>(ストリーミング データを表すカスタム ストリーミング データによるタイルの場合、稲妻マークがタイトルの横に表示されます。)</li></ol><div align="center"><img src="11.png"></div></br><div class="alert is-success"><p class="alert-title">ヒント</p><p>PowerShell や API の実行が 401 (Unauthorized) エラーとなる場合、テナントでリソース キー認証がブロックされている可能性があります。</p><p>Power BI 管理者から <code>テナント設定</code> にアクセスし、<code>リソース キー認証のブロック</code> が有効化されていないかご確認ください。</p><p><a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-portal-developer#block-resourcekey-authentication">リソース キー認証のブロックについて</a></p></div></br><blockquote><p>[参考情報]<br><a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-real-time-streaming">Power BI のリアルタイム ストリーミング</a></p></blockquote><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山本です。&lt;br&gt;Power BI では、様々なタイプのデータセットを作成することができますが、その中でもデータを即時に集約・可視化することに特化したリアルタイム データセットという種類があります。&lt;/p&gt;
&lt;p&gt;今回はリアルタイム データセットとはどのようなもので、どのように扱うことができるか、紹介していきます。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="リアルタイム" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%BF%E3%82%A4%E3%83%A0/"/>
    
    <category term="ストリーミング" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%B9%E3%83%88%E3%83%AA%E3%83%BC%E3%83%9F%E3%83%B3%E3%82%B0/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Service へのアクセス制御③ 秘密度ラベル</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_sensitivity-label/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_sensitivity-label/</id>
    <published>2023-01-30T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.887Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>セキュリティの観点から、Power BI Service へのアクセスを制限したいというお問い合わせをいただくことがあります。「<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_conditional-access/">条件付きアクセス</a>」、｢<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_privatelink/">Azure Private Link</a>｣と説明してきましたが、今回は  ｢秘密度ラベル｣ について説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><ul><li><a href="#%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB-%E3%81%A8%E3%81%AF">秘密度ラベル とは</a></li><li><a href="#%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%81%AE%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86">秘密度ラベル の設定手順</a><ul><li><a href="#1-%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%8B%E3%82%89%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">1.テナント設定から秘密度ラベルを有効化する</a></li><li><a href="#2-%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%82%92%E9%81%A9%E7%94%A8%E3%81%99%E3%82%8B">2.秘密度ラベルを適用する</a></li><li><a href="#3-%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B">3.秘密度ラベルを追加する</a></li><li><a href="#4-%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E8%A8%AD%E5%AE%9A">4.秘密度ラベルに関する設定</a></li></ul></li><li><a href="#%E3%83%87%E3%83%BC%E3%82%BF%E4%BF%9D%E8%AD%B7%E3%83%A1%E3%83%88%E3%83%AA%E3%83%83%E3%82%AF-%E3%83%AC%E3%83%9D%E3%83%BC%E3%83%88">データ保護メトリック レポート</a></li></ul><h2 id="秘密度ラベル-とは"><a href="#秘密度ラベル-とは" class="headerlink" title="秘密度ラベル とは"></a>秘密度ラベル とは</h2><p>Power BI の秘密度ラベルは、データのセキュリティとアクセス制御を管理するための機能です。これにより、特定のデータセットやレポートにアクセスできるユーザーを制限することができます。例えば、特定のレポートファイル (.pbixファイル) に「機密」というラベルを設定し、それに対してアクセス権を持つのは特定のグループのみに限定することができます。秘密度ラベルはPower BI Desktopでご利用いただける機能です。Power BI Serviceでは秘密度ラベルを設定している場合であってもコンテンツへのアクセスには影響しません。Power BI Serviceでのアクセス制御にはワークスペースやレポート単位のアクセス許可を設定する必要があります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考＃<a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-sensitivity-label-overview">Power BI での Microsoft Purview Information Protection の秘密度ラベル - Power BI | Microsoft Learn</a>  </p></div><div align="center"><img src="sensitivity12.png"></div>  <p>秘密度ラベルはPower BIのコンテンツのみではなく、Power BIからエクスポートしたExcel、Power Point、PDFファイルでも適用されるため、機密データはどこであっても保護することができます。</p><div class="alert is-warning"><p class="alert-title">警告</p><p>画像ファイルやcsvには秘密度ラベルを適用することができませんのでご注意ください。  </p></div><div align="center"><img src="sensitivity13.png"></div>  <h2 id="秘密度ラベルの設定手順"><a href="#秘密度ラベルの設定手順" class="headerlink" title="秘密度ラベルの設定手順"></a>秘密度ラベルの設定手順</h2><p>Power BI で秘密度ラベルを利用するためには、以下の設定を行います。</p><p><a href="#1-%E3%83%86%E3%83%8A%E3%83%B3%E3%83%88%E8%A8%AD%E5%AE%9A%E3%81%8B%E3%82%89%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%82%92%E6%9C%89%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B">1.テナント設定から秘密度ラベルを有効化する</a><br><a href="#2-%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%82%92%E9%81%A9%E7%94%A8%E3%81%99%E3%82%8B">2.秘密度ラベルを適用する</a><br><a href="#3-%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B">3.秘密度ラベルを追加する</a><br><a href="#4-%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E8%A8%AD%E5%AE%9A">4.秘密度ラベルに関する設定</a></p><p>それぞれの詳細な手順について、以下に説明します。なお、秘密度ラベルの適用には以下のライセンスが必要となります。</p><ul><li>Azure Information Protection Premium P1 または Premium P2 ライセンス</li><li>Power BI Pro または Premium Per Userライセンス<div class="alert is-info"><p class="alert-title">Note</p><p>参考＃<a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-enable-data-sensitivity-labels">Power BI で秘密度ラベルを有効にする - Power BI | Microsoft Learn</a></p></div></li></ul><h3 id="1-テナント設定から秘密度ラベルを有効化する"><a href="#1-テナント設定から秘密度ラベルを有効化する" class="headerlink" title="1.テナント設定から秘密度ラベルを有効化する"></a>1.テナント設定から秘密度ラベルを有効化する</h3><p>テナントで秘密度ラベルを有効化するには、管理ポータルにアクセスし、 <strong>[テナント設定]</strong> &gt; <strong>[情報の保護]</strong> &gt; <strong>[ユーザーによるコンテンツへの秘密度ラベルの適用を許可]</strong> を有効化します。  </p><div align="center"><img src="sensitivity01.png"></div>  <h3 id="2-秘密度ラベルを適用する"><a href="#2-秘密度ラベルを適用する" class="headerlink" title="2.秘密度ラベルを適用する"></a>2.秘密度ラベルを適用する</h3><p> <strong>[ユーザーによるコンテンツへの秘密度ラベルの適用を許可]</strong> が有効化されている場合、Power BI Desktop/Service で秘密度ラベルの設定が可能となります。それぞれの設定手順について説明します。</p><h4 id="Power-BI-Desktopで秘密度ラベルを適用する"><a href="#Power-BI-Desktopで秘密度ラベルを適用する" class="headerlink" title="Power BI Desktopで秘密度ラベルを適用する"></a>Power BI Desktopで秘密度ラベルを適用する</h4><p>Power BI Desktopを開き、 <strong>[ホーム]</strong> &gt; <strong>[秘密度]</strong> を選択します。  </p><div align="center"><img src="sensitivity02.png"></div>  <p>設定可能な秘密度ラベルの一覧が表示されるので、設定したい秘密度ラベルを選択します。  </p><div align="center"><img src="sensitivity03.png"></div>  <p>秘密度ラベルが設定されている場合、左下に表示されます。以下の例では、”Highly Confidential\All Employees”が設定されています。  </p><div align="center"><img src="sensitivity04.png"></div>  <h4 id="Power-BI-Serviceで秘密度ラベルを適用する"><a href="#Power-BI-Serviceで秘密度ラベルを適用する" class="headerlink" title="Power BI Serviceで秘密度ラベルを適用する"></a>Power BI Serviceで秘密度ラベルを適用する</h4><p>レポート、ダッシュボードに秘密度ラベルを適用する場合、 <strong>[その他のオプション]</strong> `&gt; <strong>[設定]</strong> を選択します。  </p><div align="center"><img src="sensitivity05.png"></div>  <p><strong>[秘密度ラベル]</strong> を選択し、保存します。  </p><div align="center"><img src="sensitivity06.png"></div>  <p>データセット、データフローに秘密度ラベルを適用する場合、 <strong>[その他のオプション]</strong> `&gt; <strong>[設定]</strong> を選択します。  </p><div align="center"><img src="sensitivity07.png"></div>  <p><strong>[秘密度ラベル]</strong> を選択し、保存します。  </p><div align="center"><img src="sensitivity08.png"></div>  <p>設定されている秘密度ラベルはワークスペースから確認できるほか、  </p><div align="center"><img src="sensitivity09.png"></div>  <p>レポートやダッシュボードの上部でも確認することができます。  </p><div align="center"><img src="sensitivity10.png"></div>  <h3 id="3-秘密度ラベルを追加する"><a href="#3-秘密度ラベルを追加する" class="headerlink" title="3.秘密度ラベルを追加する"></a>3.秘密度ラベルを追加する</h3><p>秘密度ラベルは標準で用意されているものもありますが、管理者が設定することも可能です。手順について説明します。なお、設定にはPower BIとは異なるライセンスが必要となりますのでご注意ください。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/microsoft-365/compliance/get-started-with-sensitivity-labels?view=o365-worldwide">秘密度ラベルの概要 - Microsoft Purview (compliance) | Microsoft Learn</a></p><p>参考# <a href="https://learn.microsoft.com/ja-jp/microsoft-365/compliance/encryption-sensitivity-labels?view=o365-worldwide">秘密度ラベルを使用して暗号化を適用する - Microsoft Purview (compliance) | Microsoft Learn</a></p></div><p><a href="https://aka.ms/dpfwl15">Microsoft Purview コンプライアンス ポータル</a>にアクセスし、 <strong>[+ ラベルの作成]</strong> を選択します。  </p><div align="center"><img src="sensitivity11.png"></div>  <p>名前、表示名、説明を入力し、 <strong>[次へ]</strong> を選択します。  </p><div align="center"><img src="sensitivity14.png"></div>  <p><strong>[アイテム]</strong> にチェックし、 <strong>[次へ]</strong> を選択します。  </p><div align="center"><img src="sensitivity15.png"></div>  <p><strong>[項目の暗号化]</strong> にチェックし、 <strong>[次へ]</strong> を選択します。  </p><div align="center"><img src="sensitivity16.png"></div>  <p>暗号化の設定をします。 <strong>[特定のユーザーとグループにアクセス許可を付与する]</strong> により設定したユーザーまたはグループが、このラベルの設定されたコンテンツを操作することができます。一般的にはユーザーではなくグループを利用をすることで構成が簡単になるため推奨されます。</p><p>この際に設定する <strong>[アクセス許可の選択]</strong> は、<a href="https://learn.microsoft.com/ja-jp/azure/information-protection/configure-usage-rights#usage-rights-and-descriptions">使用権限と説明</a>をご確認ください。</p><p>テナント設定と秘密度ラベルでは、制限の厳しいものが適用されます。例えば、テナント設定でデータのエクスポートを有効にしている場合でも、秘密度ラベルでエクスポートが無効になっている場合、ユーザーはエクスポートをすることができません。  </p><div align="center"><img src="sensitivity17.png"></div>  <p><strong>[ファイルとメールの自動ラベル付け]</strong> の設定をしたら、 <strong>[次へ]</strong> を選択します。  </p><div align="center"><img src="sensitivity18.png"></div>  <p><strong>[グループとサイトの保護設定を定義]</strong> の設定をしたら、 <strong>[次へ]</strong> を選択します。  </p><div align="center"><img src="sensitivity19.png"></div>  <p><strong>[スキーマ化されたデータ アセットの自動ラベル付け]</strong> の設定をしたら、 <strong>[次へ]</strong> を選択します。  </p><div align="center"><img src="sensitivity20.png"></div>  <p>設定を確認したら、 <strong>[ラベルを作成]</strong> を選択します。  </p><div align="center"><img src="sensitivity21.png"></div>  <p>秘密度ラベルが作成されたことを確認し、 <strong>[完了]</strong> を選択します。秘密度ラベルの反映は、すぐに行われず10分~最大24時間ほどかかる場合があります。  </p><div align="center"><img src="sensitivity22.png"></div>  <h3 id="4-秘密度ラベルに関する設定"><a href="#4-秘密度ラベルに関する設定" class="headerlink" title="4.秘密度ラベルに関する設定"></a>4.秘密度ラベルに関する設定</h3><p>管理ポータルから設定できる、秘密度ラベルに関する設定について説明します。</p><ul><li><p>データ ソースから秘密度ラベルを Power BI のそのデータに適用する(プレビュー)<br>データ ソースで秘密度ラベルが設定されている場合、その秘密度ラベルを継承してPower BI データセットに設定することができる機能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-sensitivity-label-inheritance-from-data-sources">Power BI でのデータ ソースからの秘密度ラベルの継承 - Power BI | Microsoft Learn</a>  </p></div><div align="center"><img src="sensitivity23.png"></div>  </li><li><p>ダウンストリーム コンテンツに秘密度ラベルを自動的に適用する<br>秘密度ラベルが適用されたデータセットから作成される他のデータセット、レポート、ダッシュボードや、秘密度ラベルが適用されたレポートから作成されたダッシュボードに、作成元の秘密度ラベルを適用することができる機能です。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-sensitivity-label-downstream-inheritance">Power BI での秘密度ラベルの下流への継承 - Power BI | Microsoft Learn</a>  </p></div><div align="center"><img src="sensitivity24.png"></div>  </li><li><p>ワークスペース管理者が自動的に適用された秘密度ラベルをオーバーライドすることを許可する(プレビュー)<br>自動的に秘密度ラベルが適用された場合、コンテンツに対する秘密度ラベル発行者のユーザーがいなくなる場合があり、その場合ラベルの変更や削除ができるユーザーがいなくなることがあります。この設定はそのような状況を回避するための機能であり、ワークスペース管理者が秘密度ラベルをオーバーライドできるようになります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-sensitivity-label-change-enforcement#relaxations-to-accommodate-automatic-labeling-scenarios">自動ラベル付けのシナリオに対応するための緩和策</a>  </p></div><div align="center"><img src="sensitivity25.png"></div>  </li><li><p>保護されたラベルを持つコンテンツが、組織内の全ユーザーとリンクを介して共有されないように制御する<br>この設定が有効な場合、秘密度ラベルに”保護”が設定されているコンテンツに対して組織内のユーザーとの共有リンクが生成できなくなります。</p><div class="alert is-info"><p class="alert-title">Note</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/power-bi/admin/service-admin-portal-information-protection#restrict-content-with-protected-labels-from-being-shared-via-link-with-everyone-in-your-organization">保護されたラベルが付けられたコンテンツがリンクを介して組織内のすべてのユーザーと共有されないように制限する</a>  </p></div><div align="center"><img src="sensitivity26.png"></div>  </li></ul><h2 id="データ保護メトリック-レポート"><a href="#データ保護メトリック-レポート" class="headerlink" title="データ保護メトリック レポート"></a>データ保護メトリック レポート</h2><p>Power BI管理者は、テナント内で利用されている秘密度ラベルを監視したり追跡することができます。このデータ保護メトリック レポートは、管理ポータル内の <strong>[保護メトリック]</strong> から確認することができます。  </p><div align="center"><img src="sensitivity27.png"></div>  <p>秘密度ラベルを設定いただくことで、よりセキュアにPower BIをご利用いただけます。</p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;セキュリティの観点から、Power BI Service へのアクセスを制限したいというお問い合わせをいただくことがあります。「&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_conditional-access/&quot;&gt;条件付きアクセス&lt;/a&gt;」、｢&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_privatelink/&quot;&gt;Azure Private Link&lt;/a&gt;｣と説明してきましたが、今回は  ｢秘密度ラベル｣ について説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="アクセス制御" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E5%88%B6%E5%BE%A1/"/>
    
    <category term="秘密度ラベル" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E7%A7%98%E5%AF%86%E5%BA%A6%E3%83%A9%E3%83%99%E3%83%AB/"/>
    
  </entry>
  
  <entry>
    <title>Power BI を学習するために役に立つコンテンツのご紹介</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_useful_learning_link/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_useful_learning_link/</id>
    <published>2022-12-29T06:00:00.000Z</published>
    <updated>2023-04-12T04:01:10.035Z</updated>
    
    <content type="html"><![CDATA[</br><p>こんにちは、 Power BI サポート チームのチャンです。<br>本ブログをご覧になっている皆さま、及びお問い合わせいただくお客さまから、 Power BI を学習するための資料に関する情報がまとまっていてほしいという声が寄せられています。<br>今回は Power BI を勉強されている皆さまにお役に立つコンテンツをご紹介したいと思います。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>こちらの投稿でご紹介する記事の一部は、マイクロソフトが提供する公式情報を十分に読み解いて頂いた有識者の方々にてご厚意で公開頂いており、今回ご紹介させて頂いております。公式の情報についてはマイクロソフトが公開する最新の情報をご参照頂くようお願いします。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#1-Power-BI-%E3%81%AE%E5%85%AC%E5%BC%8F%E3%83%88%E3%83%AC%E3%83%BC%E3%83%8B%E3%83%B3%E3%82%B0">Power BI の公式トレーニング</a></li><li><a href="#2-Power-BI-%E3%81%AE%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88">Power BI のドキュメント</a></li><li><a href="#2-Power-BI-%E6%9C%89%E8%AD%98%E8%80%85%E3%81%AE%E3%82%BB%E3%83%9F%E3%83%8A%E3%83%BC%E3%83%BB%E3%83%96%E3%83%AD%E3%82%B0%E3%83%BB%E3%82%B5%E3%82%A4%E3%83%88">Power BI 有識者のセミナー・ブログ・サイト</a></br></li></ol><hr><h2 id="1-Power-BI-の公式トレーニング"><a href="#1-Power-BI-の公式トレーニング" class="headerlink" title="1. Power BI の公式トレーニング"></a>1. Power BI の公式トレーニング</h2><hr><p>マイクロソフトでは、Power BIを無料で学習いただくためのトレーニング資料を用意しております。<br>導入前の概要として知っておくべき内容や、他製品との比較、初心者から中級者の学習材料まで提供しておりますので、<br>ぜひ一度下記のリンクより皆さまにとって有用なトレーニングを見つけてください。</p><h4 id="■-一覧"><a href="#■-一覧" class="headerlink" title="■ 一覧"></a>■ 一覧</h4><p> <a href="https://learn.microsoft.com/ja-jp/training/browse/?terms=power%20bi">Power BIのすべてのラーニングパスとモジュール</a></p><h4 id="■-導入前・初級者"><a href="#■-導入前・初級者" class="headerlink" title="■ 導入前・初級者"></a>■ 導入前・初級者</h4><ul><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/get-started-power-bi/">Power BI の概要</a><br>Power BI の概要を簡潔にまとめた資料です。初心者や、導入をご検討されている方もぜひご覧ください。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/consume-data-with-power-bi/">Power BI でデータを使用する</a><br>初心者やビジネスユーザー向けに、Power BIの利用方法を紹介されています。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/create-use-analytics-reports-power-bi/">Power BI で分析レポートを作成して使用する</a><br>Power BI でデータを取得からレポート作成、共有するところまでという一連の流れを一通りまとめて学習できる資料です。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/get-transform-data-power-bi/">Power BI を使ってデータを取得および変換する</a><br>Power BI でデータを取得し加工する方法が詳細に案内されています。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/distribute-power-bi-insights/">Power BI の分析情報を配布する</a><br>作成したレポートを共有・配布することに焦点を当てた資料です。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/introduction-power-bi-administration/">Power BI 管理の概要</a><br>Power BI 管理者向けに、Power BIの概要と管理するための機能などが紹介されています。</p></li></ul><h4 id="■-他製品との比較"><a href="#■-他製品との比較" class="headerlink" title="■ 他製品との比較"></a>■ 他製品との比較</h4><p>Power BI と Tableau という2大 BI ツールとの比較が、詳細に記載されています。<br>両者のどちらか導入を迷っている・検討されている方や、元々 Tableau ユーザーでこれから Power BI を学習する方はぜひご活用ください。</p><ul><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-intro/">Tableau ユーザー向けの Power BI の概要</a></li><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-data-connectivity/">Tableau ユーザー向けの Power BI にデータを接続する</a></li><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-calculations/">Tableau ユーザーのための Power BI の計算を作成する</a></li><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-visuals/">Tableau ユーザー用に Power BI ビジュアルを作成する</a></li><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-analytics/">Tableau ユーザー向けの Power BI での分析の実行</a></li><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-organize-fields/">Tableau ユーザー向けに Power BI フィールドを整理して簡素化する</a></li><li><a href="https://learn.microsoft.com/ja-jp/training/modules/power-bi-tableau-optimize-performance/">Tableau ユーザー向けの Power BI パフォーマンスを最適化する</a></li></ul><h4 id="■-中・上級者向け"><a href="#■-中・上級者向け" class="headerlink" title="■ 中・上級者向け"></a>■ 中・上級者向け</h4><ul><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/dax-power-bi/">Power BI Desktop で DAX を使用する</a><br>DAXを勉強する皆さまにぜひ熟読いただきたい概要から実例まで含まれているチュートリアルとなります。<br>例えば、よく混乱を起こす計算列とメジャーの比較、SUMとSUMXの集計、CALCULATEを使用したフィルターコンテキスト、タイムインテリジェンス関数の詳細まで紹介されています。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/visualize-data-power-bi/">Power BI でデータを視覚化する</a><br>レポートの閲覧者に分析結果やインサイトを伝えるための視覚化するバリエーションや関連の有用な機能がたくさんご紹介されています。レポート、ダッシュボード、ページ分割されたレポートそれぞれについて勉強されたい方でもぜひご確認ください。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/perform-analytics-power-bi/">Power BI でのデータ分析</a><br>Power BI に実装された統計機能や、各アルゴリズムやAI分析機能の概要がまとまっているコンテンツです。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/power-bi-effective/">Power BI のデザイン効果の高いレポート</a><br>より伝わりやすいレポートや、閲覧者のユーザーエクスペリエンスを強化したレポートを作成するためのTipsがたっぷり載っております。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/implement-advanced-data-visualization-techniques/">Power BI を使用して高度なデータの可視化手法を実装する</a><br>通常のPower BIビジュアルより、中級や上級向けに、レポートのブラッシュアップのTipsやデータの可視化方法が記載されています。リアルタイムのデータを扱うための手順も含まれています。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/prepare-data-for-tabular-models-power-bi/">Power BI で表形式モデルのデータを準備する</a><br>データモデルに注目したトレーニング内容となっております。インポート？Direct Query？データセット？データフロー？などを悩まれている方がいらっしゃれば、ぜひご一読ください。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/administer-power-bi-part-1/">Power BI の管理、パート 1 - テナント、ガバナンス、コラボレーション</a><br>Power BI管理者の役割や、ユーザー利用の活性化、監査など、実施すべきことなどより詳しく紹介されたコンテンツです。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/training/paths/manage-workspaces-datasets-power-bi/">Power BI でワークスペースとデータセットを管理する</a><br>Power BIサービスのワークスペースでできること、データセットを使ったより高度な機能、RLS（行レベルセキュリティ）についてすべて網羅されています。</p></li></ul><hr><h2 id="2-Power-BI-のドキュメント"><a href="#2-Power-BI-のドキュメント" class="headerlink" title="2. Power BI のドキュメント"></a>2. Power BI のドキュメント</h2><hr><p>Power BIのドキュメントでは、機能説明以外にも、活用する様々な立場のユーザー向けに、情報をまとめておりますので、一部をご紹介いたします。</p><ul><li><p><a href="https://learn.microsoft.com/ja-JP/power-bi/fundamentals/">Power BI 入門</a><br>Power BI とは？という疑問点をお持ちの方へ、 Power BI の概要をシンプルに紹介している入門編のドキュメントです。</p></li><li><p><a href="https://learn.microsoft.com/ja-JP/power-bi/consumer/">Power BI ビジネスユーザー向けの紹介</a><br>レポートの開発者や作成者ではなく、ビジネスユーザー＝閲覧者の目線にて、 Power BI の有用な機能を網羅している初級者用のドキュメントです。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/power-bi/guidance/power-bi-optimization">Power BI ベストプラクティスのガイダンス</a><br>Power BIを活用する上で、より Power BI を効果的にご利用いただくために、具体的な実装方法や重要な概念などの技術的な内容から、社内への導入ロードマップ、広め方、実装計画などの技術的な部分以外の考え方まで、すべてのベストプラクティスがたっぷり詳細に記載されているこちらのドキュメントは必読です。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/power-bi/learning-catalog/">Power BI ラーニング カタログ</a><br>Power BI を学習するために、様々な立場の方（ビジネスユーザー、レポート作成者、データアナリスト、開発者、管理者、コンサルタントなど）へ向けに、おすすめのラーニングコンテンツが体系的に紹介されています。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/power-bi/troubleshoot/">Power BI のサポートとトラブルシューティング</a><br>Power BI を利用いただいている際に、問題が発生した場合のトラブルシューティング情報及びサポートサービスをご利用いただく上での注意事項が案内されています。</p></li><li><p><a href="https://learn.microsoft.com/ja-jp/power-bi/create-reports/sample-datasets">Power BI のサンプルを入手する</a><br>実際にPower BI Desktopにてレポートを作成する際は、上記の公開情報にて 色々な利用者の立場を想定したサンプルファイルを提供しております。ぜひご活用いただけますと幸いです。 </p></li></ul><hr><h2 id="3-Power-BI-有識者のセミナー・ブログ・サイト"><a href="#3-Power-BI-有識者のセミナー・ブログ・サイト" class="headerlink" title="3. Power BI 有識者のセミナー・ブログ・サイト"></a>3. Power BI 有識者のセミナー・ブログ・サイト</h2><hr><ul><li><p><a href="https://powerbi.connpass.com/">Power BI 勉強会 - connpass</a><br>Power BI MVPの方が主体となって定期的に開催されている勉強会となります。<br>勉強会の中では、PBIJP DAX Boot campなども開催されております。 </p></li><li><p><a href="https://marshal115.hatenablog.com/">テクテク日記 (hatenablog.com)</a><br>弊社社員のブログですが、導入のお話から、中上級のユーザー向けにPower BIに関する役立つ技術情報を様々な範囲に渡って発信しております。 </p></li><li><p><a href="https://blog.crossjoin.co.uk/">CHRIS WEBB’S BI BLOG</a><br>長年 BI 製品に携わってきた弊社社員のブログです。英語コンテンツですが、Power BI 内部のアーキテクチャである Analysis Services や DAX, Power Query などについて、より深い情報や洞察を発信しています。</p></li></ul><ul><li><p><a href="https://www.youtube.com/channel/UCFp1vaKzpfvoGai0vE5VJ0w">Guy in a Cube - Youtube</a><br>弊社ベテラン社員の Adam と Patrickがいつも Power BI の幅広い機能や技術のことをわかりやすく解説している YouTube チャネルです。今までご紹介するコンテンツの中と違って、英語教材となりますが、日本語字幕による翻訳も可能ですし、とても有益な情報がたくさん含まれているので、Power BIを勉強する上で、欠かせない大事な教材です。</p></li><li><p><a href="https://www.sqlbi.com/">SQLBI</a><br>こちらも英語のコンテンツですが、Power BIをはじめ、核心となる技術であるAnalysis Servicesに対して長年の経験をお持ちのMicrosoft MVPの方を中心に、特にDAXに関する詳細な説明の記事やビデオがたくさん公開されており、Power BIやAnalysis Servicesを開発する上で有益な情報が共有されています。</p></li></ul><hr><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;/br&gt;

&lt;p&gt;こんにちは、 Power BI サポート チームのチャンです。&lt;br&gt;本ブログをご覧になっている皆さま、及びお問い合わせいただくお客さまから、 Power BI を学習するための資料に関する情報がまとまっていてほしいという声が寄せられています。&lt;br&gt;今回は Power BI を勉強されている皆さまにお役に立つコンテンツをご紹介したいと思います。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="学習" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E5%AD%A6%E7%BF%92/"/>
    
    <category term="自習" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%87%AA%E7%BF%92/"/>
    
    <category term="Learning" scheme="https://jpbap-sqlbi.github.io/blog/tags/Learning/"/>
    
    <category term="勉強" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E5%8B%89%E5%BC%B7/"/>
    
  </entry>
  
  <entry>
    <title>Power BI 試用版（無料体験）を無効化する方法</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_disable_trial_version/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_disable_trial_version/</id>
    <published>2022-12-28T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.431Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームのファムです。</p><p>Power BI試用版（無料体験）（以下「試用版」と表現します）をご利用されたことがありますか。有料版の機能をご利用いただくことはもちろん、ワークスペースのレポートを共有・閲覧もできます。ただ、セキュリティの観点で、ユーザーにレポートの共有・閲覧を制限したいため、試用版を無効化したいというお問合せが Power BI 管理者様よりたくさん寄せられます。</p><p>本ブログでは、試用版を無効化する方法、および試用版に関する疑問点をQ&amp;A形式で紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></br></p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#Power-BI-%E8%A9%A6%E7%94%A8%E7%89%88%EF%BC%88%E7%84%A1%E6%96%99%E4%BD%93%E9%A8%93%EF%BC%89%E3%81%A8%E3%81%AF">Power BI 試用版（無料体験）とは</a></li><li><a href="#Power-BI-%E8%A9%A6%E7%94%A8%E7%89%88%EF%BC%88%E7%84%A1%E6%96%99%E4%BD%93%E9%A8%93%EF%BC%89%E3%82%92%E7%84%A1%E5%8A%B9%E5%8C%96%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95">Power BI 試用版（無料体験）を無効化する方法</a></li><li><a href="#%E6%B3%A8%E6%84%8F%E3%83%BB%E5%88%B6%E7%B4%84%E4%BA%8B%E9%A0%85">注意・制約事項</a></li><li><a href="#%E3%81%9D%E3%81%AE%E4%BB%96Q&A">その他Q＆A</a></br></li></ol><hr><h2 id="Power-BI-試用版（無料体験）とは"><a href="#Power-BI-試用版（無料体験）とは" class="headerlink" title="Power BI 試用版（無料体験）とは"></a>Power BI 試用版（無料体験）とは</h2><hr><p>現在、60日間限定で提供される有償ライセンスの無料体験中は、元のライセンスが無償（Free）、Proライセンスいずれであっても、最上位のユーザーライセンスとなるPPU（Premium Per User）にアップグレードされます。</p><p>PPUライセンスには、Proで提供される機能がすべて含まれております。各ライセンスの機能比較の詳細につきましては、以下ブログご参照ください。</p><p>参考情報：</p><ul><li><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E9%96%B2%E8%A6%A7%E5%8F%AF%E5%90%A6">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）― ライセンス組み合わせのコンテンツ閲覧可否</a></li><li><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-signing-up-for-power-bi-with-a-new-office-365-trial">新しい Microsoft 365 試用版で Power BI にサインアップする</a></li></ul><hr><h2 id="Power-BI-試用版（無料体験）を無効化する方法"><a href="#Power-BI-試用版（無料体験）を無効化する方法" class="headerlink" title="Power BI 試用版（無料体験）を無効化する方法"></a>Power BI 試用版（無料体験）を無効化する方法</h2><hr><p>Power BI 管理者はPower BI サービスにサインインし、管理ポータルから、「ユーザーが Power BI 有料機能を試せるようにする」を無効化に設定することで、ユーザーの画面にPower BI の無料体験ポップアップの案内が表示されなくなります。よって、ユーザー自身で、Power BI FreeライセンスまたはProライセンスから試用版を開始できないようになります。<br>試用版を無効化する対象は、組織全体か、一部のユーザーか、制御することが可能です。以下の３通りでご設定いただけます。</p><ol><li>   組織全体に試用版を無効化</li><li>   一部のユーザーに試用版を有効化し、他のユーザーに無効化</li><li>   一部のユーザーに試用版を無効化し、他のユーザーに有効化</li></ol><p>それぞれの手順について、下記をご確認ください。</p><h3 id="1-組織全体に試用版を無効化"><a href="#1-組織全体に試用版を無効化" class="headerlink" title="1.    組織全体に試用版を無効化"></a>1.    組織全体に試用版を無効化</h3><p>Power BI管理ポータル ＞ ヘルプとサポートの設定　＞　ユーザーがPower BI有料機能を試せるようにする　＞　無効を選択　＞　適用を押下してください。</p></br><div align="center"><img src="pic1.png"></div><p>上記の設定後、ユーザーの画面ではPower BI試用版のポップアップが以下のイメージの通り、表示されなくなります。<br></br></p><div align="center"><img src="pic2.png"></div><h3 id="2-一部のユーザーに試用版を有効化し、他のユーザーに無効化"><a href="#2-一部のユーザーに試用版を有効化し、他のユーザーに無効化" class="headerlink" title="2.    一部のユーザーに試用版を有効化し、他のユーザーに無効化"></a>2.    一部のユーザーに試用版を有効化し、他のユーザーに無効化</h3><p>まず、試用版を有効化したいユーザーが含まれたセキュリティ グループを事前に作成していただく必要があります。その後、以下の手順にて「特定のセキュリティ グループ」欄にチェック入れ、作成したセキュリティ グループを入力し、適用ボタンを押下してください。</p><div align="center"><img src="pic3.png"></div><p>　セキュリティ グループの作成方法は、以下の公開情報をご参考ください。</p><p>公開情報：<br><a href="https://learn.microsoft.com/ja-jp/azure/virtual-network/manage-network-security-group?tabs=network-security-group-portal">ネットワーク セキュリティ グループの作成、変更、削除</a></p><h3 id="3-一部のユーザーに試用版を無効化し、他のユーザーに有効化"><a href="#3-一部のユーザーに試用版を無効化し、他のユーザーに有効化" class="headerlink" title="3.    一部のユーザーに試用版を無効化し、他のユーザーに有効化"></a>3.    一部のユーザーに試用版を無効化し、他のユーザーに有効化</h3><p>まず、手順２で案内した公開情報を参考に試用版を無効化したいユーザーが含まれたセキュリティ グループを作成します。その後、以下の手順にて「特定のセキュリティ グループを除く」欄にチェック入れ、作成したセキュリティ グループを入力し、適用ボタンを押下してください。</p><div align="center"><img src="pic4.png"></div><hr><h2 id="注意・制約事項"><a href="#注意・制約事項" class="headerlink" title="注意・制約事項"></a>注意・制約事項</h2><hr><p>既に試用版を開始しているユーザーは、ご本人にて試用版の取り消しを実施していただく必要があります。Power BI管理者は、ユーザーの試用版の取り消しを実行できないので、ご留意ください。<br>試用版の取り消しの手順は、ユーザーのアカウントでPower BI サービスにサインイン後、画面右上のアカウントのアイコンをクリックし、「試用版を取り消す」＞「取り消しを続行する」と進めます。</p><div align="center"><img src="pic5.png" ></div><p>試用版の取り消し後、「試用版：残り日数」が表示されなくなり、試用版の無効化が正常に実施されたことが確認できます。</p><hr><h2 id="その他Q-amp-A"><a href="#その他Q-amp-A" class="headerlink" title="その他Q&amp;A"></a>その他Q&amp;A</h2><hr><p>その他、よくあるご質問についてご案内します。</p><h3 id="Q．Power-BI管理者権限で、ユーザーが試用版を利用しているかどうか確認する方法があるか？"><a href="#Q．Power-BI管理者権限で、ユーザーが試用版を利用しているかどうか確認する方法があるか？" class="headerlink" title="Q．Power BI管理者権限で、ユーザーが試用版を利用しているかどうか確認する方法があるか？"></a>Q．Power BI管理者権限で、ユーザーが試用版を利用しているかどうか確認する方法があるか？</h3><p>いいえ、確認する方法はありません。ユーザーのアカウントからPower BIサービスにサインインし、「PPU試用版：残り日数」の表示を確認する方法のみです。こちらが表示される場合、試用版を利用していることになります。</p><h3 id="Q．Power-BI有料機能を「無効化」から「有効化」にする場合、ユーザーは試用版をまだ利用していない場合、利用可能か？"><a href="#Q．Power-BI有料機能を「無効化」から「有効化」にする場合、ユーザーは試用版をまだ利用していない場合、利用可能か？" class="headerlink" title="Q．Power BI有料機能を「無効化」から「有効化」にする場合、ユーザーは試用版をまだ利用していない場合、利用可能か？"></a>Q．Power BI有料機能を「無効化」から「有効化」にする場合、ユーザーは試用版をまだ利用していない場合、利用可能か？</h3><p>はい、可能です。ユーザーは、まだ試用版が開始していない場合、無料体験のポップアップが再度表示され、お試しいただけます。</p><h3 id="Q．試用版の期間は、現状60日ですが、この期間が延長可能か？"><a href="#Q．試用版の期間は、現状60日ですが、この期間が延長可能か？" class="headerlink" title="Q．試用版の期間は、現状60日ですが、この期間が延長可能か？"></a>Q．試用版の期間は、現状60日ですが、この期間が延長可能か？</h3><p>いいえ、延長できません。</p><h3 id="Q．試用版を無効化後、有償ライセンスの購入に影響は与えるか？"><a href="#Q．試用版を無効化後、有償ライセンスの購入に影響は与えるか？" class="headerlink" title="Q．試用版を無効化後、有償ライセンスの購入に影響は与えるか？"></a>Q．試用版を無効化後、有償ライセンスの購入に影響は与えるか？</h3><p>有償ライセンスの購入には影響を与えません。</p><h3 id="Q-試用版の期間が過ぎると、ライセンスと作成したコンテンツはどうなるか？"><a href="#Q-試用版の期間が過ぎると、ライセンスと作成したコンテンツはどうなるか？" class="headerlink" title="Q.試用版の期間が過ぎると、ライセンスと作成したコンテンツはどうなるか？"></a>Q.試用版の期間が過ぎると、ライセンスと作成したコンテンツはどうなるか？</h3><p>本来割り当てられているライセンスに戻り、PPUの機能は使用できなくなります。その間、作成したコンテンツ自体は削除されず、割り当てられているライセンスに応じてご利用いただけます。</p><h3 id="Q．ユーザー自身で試用版の取り消しを実施した後、ライセンスと作成したコンテンツはどうなるのか？"><a href="#Q．ユーザー自身で試用版の取り消しを実施した後、ライセンスと作成したコンテンツはどうなるのか？" class="headerlink" title="Q．ユーザー自身で試用版の取り消しを実施した後、ライセンスと作成したコンテンツはどうなるのか？"></a>Q．ユーザー自身で試用版の取り消しを実施した後、ライセンスと作成したコンテンツはどうなるのか？</h3><p>本来割り当てられているライセンスに戻り、PPUの機能は使用できなくなります。その間、作成したコンテンツ自体は削除されず、割り当てられているライセンスに応じてご利用いただけます。</p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームのファムです。&lt;/p&gt;
&lt;p&gt;Power BI試用版（無料体験）（以下「試用版」と表現します）をご利用されたことがありますか。有料版の機能をご利用いただくことはもちろん、ワークスペースのレポートを共有・閲覧もできます。ただ、セキュリティの観点で、ユーザーにレポートの共有・閲覧を制限したいため、試用版を無効化したいというお問合せが Power BI 管理者様よりたくさん寄せられます。&lt;/p&gt;
&lt;p&gt;本ブログでは、試用版を無効化する方法、および試用版に関する疑問点をQ&amp;amp;A形式で紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="trial version" scheme="https://jpbap-sqlbi.github.io/blog/tags/trial-version/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Service へのアクセス制御② Azure Private Link</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_privatelink/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_privatelink/</id>
    <published>2022-12-28T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.595Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>セキュリティの観点から、Power BI Service へのアクセスを制限したいというお問い合わせを受けることがあります。前回は「<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_conditional-access/">条件付きアクセス</a>」について説明しましたが、今回は  ｢Private Link｣ について説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><ul><li><a href="#Azure-Private-Link-%E3%81%A8%E3%81%AF">Azure Private Link とは</a></li><li><a href="#Azure-Private-Link-%E3%81%AE%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86">Azure Private Link の設定手順</a><ul><li><a href="#1.%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">1.事前準備</a></li><li><a href="#2-Power-BI-%E3%81%AE%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88-%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E6%9C%89%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B">2.Power BI のプライベート エンドポイントを有効にする</a></li><li><a href="##3.Azure-portal-%E3%81%A7-Power-BI-%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">3.Azure portal で Power BI リソースを作成する</a></li><li><a href="#4.%E4%BB%AE%E6%83%B3%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">4.仮想ネットワークを作成する</a></li><li><a href="#5.%E4%BB%AE%E6%83%B3%E3%83%9E%E3%82%B7%E3%83%B3-(VM)-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">5.仮想マシン (VM) を作成する</a>    </li><li><a href="#6.%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88-%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">6.プライベート エンドポイントを作成する</a></li><li><a href="#7.%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%88-%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97-(RDP)-%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6-VM-%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B">7.リモート デスクトップ (RDP) を使用して VM に接続する</a></li><li><a href="#8.%E4%BB%AE%E6%83%B3%E3%83%9E%E3%82%B7%E3%83%B3%E3%81%8B%E3%82%89-Power-BI-%E3%81%AB%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B">8.仮想マシンから Power BI にプライベート アクセスする</a></li><li><a href="#9.Power-BI-%E3%81%AE%E3%83%91%E3%83%96%E3%83%AA%E3%83%83%E3%82%AF-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%82%92%E7%84%A1%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B">9.Power BI のパブリック アクセスを無効にする</a></li></ul></li></ul><h2 id="Azure-Private-Link-とは"><a href="#Azure-Private-Link-とは" class="headerlink" title="Azure Private Link とは"></a>Azure Private Link とは</h2><p>Azure Private Linkは、 仮想ネットワーク内のプライベート エンドポイントを経由してAzureサービスやその他のサービスにアクセスする機能です。この仮想ネットワークとサービス間の通信では、Microsoftのネットワークが利用されるため、インターネットを経由するよりもセキュアな通信が可能です。<br>参考＃<a href="https://learn.microsoft.com/ja-jp/azure/private-link/private-link-overview">Azure Private Link とは | Microsoft Learn</a></p><h2 id="Azure-Private-Link-の設定手順"><a href="#Azure-Private-Link-の設定手順" class="headerlink" title="Azure Private Link の設定手順"></a>Azure Private Link の設定手順</h2><p>Power BI Service でAzure Private Linkを有効にし、パブリックネットワークからの通信を制限するためには、以下の設定を行います。</p><p><a href="#1.%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99">1.事前準備</a><br><a href="#2-Power-BI-%E3%81%AE%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88-%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E6%9C%89%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B">2.Power BI のプライベート エンドポイントを有効にする</a><br><a href="##3.Azure-portal-%E3%81%A7-Power-BI-%E3%83%AA%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">3.Azure portal で Power BI リソースを作成する</a><br><a href="#4.%E4%BB%AE%E6%83%B3%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">4.仮想ネットワークを作成する</a><br><a href="#5.%E4%BB%AE%E6%83%B3%E3%83%9E%E3%82%B7%E3%83%B3-(VM)-%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">5.仮想マシン (VM) を作成する</a><br><a href="#6.%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88-%E3%82%A8%E3%83%B3%E3%83%89%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B">6.プライベート エンドポイントを作成する</a><br><a href="#7.%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%88-%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97-(RDP)-%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%A6-VM-%E3%81%AB%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B">7.リモート デスクトップ (RDP) を使用して VM に接続する</a><br><a href="#8.%E4%BB%AE%E6%83%B3%E3%83%9E%E3%82%B7%E3%83%B3%E3%81%8B%E3%82%89-Power-BI-%E3%81%AB%E3%83%97%E3%83%A9%E3%82%A4%E3%83%99%E3%83%BC%E3%83%88-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%99%E3%82%8B">8.仮想マシンから Power BI にプライベート アクセスする</a><br><a href="#9.Power-BI-%E3%81%AE%E3%83%91%E3%83%96%E3%83%AA%E3%83%83%E3%82%AF-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%82%92%E7%84%A1%E5%8A%B9%E3%81%AB%E3%81%99%E3%82%8B">9.Power BI のパブリック アクセスを無効にする</a></p><p>それぞれの詳細な手順について、以下に説明します。なお、この設定はAzure Portalから構築するものが多くあり、Power BI管理者とは異なる権限が必要となりますのでご注意ください。<br>参考＃<a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-private-links">Power BI にアクセスするためのプライベート エンドポイント - Power BI | Microsoft Learn</a></p><h3 id="1-事前準備"><a href="#1-事前準備" class="headerlink" title="1.事前準備"></a>1.事前準備</h3><p>後の手順で利用するため、テナントIDと、Power BIで利用しているリージョン情報を取得します。<br>はじめにテナントIDを取得します。Azure Portalを開き、メニューから［Azure Active Directory］を選択します。</p><div align="center"><img src="privatelink01.png"></div>  <p>表示されるテナントIDを控えます。</p><div align="center"><img src="privatelink02.png"></div><p>次にPower BIのリージョン情報を取得します。Power BI Service にアクセスし、［ヘルプとサポート］＞［Power BI について］を選択します。</p><div align="center"><img src="privatelink10.png"></div><p>［データの保存先］に記載されている情報を控えます。以下の画像では［東日本（東京、埼玉）］です。</p><div align="center"><img src="privatelink11.png"></div><p>テナントIDとリージョン情報が取得できたら、次の手順に進みます。</p><h3 id="2-Power-BI-のプライベート-エンドポイントを有効にする"><a href="#2-Power-BI-のプライベート-エンドポイントを有効にする" class="headerlink" title="2.Power BI のプライベート エンドポイントを有効にする"></a>2.Power BI のプライベート エンドポイントを有効にする</h3><p>Power BI Service の管理ポータルにアクセスし、[テナント設定］&gt;［高度なネットワーク］＞［Azure Private Link］を有効化します。</p><div align="center"><img src="privatelink03.png"></div><p>［Azure Private Link］の設定を変更すると、テナント用に個別のFQDNを構成するなどで15分程度の時間がかかります。これ以降の手順でリソースを作成するのには影響しないので、次の手順に進みます。</p><h3 id="3-Azure-portal-で-Power-BI-リソースを作成する"><a href="#3-Azure-portal-で-Power-BI-リソースを作成する" class="headerlink" title="3.Azure portal で Power BI リソースを作成する"></a>3.Azure portal で Power BI リソースを作成する</h3><p>次に、Azureテンプレートを使用してPower BI リソースグループを作成します。Azure Portalを開き、画面上部の検索欄に”テンプレート”と入力し、［サービス］にある［テンプレート］を選択します。</p><div align="center"><img src="privatelink04.png"></div><p>［テンプレートの作成］から新しくテンプレートを作成します。</p><div align="center"><img src="privatelink05.png"></div><p>［名前］と［説明］を入力し、［ARM テンプレート］を選択します。</p><div align="center"><img src="privatelink06.png"></div><p>ARMテンプレートでは以下のように入力します。マーカー部分の ”name” : ”resource-name” は適当に設定をし、 ”tenantId” : “tenant-object-id” は事前準備で控えたテナントIDを入力します。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;$schema&quot;</span>: <span class="string">&quot;http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;contentVersion&quot;</span>: <span class="string">&quot;1.0.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;parameters&quot;</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">&quot;resources&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">          <span class="attr">&quot;type&quot;</span>:<span class="string">&quot;Microsoft.PowerBI/privateLinkServicesForPowerBI&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;apiVersion&quot;</span>: <span class="string">&quot;2020-06-01&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;name&quot;</span> : <span class="string">&quot;&lt;resource-name&gt;&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;location&quot;</span>: <span class="string">&quot;global&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;properties&quot;</span> : </span><br><span class="line">          &#123;</span><br><span class="line">               <span class="attr">&quot;tenantId&quot;</span>: <span class="string">&quot;&lt;tenant-object-id&gt;&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div align="center"><img src="privatelink07.png"></div><p>テンプレートが作成できたら、［…］＞［デプロイ］を選択します。</p><div align="center"><img src="privatelink08.png"></div><p>［サブスクリプション］、［リソースグループ］は適当に選択をします。［場所］は事前準備で控えたリージョンと同じ場所を選択します。設定ができたら［上記の使用条件に同意する］にチェックを入れ［購入］を選択します。</p><div align="center"><img src="privatelink09.png"></div><p>デプロイが完了したら次の手順に進みます。</p><h3 id="4-仮想ネットワークを作成する"><a href="#4-仮想ネットワークを作成する" class="headerlink" title="4.仮想ネットワークを作成する"></a>4.仮想ネットワークを作成する</h3><p>次に、仮想ネットワークとサブネットを作成します。メニューから［仮想ネットワーク］を選択します。</p><div align="center"><img src="privatelink13.png"></div><p>［仮想ネットワークの作成］から新しく仮想ネットワークを作成します。</p><div align="center"><img src="privatelink14.png"></div><p>［地域］についてはリージョン情報と同じ場所を選択し、それ以外を適当に設定したら［次：セキュリティ＞］を選択します。</p><div align="center"><img src="privatelink15.png"></div><p>セキュリティについては今回は設定を変更せず［次：IPアドレス＞］を選択します。</p><div align="center"><img src="privatelink16.png"></div><p>［IPアドレス］は設定されている内容に問題がなければ特に変更せず［確認＋作成］を選択します。</p><div align="center"><img src="privatelink17.png"></div><p>確認し、［作成］を選択します。</p><div align="center"><img src="privatelink18.png"></div><p>デプロイが完了したら、次の手順に進みます。</p><h3 id="5-仮想マシン-VM-を作成する"><a href="#5-仮想マシン-VM-を作成する" class="headerlink" title="5.仮想マシン (VM) を作成する"></a>5.仮想マシン (VM) を作成する</h3><p>次に仮想マシンを作成します。メニューから［Virtual Machines］を選択します。</p><div align="center"><img src="privatelink20.png"></div><p>［作成］から新しいVMを作成します。</p><div align="center"><img src="privatelink21.png"></div><p>［地域］についてはリージョン情報と同じ場所を選択し、それ以外を適当に設定したら［次：ディスク＞］を選択します。</p><div align="center"><img src="privatelink22.png"></div><div align="center"><img src="privatelink23.png"></div><p>今回は特に変更せず［次：ネットワーク＞］を選択します。</p><div align="center"><img src="privatelink24.png"></div><p>［仮想ネットワーク］、［サブネット］が手順4で作成したものに設定されていることを確認し、［確認および作成］を選択します。</p><div align="center"><img src="privatelink25.png"></div><p>［作成］を選択します。</p><div align="center"><img src="privatelink26.png"></div><p>デプロイが完了したら次の手順に進みます。</p><h3 id="6-プライベート-エンドポイントを作成する"><a href="#6-プライベート-エンドポイントを作成する" class="headerlink" title="6.プライベート エンドポイントを作成する"></a>6.プライベート エンドポイントを作成する</h3><p>次の手順では、Power BI のプライベート エンドポイントを作成します。メニューから［リソースの作成］を選択します。</p><div align="center"><img src="privatelink28.png"></div><p>検索欄に”private link”と入力し、Enterキーを押します。</p><div align="center"><img src="privatelink29.png"></div><p>［Private Link］の［作成］＞［Private Link］を選択します。</p><div align="center"><img src="privatelink30.png"></div><p>［Private Link センター］が開けたら、［プライベート エンドポイントの作成］を選択します。</p><div align="center"><img src="privatelink31.png"></div><p>［地域］についてはリージョン情報と同じ場所を選択し、それ以外を適当に設定したら［次：リソース＞］を選択します。</p><div align="center"><img src="privatelink32.png"></div><p>［リソースの種類］は［Microsoft.PowerBI/privateLinkServicesForPowerBI］を選択します。［リソース］は手順3で作成したリソースを選択し、［対象サブリソース］は［tenant］を選択します。［次：仮想ネットワーク＞］を選択します。</p><div align="center"><img src="privatelink33.png"></div><p>［仮想ネットワーク］［サブネット］が、手順4で作成されたものに設定されていることを確認し、［次：DNS＞］を選択します。</p><div align="center"><img src="privatelink34.png"></div><p>今回は特に設定を変更せず、［次：タグ＞］を選択します。</p><div align="center"><img src="privatelink35.png"></div><p>タグは必要に応じて設定し、［次：確認および作成＞］を選択します。</p><div align="center"><img src="privatelink44.png"></div><p>［作成］を選択します。</p><div align="center"><img src="privatelink36.png"></div><p>デプロイが完了したら次の手順に進みます。</p><h3 id="7．リモート-デスクトップ-RDP-を使用して-VM-に接続する"><a href="#7．リモート-デスクトップ-RDP-を使用して-VM-に接続する" class="headerlink" title="7．リモート デスクトップ (RDP) を使用して VM に接続する"></a>7．リモート デスクトップ (RDP) を使用して VM に接続する</h3><p>Power BI にプライベートアクセスするため、手順5で作成したVMに接続します。ホームに戻り、手順5で作成したVMを選択します。</p><div align="center"><img src="privatelink38.png"></div><p>［接続］＞［RDP］を選択します。</p><div align="center"><img src="privatelink39.png"></div><p>［RDPファイルのダウンロード］を選択します。</p><div align="center"><img src="privatelink40.png"></div><p>ダウンロードされたRDPファイルをダブルクリックします。［Connect］を選択します。</p><div align="center"><img src="privatelink45.png"></div><p>認証情報を求められるため、［More choices］＞［Use a different account］を選択し、VMを作成するときに設定したアカウント名とパスワードを入力し［OK］を選択します。</p><div align="center"><img src="privatelink46.png"></div><p>接続ができたら次の手順に進みます。</p><h3 id="8-VMから-Power-BI-にプライベート-アクセスする"><a href="#8-VMから-Power-BI-にプライベート-アクセスする" class="headerlink" title="8.VMから Power BI にプライベート アクセスする"></a>8.VMから Power BI にプライベート アクセスする</h3><p>VMに接続できたら、PowerShellを開き、以下のコマンドを入力します。［tenant-object-id-without-hyphens］は、事前準備で取得したテナントIDから、ハイフンを抜き入力します。例えば、テナントIDが”AAAAAAAA-BBBB-CCCC-DDDD-EEEEEEEEEEEE”の場合に入力するコマンドは”nslookup AAAAAAAABBBBCCCCDDDDEEEEEEEEEEEE-api.privatelink.analysis.windows.net”となります。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nslookup [<span class="type">tenant</span>-<span class="type">object</span>-<span class="type">id</span>-<span class="type">without</span>-<span class="type">hyphens</span>]<span class="literal">-api</span>.privatelink.analysis.windows.net</span><br></pre></td></tr></table></figure><p>入力すると以下のような応答があり、プライベートIPで名前解決されていることが確認できます。</p><div align="center"><img src="privatelink41.png"></div><h3 id="9-Power-BI-のパブリック-アクセスを無効にする"><a href="#9-Power-BI-のパブリック-アクセスを無効にする" class="headerlink" title="9.Power BI のパブリック アクセスを無効にする"></a>9.Power BI のパブリック アクセスを無効にする</h3><p>最後に、Power BIのパブリックアクセスを無効にします。Power BI Service の管理ポータルにアクセスし、[テナント設定］&gt;［高度なネットワーク］＞［パブリック インターネット アクセスのブロック］を有効化します。</p><div align="center"><img src="privatelink42.png"></div><p>有効化には10～20分程度かかります。しばらく時間をおいて、外部ネットワークからPower BIにアクセスしようとすると、以下のようなメッセージが表示され、アクセスできないことが確認できます。</p><div align="center"><img src="privatelink43.png"></div><p>以上で設定は完了となります。プライベート エンドポイントを利用する際には、いくつかの制限事項がございます。公開情報にてご案内しておりますのでご確認いただけますと幸いでございます。<br>参考＃ <a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-security-private-links#considerations-and-limitations">Power BI にアクセスするためのプライベート エンドポイント - 考慮事項と制限事項</a></p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;セキュリティの観点から、Power BI Service へのアクセスを制限したいというお問い合わせを受けることがあります。前回は「&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_conditional-access/&quot;&gt;条件付きアクセス&lt;/a&gt;」について説明しましたが、今回は  ｢Private Link｣ について説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="ダッシュボード" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%80%E3%83%83%E3%82%B7%E3%83%A5%E3%83%9C%E3%83%BC%E3%83%89/"/>
    
  </entry>
  
  <entry>
    <title>セルフサービス サインアップの無効化</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_self-service-signup/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_self-service-signup/</id>
    <published>2022-12-28T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.887Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。</p><p>Power BI にはいくつかのライセンスがあることを、こちらのブログ「 <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）</a> 」でご紹介させていただきました。</p><p>無償版の Power BI Free ライセンスについては、組織において無制限でライセンスを取得しご利用いただけますが、ライセンス管理者様が割り当てを行わずとも、ユーザー自身でライセンスの利用を開始すること (セルフサービス サインアップ) が可能です。</p><p>今回は、管理者が組織内のユーザーに対して、”ユーザー自身で Power BI Free ライセンスの利用を開始できるようにするかどうかを制御する方法” についてご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="ユーザー自身が-Power-BI-Free-ライセンスの利用開始することを制御したいのはどんな時？"><a href="#ユーザー自身が-Power-BI-Free-ライセンスの利用開始することを制御したいのはどんな時？" class="headerlink" title="ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？"></a>ユーザー自身が Power BI Free ライセンスの利用開始することを制御したいのはどんな時？</h2><hr><p>Power BI 管理者様や IT 管理者様、これから Power BI 導入のプロジェクトを進められるご担当者様などから、「ユーザーが勝手に Power BI Freeライセンスの利用を開始することを制御したい」とご要望をいただくことがたくさんあります。<br>組織によって背景は様々ですが、多くのお問合せは以下のような場合の時にいただきます。<br>このようなシナリオに該当する場合は、”セルフサービス サインアップ” 機能を無効にすることをご検討ください。</p><ul><li>ライセンス割り当ては管理者側で完全に制御したい</li><li>Power BI を組織内で徐々に展開していることを検討しているため、知らないうちにユーザーが勝手に利用することを防ぎたい</li><li>有償ライセンスのみを利用することを検討しているため、Power BI Free を利用させたくない</li></ul></br><hr><h2 id="セルフサービス-サインアップとは？"><a href="#セルフサービス-サインアップとは？" class="headerlink" title="セルフサービス サインアップとは？"></a>セルフサービス サインアップとは？</h2><hr><p>セルフサービス サインアップとは、管理者側が各ユーザーへのライセンス割り当てをしなくてもユーザー側のサインアップ作業によってライセンスの取得およびサービスの利用開始が可能となる機能です。</p><p>本機能を無効化することで、ユーザーが勝手に Power BI Free ライセンスを利用開始することを制御できます。</p></br><div class="alert is-warning"><p class="alert-title">警告</p><p>無効化の設定は他のセルフサービス プログラムと一括で管理されているため、例えば Power Apps のセルフサービス サインアップなども無効化されます。</p><p>サービスごとに制御する方法はご用意がないことを、ご注意くださいますようお願いいたします。</p></div></br><blockquote><p><strong>参考情報</strong><br>セルフ サービスサインアップが有効なプログラムの一覧はこちらでご案内しております。<br><a href="https://learn.microsoft.com/ja-jp/microsoft-365/admin/misc/self-service-sign-up?view=o365-worldwide">セルフサービスでのサインアップと購入を有効または無効にする - Power BI | Microsoft Learn</a>   </p></blockquote><hr><h2 id="セルフサービス-サインアップの無効化手順"><a href="#セルフサービス-サインアップの無効化手順" class="headerlink" title="セルフサービス サインアップの無効化手順"></a>セルフサービス サインアップの無効化手順</h2><hr><p>セルフサービス サインアップ無効化手順は以下公開情報にてご案内しておりますが、一連の設定手順を詳細におまとめいたしました。</p></br><blockquote><p><strong>参考情報</strong><br><a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-admin-disable-self-service#use-powershell-azure-ad-and-microsoft-365-to-enable-and-disable-self-service">組織でのセルフサービス サインアップの使用 - Microsoft 365 admin | Microsoft Learn</a></p></blockquote></br><h4 id="＜手順＞"><a href="#＜手順＞" class="headerlink" title="＜手順＞"></a>＜手順＞</h4><p>管理者として Windows Power Shell を起動し、以下項番１から順番にコマンドを実行します。</p><ol><li><p>資格情報の入力</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$credential</span> = <span class="built_in">Get-Credential</span></span><br></pre></td></tr></table></figure><p>認証画面が表示されたら、 Office 365 管理者 ID と Pass を入力します。</p></li><li><p>$credential 値の確認</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$credential</span></span><br></pre></td></tr></table></figure></li><li><p>MsOnline モジュールの取得</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-Module</span> MsOnline</span><br></pre></td></tr></table></figure><p>ご環境によってはエラーとなる場合があります。その際は、“Import-Module MsOnline” をお試しください。</p></li><li><p>Azure Active Directory への接続</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Connect-MsolService</span> <span class="literal">-Credential</span> <span class="variable">$credential</span></span><br></pre></td></tr></table></figure></li><li><p>Azure Active Directory 内のドメイン取得</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-MsolDomain</span></span><br></pre></td></tr></table></figure><p>アクセス先ドメインを確認します。</p></li><li><p>各テナント情報の取得</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-MsolCompanyInformation</span> | <span class="built_in">fl</span> allow*</span><br><span class="line"></span><br><span class="line">AllowAdHocSubscriptions : True</span><br><span class="line">AllowEmailVerifiedUsers : True</span><br></pre></td></tr></table></figure><p>Office 365 内の設定にてすでにブロックされているか確認します。<br>この時点で両方の値が False の場合、以降の 項番７を実施する必要はありません。<br>既にセルフサービス サインアップの機能は無効になっています。</p></li><li><p>上記機能が True の場合、下記のコマンドにて各機能を無効に設定します。</p><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-MsolCompanySettings</span> <span class="literal">-AllowEmailVerifiedUsers</span> <span class="variable">$false</span></span><br><span class="line"><span class="built_in">Set-MsolCompanySettings</span> <span class="literal">-AllowAdHocSubscriptions</span> <span class="variable">$false</span></span><br></pre></td></tr></table></figure><p>※各機能はそれぞれ以下のような意味を持ちます。<br>新規ユーザーに対してテナントの自動参加の可否を決める機能: <strong>-AllowEmailVerifiedUsers</strong><br>既存ユーザーに対してライセンスの自動配布の可否を決める機能: <strong>-AllowAdHocSubscriptions</strong></p></li><li><p>設定後、再度項番６のコマンドを実行して、設定が更新されていることを確認します。</p></li></ol><p><strong>実行結果例：</strong></p><div align="center"><img src="1.png"></div></br><p>上記設定後、Power BI のライセンスをもたないユーザーが Power BI（app.powerbi.com）にサインインしようとしても、以下画面の通りセルフサービス サインアップができなくなります。</p><div align="center"><img src="2.png"></div></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;/p&gt;
&lt;p&gt;Power BI にはいくつかのライセンスがあることを、こちらのブログ「 &lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/&quot;&gt;Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）&lt;/a&gt; 」でご紹介させていただきました。&lt;/p&gt;
&lt;p&gt;無償版の Power BI Free ライセンスについては、組織において無制限でライセンスを取得しご利用いただけますが、ライセンス管理者様が割り当てを行わずとも、ユーザー自身でライセンスの利用を開始すること (セルフサービス サインアップ) が可能です。&lt;/p&gt;
&lt;p&gt;今回は、管理者が組織内のユーザーに対して、”ユーザー自身で Power BI Free ライセンスの利用を開始できるようにするかどうかを制御する方法” についてご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="ライセンス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9/"/>
    
    <category term="Power BI Free" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Free/"/>
    
    <category term="セルフサービス サインアップ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%BB%E3%83%AB%E3%83%95%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9-%E3%82%B5%E3%82%A4%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97/"/>
    
  </entry>
  
  <entry>
    <title>Power BI アプリの紹介</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_app_introduction/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_app_introduction/</id>
    <published>2022-11-29T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.311Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの呂です。</p><p>レポートやダッシュボード以外のコンテンツ配布方法として、Power BI アプリという便利な機能があることをご存知でしょうか？<br>今回は、Power BI アプリの機能やご利用方法について紹介します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事編集時点と実際の機能に相違がある場合がございます。予めご了承ください。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p><p></br></p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#Power-BI-%E3%82%A2%E3%83%97%E3%83%AA%E3%81%A8%E3%81%AF">Power BI アプリとは</a></li><li><a href="#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E8%A6%81%E4%BB%B6">ライセンス要件</a></li><li><a href="#%E7%B5%84%E7%B9%94%E3%82%A2%E3%83%97%E3%83%AA">組織アプリ</a></li><li><a href="#%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%A2%E3%83%97%E3%83%AA">テンプレートアプリ</a></br></li></ol><hr><h2 id="Power-BI-アプリとは"><a href="#Power-BI-アプリとは" class="headerlink" title="Power BI アプリとは"></a>Power BI アプリとは</h2><hr><p>Power BI アプリはパッケージ化するコンテンツを作成し、アプリとして多くの対象ユーザーに配布できる機能です。<br>Power BI アプリには組織内に配布する組織アプリと、組織外の顧客に配布するテンプレートアプリという２種類があります。</p><hr><h2 id="ライセンス要件"><a href="#ライセンス要件" class="headerlink" title="ライセンス要件"></a>ライセンス要件</h2><hr><p>アプリを作成または更新するには、Power BI Pro または Premium Per User (PPU) のライセンスが必要です。<br>アプリの閲覧についてはレポートと同様に閲覧権限が必要になります。各ライセンスの閲覧可否の詳細につきましては、以下ブログをご参考ください。</p><p>参考情報<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_license/#%E3%83%A9%E3%82%A4%E3%82%BB%E3%83%B3%E3%82%B9%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E3%81%AE%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E9%96%B2%E8%A6%A7%E5%8F%AF%E5%90%A6">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）― ライセンス組み合わせのコンテンツ閲覧可否</a><br></br></p><hr><h2 id="組織アプリ"><a href="#組織アプリ" class="headerlink" title="組織アプリ"></a>組織アプリ</h2><hr><p>組織アプリは、特定のワークスペースにあるコンテンツをバージョン管理の上パッケージ化して、組織全体または特定のユーザーに発行する機能です。 アプリはワークスペースと異なるアクセス許可を設定でき、また各対象ユーザーに対して異なるコンテンツを表示することができますため、組織内における大規模なコンテンツ配布する際に便利な機能になっています。</p><p>レポート、ダッシュボードとの機能比較</p><table><thead><tr><th>機能</th><th>レポート</th><th>ダッシュボード</th><th>組織アプリ</th></tr></thead><tbody><tr><td>コンテンツ</td><td>レポートのページ</td><td>複数のレポートに存在するビジュアル</td><td>同一ワークスペースにある複数レポート及びダッシュボードのコンテンツ</td></tr><tr><td>アクセス</td><td>レポート単位で設定可能</td><td>ダッシュボード単位で設定可能</td><td>特定のユーザーグループに特定のコンテンツを表示可能</td></tr><tr><td>コピーの保存</td><td>可</td><td>可</td><td>不可</td></tr><tr><td>ダウンロード</td><td>可</td><td>不可</td><td>不可</td></tr><tr><td>埋め込み</td><td>可</td><td>不可</td><td>可（レポートの埋め込み）</td></tr><tr><td></br></td><td></td><td></td><td></td></tr></tbody></table><h3 id="組織アプリの発行方法"><a href="#組織アプリの発行方法" class="headerlink" title="組織アプリの発行方法"></a>組織アプリの発行方法</h3><ol><li><p>ワークスペース画面から、右上の[アプリの作成]をクリックします。</p><div align="center"><img src="1.png"></div></li><li><p>セットアップ画面でアプリ名と説明（必須）、ロゴの変更、連絡先などを指定できます。<br>設定終了後、[次へ: コンテンツを追加する]を選択します。</p></li></ol><div align="center"><img src="2.png"></div><ol start="3"><li>コンテンツ画面で、[コンテンツの追加]を選択します、ポップアップ画面でアプリに追加したいレポート／ダッシュボードをチェックし、[追加]を選択し、[次へ: 対象ユーザーを選択する]を選択します。</li></ol><div align="center"><img src="3.png"></div><ol start="4"><li>対象ユーザー画面で、特定のユーザーグループに特定のコンテンツを表示させる設定を行えます。<br>4-①　必要に応じて[対象ユーザー]を作成します。<br>※作成しました対象ユーザーをダブルクリックすると名前の変更が可能です。<br>4-②　選択している対象ユーザーに表示／非表示したい内容を編集する。<br>※画面ショットの例では、営業部に所属するユーザーに、Report03／Report04／Report05のみを表示するように設定しております。<br>4-③　[Audience Accessを管理する]で対象ユーザー、もしくは対象ユーザーが所属しているグループのアクセス権限を設定します。</li></ol><div class="alert is-success"><p class="alert-title">ヒント</p><p>[Audience Accessを管理する]&gt;[詳細]で対象ユーザーへのデータセット共有やコンテンツのビルド許可の設定も可能です。</p></div><div align="center"><img src="4.png"></div><ol start="5"><li>以上の設定終了後、[アプリの発行]を選択すると、コンテンツは組織として発行されます。<br>発行後の組織アプリは、Power BIサービス左側のナビゲーションの[アプリ]一覧から確認することができます。</li></ol><div align="center"><img src="5.png"></div></br><h3 id="組織アプリの編集方法"><a href="#組織アプリの編集方法" class="headerlink" title="組織アプリの編集方法"></a>組織アプリの編集方法</h3><p>アプリ発行後、ワークスペース画面右上の[アプリの作成]ボタンが[アプリの更新]に変更され、選択すると発行済のアプリの内容を編集することができます。</p><div align="center"><img src="6.png"></div></br><h3 id="組織アプリの削除方法"><a href="#組織アプリの削除方法" class="headerlink" title="組織アプリの削除方法"></a>組織アプリの削除方法</h3><p>ワークスペース画面＞[･･･]&gt;[アプリ発行の取り消し]で組織アプリを削除できます。</p><div align="center"><img src="7.png"></div></br><hr><h2 id="テンプレートアプリ"><a href="#テンプレートアプリ" class="headerlink" title="テンプレートアプリ"></a>テンプレートアプリ</h2><hr><p>テンプレートアプリはMicrosoftまたはPower BIパートナーが顧客に向けて提供しているダッシュボードとライブデータソースのパッケージです。自身でレポートなどを構築する必要がなく、取得後にすぐに使用できます。<br>※Power BIパートナーは、Microsoftと提携して、BIソリューションに提供するPower BIの認定パートナーやコンサルタントのことです。<br></br></p><h3 id="テンプレートアプリの取得"><a href="#テンプレートアプリの取得" class="headerlink" title="テンプレートアプリの取得"></a>テンプレートアプリの取得</h3><p>Power BIサービス左側のナビゲーションの[アプリ]&gt;[アプリの取得]から、テンプレートアプリを検索し、ダウンロードすることができます。</p><div align="center"><img src="8.png"></div><p>以下、例としてPower BI関連の便利なテンプレートアプリを２つご紹介します：</p><p><a href="https://appsource.microsoft.com/en-us/product/power-bi/pbi_pcmm.pbipremiumcapacitymonitoringreport">■Power BI Premium Capacity Utilization and Metrics</a></p><div align="center"><img src="9.png"></div><p>Premium 容量管理者が、Power BI Premium Gen2 (プレビュー) ワークスペースのデータセット、レポート、データフローなどで使用されている CPU 使用率、処理時間、メモリの量を確認できるアプリです。</p><div class="alert is-success"><p class="alert-title">ヒント</p><p>前提条件：Gen2 容量であること及び容量管理者アカウントが必要です</p><p>公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/enterprise/service-premium-install-gen2-app?tabs=1st">Premium Gen2 メトリック アプリをインストールする - Power BI | Microsoft Learn</a></p></div><p><a href="https://appsource.microsoft.com/en-us/product/power-bi/pbicat.powerbi-release-plan">■Power BI Release Plan</a></p><p>Power BIでリリース済と今後リリース予定の機能を確認できるアプリです。</p><div align="center"><img src="10.png"></div><div class="alert is-success"><p class="alert-title">ヒント</p><p>公開情報：<a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-connect-to-power-bi-release-plan">Power BI リリース計画レポートに接続する - Power BI | Microsoft Learn</a></p><p></br></p></div><h3 id="テンプレートアプリの更新"><a href="#テンプレートアプリの更新" class="headerlink" title="テンプレートアプリの更新"></a>テンプレートアプリの更新</h3><p>現在、テンプレートアプリの新しいバージョンがリリースされても、最新バージョンに自動で更新されません。最新バージョンを利用する場合は、以下の手順で更新してください。<br>１．[アプリの取得]からもう一度ご更新されたいアプリをダウンロードする。<br>２．既に旧バージョンをインストールしている場合、以下のポップアップが表示され、更新したいアプリを選択しインストールすると、テンプレートアプリは最新バージョンに更新されます。</p><div align="center"><img src="11.png"></div></br><hr><h3 id="参考情報"><a href="#参考情報" class="headerlink" title="参考情報"></a>参考情報</h3><hr><ul><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-apps">公開情報：Power BI のアプリ</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/collaborate-share/service-create-distribute-apps">公開情報：Power BI でアプリを発行する</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-template-apps-install-distribute">公開情報：組織でテンプレート アプリをインストールし、共有し、更新する</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-template-apps-overview">公開情報：Power BI テンプレート アプリとは</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-template-apps-create">公開情報：Power BI でテンプレート アプリを作成する</a></li><li> <a href="https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-app-view">公開情報：Power BI でダッシュボードとレポートを含むアプリをインストールして使用する</a></li></ul></br><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの呂です。&lt;/p&gt;
&lt;p&gt;レポートやダッシュボード以外のコンテンツ配布方法として、Power BI アプリという便利な機能があることをご存知でしょうか？&lt;br&gt;今回は、Power BI アプリの機能やご利用方法について紹介します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI サービス" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%B5%E3%83%BC%E3%83%93%E3%82%B9/"/>
    
    <category term="Power BI アプリ" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
  </entry>
  
  <entry>
    <title>Power BI CSS Blog でよく閲覧されているページランキング</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blog_reflection2022/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blog_reflection2022/</id>
    <published>2022-11-29T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.323Z</updated>
    
    <content type="html"><![CDATA[</br><p>こんにちは、Power BI サポート チームの丸山です。<br>この Power BI CSS ブログは2021年7月からリニューアルして、早いもので1年と数か月が経過しました。ここまで続いているのはひとえに閲覧いただいている皆様のおかげでしかありません。いつもご覧いただき本当にありがとうございます！この場を借りて、ブログチーム一同から深く感謝申し上げます。<br>今回はいつもと趣向を変えて、当ブログでどんな記事がよく閲覧されているかのランキングをご紹介します。まだご覧になってない記事で気になるものがあれば是非リンクからお立ち寄りください。</p><span id="more"></span><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ol><li><a href="#1-Power-BI-%E3%81%AE%E6%A4%9C%E7%B4%A2%E6%95%B0%E5%8B%95%E5%90%91">Power BI の検索数動向</a></li><li><a href="#2-%E9%96%B2%E8%A6%A7%E3%83%9A%E3%83%BC%E3%82%B8%E3%83%A9%E3%83%B3%E3%82%AD%E3%83%B3%E3%82%B0">閲覧ページランキング</a></li></ol></br><hr><h2 id="1-Power-BI-の検索数動向"><a href="#1-Power-BI-の検索数動向" class="headerlink" title="1. Power BI の検索数動向"></a>1. Power BI の検索数動向</h2><hr><p>ページランキングに行く前に、市場全体における Power BI への興味関心がこの数年間でどのような傾向になっているのか、Google Trends にて検索キーワード “Power BI” の傾向を調べてみました。<br>検索数は以下のとおり、日本も全世界も右肩上がりで、2020年からの3年間で1.5～2倍に伸びているのがわかります（Google Trends は数値が最も多い時を100として、それ以外を0～100で表現しています）</p><h3 id="検索キーワード-“Power-BI”-日本"><a href="#検索キーワード-“Power-BI”-日本" class="headerlink" title="検索キーワード “Power BI” : 日本"></a>検索キーワード “Power BI” : 日本</h3><div align="center"><img src="1.png"></div></br><p>定期的に下降スパイクしているのはゴールデンウィークや年末年始の連休です。</p><h3 id="検索キーワード-“Power-BI”-すべての国"><a href="#検索キーワード-“Power-BI”-すべての国" class="headerlink" title="検索キーワード “Power BI” : すべての国"></a>検索キーワード “Power BI” : すべての国</h3><div align="center"><img src="3.png"></div></br><h3 id="検索キーワード-“Power-BI”-アメリカ合衆国"><a href="#検索キーワード-“Power-BI”-アメリカ合衆国" class="headerlink" title="検索キーワード “Power BI” : アメリカ合衆国"></a>検索キーワード “Power BI” : アメリカ合衆国</h3><div align="center"><img src="2.png"></div></br><hr><h2 id="2-閲覧ページランキング"><a href="#2-閲覧ページランキング" class="headerlink" title="2. 閲覧ページランキング"></a>2. 閲覧ページランキング</h2><hr><p>それでは、当ブログの記事でどのページがよく閲覧されているのか、<br>上位ランキングをご紹介します（データ期間 = 1か月 : 2022/10/24 – 2022/11/23）</p><p>第1位 ：<a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_desktop_service/">Power BI ライセンスの違い（Free・Pro・Premium Per User・Premium Per Capacity・Embedded）</a></p><p>やはり、1位は断トツでライセンスの詳細についての記事でした。<br>Power BI のライセンスはユーザーベースとテナントベースがあり、機能比較で少し混乱すると思われますが、是非こちらの記事を参考に整理をしてライセンス購入にお役立ていただければ幸いです。</p><p>続いて第2～4位 は僅差で以下の並びになりました。</p><p>第2位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_desktop_outofmemory_error/">「メモリ不足のため完了できません」エラーの対処策 - Power BI Desktop</a><br>第3位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_refresh_settings/">Power BI サービスのデータセット更新手順について</a><br>第4位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_reflesh_error/">「テーブルの列 ‘***’ が見つかりませんでした。」Power BI更新エラーについて</a></p><p>僅差のため月によって多少の入れ替わりがありますが、現状この３つが上位にいることが多いようです。<br>Power BI の活用フェーズでいうと、1位のライセンスは導入時の検討事項、2～4位はデータソースへの接続やデータ更新など Power BI を活用する際の分析やデータ更新時のフェーズが占めたといえます。</p><p>さて、5位以下も一気にみてみましょう。</p><p>第5位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_contents_share_1/">Power BI サービスでのコンテンツ共有方法の種類</a><br>第6位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_dataflow_dataset/">Power BI データフローとデータセット及びデータマートの紹介と比較</a><br>第7位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_privacylevels/">プライバシー レベルの選択について</a><br>第8位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_map_visual/">Power BIのマップビジュアル</a><br>第9位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_embed/">Power BI レポートの埋め込み方法の種類について</a><br>第10位 : <a href="https://jpbap-sqlbi.github.io/blog/powerbi/storage_mode/">「インポート」と「Direct Query」データセットの違い</a></p><p>データフローやプライバシーレベル、そしてマップビジュアルなど特定の使い方にクローズアップしている記事が続きました。</p><p>上位10位をみた総論としては、下図の右のファネルで表現したとおり、導入検討→分析・更新→共有→応用 という、なんとなく Power BI の活用フェーズの順という見方もできると思います。</p><div align="center"><img src="4.png"></div></br><p>参考までに20位までのタイトルも以下に載せておきます。</p><div align="center"><img src="5.png"></div></br><p>いかがでしたでしょうか。</p><p>弊社ブログチームとしては、Power BI を活用していくうえで課題や不明点になりやすい部分をこれからも随時投稿してまいります。閲覧者の方々に「読んで良かった！課題解決につながった！」と思っていただける内容を目指して当ブログの構築を進めてまいりますので、引き続き、どうぞよろしくお願いいたします。</p><p>以上となります。<br>これからもよろしくお願いいたします！</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;/br&gt;

&lt;p&gt;こんにちは、Power BI サポート チームの丸山です。&lt;br&gt;この Power BI CSS ブログは2021年7月からリニューアルして、早いもので1年と数か月が経過しました。ここまで続いているのはひとえに閲覧いただいている皆様のおかげでしかありません。いつもご覧いただき本当にありがとうございます！この場を借りて、ブログチーム一同から深く感謝申し上げます。&lt;br&gt;今回はいつもと趣向を変えて、当ブログでどんな記事がよく閲覧されているかのランキングをご紹介します。まだご覧になってない記事で気になるものがあれば是非リンクからお立ち寄りください。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
  </entry>
  
  <entry>
    <title>【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/</id>
    <published>2022-11-29T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.327Z</updated>
    
    <content type="html"><![CDATA[</dr><p>こんにちは、Power BI サポート チームの山本です。 </p><p>いつもの当ブログをご利用いただいている皆様、また初めて来られたという方も、ありがとうございます。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blog_reflection2022/">Power BI CSS ブログでよく閲覧されているページランキング</a>でも取り上げましたが、当ブログは「弊社サポートチームへお問い合わせいただく内容をわかりやすくお伝えする」をモットーに、私たちも様々な内容の記事を取り上げてまいりました。<br>今後もよりお役に立てる記事の作成やブログの品質向上を目的に、この度、匿名回答でのアンケートを用意させていただきました。<br>1分程度で回答できる内容となっております。ぜひご協力をいただけますと幸いです。</p><p>以下 [Read more] をクリックし、表示されるアンケートフォームからご回答ください。<br>*こちらの<a href="https://forms.microsoft.com/r/LfhqfuwNeg">リンク</a>からもアクセス可能です。</p><span id="more"></span><iframe width="680px" height="600px" src="https://forms.microsoft.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR8vbNkPEq5NBksLHn6yNV_lUOEhONDBTT1VJWElINUNLUDRCVkRTV0w1NC4u&embed=true" frameborder="0" marginwidth="0" marginheight="0" style="border: none; max-width:100%; max-height:100vh" allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen> </iframe>]]></content>
    
    
    <summary type="html">&lt;/dr&gt;

&lt;p&gt;こんにちは、Power BI サポート チームの山本です。 &lt;/p&gt;
&lt;p&gt;いつもの当ブログをご利用いただいている皆様、また初めて来られたという方も、ありがとうございます。&lt;br&gt;&lt;a href=&quot;https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blog_reflection2022/&quot;&gt;Power BI CSS ブログでよく閲覧されているページランキング&lt;/a&gt;でも取り上げましたが、当ブログは「弊社サポートチームへお問い合わせいただく内容をわかりやすくお伝えする」をモットーに、私たちも様々な内容の記事を取り上げてまいりました。&lt;br&gt;今後もよりお役に立てる記事の作成やブログの品質向上を目的に、この度、匿名回答でのアンケートを用意させていただきました。&lt;br&gt;1分程度で回答できる内容となっております。ぜひご協力をいただけますと幸いです。&lt;/p&gt;
&lt;p&gt;以下 [Read more] をクリックし、表示されるアンケートフォームからご回答ください。&lt;br&gt;*こちらの&lt;a href=&quot;https://forms.microsoft.com/r/LfhqfuwNeg&quot;&gt;リンク&lt;/a&gt;からもアクセス可能です。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
  </entry>
  
  <entry>
    <title>Power BI Service へのアクセス制御① 条件付きアクセス</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_conditional-access/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_conditional-access/</id>
    <published>2022-11-29T15:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.327Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの亀田です。<br>セキュリティの観点から、Power BI Service へのアクセスを制限したいというお問い合わせを受けることがあります。今回はアクセス制御を行う方法の1つである  ｢条件付きアクセス｣ について説明します。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="目次"><a href="#目次" class="headerlink" title="目次"></a>目次</h2><hr><ul><li><a href="#%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%A8%E3%81%AF">条件付きアクセスとは</a></li><li><a href="#%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%AE%E8%A8%AD%E5%AE%9A">条件付きアクセスの設定</a></li><li><a href="#%E8%A8%AD%E5%AE%9A%E6%89%8B%E9%A0%86">設定手順</a><br>  <a href="#1-%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%82%92%E8%A8%B1%E5%8F%AF%E3%81%99%E3%82%8BIP%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9%E3%81%AE%E7%99%BB%E9%8C%B2">1.アクセスを許可するIPアドレスの登録</a><br>  <a href="#2-%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E3%81%AE%E3%83%9D%E3%83%AA%E3%82%B7%E3%83%BC%E3%81%AE%E4%BD%9C%E6%88%90">2.条件付きアクセスのポリシーの作成</a></li></ul><hr><h2 id="条件付きアクセスとは"><a href="#条件付きアクセスとは" class="headerlink" title="条件付きアクセスとは"></a>条件付きアクセスとは</h2><hr><p>条件付きアクセスは、 Azure Active Directory (以降AAD) で設定できる機能となります。条件付きアクセスを設定することで、ユーザーのIPアドレスやデバイス、アプリケーションを条件としてアクセスを制御することが可能となります。なお、設定にはAAD Premium P1ライセンスが必要となりますこと、ご留意ください。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/conditional-access/overview">Azure Active Directory の条件付きアクセスとは - Microsoft Entra | Microsoft Learn</a></p><hr><h2 id="条件付きアクセスの設定"><a href="#条件付きアクセスの設定" class="headerlink" title="条件付きアクセスの設定"></a>条件付きアクセスの設定</h2><hr><p>Power BI Service へのアクセスを制限するためには、以下のポリシーを設定します。</p><ul><li>Power BI Service へのアクセスをブロック</li><li>特定のIPアドレスからのアクセスを例外として許可</li></ul><p>このように設定することで、例えば社内ネットワーク内からのみ Power BI Service にアクセスさせることが可能になります。</p><hr><h2 id="設定手順"><a href="#設定手順" class="headerlink" title="設定手順"></a>設定手順</h2><hr><p>条件付きアクセスの設定は、次のような手順となります。</p><ol><li>アクセスを許可するIPアドレスの登録</li><li>条件付きアクセスのポリシーの作成</li></ol><p>それぞれの詳細な手順について、以下に説明します。なお、この設定はAzure Portal上での設定となり、Power BI管理者とは異なる権限が必要となりますのでご注意ください。</p><p>参考# <a href="https://learn.microsoft.com/ja-jp/azure/active-directory/conditional-access/howto-conditional-access-policy-location">条件付きアクセス - 場所ごとにアクセスをブロックする - Azure Active Directory - Microsoft Entra | Microsoft Learn</a></p><hr><h3 id="1-アクセスを許可するIPアドレスの登録"><a href="#1-アクセスを許可するIPアドレスの登録" class="headerlink" title="1.アクセスを許可するIPアドレスの登録"></a>1.アクセスを許可するIPアドレスの登録</h3><hr><p>まずはじめに、[Azure Portal] にアクセスし、[Azure Active Directory] &gt; [セキュリティ] をクリックします。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig01.png"></div>  <p>このあとの条件付きアクセスの設定で利用するため、[ネームド ロケーション] &gt; [IP 範囲の場所] を選択し、IPアドレスを登録します。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig02.png"></div>  <p>IPアドレスが登録できたら、次に案内する手順で条件付きアクセス ポリシーを作成します。</p><hr><h3 id="2-条件付きアクセスのポリシーの作成"><a href="#2-条件付きアクセスのポリシーの作成" class="headerlink" title="2.条件付きアクセスのポリシーの作成"></a>2.条件付きアクセスのポリシーの作成</h3><hr><p>[条件付きアクセス] をクリックします。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig03.png"></div>  <p>[新しいポリシー] をクリックします。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig04.png"></div>  <p>名前を入力し、[ユーザーまたはワークロード] で対象を選択します。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig05.png"></div>  <p>今回は、Power BI Service を対象にアクセスを制御したいため、[クラウド アプリまたは操作] &gt; [対象] &gt; [アプリを選択] &gt; [選択] の [なし] をクリックし、[Power BI Service] にチェックをいれ [選択] をクリックします。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig06.png"></div>  <p>[条件] &gt; [場所] &gt; [構成] の [はい] を選択します。[対象外] &gt; [選択された場所] &gt; [なし] をクリックすると、右側にネームド ロケーションを選択する欄が表示されます。手順1で作成したIPアドレスのネームド ロケーションを選択し、[選択] をクリックします。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig07.png"></div>  <p>[アクセス制御] &gt; [許可] で、[アクセスのブロック] を選択し、[選択] をクリックします。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig08.png"></div>  <p>最後に、[ポリシーの有効化] を”オン”にすることで、このポリシーが適用されます。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig09.png"></div>  <p>上記設定後、設定したIPアドレス外からアクセスをすると以下のようにPower BI Serviceにアクセスすることができなくなります。</p><div align="center"><img src="2022-11_アクセス制御-条件付きアクセス_fig10.png"></div>  <p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの亀田です。&lt;br&gt;セキュリティの観点から、Power BI Service へのアクセスを制限したいというお問い合わせを受けることがあります。今回はアクセス制御を行う方法の1つである  ｢条件付きアクセス｣ について説明します。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="アクセス制御" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9%E5%88%B6%E5%BE%A1/"/>
    
    <category term="条件付きアクセス" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%A2%E3%82%AF%E3%82%BB%E3%82%B9/"/>
    
  </entry>
  
  <entry>
    <title>Oracle データベースとの接続におけるトラブルシューティング</title>
    <link href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_oracle_driver/"/>
    <id>https://jpbap-sqlbi.github.io/blog/powerbi/pbi_oracle_driver/</id>
    <published>2022-10-31T05:00:00.000Z</published>
    <updated>2023-04-12T04:01:09.567Z</updated>
    
    <content type="html"><![CDATA[<p>こんにちは、Power BI サポート チームの山崎です。<br>Power BI には現在 、様々なコネクタが実装され、<a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/power-bi-data-sources">接続がサポートされているデータソース</a> が多くありますが、データソースによっては端末とデータソース間の接続を確立するためにドライバーの インストールが必要となります。  </p><p>このため、弊社サポートには、 Power BI Desktop やオンプレミスデータゲートウェイから対象のデータソースに接続できないというお問い合わせをいただくことがありますが、まずは前提条件として、ドライバーの観点でその端末とデータソース間の接続が確立されているかをご確認、いただくようにしております。  </p><p>ドライバーのインストールや設定方法については 対象データソースの開発元にお問い合わせいただく必要がありますが、今回は特によくお問い合わせをいただく Oracle データベースとの接続シナリオについて、ご参考情報をご案内いたします。</p><span id="more"></span><div class="alert is-important"><p class="alert-title">重要</p><p>本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、　　</p><p>本記事編集時点と実際の機能に相違がある場合がございます。</p><p>最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。</p></div><hr><h2 id="Oracle-データベースへの接続に必要なドライバー"><a href="#Oracle-データベースへの接続に必要なドライバー" class="headerlink" title="Oracle データベースへの接続に必要なドライバー"></a>Oracle データベースへの接続に必要なドライバー</h2><p>Power BI Desktop やオンプレミスデータゲートウェイから Oracle データベースに接続するには、Power BI Desktopやオンプレミスデータゲートウェイ アプリを実行しているコンピューター上に適切な Oracle クライアント ソフトウェアをインストールする必要があります。</p><h3 id="1-Power-BI-Desktop-からの接続の場合"><a href="#1-Power-BI-Desktop-からの接続の場合" class="headerlink" title="1.Power BI Desktop からの接続の場合"></a>1.Power BI Desktop からの接続の場合</h3><p>使用している Power BI Desktop のビットバージョンにあわせた Oracle クライアントをインストールします。<br>つまり、32 ビットバージョンの Power BI Desktop を使用している場合は 32 ビット Oracle クライアントをインストールし、64 ビットバージョンの Power BI Desktop を使用している場合は 64 ビット Oracle クライアントをインストールします。  </p><h3 id="2-オンプレミスデータゲートウェイからの接続の場合"><a href="#2-オンプレミスデータゲートウェイからの接続の場合" class="headerlink" title="2.オンプレミスデータゲートウェイからの接続の場合"></a>2.オンプレミスデータゲートウェイからの接続の場合</h3><p>オンプレミスデータゲートウェイは 64 ビットアプリとなりますので、64 ビット Oracle クライアントをインストールします。</p><p>インストール方法の詳細につきましては以下参考情報をご確認くださいますようお願いいたします。</p><p>参考情報：<br><a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/desktop-connect-oracle-database#64-bit-and-32-bit-drivers-for-power-bi-desktop">Power BI Desktop を使用して Oracle データベースに接続する</a><br><a href="https://learn.microsoft.com/ja-jp/power-bi/connect-data/service-gateway-onprem-manage-oracle#install-the-oracle-client">データ ソースの管理 - Oracle</a>  </p><h2 id="Oracle-データベースへの接続テスト"><a href="#Oracle-データベースへの接続テスト" class="headerlink" title="Oracle データベースへの接続テスト"></a>Oracle データベースへの接続テスト</h2><p>Oracle データベースへ接続できない場合、Power BI Desktop やオンプレミスデータゲートウェイからの接続のみで問題が発生しているのか、対象の端末からの接続自体が確立されていないのか、を切り分ける必要あります 。<br>その際に、以下 PowerShell スクリプトにて確認が可能です。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ORAServer</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="variable">$UserId</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="variable">$Password</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">[<span class="built_in">void</span>][<span class="type">System.Reflection.Assembly</span>]::LoadWithPartialName(<span class="string">&quot;Oracle.DataAccess&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="variable">$oraCon</span> = <span class="built_in">New-Object</span> Oracle.DataAccess.Client.OracleConnection(<span class="string">&quot;User ID=<span class="variable">$</span>(<span class="variable">$UserId</span>);Data Source=<span class="variable">$</span>(<span class="variable">$ORAServer</span>);Password=<span class="variable">$</span>(<span class="variable">$Password</span>)&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="variable">$oraCmd</span> = <span class="variable">$oraCon</span>.CreateCommand()</span><br><span class="line"><span class="variable">$oraCmd</span>.CommandText = <span class="string">&quot;select user from dual&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="variable">$oraCon</span>.Open()</span><br><span class="line">“Connected to database: &#123;<span class="number">0</span>&#125; running on host: &#123;<span class="number">1</span>&#125; – Servicename: &#123;<span class="number">2</span>&#125; – Serverversion: &#123;<span class="number">3</span>&#125;” <span class="operator">-f</span> <span class="variable">$oraCon</span>.DatabaseName, <span class="variable">$oraCon</span>.HostName, <span class="variable">$oraCon</span>.ServiceName, <span class="variable">$oraCon</span>.ServerVersion</span><br><span class="line"> </span><br><span class="line"><span class="variable">$reader</span> = <span class="variable">$oraCmd</span>.ExecuteReader()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$reader</span>.Read()) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$reader</span>.GetString(<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$oraCon</span>.Close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>結果の例：</strong><br>上記スクリプトを ODPNET_ACCESSTEST.ps1 として実行した場合、接続に成功すると以下結果が返ってきます。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:Work&gt; .\ODPNET_ACCESSTEST.ps1</span><br><span class="line">Connected to database: orcldb running on host: ***** ? Srvicename: ***** ? Serverversion:*.*.*.*.*</span><br></pre></td></tr></table></figure><p>成功している場合は、対象の端末からの接続自体は確立されているということになりますので、問題が生じている Power BI Desktop やオンプレミスデータゲートウェイの観点で引き続き調査が必要となります。 </p><p>もしエラーとなる場合は、対象の端末からの接続自体が確立できていないということになりますので、Power BI サポートチームへ Power BI の事象としてお問い合わせをいただく前に、対象の端末とデータソース間の接続において発生している問題のトラブルシューティングを実施いただきますようお願いいたします。  </p><p>以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。</p><hr><p><strong>アンケートご協力のお願い</strong><br>Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。<br>ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 </p><p>※　所要時間は1分程度となります。<br><a href="https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/">【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;こんにちは、Power BI サポート チームの山崎です。&lt;br&gt;Power BI には現在 、様々なコネクタが実装され、&lt;a href=&quot;https://learn.microsoft.com/ja-jp/power-bi/connect-data/power-bi-data-sources&quot;&gt;接続がサポートされているデータソース&lt;/a&gt; が多くありますが、データソースによっては端末とデータソース間の接続を確立するためにドライバーの インストールが必要となります。  &lt;/p&gt;
&lt;p&gt;このため、弊社サポートには、 Power BI Desktop やオンプレミスデータゲートウェイから対象のデータソースに接続できないというお問い合わせをいただくことがありますが、まずは前提条件として、ドライバーの観点でその端末とデータソース間の接続が確立されているかをご確認、いただくようにしております。  &lt;/p&gt;
&lt;p&gt;ドライバーのインストールや設定方法については 対象データソースの開発元にお問い合わせいただく必要がありますが、今回は特によくお問い合わせをいただく Oracle データベースとの接続シナリオについて、ご参考情報をご案内いたします。&lt;/p&gt;</summary>
    
    
    
    
    <category term="Power BI　　" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI/"/>
    
    <category term="Power BI Desktop" scheme="https://jpbap-sqlbi.github.io/blog/tags/Power-BI-Desktop/"/>
    
    <category term="資格情報" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%B3%87%E6%A0%BC%E6%83%85%E5%A0%B1/"/>
    
    <category term="認証　" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E8%AA%8D%E8%A8%BC/"/>
    
    <category term="データソース設定" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%BD%E3%83%BC%E3%82%B9%E8%A8%AD%E5%AE%9A/"/>
    
    <category term="トラブルシューティング" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0/"/>
    
    <category term="オンプレミスデータゲートウェイ" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%82%AA%E3%83%B3%E3%83%97%E3%83%AC%E3%83%9F%E3%82%B9%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4/"/>
    
    <category term="Oracle" scheme="https://jpbap-sqlbi.github.io/blog/tags/Oracle/"/>
    
    <category term="ドライバー" scheme="https://jpbap-sqlbi.github.io/blog/tags/%E3%83%89%E3%83%A9%E3%82%A4%E3%83%90%E3%83%BC/"/>
    
  </entry>
  
</feed>
