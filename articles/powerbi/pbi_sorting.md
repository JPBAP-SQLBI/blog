---
title: よくある「並べ替え」のお問い合わせ
date: 2023-03-31 00:00:00 
tags:
  - Power BI
  - Power BI Desktop
---


こんにちは、Power BI サポート チーム 丸山です。

Power BI でレポートを作成しているとき、ビジュアル内のデータの「並べ替え」を行いたいことがあると思います。
今回は「並べ替え」についてよくあるお問い合わせと、その代表的な解決策をご紹介します。

<!-- more -->


> [!IMPORTANT]  
> 本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、
> 本記事編集時点と実際の機能に相違がある場合がございます。  
> 最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。

---
## 目次
---
 [前提：ビジュアルのメニュー「軸の並び替え」](#前提：ビジュアルのメニュー「軸の並び替え」)
 [ケース１：列がテキスト型であるため意図した順にならない場合](#ケース１：列がテキスト型であるため意図した順にならない場合)
 [ケース２：２つの列を使って「並び替え」したい場合](#ケース２：２つの列を使って「並び替え」したい場合)

---
## 前提：ビジュアルのメニュー「軸の並び替え」
---
ビジュアル内のフィールドで並べ替え（昇順/降順）をしたい場合は、以下図の手順で可能です。

ビジュアル右上 (…) > 軸の並べ替え > フィールド名と昇順/降順を選択
<div align="center">
<img src="1.png">
</div>

</br>

凡例についても、凡例に使用している列で「並べ替え」を行うことが可能です。

</br>

> [!NOTE]
> // 参考情報：[レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn](https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort)

</br>

---
## ケース１：列がテキスト型であるため意図した順にならない場合
---

特定の列で並べ替えをしようと思っても、列がテキスト型である場合は意図した順にならず、
テキストによる並び順になってしまいます（見た目が数値でも）

例） X軸の「月（テキスト型）」で昇順にした場合。1から始まる名称が先頭に並んでいる
<div align="center">
<img src="2.png">
</div>
 
</br>

この問題を解決するには、根本的にはデータアーキテクトの観点でデータソース側のデータの持ち方を変更するということが
重要な場合もありますが、Power BI 上でどうにかしたいという場合は、別の列をもとに並べ替えるという解決策があります。
具体的な手順は以下です。

</br>

ステップ１：並べ替えのもととなる数値型の列を作成する（すでにある場合はステップ２へ）

① Power Query エディタを開く
Power BI Desktop > ホーム > データの変換
<div align="center">
<img src="3.png">
</div>

</br>

② 列を作成する（以下は一例です。シナリオによっては別の方法で列を作成します）
列の追加 > 例からの列 > 選択範囲から > 例をいくつか入力すると法則から値が自動入力される
<div align="center">
<img src="4.png">
</div>

</br>

③ Power Query エディタを閉じて適用する
<div align="center">
<img src="5.png">
</div>

</br>

ステップ２ ： 「列で並べ替え」を設定する

テキスト型のフィールドを選択 > 列で並べ替え > 作成した数値型の列を選択する
<div align="center">
<img src="6.png">
</div>

</br>

ステップ３：[軸の並べ替え] をすると、裏側では数値型をもとにして並び替えが完了する

<div align="center">
<img src="7.png">
</div>

</br>

> [!NOTE]
> // 参考情報：[Power BI で 1 つの列をほかの列で並べ替える - Power BI | Microsoft Learn](https://learn.microsoft.com/ja-jp/power-bi/create-reports/desktop-sort-by-column?tabs=powerbi-desktop)

</br>

---
## ケース２：２つの列を使って「並び替え」したい場合
---

列１の値の中で重複するものが存在していて、列２の値も含めて並べ替えをしたい場合、
列１の並べ替えを実施した後に、Shift キーを押しながら列２のヘッダーをクリックすると、
列１の並べ替えを保持したまま、列２の並べ替えを設定することが可能です。

以下テーブルビジュアルを例にご説明いたします。
「列１」をクリックして並べ替えをした後、Shift キーを押しながら「列2」をクリックします。すると、列１内で重複した値 “3” や “2” に対する列２の値が、それぞれ降順で並べ替えられているのがわかります。

※昇順と降順の切り替えは、Shift キーを押したままもう一度ヘッダーをクリックする
<div align="center">
<img src="8.png">
</div>

</br>

> [!NOTE]
> // 参考情報：[レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn](https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort)

</br>

以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。

---

**アンケートご協力のお願い**
Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。
ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 

※　所要時間は1分程度となります。
[【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート](https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/)