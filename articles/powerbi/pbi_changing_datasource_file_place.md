---
title: pbix ファイルのデータソースのファイル格納場所が変更される場合の対処策
date: 2023-09-30 00:00:00 
tags:
  - Power BI
  - Power BI Desktop
  - データソース設定
---


こんにちは、Power BI サポート チーム 丸山です。

Excel ファイルや CSV ファイルをデータソースにして Power BI レポートを作成したあと、「ファイルの格納場所が変更になる」という場合がございます。
その場合、基本的にはレポートを新規作成して新しい格納場所にあるファイルに接続をしますが、既存レポートが作りこんだ内容である場合、「そのレポートの作りを残したままデータソースの接続先だけを変更したい」というお問い合わせがよくあります。今回はその代表的な対処策を１つご紹介します。

<!-- more -->
<div align="center">
<img src="1.jpg">
</div>

</br>

> [!IMPORTANT]  
> 本記事は弊社公式ドキュメントの公開情報を元に構成しておりますが、
> 本記事編集時点と実際の機能に相違がある場合がございます。  
> 最新情報につきましては、参考情報として記載しておりますドキュメントをご確認ください。

---
## 目次
---
 [本ブログの前提](#本ブログの前提)
 [データソースのファイルの格納場所が変更される場合の対処策](#データソースのファイルの格納場所が変更される場合の対処策)

---
## 本ブログの前提
---
Excel ファイルや CSV ファイルをデータソースにしていて、そのファイルの格納場所がローカルフォルダから SharePoint フォルダに変更される場合その逆、またはローカルフォルダ内（SharePoint フォルダ内）で移動される場合を想定しています。

</br>

---
## データソースのファイルの格納場所が変更される場合の対処策
---

Power BI Desktop で pbixファイルを開いて、Power Query エディターで、データソースの接続部分を新しい接続先に差し替えます。具体的な手順は以下です。

1. バックアップとして、対象の pbix ファイルをコピーしておきます。

2. 対象の pbix ファイルを開き、「データの変換」から Power Query エディターを開きます。
<div align="center">
<img src="2.jpg">
</div>
 
</br>

3. 新しい接続先のダミーのクエリを以下の手順で生成してコピーします。
①「新しいソース」 > 「その他」
<div align="center">
<img src="3.jpg">
</div>

</br>

② 新しい接続先のコネクタ（以下例は SharePoint フォルダー）でデータを取得します。
<div align="center">
<img src="4.jpg">
</div>

</br>

③ ②で作成した新しいクエリ（テーブル）を選択 > ホーム > 詳細エディター　を押して、
クエリ（画像の赤太枠の部分）をコピーして、「キャンセル」で閉じます。
<div align="center">
<img src="5.jpg">
</div>

</br>

4. 既存のクエリ（テーブル）選択  > ホーム > 詳細エディター　を押して、３でコピーしたクエリの部分（例でいうと「ソース」から「変更された型」まで）を差し替えます。

<div align="center">
<img src="6.jpg">
</div>

</br>

※注意点
・貼り付け用のクエリ以上の部分を消さないようにします（上記画像だと「追加されたカスタム」の行は残す）
・貼り付けたクエリのうしろにステップが存在する場合は、以下画像のように貼り付けたクエリの最後に「,（カンマ）」を忘れずに付けます（付けないと「’,’ が必要です」というエラーメッセージが出る）

<div align="center">
<img src="7.jpg">
</div>

</br>

・読み込んでいるクエリ（テーブル）が複数ある場合は、すべて差し替えます。


（差し替えがすべて完了したら、手順３で作成したダミーのクエリは削除して問題ありません。）

</br>

４．Power Query エディターを「閉じて適用」をします。
<div align="center">
<img src="8.jpg">
</div>

</br>
適用後は、レポートが変更前と変わらず表示できていることを確認しましょう。
Power BI サービスにレポートを発行している場合は、再度、発行をしてデータセット更新の設定を改めて行ってください。

</br>

上記でご紹介した内容はあくまで１つの方法論でございます。
結論としては、Power Query 内のデータソースへの接続部分のクエリで、データソースの変更後の格納場所や名前を問題なく指定することができれば解決となります。 

以上、本ブログが少しでも皆様のお役に立てますと幸いでございます。

</br>

> [!NOTE]
> // 参考情報：[レポート内のグラフの並べ替え方法を変更する - Power BI | Microsoft Learn](https://learn.microsoft.com/ja-jp/power-bi/consumer/end-user-change-sort)

</br>

---

**アンケートご協力のお願い**
Japan CSS Support Power BI Blog では、作成する記事やブログの品質向上を目的に、匿名回答でのアンケートを実施しております。
ユーザー様のご意見・ご要望を参考に今後もお役に立てるブログを目指してまいりますので、ぜひご協力いただけますと幸いでございます。 

※　所要時間は1分程度となります。
[【ご協力のお願い】Microsoft Japan CSS Power BI Blog ご利用に関するアンケート](https://jpbap-sqlbi.github.io/blog/powerbi/pbi_blogsurvey2022/)